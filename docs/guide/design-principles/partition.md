---
title: Разделение для обхода ограничений
titleSuffix: Azure Application Architecture Guide
description: Применяйте секционирование для обхода ограничений базы данных, сети и вычислений.
author: MikeWasson
ms.date: 08/30/2018
ms.custom: seojan19
ms.openlocfilehash: f6c0daa1b1ea469413156fdf3cd6969f98528fb3
ms.sourcegitcommit: 1f4cdb08fe73b1956e164ad692f792f9f635b409
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2019
ms.locfileid: "54110498"
---
# <a name="partition-around-limits"></a><span data-ttu-id="10805-103">Разделение для обхода ограничений</span><span class="sxs-lookup"><span data-stu-id="10805-103">Partition around limits</span></span>

## <a name="use-partitioning-to-work-around-database-network-and-compute-limits"></a><span data-ttu-id="10805-104">Используйте секционирования для обхода лимитов базы данных, сети и вычислений</span><span class="sxs-lookup"><span data-stu-id="10805-104">Use partitioning to work around database, network, and compute limits</span></span>

<span data-ttu-id="10805-105">В облаке все службы ограничены по масштабированию.</span><span class="sxs-lookup"><span data-stu-id="10805-105">In the cloud, all services have limits in their ability to scale up.</span></span> <span data-ttu-id="10805-106">Сведения о других ограничениях Azure см. в статье [Подписка Azure, границы, квоты и ограничения службы][azure-limits].</span><span class="sxs-lookup"><span data-stu-id="10805-106">Azure service limits are documented in [Azure subscription and service limits, quotas, and constraints][azure-limits].</span></span> <span data-ttu-id="10805-107">Ограничения могут распространяться на количество ядер, размер базы данных, пропускную способность запросов и сети.</span><span class="sxs-lookup"><span data-stu-id="10805-107">Limits include number of cores, database size, query throughput, and network throughput.</span></span> <span data-ttu-id="10805-108">Вы можете достигнуть одного или нескольких из этих ограничений, если система станет достаточно большой.</span><span class="sxs-lookup"><span data-stu-id="10805-108">If your system grows sufficiently large, you may hit one or more of these limits.</span></span> <span data-ttu-id="10805-109">С помощью секционирования можно обойти эти ограничения.</span><span class="sxs-lookup"><span data-stu-id="10805-109">Use partitioning to work around these limits.</span></span>

<span data-ttu-id="10805-110">Существует много способов разделения системы, например:</span><span class="sxs-lookup"><span data-stu-id="10805-110">There are many ways to partition a system, such as:</span></span>

- <span data-ttu-id="10805-111">Разделение базы данных, чтобы избежать ограничений на размер базы данных, ввод-вывод данных и количество одновременных сеансов.</span><span class="sxs-lookup"><span data-stu-id="10805-111">Partition a database to avoid limits on database size, data I/O, or number of concurrent sessions.</span></span>

- <span data-ttu-id="10805-112">Разделение шины очереди или сообщения, чтобы избежать ограничений на число запросов и число одновременных подключений.</span><span class="sxs-lookup"><span data-stu-id="10805-112">Partition a queue or message bus to avoid limits on the number of requests or the number of concurrent connections.</span></span>

- <span data-ttu-id="10805-113">Разделение веб-приложения службы приложений, чтобы избежать ограничения на число экземпляров для каждого плана служб приложений.</span><span class="sxs-lookup"><span data-stu-id="10805-113">Partition an App Service web app to avoid limits on the number of instances per App Service plan.</span></span>

<span data-ttu-id="10805-114">База данных может быть секционирована *горизонтально*, *вертикально* или *функционально*.</span><span class="sxs-lookup"><span data-stu-id="10805-114">A database can be partitioned *horizontally*, *vertically*, or *functionally*.</span></span>

- <span data-ttu-id="10805-115">В горизонтальном секционировании, также называемым сегментированием, каждая секция содержит данные подмножества полного набора данных.</span><span class="sxs-lookup"><span data-stu-id="10805-115">In horizontal partitioning, also called sharding, each partition holds data for a subset of the total data set.</span></span> <span data-ttu-id="10805-116">Секции используют одну и ту же схему данных.</span><span class="sxs-lookup"><span data-stu-id="10805-116">The partitions share the same data schema.</span></span> <span data-ttu-id="10805-117">Например, пользователи, имена которых начинаются с А&ndash;M, переходят в одну секцию, а те, у кого имена начинаются с N&ndash;Z, — в другую.</span><span class="sxs-lookup"><span data-stu-id="10805-117">For example, customers whose names start with A&ndash;M go into one partition, N&ndash;Z into another partition.</span></span>

- <span data-ttu-id="10805-118">В вертикальном секционировании каждая секция содержит подмножество полей для элементов в хранилище данных.</span><span class="sxs-lookup"><span data-stu-id="10805-118">In vertical partitioning, each partition holds a subset of the fields for the items in the data store.</span></span> <span data-ttu-id="10805-119">Например, часто используемые поля размещаются в одной секции, а более редко используемые — в другой.</span><span class="sxs-lookup"><span data-stu-id="10805-119">For example, put frequently accessed fields in one partition, and less frequently accessed fields in another.</span></span>

- <span data-ttu-id="10805-120">В функциональном секционировании данные разделяются в соответствии с тем, как они используются каждым ограниченным контекстом в системе.</span><span class="sxs-lookup"><span data-stu-id="10805-120">In functional partitioning, data is partitioned according to how it is used by each bounded context in the system.</span></span> <span data-ttu-id="10805-121">Например, можно хранить данные счета в одном разделе и данные по инвентаризации продуктов в другом.</span><span class="sxs-lookup"><span data-stu-id="10805-121">For example, store invoice data in one partition and product inventory data in another.</span></span> <span data-ttu-id="10805-122">Схемы независимы.</span><span class="sxs-lookup"><span data-stu-id="10805-122">The schemas are independent.</span></span>

<span data-ttu-id="10805-123">Дополнительные сведения можно найти в статье [Data partitioning][data-partitioning-guidance] (Секционирование данных).</span><span class="sxs-lookup"><span data-stu-id="10805-123">For more detailed guidance, see [Data partitioning][data-partitioning-guidance].</span></span>

## <a name="recommendations"></a><span data-ttu-id="10805-124">Рекомендации</span><span class="sxs-lookup"><span data-stu-id="10805-124">Recommendations</span></span>

<span data-ttu-id="10805-125">**Разделение разных частей приложения**.</span><span class="sxs-lookup"><span data-stu-id="10805-125">**Partition different parts of the application**.</span></span> <span data-ttu-id="10805-126">Базы данных являются одними из очевидных кандидатов для секционирования, но также рекомендуется разделять хранилища, кэш, очереди и вычислительные экземпляры.</span><span class="sxs-lookup"><span data-stu-id="10805-126">Databases are one obvious candidate for partitioning, but also consider storage, cache, queues, and compute instances.</span></span>

<span data-ttu-id="10805-127">**Разработка ключа раздела для устранения областей с большой нагрузкой**.</span><span class="sxs-lookup"><span data-stu-id="10805-127">**Design the partition key to avoid hot spots**.</span></span> <span data-ttu-id="10805-128">Если после разделения базы данных один из сегментов по-прежнему получает большинство запросов, это значит, что проблема не решена.</span><span class="sxs-lookup"><span data-stu-id="10805-128">If you partition a database, but one shard still gets the majority of the requests, then you haven't solved your problem.</span></span> <span data-ttu-id="10805-129">В идеале после разделения нагрузка должна распределяться равномерно по всем разделам.</span><span class="sxs-lookup"><span data-stu-id="10805-129">Ideally, load gets distributed evenly across all the partitions.</span></span> <span data-ttu-id="10805-130">Например, хэширование происходит по идентификатору клиента, а не по первой букве его имени, так как некоторые буквы встречаются чаще.</span><span class="sxs-lookup"><span data-stu-id="10805-130">For example, hash by customer ID and not the first letter of the customer name, because some letters are more frequent.</span></span> <span data-ttu-id="10805-131">Тот же принцип применяется при секционировании очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="10805-131">The same principle applies when partitioning a message queue.</span></span> <span data-ttu-id="10805-132">Выберите ключ раздела, который позволит равномерно распределить сообщения по множеству очередей.</span><span class="sxs-lookup"><span data-stu-id="10805-132">Pick a partition key that leads to an even distribution of messages across the set of queues.</span></span> <span data-ttu-id="10805-133">Дополнительные сведения можно найти в разделе [Sharding pattern][sharding] (Шаблон сегментирования)</span><span class="sxs-lookup"><span data-stu-id="10805-133">For more information, see [Sharding][sharding].</span></span>

<span data-ttu-id="10805-134">**Разделение по ограничениям подписки и службы Azure**.</span><span class="sxs-lookup"><span data-stu-id="10805-134">**Partition around Azure subscription and service limits**.</span></span> <span data-ttu-id="10805-135">У отдельных компонентов и служб имеются ограничения, как и у подписок и групп ресурсов.</span><span class="sxs-lookup"><span data-stu-id="10805-135">Individual components and services have limits, but there are also limits for subscriptions and resource groups.</span></span> <span data-ttu-id="10805-136">Для очень больших приложений может потребоваться разделить эти ограничения.</span><span class="sxs-lookup"><span data-stu-id="10805-136">For very large applications, you might need to partition around those limits.</span></span>

<span data-ttu-id="10805-137">**Разделение на разных уровнях**.</span><span class="sxs-lookup"><span data-stu-id="10805-137">**Partition at different levels**.</span></span> <span data-ttu-id="10805-138">Рассмотрим сервер базы данных, развернутый на виртуальной машине.</span><span class="sxs-lookup"><span data-stu-id="10805-138">Consider a database server deployed on a VM.</span></span> <span data-ttu-id="10805-139">Виртуальная машина содержит виртуальный жесткий диск, который поддерживается службой хранилища Azure.</span><span class="sxs-lookup"><span data-stu-id="10805-139">The VM has a VHD that is backed by Azure Storage.</span></span> <span data-ttu-id="10805-140">Учетная запись хранения относится к подписке Azure.</span><span class="sxs-lookup"><span data-stu-id="10805-140">The storage account belongs to an Azure subscription.</span></span> <span data-ttu-id="10805-141">Обратите внимание, что каждый шаг в иерархии имеет свои ограничения.</span><span class="sxs-lookup"><span data-stu-id="10805-141">Notice that each step in the hierarchy has limits.</span></span> <span data-ttu-id="10805-142">У сервера базы данных может быть ограничен пул соединений.</span><span class="sxs-lookup"><span data-stu-id="10805-142">The database server may have a connection pool limit.</span></span> <span data-ttu-id="10805-143">Виртуальные машины имеют ограничения на использование ЦП и сети.</span><span class="sxs-lookup"><span data-stu-id="10805-143">VMs have CPU and network limits.</span></span> <span data-ttu-id="10805-144">Хранилище имеет ограничение на число операций ввода-вывода в секунду.</span><span class="sxs-lookup"><span data-stu-id="10805-144">Storage has IOPS limits.</span></span> <span data-ttu-id="10805-145">Подписка имеет ограничения по количеству ядер виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="10805-145">The subscription has limits on the number of VM cores.</span></span> <span data-ttu-id="10805-146">Как правило, проще разделять объект более низкого уровня иерархии.</span><span class="sxs-lookup"><span data-stu-id="10805-146">Generally, it's easier to partition lower in the hierarchy.</span></span> <span data-ttu-id="10805-147">Только крупные приложения следует разделять на уровне подписки.</span><span class="sxs-lookup"><span data-stu-id="10805-147">Only large applications should need to partition at the subscription level.</span></span>

<!-- links -->

[azure-limits]: /azure/azure-subscription-service-limits
[data-partitioning-guidance]: ../../best-practices/data-partitioning.md
[sharding]: ../../patterns/sharding.md
