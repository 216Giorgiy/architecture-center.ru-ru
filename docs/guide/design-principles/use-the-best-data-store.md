---
title: Использование подходящего хранилища данных для задания
titleSuffix: Azure Application Architecture Guide
description: Выберите подходящую технологию хранения для используемых данных и способ ее использования.
author: MikeWasson
ms.date: 08/30/2018
ms.topic: guide
ms.service: architecture-center
ms.subservice: reference-architecture
ms.custom: seojan19
ms.openlocfilehash: 2f83e7a184e8fa94f49da4e8fd5252396ecfd632
ms.sourcegitcommit: c053e6edb429299a0ad9b327888d596c48859d4a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/20/2019
ms.locfileid: "58242015"
---
# <a name="use-the-best-data-store-for-the-job"></a><span data-ttu-id="fbd3e-103">Использование подходящего хранилища данных для задания</span><span class="sxs-lookup"><span data-stu-id="fbd3e-103">Use the best data store for the job</span></span>

## <a name="pick-the-storage-technology-that-is-the-best-fit-for-your-data-and-how-it-will-be-used"></a><span data-ttu-id="fbd3e-104">Выберите подходящую технологию хранения в соответствии с типом данных и методами их использования.</span><span class="sxs-lookup"><span data-stu-id="fbd3e-104">Pick the storage technology that is the best fit for your data and how it will be used</span></span>

<span data-ttu-id="fbd3e-105">Те времена, когда можно было просто поместить все данные в большую реляционную базу данных SQL, остались в прошлом.</span><span class="sxs-lookup"><span data-stu-id="fbd3e-105">Gone are the days when you would just stick all of your data into a big relational SQL database.</span></span> <span data-ttu-id="fbd3e-106">Реляционные базы данных отлично справляются со своей основной задачей &mdash; поддержкой гарантий ACID для транзакций с реляционными данными.</span><span class="sxs-lookup"><span data-stu-id="fbd3e-106">Relational databases are very good at what they do &mdash; providing ACID guarantees for transactions over relational data.</span></span> <span data-ttu-id="fbd3e-107">Но у них есть и ряд недостатков:</span><span class="sxs-lookup"><span data-stu-id="fbd3e-107">But they come with some costs:</span></span>

- <span data-ttu-id="fbd3e-108">Для запросов могут потребоваться дорогостоящие соединения.</span><span class="sxs-lookup"><span data-stu-id="fbd3e-108">Queries may require expensive joins.</span></span>
- <span data-ttu-id="fbd3e-109">Нужна дополнительная нормализация данных и соблюдение предварительно определенной схемы (схема при записи).</span><span class="sxs-lookup"><span data-stu-id="fbd3e-109">Data must be normalized and conform to a predefined schema (schema on write).</span></span>
- <span data-ttu-id="fbd3e-110">Конфликты блокировки могут снижать производительность.</span><span class="sxs-lookup"><span data-stu-id="fbd3e-110">Lock contention may impact performance.</span></span>

<span data-ttu-id="fbd3e-111">Скорее всего, в любом крупном решении одной технологии хранилища данных окажется недостаточно.</span><span class="sxs-lookup"><span data-stu-id="fbd3e-111">In any large solution, it's likely that a single data store technology won't fill all your needs.</span></span> <span data-ttu-id="fbd3e-112">Кроме реляционных баз данных есть множество альтернативных технологий: хранилище ключей и значений, база данных документов, базы данных для поисковых систем, базы данных временных рядов, базы данных семейства столбцов, базы данных графов и т. д.</span><span class="sxs-lookup"><span data-stu-id="fbd3e-112">Alternatives to relational databases include key/value stores, document databases, search engine databases, time series databases, column family databases, and graph databases.</span></span> <span data-ttu-id="fbd3e-113">Каждый из этих вариантов имеет свои преимущества и недостатки и каждый хорошо подходит для определенных типов данных.</span><span class="sxs-lookup"><span data-stu-id="fbd3e-113">Each has pros and cons, and different types of data fit more naturally into one or another.</span></span>

<span data-ttu-id="fbd3e-114">Например, каталог продуктов можно хранить в базе данных документов, такой как Cosmos DB, которая позволяет использовать гибкую схему данных.</span><span class="sxs-lookup"><span data-stu-id="fbd3e-114">For example, you might store a product catalog in a document database, such as Cosmos DB, which allows for a flexible schema.</span></span> <span data-ttu-id="fbd3e-115">В этом примере каждое описание продукта является полностью автономным документом.</span><span class="sxs-lookup"><span data-stu-id="fbd3e-115">In that case, each product description is a self-contained document.</span></span> <span data-ttu-id="fbd3e-116">Чтобы выполнять запросы по всему каталогу, проиндексируйте его и сохраните полученный индекс в службе "Поиск Azure".</span><span class="sxs-lookup"><span data-stu-id="fbd3e-116">For queries over the entire catalog, you might index the catalog and store the index in Azure Search.</span></span> <span data-ttu-id="fbd3e-117">Список товаров лучше разместить в базе данных SQL, так как для этих данных нужны гарантии ACID.</span><span class="sxs-lookup"><span data-stu-id="fbd3e-117">Product inventory might go into a SQL database, because that data requires ACID guarantees.</span></span>

<span data-ttu-id="fbd3e-118">И не забывайте, что работать нужно не только с основными данными приложения.</span><span class="sxs-lookup"><span data-stu-id="fbd3e-118">Remember that data includes more than just the persisted application data.</span></span> <span data-ttu-id="fbd3e-119">Есть еще и журналы приложений, события, сообщения и кэши.</span><span class="sxs-lookup"><span data-stu-id="fbd3e-119">It also includes application logs, events, messages, and caches.</span></span>

## <a name="recommendations"></a><span data-ttu-id="fbd3e-120">Рекомендации</span><span class="sxs-lookup"><span data-stu-id="fbd3e-120">Recommendations</span></span>

<span data-ttu-id="fbd3e-121">**Не используйте реляционную базу данных для всех задач.**</span><span class="sxs-lookup"><span data-stu-id="fbd3e-121">**Don't use a relational database for everything**.</span></span> <span data-ttu-id="fbd3e-122">Когда это целесообразно, выбирайте другие хранилища данных.</span><span class="sxs-lookup"><span data-stu-id="fbd3e-122">Consider other data stores when appropriate.</span></span> <span data-ttu-id="fbd3e-123">См. статью [Choose the right data store][data-store-overview] (Выбор правильного хранилища данных).</span><span class="sxs-lookup"><span data-stu-id="fbd3e-123">See [Choose the right data store][data-store-overview].</span></span>

<span data-ttu-id="fbd3e-124">**Предусмотрите возможность многоязычного хранения.**</span><span class="sxs-lookup"><span data-stu-id="fbd3e-124">**Embrace polyglot persistence**.</span></span> <span data-ttu-id="fbd3e-125">Скорее всего, в любом крупном решении одной технологии хранилища данных окажется недостаточно.</span><span class="sxs-lookup"><span data-stu-id="fbd3e-125">In any large solution, it's likely that a single data store technology won't fill all your needs.</span></span>

<span data-ttu-id="fbd3e-126">**Учитывайте типы данных.**</span><span class="sxs-lookup"><span data-stu-id="fbd3e-126">**Consider the type of data**.</span></span> <span data-ttu-id="fbd3e-127">Например, данные о транзакциях лучше хранить в формате SQL, документы JSON — в базе данных документов, данные телеметрии — в базе данных временных рядов, журналы приложений — в Elasticsearch, а большие двоичные объекты — в хранилище BLOB-объектов Azure.</span><span class="sxs-lookup"><span data-stu-id="fbd3e-127">For example, put transactional data into SQL, put JSON documents into a document database, put telemetry data into a time series data base, put application logs in Elasticsearch, and put blobs in Azure Blob Storage.</span></span>

<span data-ttu-id="fbd3e-128">**Доступность данных важнее строгой согласованности.**</span><span class="sxs-lookup"><span data-stu-id="fbd3e-128">**Prefer availability over (strong) consistency**.</span></span> <span data-ttu-id="fbd3e-129">Теорема CAP свидетельствует о том, что в распределенной системе неизбежен компромисс между доступностью и согласованностью.</span><span class="sxs-lookup"><span data-stu-id="fbd3e-129">The CAP theorem implies that a distributed system must make trade-offs between availability and consistency.</span></span> <span data-ttu-id="fbd3e-130">(Невозможно полностью избавиться от сетевых сегментов, которые входят в теорему CAP.) Иногда можно повысить доступность данных, применив модель *согласованности в конечном счете*.</span><span class="sxs-lookup"><span data-stu-id="fbd3e-130">(Network partitions, the other leg of the CAP theorem, can never be completely avoided.) Often, you can achieve higher availability by adopting an *eventual consistency* model.</span></span>

<span data-ttu-id="fbd3e-131">**Учитывайте опыт и навыки разработчиков.**</span><span class="sxs-lookup"><span data-stu-id="fbd3e-131">**Consider the skill set of the development team**.</span></span> <span data-ttu-id="fbd3e-132">Многоязычное хранение дает значительные преимущества, но важно не перейти границы.</span><span class="sxs-lookup"><span data-stu-id="fbd3e-132">There are advantages to using polyglot persistence, but it's possible to go overboard.</span></span> <span data-ttu-id="fbd3e-133">Внедрение новых технологий хранилища данных требует и новых навыков.</span><span class="sxs-lookup"><span data-stu-id="fbd3e-133">Adopting a new data storage technology requires a new set of skills.</span></span> <span data-ttu-id="fbd3e-134">Команда разработчиков должна хорошо понимать, как применить их наиболее эффективно.</span><span class="sxs-lookup"><span data-stu-id="fbd3e-134">The development team must understand how to get the most out of the technology.</span></span> <span data-ttu-id="fbd3e-135">Им предстоит изучить все применимые шаблоны использования, методы оптимизации запросов, настройки производительности и т. д.</span><span class="sxs-lookup"><span data-stu-id="fbd3e-135">They must understand appropriate usage patterns, how to optimize queries, tune for performance, and so on.</span></span> <span data-ttu-id="fbd3e-136">Обязательно учитывайте это при выборе технологий хранилища данных.</span><span class="sxs-lookup"><span data-stu-id="fbd3e-136">Factor this in when considering storage technologies.</span></span>

<span data-ttu-id="fbd3e-137">**Используйте компенсирующие транзакции.**</span><span class="sxs-lookup"><span data-stu-id="fbd3e-137">**Use compensating transactions**.</span></span> <span data-ttu-id="fbd3e-138">Побочный эффект многоязычного хранения заключается в том, что одна транзакция может записывать данные в разные хранилища.</span><span class="sxs-lookup"><span data-stu-id="fbd3e-138">A side effect of polyglot persistence is that single transaction might write data to multiple stores.</span></span> <span data-ttu-id="fbd3e-139">Если что-то пойдет не так, примените компенсирующие транзакции для отмены всех выполненных действий.</span><span class="sxs-lookup"><span data-stu-id="fbd3e-139">If something fails, use compensating transactions to undo any steps that already completed.</span></span>

<span data-ttu-id="fbd3e-140">**Изучите ограниченные контексты.**</span><span class="sxs-lookup"><span data-stu-id="fbd3e-140">**Look at bounded contexts**.</span></span> <span data-ttu-id="fbd3e-141">Понятие *ограниченный контекст* пришло к нам из предметно-ориентированного проектирования.</span><span class="sxs-lookup"><span data-stu-id="fbd3e-141">*Bounded context* is a term from domain driven design.</span></span> <span data-ttu-id="fbd3e-142">Ограниченный контекст — это четкий лимит для модели предметной области, который определяет, к каким частям предметной области она применяется.</span><span class="sxs-lookup"><span data-stu-id="fbd3e-142">A bounded context is an explicit boundary around a domain model, and defines which parts of the domain the model applies to.</span></span> <span data-ttu-id="fbd3e-143">В идеальном случае ограниченный контекст обозначает конкретный сегмент предметной области.</span><span class="sxs-lookup"><span data-stu-id="fbd3e-143">Ideally, a bounded context maps to a subdomain of the business domain.</span></span> <span data-ttu-id="fbd3e-144">Ограниченные контексты в системе — самая логичная область применения многоязычного хранения.</span><span class="sxs-lookup"><span data-stu-id="fbd3e-144">The bounded contexts in your system are a natural place to consider polyglot persistence.</span></span> <span data-ttu-id="fbd3e-145">Например, сущность "товар" может существовать одновременно в сегменте каталога товаров и в сегменте запаса товаров. Но, скорее всего, для этих сегментов существуют разные требования к хранению, обновлению и получению данных.</span><span class="sxs-lookup"><span data-stu-id="fbd3e-145">For example, "products" may appear in both the Product Catalog subdomain and the Product Inventory subdomain, but it's very likely that these two subdomains have different requirements for storing, updating, and querying products.</span></span>

[data-store-overview]: ../technology-choices/data-store-overview.md
