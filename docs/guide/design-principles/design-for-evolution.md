---
title: Разработка с учетом изменений
description: Эволюционное проектирование закладывает основу для непрерывных инноваций.
author: MikeWasson
ms.date: 08/30/2018
ms.openlocfilehash: df5a2d0756295a9632b3ea336527b2fbfb35318c
ms.sourcegitcommit: f6be2825bf2d37dfe25cfab92b9e3973a6b51e16
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/08/2018
ms.locfileid: "48858152"
---
# <a name="design-for-evolution"></a><span data-ttu-id="3e938-103">Разработка с учетом будущих изменений</span><span class="sxs-lookup"><span data-stu-id="3e938-103">Design for evolution</span></span>

## <a name="an-evolutionary-design-is-key-for-continuous-innovation"></a><span data-ttu-id="3e938-104">Эволюционное проектирование закладывает основу для непрерывных инноваций</span><span class="sxs-lookup"><span data-stu-id="3e938-104">An evolutionary design is key for continuous innovation</span></span>

<span data-ttu-id="3e938-105">Все успешные приложения изменяются с течением времени: в них исправляются ошибки, добавляются компоненты, изменяются технологии, применяются меры для повышения масштабируемости и гибкости.</span><span class="sxs-lookup"><span data-stu-id="3e938-105">All successful applications change over time, whether to fix bugs, add new features, bring in new technologies, or make existing systems more scalable and resilient.</span></span> <span data-ttu-id="3e938-106">Если все части приложения очень тесно связаны, в такую систему сложно вносить изменения.</span><span class="sxs-lookup"><span data-stu-id="3e938-106">If all the parts of an application are tightly coupled, it becomes very hard to introduce changes into the system.</span></span> <span data-ttu-id="3e938-107">Изменение в одной части приложения может вызвать сбой в другой части или потребовать изменений во всей базе кода.</span><span class="sxs-lookup"><span data-stu-id="3e938-107">A change in one part of the application may break another part, or cause changes to ripple through the entire codebase.</span></span>

<span data-ttu-id="3e938-108">Такая проблема характерна не только для монолитных приложений.</span><span class="sxs-lookup"><span data-stu-id="3e938-108">This problem is not limited to monolithic applications.</span></span> <span data-ttu-id="3e938-109">Даже если приложение разложено на несколько служб, в нем могут существовать такие жесткие взаимозависимости, которые делают систему жесткой и хрупкой.</span><span class="sxs-lookup"><span data-stu-id="3e938-109">An application can be decomposed into services, but still exhibit the sort of tight coupling that leaves the system rigid and brittle.</span></span> <span data-ttu-id="3e938-110">Но если сразу разрабатывать службы с учетом будущих изменений, разработчики смогут смелее и чаще внедрять новые функции.</span><span class="sxs-lookup"><span data-stu-id="3e938-110">But when services are designed to evolve, teams can innovate and continuously deliver new features.</span></span> 

<span data-ttu-id="3e938-111">Микрослужбы становятся популярными при эволюционной разработке, так как этот подход учитывает многие из упомянутых здесь аспектов.</span><span class="sxs-lookup"><span data-stu-id="3e938-111">Microservices are becoming a popular way to achieve an evolutionary design, because they address many of the considerations listed here.</span></span>

## <a name="recommendations"></a><span data-ttu-id="3e938-112">Рекомендации</span><span class="sxs-lookup"><span data-stu-id="3e938-112">Recommendations</span></span>

<span data-ttu-id="3e938-113">**Обеспечьте высокую слаженность и слабую взаимозависимость**.</span><span class="sxs-lookup"><span data-stu-id="3e938-113">**Enforce high cohesion and loose coupling**.</span></span> <span data-ttu-id="3e938-114">Служба считается *слаженной*, если ее функциональные возможности логически связаны друг с другом.</span><span class="sxs-lookup"><span data-stu-id="3e938-114">A service is *cohesive* if it provides functionality that logically belongs together.</span></span> <span data-ttu-id="3e938-115">При *слабой взаимозависимости* служб можно изменить одну из них, не затрагивая другую.</span><span class="sxs-lookup"><span data-stu-id="3e938-115">Services are *loosely coupled* if you can change one service without changing the other.</span></span> <span data-ttu-id="3e938-116">Высокая слаженность обычно означает, что изменения в одной функции потребуют изменений и в других связанных функциях.</span><span class="sxs-lookup"><span data-stu-id="3e938-116">High cohesion generally means that changes in one function will require changes in other related functions.</span></span> <span data-ttu-id="3e938-117">Если вы обнаружите, что обновление службы требует скоординированных обновлений в других службах, это повод усомниться в слаженности функций.</span><span class="sxs-lookup"><span data-stu-id="3e938-117">If you find that updating a service requires coordinated updates to other services, it may be a sign that your services are not cohesive.</span></span> <span data-ttu-id="3e938-118">Одна из задач разработки на основе домена (DDD) — выявление таких границ.</span><span class="sxs-lookup"><span data-stu-id="3e938-118">One of the goals of domain-driven design (DDD) is to identify those boundaries.</span></span>

<span data-ttu-id="3e938-119">**Внедряйте знания о предметной области**.</span><span class="sxs-lookup"><span data-stu-id="3e938-119">**Encapsulate domain knowledge**.</span></span> <span data-ttu-id="3e938-120">Недопустимо перекладывать ответственность за соблюдение бизнес-правил предметной области на клиента, который использует службу.</span><span class="sxs-lookup"><span data-stu-id="3e938-120">When a client consumes a service, the responsibility for enforcing the business rules of the domain should not fall on the client.</span></span> <span data-ttu-id="3e938-121">Вместо этого следует внедрять в службу все знания о предметной области, которые входят в ее область действия.</span><span class="sxs-lookup"><span data-stu-id="3e938-121">Instead, the service should encapsulate all of the domain knowledge that falls under its responsibility.</span></span> <span data-ttu-id="3e938-122">Если каждый клиент будет самостоятельно контролировать соблюдение бизнес-правил, знания о предметной области будут распределены по разным частям приложения.</span><span class="sxs-lookup"><span data-stu-id="3e938-122">Otherwise, every client has to enforce the business rules, and you end up with domain knowledge spread across different parts of the application.</span></span> 

<span data-ttu-id="3e938-123">**Используйте асинхронный обмен сообщениями**.</span><span class="sxs-lookup"><span data-stu-id="3e938-123">**Use asynchronous messaging**.</span></span> <span data-ttu-id="3e938-124">Асинхронный обмен сообщениями помогает устранить зависимость поставщика сообщений от их получателя.</span><span class="sxs-lookup"><span data-stu-id="3e938-124">Asynchronous messaging is a way to decouple the message producer from the consumer.</span></span> <span data-ttu-id="3e938-125">Поставщик не обязан ожидать, пока получатель ответит на сообщение или выполнит какие-то действия.</span><span class="sxs-lookup"><span data-stu-id="3e938-125">The producer does not depend on the consumer responding to the message or taking any particular action.</span></span> <span data-ttu-id="3e938-126">Архитектура на основе публикации и подписки даже позволяет поставщику не знать, кто получает его сообщения.</span><span class="sxs-lookup"><span data-stu-id="3e938-126">With a pub/sub architecture, the producer may not even know who is consuming the message.</span></span> <span data-ttu-id="3e938-127">Вы легко сможете добавлять новые службы для обработки сообщений, не внося никаких изменений в поставщик сообщений.</span><span class="sxs-lookup"><span data-stu-id="3e938-127">New services can easily consume the messages without any modifications to the producer.</span></span>

<span data-ttu-id="3e938-128">**Не внедряйте знания о предметной области в шлюз**.</span><span class="sxs-lookup"><span data-stu-id="3e938-128">**Don't build domain knowledge into a gateway**.</span></span> <span data-ttu-id="3e938-129">В архитектуре микрослужб шлюзы выполняют много важных функций, таких как маршрутизация запросов, преобразование протоколов, балансировка нагрузки и аутентификация.</span><span class="sxs-lookup"><span data-stu-id="3e938-129">Gateways can be useful in a microservices architecture, for things like request routing, protocol translation, load balancing, or authentication.</span></span> <span data-ttu-id="3e938-130">Но функции шлюза следует строго ограничить только инфраструктурными задачами такого типа.</span><span class="sxs-lookup"><span data-stu-id="3e938-130">However, the gateway should be restricted to this sort of infrastructure functionality.</span></span> <span data-ttu-id="3e938-131">Он не должен содержать никаких знаний о предметной области, чтобы не стать очень опасной зависимостью.</span><span class="sxs-lookup"><span data-stu-id="3e938-131">It should not implement any domain knowledge, to avoid becoming a heavy dependency.</span></span>

<span data-ttu-id="3e938-132">**Предоставьте открытые интерфейсы**.</span><span class="sxs-lookup"><span data-stu-id="3e938-132">**Expose open interfaces**.</span></span> <span data-ttu-id="3e938-133">Старайтесь не создавать слои преобразования, размещенные между службами.</span><span class="sxs-lookup"><span data-stu-id="3e938-133">Avoid creating custom translation layers that sit between services.</span></span> <span data-ttu-id="3e938-134">Каждая служба должна предоставлять API-интерфейс с четко определенным контрактом API.</span><span class="sxs-lookup"><span data-stu-id="3e938-134">Instead, a service should expose an API with a well-defined API contract.</span></span> <span data-ttu-id="3e938-135">Для API-интерфейса важно поддерживать систему версий, чтобы развивать его с сохранением обратной совместимости.</span><span class="sxs-lookup"><span data-stu-id="3e938-135">The API should be versioned, so that you can evolve the API while maintaining backward compatibility.</span></span> <span data-ttu-id="3e938-136">Это позволит вам обновить одну службу, не управляя обновлениями всех вышестоящих служб, которые от нее зависят.</span><span class="sxs-lookup"><span data-stu-id="3e938-136">That way, you can update a service without coordinating updates to all of the upstream services that depend on it.</span></span> <span data-ttu-id="3e938-137">Общедоступные службы должны предоставлять интерфейс API RESTful по протоколу HTTP.</span><span class="sxs-lookup"><span data-stu-id="3e938-137">Public facing services should expose a RESTful API over HTTP.</span></span> <span data-ttu-id="3e938-138">Для серверных служб допустимо использовать протокол обмена сообщениями в стиле RPC для повышения производительности.</span><span class="sxs-lookup"><span data-stu-id="3e938-138">Backend services might use an RPC-style messaging protocol for performance reasons.</span></span> 

<span data-ttu-id="3e938-139">**Составляйте контракты служб и проверяйте их выполнение**.</span><span class="sxs-lookup"><span data-stu-id="3e938-139">**Design and test against service contracts**.</span></span> <span data-ttu-id="3e938-140">Если службы предоставляют четко определенные API-интерфейсы, вы можете использовать эти API-интерфейсы для разработки и тестирования.</span><span class="sxs-lookup"><span data-stu-id="3e938-140">When services expose well-defined APIs, you can develop and test against those APIs.</span></span> <span data-ttu-id="3e938-141">Это позволяет создавать и тестировать каждую службу отдельно, не затрагивая все зависимые службы.</span><span class="sxs-lookup"><span data-stu-id="3e938-141">That way, you can develop and test an individual service without spinning up all of its dependent services.</span></span> <span data-ttu-id="3e938-142">(Но, разумеется, при этом нельзя забывать об интеграции и нагрузочном тестировании в реальных условиях эксплуатации.)</span><span class="sxs-lookup"><span data-stu-id="3e938-142">(Of course, you would still perform integration and load testing against the real services.)</span></span>

<span data-ttu-id="3e938-143">**Абстрагируйте инфраструктуру от логики предметной области**.</span><span class="sxs-lookup"><span data-stu-id="3e938-143">**Abstract infrastructure away from domain logic**.</span></span> <span data-ttu-id="3e938-144">Не смешивайте логику предметной области с инфраструктурными функциями, такими как обмен сообщениями или сохраняемость.</span><span class="sxs-lookup"><span data-stu-id="3e938-144">Don't let domain logic get mixed up with infrastructure-related functionality, such as messaging or persistence.</span></span> <span data-ttu-id="3e938-145">В противном случае изменения логики предметной области повлекут за собой изменения на уровне инфраструктуры, и наоборот.</span><span class="sxs-lookup"><span data-stu-id="3e938-145">Otherwise, changes in the domain logic will require updates to the infrastructure layers and vice versa.</span></span> 

<span data-ttu-id="3e938-146">**Разгружайте сквозные функции в отдельную службу**.</span><span class="sxs-lookup"><span data-stu-id="3e938-146">**Offload cross-cutting concerns to a separate service**.</span></span> <span data-ttu-id="3e938-147">Например, если несколько разных служб используют запросы аутентификации, эту функциональность можно вынести в дополнительную службу.</span><span class="sxs-lookup"><span data-stu-id="3e938-147">For example, if several services need to authenticate requests, you could move this functionality into its own service.</span></span> <span data-ttu-id="3e938-148">Теперь вы сможете улучшить эту службу аутентификации, например добавить в нее новый поток аутентификации, не вмешиваясь в работу тех служб, которые ее используют.</span><span class="sxs-lookup"><span data-stu-id="3e938-148">Then you could evolve the authentication service &mdash; for example, by adding a new authentication flow &mdash; without touching any of the services that use it.</span></span>

<span data-ttu-id="3e938-149">**Развертывайте службы независимо друг от друга**.</span><span class="sxs-lookup"><span data-stu-id="3e938-149">**Deploy services independently**.</span></span> <span data-ttu-id="3e938-150">Если команда DevOps может развернуть одну службу отдельно от остальных служб в приложении, обновления выполняются быстрее и безопаснее.</span><span class="sxs-lookup"><span data-stu-id="3e938-150">When the DevOps team can deploy a single service independently of other services in the application, updates can happen more quickly and safely.</span></span> <span data-ttu-id="3e938-151">Вы сможете чаще развертывать исправления ошибок и новые функции.</span><span class="sxs-lookup"><span data-stu-id="3e938-151">Bug fixes and new features can be rolled out at a more regular cadence.</span></span> <span data-ttu-id="3e938-152">И само приложение, и процесс выпуска должны поддерживать независимые обновления.</span><span class="sxs-lookup"><span data-stu-id="3e938-152">Design both the application and the release process to support independent updates.</span></span>
