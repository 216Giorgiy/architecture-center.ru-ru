---
title: "Восстановление данных после повреждения или случайного удаления"
description: "В этой статье объясняется, как восстанавливать данные после повреждения или случайного удаления, как создавать надежные, высокодоступные и отказоустойчивые приложения и как правильно планировать аварийное восстановление."
author: MikeWasson
ms.date: 01/10/2018
ms.openlocfilehash: 76d2f996750d5a67b67bd5dc4977580f3b8abbc3
ms.sourcegitcommit: 3d6dba524cc7661740bdbaf43870de7728d60a01
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/11/2018
---
# <a name="recover-from-data-corruption-or-accidental-deletion"></a><span data-ttu-id="08f9c-103">Восстановление данных после повреждения или случайного удаления</span><span class="sxs-lookup"><span data-stu-id="08f9c-103">Recover from data corruption or accidental deletion</span></span> 

<span data-ttu-id="08f9c-104">Надежный план обеспечения непрерывности бизнес-процессов должен включать в себя меры на случай повреждения или случайного удаления данных.</span><span class="sxs-lookup"><span data-stu-id="08f9c-104">Part of a robust business continuity plan is having a plan if your data gets corrupted or accidentally deleted.</span></span> <span data-ttu-id="08f9c-105">Ниже приводятся сведения о восстановлении после повреждения или случайного удаления данных в результате ошибки приложения или оператора.</span><span class="sxs-lookup"><span data-stu-id="08f9c-105">The following is information about recovery after data has been corrupted or accidentally deleted, due to application errors or operator error.</span></span>

## <a name="virtual-machines"></a><span data-ttu-id="08f9c-106">Виртуальные машины</span><span class="sxs-lookup"><span data-stu-id="08f9c-106">Virtual Machines</span></span>

<span data-ttu-id="08f9c-107">Чтобы защитить виртуальные машины Azure от ошибок приложений и случайного удаления данных, используйте [службу Azure Backup](/azure/backup/).</span><span class="sxs-lookup"><span data-stu-id="08f9c-107">To protect Azure Virtual Machines (VMs) from application errors or accidental deletion, use [Azure Backup](/azure/backup/).</span></span> <span data-ttu-id="08f9c-108">Служба архивации Azure позволяет создавать согласованные резервные копии нескольких дисков виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="08f9c-108">Azure Backup enables the creation of backups that are consistent across multiple VM disks.</span></span> <span data-ttu-id="08f9c-109">Кроме того, в хранилище резервных копий предусмотрена репликация между регионами, которая обеспечивает восстановление в случае потери данных в одном из регионов.</span><span class="sxs-lookup"><span data-stu-id="08f9c-109">In addition, the Backup Vault can be replicated across regions to provide recovery from region loss.</span></span>

## <a name="storage"></a><span data-ttu-id="08f9c-110">Хранилище</span><span class="sxs-lookup"><span data-stu-id="08f9c-110">Storage</span></span>

<span data-ttu-id="08f9c-111">Служба хранилища Azure обеспечивает устойчивость данных благодаря автоматическим репликам.</span><span class="sxs-lookup"><span data-stu-id="08f9c-111">Azure Storage provides data resiliency through automated replicas.</span></span> <span data-ttu-id="08f9c-112">Однако это не может помешать коду приложения и пользователям повредить данные, случайно или намеренно.</span><span class="sxs-lookup"><span data-stu-id="08f9c-112">However, this does not prevent application code or users from corrupting data, whether accidentally or maliciously.</span></span> <span data-ttu-id="08f9c-113">Чтобы сохранить точность данных в случае ошибок приложения или пользователя, требуются более сложные приемы, например копирование данных в дополнительное хранилище и ведение журнала аудита.</span><span class="sxs-lookup"><span data-stu-id="08f9c-113">Maintaining data fidelity in the face of application or user error requires more advanced techniques, such as copying the data to a secondary storage location with an audit log.</span></span> 

- <span data-ttu-id="08f9c-114">**Блочные BLOB-объекты**.</span><span class="sxs-lookup"><span data-stu-id="08f9c-114">**Block blobs**.</span></span> <span data-ttu-id="08f9c-115">Создайте моментальный снимок на определенный момент каждого блочного BLOB-объекта.</span><span class="sxs-lookup"><span data-stu-id="08f9c-115">Create a point-in-time snapshot of each block blob.</span></span> <span data-ttu-id="08f9c-116">Дополнительные сведения см. в статье [Создание моментального снимка большого двоичного объекта](/rest/api/storageservices/creating-a-snapshot-of-a-blob).</span><span class="sxs-lookup"><span data-stu-id="08f9c-116">For more information, see [Creating a Snapshot of a Blob](/rest/api/storageservices/creating-a-snapshot-of-a-blob).</span></span> <span data-ttu-id="08f9c-117">По каждому моментальному снимку взимается оплата только за хранение данных, которые отражают отличия состояния большого двоичного объекта по сравнению с предыдущим моментальным снимком.</span><span class="sxs-lookup"><span data-stu-id="08f9c-117">For each snapshot, you are only charged for the storage required to store the differences within the blob since the last snapshot state.</span></span> <span data-ttu-id="08f9c-118">Моментальные снимки применимы, только если существует исходный большой двоичный объект, на котором они основаны. Поэтому мы рекомендуем создавать копии в другом большом двоичном объекте или даже в другой учетной записи хранения.</span><span class="sxs-lookup"><span data-stu-id="08f9c-118">The snapshots are dependent on the existence of the original blob they are based on, so a copy operation to another blob or even another storage account is advisable.</span></span> <span data-ttu-id="08f9c-119">Это гарантирует надежную защиту данных резервных копий от случайного удаления.</span><span class="sxs-lookup"><span data-stu-id="08f9c-119">This ensures that backup data is properly protected against accidental deletion.</span></span> <span data-ttu-id="08f9c-120">Используйте [AzCopy](/azure/storage/common/storage-use-azcopy) или [Azure PowerShell](/azure/storage/common/storage-powershell-guide-full) для копирования больших двоичных объектов в другую учетную запись хранения.</span><span class="sxs-lookup"><span data-stu-id="08f9c-120">You can use [AzCopy](/azure/storage/common/storage-use-azcopy) or [Azure PowerShell](/azure/storage/common/storage-powershell-guide-full) to copy the blobs to another storage account.</span></span>

- <span data-ttu-id="08f9c-121">**Файлы**.</span><span class="sxs-lookup"><span data-stu-id="08f9c-121">**Files**.</span></span> <span data-ttu-id="08f9c-122">Используйте [моментальные снимки общих ресурсов (предварительная версия)](/azure/storage/files/storage-how-to-use-files-snapshots) либо AzCopy или Azure PowerShell для копирования файлов в другую учетную запись хранения.</span><span class="sxs-lookup"><span data-stu-id="08f9c-122">Use [share snapshots (preview)](/azure/storage/files/storage-how-to-use-files-snapshots), or use AzCopy or PowerShell to copy your files to another storage account.</span></span>

- <span data-ttu-id="08f9c-123">**Таблицы**.</span><span class="sxs-lookup"><span data-stu-id="08f9c-123">**Tables**.</span></span> <span data-ttu-id="08f9c-124">Используйте AzCopy для экспорта данных таблиц в другую учетную запись хранения, относящуюся к другому региону.</span><span class="sxs-lookup"><span data-stu-id="08f9c-124">Use AzCopy to export the table data into another storage account in another region.</span></span>

## <a name="database"></a><span data-ttu-id="08f9c-125">База данных</span><span class="sxs-lookup"><span data-stu-id="08f9c-125">Database</span></span>

### <a name="azure-sql-database"></a><span data-ttu-id="08f9c-126">Базы данных SQL Azure</span><span class="sxs-lookup"><span data-stu-id="08f9c-126">Azure SQL Database</span></span> 

<span data-ttu-id="08f9c-127">База данных SQL автоматически создает полные резервные копии (раз в неделю) и разностные резервные копии базы данных (раз в час), а также резервные копии журнала транзакций (раз в пять-десять минут) для защиты вашей компании от потери данных.</span><span class="sxs-lookup"><span data-stu-id="08f9c-127">SQL Database automatically performs a combination of full database backups weekly, differential database backups hourly, and transaction log backups every five - ten minutes to protect your business from data loss.</span></span> <span data-ttu-id="08f9c-128">Используйте восстановление до точки во времени для восстановления более раннего состояния базы данных.</span><span class="sxs-lookup"><span data-stu-id="08f9c-128">Use point-in-time restore to restore a database to an earlier time.</span></span> <span data-ttu-id="08f9c-129">Дополнительные сведения можно найти в разделе </span><span class="sxs-lookup"><span data-stu-id="08f9c-129">For more information, see:</span></span>

- [<span data-ttu-id="08f9c-130">Восстановление базы данных Azure SQL с помощью создаваемых автоматически резервных копий</span><span class="sxs-lookup"><span data-stu-id="08f9c-130">Recover an Azure SQL database using automated database backups</span></span>](/azure/sql-database/sql-database-recovery-using-backups)

- [<span data-ttu-id="08f9c-131">Обзор обеспечения непрерывности бизнес-процессов с помощью базы данных SQL Azure</span><span class="sxs-lookup"><span data-stu-id="08f9c-131">Overview of business continuity with Azure SQL Database</span></span>](/azure/sql-database/sql-database-business-continuity)

### <a name="sql-server-on-vms"></a><span data-ttu-id="08f9c-132">SQL Server на виртуальных машинах</span><span class="sxs-lookup"><span data-stu-id="08f9c-132">SQL Server on VMs</span></span>

<span data-ttu-id="08f9c-133">Для SQL Server, выполняющегося на виртуальных машинах, существует два варианта резервного копирования: традиционные резервные копии и доставка журналов.</span><span class="sxs-lookup"><span data-stu-id="08f9c-133">For SQL Server running on VMs, there are two options: traditional backups and log shipping.</span></span> <span data-ttu-id="08f9c-134">Традиционные резервные копии позволяют восстановить данные на определенный момент времени, но процесс восстановления в таком случае будет длительным.</span><span class="sxs-lookup"><span data-stu-id="08f9c-134">Traditional backups enables you to restore to a specific point in time, but the recovery process is slow.</span></span> <span data-ttu-id="08f9c-135">Восстановление традиционных резервных копий начинается с первоначальной полной резервной копии, на которую последовательно накладываются все последующие резервные копии.</span><span class="sxs-lookup"><span data-stu-id="08f9c-135">Restoring traditional backups requires starting with an initial full backup, and then applying any backups taken after that.</span></span> <span data-ttu-id="08f9c-136">Второй вариант подразумевает, что вы можете настроить сеанс доставки журналов с определенной задержкой до восстановления резервных копий журналов (например, на два часа).</span><span class="sxs-lookup"><span data-stu-id="08f9c-136">The second option is to configure a log shipping session to delay the restore of log backups (for example, by two hours).</span></span> <span data-ttu-id="08f9c-137">Так вы получите временной зазор для восстановления после ошибок, возникших в базе данных-источнике.</span><span class="sxs-lookup"><span data-stu-id="08f9c-137">This provides a window to recover from errors made on the primary.</span></span>

### <a name="azure-cosmos-db"></a><span data-ttu-id="08f9c-138">Azure Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="08f9c-138">Azure Cosmos DB</span></span>

<span data-ttu-id="08f9c-139">Azure Cosmos DB автоматически выполняет архивацию с регулярными интервалами.</span><span class="sxs-lookup"><span data-stu-id="08f9c-139">Azure Cosmos DB automatically takes backups at regular intervals.</span></span> <span data-ttu-id="08f9c-140">Для обеспечения устойчивости в случае региональной аварии резервные копии хранятся отдельно в другой службе хранилища, а также глобально реплицируются.</span><span class="sxs-lookup"><span data-stu-id="08f9c-140">Backups are stored separately in another storage service, and those backups are globally replicated for resiliency against regional disasters.</span></span> <span data-ttu-id="08f9c-141">Если вы случайно удалите данные или коллекцию, можете обратиться с запросом в службу поддержки или позвонить в службу поддержки Azure, чтобы восстановить данные из последней автоматически созданной резервной копии.</span><span class="sxs-lookup"><span data-stu-id="08f9c-141">If you accidentally delete your database or collection, you can file a support ticket or call Azure support to restore the data from the last automatic backup.</span></span> <span data-ttu-id="08f9c-142">Дополнительные сведения см. в статье [Автоматическая оперативная архивация и восстановление с помощью Azure Cosmos DB](/azure/cosmos-db/online-backup-and-restore).</span><span class="sxs-lookup"><span data-stu-id="08f9c-142">For more information, see [Automatic online backup and restore with Azure Cosmos DB](/azure/cosmos-db/online-backup-and-restore).</span></span>

### <a name="azure-database-for-mysql-azure-database-for-postresql"></a><span data-ttu-id="08f9c-143">База данных Azure для MySQL, база данных Azure для PostreSQL</span><span class="sxs-lookup"><span data-stu-id="08f9c-143">Azure Database for MySQL, Azure Database for PostreSQL</span></span>

<span data-ttu-id="08f9c-144">При использовании базы данных Azure для MySQL или PostreSQL служба базы данных автоматически создает резервную копию службы каждые пять минут.</span><span class="sxs-lookup"><span data-stu-id="08f9c-144">When using Azure Database for MySQL or Azure Database for PostreSQL, the database service automatically makes a backup of the service every five minutes.</span></span> <span data-ttu-id="08f9c-145">С помощью этой функции автоматической архивации можно восстановить сервер и все его базы данных до более ранней точки во времени на новом сервере.</span><span class="sxs-lookup"><span data-stu-id="08f9c-145">Using this automatic backup feature you may restore the server and all its databases into a new server to an earlier point-in-time.</span></span> <span data-ttu-id="08f9c-146">Дополнительные сведения можно найти в разделе </span><span class="sxs-lookup"><span data-stu-id="08f9c-146">For more information, see:</span></span>

- [<span data-ttu-id="08f9c-147">Как выполнить резервное копирование и восстановление сервера в базе данных Azure для MySQL с помощью портала Azure</span><span class="sxs-lookup"><span data-stu-id="08f9c-147">How to back up and restore a server in Azure Database for MySQL by using the Azure portal</span></span>](/azure/mysql/howto-restore-server-portal)

- [<span data-ttu-id="08f9c-148">Как заархивировать и восстановить сервер в базе данных Azure для PostgreSQL с помощью портала Azure</span><span class="sxs-lookup"><span data-stu-id="08f9c-148">How to backup and restore a server in Azure Database for PostgreSQL using the Azure portal</span></span>](/azure/postgresql/howto-restore-server-portal)

