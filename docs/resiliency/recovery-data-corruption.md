---
title: Восстановление данных после повреждения или случайного удаления
description: В этой статье объясняется, как восстанавливать данные после повреждения или случайного удаления, как создавать надежные, высокодоступные и отказоустойчивые приложения и как правильно планировать аварийное восстановление.
author: MikeWasson
ms.date: 01/10/2018
ms.openlocfilehash: b0716de39fe69d607b9a63e51356d28bbcdbfeae
ms.sourcegitcommit: f665226cec96ec818ca06ac6c2d83edb23c9f29c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2018
---
# <a name="recover-from-data-corruption-or-accidental-deletion"></a>Восстановление данных после повреждения или случайного удаления 

Надежный план обеспечения непрерывности бизнес-процессов должен включать в себя меры на случай повреждения или случайного удаления данных. Ниже приводятся сведения о восстановлении после повреждения или случайного удаления данных в результате ошибки приложения или оператора.

## <a name="virtual-machines"></a>Виртуальные машины

Чтобы защитить виртуальные машины Azure от ошибок приложений и случайного удаления данных, используйте [службу Azure Backup](/azure/backup/). Служба архивации Azure позволяет создавать согласованные резервные копии нескольких дисков виртуальной машины. Кроме того, в хранилище резервных копий предусмотрена репликация между регионами, которая обеспечивает восстановление в случае потери данных в одном из регионов.

## <a name="storage"></a>Хранилище

Служба хранилища Azure обеспечивает устойчивость данных благодаря автоматическим репликам. Однако это не может помешать коду приложения и пользователям повредить данные, случайно или намеренно. Чтобы сохранить точность данных в случае ошибок приложения или пользователя, требуются более сложные приемы, например копирование данных в дополнительное хранилище и ведение журнала аудита. 

- **Блочные BLOB-объекты**. Создайте моментальный снимок на определенный момент каждого блочного BLOB-объекта. Дополнительные сведения см. в статье [Создание моментального снимка большого двоичного объекта](/rest/api/storageservices/creating-a-snapshot-of-a-blob). По каждому моментальному снимку взимается оплата только за хранение данных, которые отражают отличия состояния большого двоичного объекта по сравнению с предыдущим моментальным снимком. Моментальные снимки применимы, только если существует исходный большой двоичный объект, на котором они основаны. Поэтому мы рекомендуем создавать копии в другом большом двоичном объекте или даже в другой учетной записи хранения. Это гарантирует надежную защиту данных резервных копий от случайного удаления. Используйте [AzCopy](/azure/storage/common/storage-use-azcopy) или [Azure PowerShell](/azure/storage/common/storage-powershell-guide-full) для копирования больших двоичных объектов в другую учетную запись хранения.

- **Файлы**. Используйте [моментальные снимки общих ресурсов](/azure/storage/files/storage-snapshots-files) либо AzCopy или Azure PowerShell для копирования файлов в другую учетную запись хранения.

- **Таблицы**. Используйте AzCopy для экспорта данных таблиц в другую учетную запись хранения, относящуюся к другому региону.

## <a name="database"></a>База данных

### <a name="azure-sql-database"></a>Базы данных SQL Azure 

База данных SQL автоматически создает полные резервные копии (раз в неделю) и разностные резервные копии базы данных (раз в час), а также резервные копии журнала транзакций (раз в пять-десять минут) для защиты вашей компании от потери данных. Используйте восстановление до точки во времени для восстановления более раннего состояния базы данных. Дополнительные сведения можно найти в разделе 

- [Восстановление базы данных Azure SQL с помощью создаваемых автоматически резервных копий](/azure/sql-database/sql-database-recovery-using-backups)

- [Обзор обеспечения непрерывности бизнес-процессов с помощью базы данных SQL Azure](/azure/sql-database/sql-database-business-continuity)

### <a name="sql-server-on-vms"></a>SQL Server на виртуальных машинах

Для SQL Server, выполняющегося на виртуальных машинах, существует два варианта резервного копирования: традиционные резервные копии и доставка журналов. Традиционные резервные копии позволяют восстановить данные на определенный момент времени, но процесс восстановления в таком случае будет длительным. Восстановление традиционных резервных копий начинается с первоначальной полной резервной копии, на которую последовательно накладываются все последующие резервные копии. Второй вариант подразумевает, что вы можете настроить сеанс доставки журналов с определенной задержкой до восстановления резервных копий журналов (например, на два часа). Так вы получите временной зазор для восстановления после ошибок, возникших в базе данных-источнике.

### <a name="azure-cosmos-db"></a>Azure Cosmos DB

Azure Cosmos DB автоматически выполняет архивацию с регулярными интервалами. Для обеспечения устойчивости в случае региональной аварии резервные копии хранятся отдельно в другой службе хранилища, а также глобально реплицируются. Если вы случайно удалите данные или коллекцию, можете обратиться с запросом в службу поддержки или позвонить в службу поддержки Azure, чтобы восстановить данные из последней автоматически созданной резервной копии. Дополнительные сведения см. в статье [Автоматическая оперативная архивация и восстановление с помощью Azure Cosmos DB](/azure/cosmos-db/online-backup-and-restore).

### <a name="azure-database-for-mysql-azure-database-for-postresql"></a>База данных Azure для MySQL, база данных Azure для PostreSQL

При использовании базы данных Azure для MySQL или PostreSQL служба базы данных автоматически создает резервную копию службы каждые пять минут. С помощью этой функции автоматической архивации можно восстановить сервер и все его базы данных до более ранней точки во времени на новом сервере. Дополнительные сведения можно найти в разделе 

- [Как выполнить резервное копирование и восстановление сервера в базе данных Azure для MySQL с помощью портала Azure](/azure/mysql/howto-restore-server-portal)

- [Как заархивировать и восстановить сервер в базе данных Azure для PostgreSQL с помощью портала Azure](/azure/postgresql/howto-restore-server-portal)

