---
title: Оперативная аналитическая обработка (OLAP)
description: ''
author: zoinerTejada
ms.date: 02/12/2018
ms.topic: guide
ms.service: architecture-center
ms.subservice: cloud-fundamentals
ms.openlocfilehash: 70c18e1a5294b09bb156d2af06af7a32d33858da
ms.sourcegitcommit: 1b50810208354577b00e89e5c031b774b02736e2
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/23/2019
ms.locfileid: "54485488"
---
# <a name="online-analytical-processing-olap"></a>Оперативная аналитическая обработка (OLAP)

Оперативная аналитическая обработка (OLAP) — это технология, которая упорядочивает большие коммерческие базы данных и поддерживает сложный анализ. Ее можно использовать для выполнения сложных аналитических запросов без негативного воздействия на системы транзакций.

Базы данных, в которых компании хранят свои транзакции и записи, называются базами данных [оперативной обработки транзакций (OLTP)](./online-transaction-processing.md). Такие базы данных обычно содержат записи, которые вводятся поочередно. Часто они содержат много ценных для организации сведений. Но базы данных, используемые для OLTP, не предназначены для анализа. Поэтому извлечение ответов из этих баз данных требует много времени и усилий. Системы OLAP предназначены для извлечения этих сведений бизнес-аналитики из данных максимально оптимальным способом. Это достигается благодаря тому, что базы данных OLAP оптимизированы для рабочих нагрузок с большим числом операций чтения и малым числом операций записи.

![OLAP в Azure](../images/olap-data-pipeline.png)

## <a name="semantic-modeling"></a>Семантическое моделирование

Семантическая модель данных — это концептуальная модель, в которой описаны значения содержащихся в ней элементов данных. Организации часто используют собственные термины, иногда синонимы или даже разные значения одного и того же термина. Например, база данных инвентаризации может отслеживать компонент оборудования с ИД ресурса и серийным номером. Но база данных по продажам может ссылаться на серийный номер как на идентификатор ресурса. Эти значения сложно связать без модели, в которой бы описывалась связь.

Семантическое моделирование обеспечивает абстракцию на уровне схемы базы данных. В этом случае пользователям не требуются знания о базовых структурах данных. Семантическое моделирование также упрощает подачу запросов данных для пользователей: им не нужно выполнять вычисления и соединения в базовой схеме. Кроме того, обычно имена столбцов преобразуются в понятные пользователям названия, чтобы контекст и значение данных были очевидными.

Семантическое моделирование преимущественно используется для сценариев с большим числом операций чтения, например для аналитики и бизнес-аналитики (OLAP), которые отличаются от обработки данных о транзакциях с большим числом операций записи (OLTP). В основном это связано с особенностями типичного семантического слоя:

- поведение агрегатов задано так, чтобы в средствах создания отчетов правильно отображались соответствующие данные;
- определены бизнес-логика и вычисления;
- включены ориентированные на время вычисления;
- данные часто интегрируются из нескольких источников.

По этим причинам семантический слой обычно размещается над хранилищем данных.

![Пример диаграммы семантического слоя между хранилищем данных и средством создания отчетов](../images/semantic-modeling.png)

Есть два основных типа семантических моделей:

- **Табличная.** Используются реляционные конструкции моделирования (модели, таблицы, столбцы). На внутреннем уровне метаданные наследуются из конструкций моделирования OLAP (кубы, измерения, меры). В коде и скрипте используются метаданные OLAP.
- **Многомерная.** Используются традиционные конструкции моделирования OLAP (кубы, измерения, меры).

Соответствующие службы Azure:

- [Azure Analysis Services](https://azure.microsoft.com/services/analysis-services/);

## <a name="example-use-case"></a>Примеры использования

Данные организации хранятся в большой базе данных. Доступ к ним нужно предоставить бизнес-пользователям и клиентам, чтобы они могли создавать собственные отчеты и проводить анализ. Одно из решений — просто предоставить пользователям прямой доступ к базе данных. Но это решение имеет недостатки, например проблемы с безопасностью и управлением доступом. Кроме того, структура базы данных, в том числе имена таблиц и столбцов, может быть сложной для пользователя. Пользователям потребуется понять, к каким таблицам выполнять запросы, как эти таблицы должны объединяться, а также другие факторы бизнес-логики, которые следует учитывать для получения правильных результатов. Чтобы приступить к работе, пользователи также должны знать язык запросов, например SQL. Обычно это приводит к тому, что несколько пользователей предоставляют в отчете одни и те же метрики, но с разными результатами.

Второй вариант решения — инкапсулировать всю информацию, необходимую пользователям, в семантическую модель. Пользователям будет проще отправлять запросы к семантической модели с помощью любого удобного средства создания отчетов. Данные, предоставленные семантической моделью, извлекаются из хранилища данных. Благодаря этому все пользователи получают единую версию данных. Семантическая модель также предоставляет понятные имена таблиц и столбцов, связи между таблицами, описания, удобные функции вычисления и безопасность на уровне строк.

## <a name="typical-traits-of-semantic-modeling"></a>Типичные признаки семантического моделирования

Семантическое моделирование и аналитическая обработка обычно имеют следующие признаки:

| Требование | ОПИСАНИЕ |
| --- | --- |
| Схема | Схема при записи (строгое соблюдение)|
| Использование транзакций | Нет  |
| Стратегия блокировки | Нет |
| Возможность обновления | Нет (обычно требуется повторное вычисление куба) |
| Возможность добавления | Нет (обычно требуется повторное вычисление куба) |
| Рабочая нагрузка | Большое число операций чтения, только для чтения |
| Индексация | Многомерное индексирование |
| Размер данных | Небольшой и средний размер |
| Модель | Многомерная |
| Форма представления данных| Схема типа "снежинка", куб или звезда |
| Гибкость запросов | Высокая гибкость |
| Масштаб | Большой (от десятков до сотен ГБ) |

## <a name="when-to-use-this-solution"></a>Когда следует использовать это решение

Рекомендуем использовать OLAP в следующих сценариях:

- если нужно выполнять сложные аналитические и нерегламентированные запросы быстро и без негативного воздействия на системы OLTP;
- если нужно предоставить бизнес-пользователям компании простой способ создания отчетов на основе ваших данных;
- если нужно предоставить много агрегатов, с помощью которых пользователи смогут оперативно получать согласованные результаты.

Технология OLAP особенно полезна при выполнении статистических вычислений для больших объемов данных. Системы OLAP оптимизированы для сценариев с большим числом операций чтения, например для анализа и бизнес-аналитики. OLAP позволяет пользователям сегментировать многомерные данные на срезы, которые можно просматривать в двух измерениях (например, в сводной таблице), или фильтровать данные по определенным значениям. Этот процесс иногда называется "сегментирование и фрагментирование" данных. Его можно выполнять, даже если данные секционированы по нескольким источникам. Такой процесс помогает пользователям определять тенденции, выделять шаблоны и просматривать данные без специальных знаний о традиционном анализе.

Семантические модели помогают бизнес-пользователям абстрагировать сложности связей и быстро анализировать данные.

## <a name="challenges"></a>Сложности

При всех преимуществах систем OLAP они создают и некоторые проблемы:

- Данные в системах OLTP постоянно обновляются за счет транзакций, передаваемых в из разных источников, а хранилища данных OLAP обычно обновляются гораздо реже, в зависимости от потребностей компании. Это означает, что системы OLAP скорее подходят для стратегических бизнес-решений, чем для немедленной реакции на изменения. Кроме того, для поддержки хранилищ данных OLAP в актуальном состоянии необходимо запланировать определенный уровень очистки данных и оркестрации.
- В отличие от традиционных нормализованных реляционных таблиц в системах OLTP, модели данных OLAP обычно являются многомерными. Из-за этого бывает сложно или невозможно непосредственно сопоставить отношения сущностей или объектно-ориентированные модели, где каждый атрибут сопоставляется с одним столбцом. Поэтому вместо традиционной нормализации в системах OLAP обычно используются схемы типа "снежинка" или "звезда".

## <a name="olap-in-azure"></a>OLAP в Azure

В Azure данные, хранящиеся в системах OLTP, например в службе "База данных SQL", копируются в систему OLAP, например в [Azure Analysis Services](/azure/analysis-services/analysis-services-overview). Средства просмотра и визуализации данных, в том числе [Power BI](https://powerbi.microsoft.com), Excel и решения сторонних производителей, подключаются к серверам Analysis Services и предоставляют пользователям интерактивные визуальные представления моделей данных для анализа. Поток данных из системы OLTP в OLAP обычно оркестрируется с помощью SQL Server Integration Services и службы [Фабрика данных Azure](/azure/data-factory/concepts-integration-runtime).

Все следующие хранилища данных в Azure будут соответствовать основным требованиям для OLAP:

- [SQL Server с индексами columnstore](/sql/relational-databases/indexes/get-started-with-columnstore-for-real-time-operational-analytics);
- [Azure Analysis Services](/azure/analysis-services/analysis-services-overview);
- [SQL Server Analysis Services (SSAS)](/sql/analysis-services/analysis-services)

В службах SQL Server Analysis Services (SSAS) предлагаются возможности OLAP и интеллектуального анализа данных для приложений бизнес-аналитики. Вы можете установить службы SSAS на локальных серверах или разместить их на виртуальной машине в Azure. Azure Analysis Services — это полностью управляемая служба, которая предоставляет те же основные функции, что и SSAS. Службы Azure Analysis Services поддерживают подключение к различным облачным и локальным корпоративным [источникам данных](/azure/analysis-services/analysis-services-datasource).

Кластеризованные индексы columnstore доступны в SQL Server 2014 и более поздних версий, а также в Базе данных SQL Azure и отлично подходят для рабочих нагрузок OLAP. Но начиная с версии SQL Server 2016 (включая Базу данных SQL Azure) вы можете воспользоваться гибридной транзакционно-аналитической обработкой (HTAP) благодаря обновляемым некластеризованным индексам columnstore. HTAP позволяет выполнять задачи обработки OLTP и OLAP на одной платформе, что избавляет от необходимости хранить несколько копий данных и использовать отдельные системы OLTP и OLAP. Дополнительные сведения см. в статье [Начало работы с Columnstore для получения операционной аналитики в реальном времени](/sql/relational-databases/indexes/get-started-with-columnstore-for-real-time-operational-analytics).

## <a name="key-selection-criteria"></a>Основные критерии выбора

Чтобы ограничить количество вариантов, сначала ответьте на следующие вопросы:

- Вы хотите использовать управляемую службу, а не управлять собственными серверами?

- Требуется ли безопасная аутентификация с использованием Azure Active Directory (Azure AD)?

- Вам нужно проводить анализ в реальном времени? Если да, оставьте только те варианты, которые поддерживают аналитику в реальном времени.

    *Аналитика в реальном времени* в этом контексте применяется к одному источнику данных, например к приложению для управления ресурсами предприятия (ERP), в котором будут выполняться операционная и аналитическая рабочие нагрузки. Если требуется интегрировать данные из нескольких источников или обеспечить максимальную производительность для анализа с помощью предварительно вычисленных данных, таких как кубы, вам может потребоваться отдельное хранилище данных.

- Вам нужно использовать предварительно вычисленные данные, например, чтобы предоставлять семантические модели, которые делают анализ более удобным для организаций? Если да, выберите вариант, который поддерживает многомерные кубы или табличные семантические модели.

    Благодаря статистическим выражениям пользователи могут последовательно выполнять статистическое вычисление данных. Предварительно вычисленные данные также позволяют значительно повысить производительность при работе с несколькими столбцами с множеством строк. Предварительно вычисленные данные могут быть представлены в виде многомерного куба или табличной семантической модели.

- Нужно ли интегрировать данные из нескольких источников за пределами хранилища данных OLTP? Если да, рассмотрите варианты, которые позволяют легко интегрировать несколько источников данных.

## <a name="capability-matrix"></a>Матрица возможностей

В следующих таблицах перечислены основные различия в возможностях.

### <a name="general-capabilities"></a>Общие возможности

<!-- markdownlint-disable MD033 -->

| | Службы Azure Analysis Services | SQL Server Analysis Services | SQL Server с индексами columnstore | База данных SQL Azure с индексами columnstore |
| --- | --- | --- | --- | --- |
| Является управляемой службой | Yes | Нет  | Нет  | Yes |
| Поддержка многомерных кубов | Нет  | Yes | Нет  | Нет  |
| Поддержка табличных семантических моделей | Yes | Да | Нет  | Нет  |
| Простая интеграция нескольких источников данных | Yes | Yes | Нет <sup>1</sup> | Нет <sup>1</sup> |
| Поддержка аналитики в режиме реального времени | Нет  | Нет  | Yes | Yes |
| Необходимость обработки данных для их копирования из источников | Yes | Да | Нет  | Нет  |
| Интеграция с Azure AD | Yes | Нет  | Нет <sup>2</sup> | Yes |

<!-- markdownlint-enable MD033 -->

[1] Хотя SQL Server и Базу данных SQL Azure нельзя использовать для отправки запросов и интеграции нескольких внешних источников данных, можно создать конвейер для этих задач с помощью [SSIS](/sql/integration-services/sql-server-integration-services) или [фабрики данных Azure](/azure/data-factory/). Сервер SQL Server, размещенный на виртуальной машине Azure, предоставляет дополнительные варианты, например связанные серверы и [PolyBase](/sql/relational-databases/polybase/polybase-guide). Дополнительные сведения см. в статье [Choosing a data pipeline orchestration technology in Azure](../technology-choices/pipeline-orchestration-data-movement.md) (Выбор технологии оркестрации конвейера данных в Azure).

[2] Подключение к SQL Server на виртуальной машине Azure с помощью учетной записи Azure AD не поддерживается. Вместо этого используйте учетную запись домена Active Directory.

### <a name="scalability-capabilities"></a>Масштабируемость

|                                                  | Службы Azure Analysis Services | SQL Server Analysis Services | SQL Server с индексами columnstore | База данных SQL Azure с индексами columnstore |
|--------------------------------------------------|-------------------------|------------------------------|-------------------------------------|---------------------------------------------|
| Избыточные региональные серверы для высокого уровня доступности |           Yes           |              Нет               |                 Yes                 |                     Yes                     |
|             Поддержка масштабирования запросов             |           Yes           |              Нет               |                 Yes                 |                     Нет                       |
|          Динамическая масштабируемость (увеличение масштаба)          |           Yes           |              Нет               |                 Yes                 |                     Нет                       |
