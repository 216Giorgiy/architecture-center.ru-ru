---
title: Варианты архитектуры для обработки больших данных
description: ''
author: zoinerTejada
ms.date: 02/12/2018
ms.topic: guide
ms.service: architecture-center
ms.subservice: cloud-fundamentals
ms.openlocfilehash: 269a4c2b8fd0c186e1b44b6c0cfdcbfa4d37b57c
ms.sourcegitcommit: c053e6edb429299a0ad9b327888d596c48859d4a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/20/2019
ms.locfileid: "58346167"
---
# <a name="big-data-architectures"></a><span data-ttu-id="0b4c7-102">Варианты архитектуры для обработки больших данных</span><span class="sxs-lookup"><span data-stu-id="0b4c7-102">Big data architectures</span></span>

<span data-ttu-id="0b4c7-103">Архитектура для обработки больших данных позволяет принимать, обрабатывать и анализировать данные, которые являются слишком объемными или слишком сложными для традиционных систем баз данных.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-103">A big data architecture is designed to handle the ingestion, processing, and analysis of data that is too large or complex for traditional database systems.</span></span> <span data-ttu-id="0b4c7-104">Время, когда организации начинают использовать большие данные, зависит от возможностей пользователей и их средств.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-104">The threshold at which organizations enter into the big data realm differs, depending on the capabilities of the users and their tools.</span></span> <span data-ttu-id="0b4c7-105">Для некоторых это могут быть сотни гигабайт данных, а для других — сотни терабайт.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-105">For some, it can mean hundreds of gigabytes of data, while for others it means hundreds of terabytes.</span></span> <span data-ttu-id="0b4c7-106">По мере совершенствования средств для работы с большими наборами данных, изменяется и значение больших данных.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-106">As tools for working with big data sets advance, so does the meaning of big data.</span></span> <span data-ttu-id="0b4c7-107">Зачастую этот термин связан со значением, которое можно извлечь из наборов данных с помощью расширенной аналитики, а не исключительно с размером данных. Хотя в этих случаях они обычно достаточно большие.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-107">More and more, this term relates to the value you can extract from your data sets through advanced analytics, rather than strictly the size of the data, although in these cases they tend to be quite large.</span></span>

<span data-ttu-id="0b4c7-108">С годами ландшафт данных изменился.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-108">Over the years, the data landscape has changed.</span></span> <span data-ttu-id="0b4c7-109">Кроме того, появились новые возможности для работы с данными.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-109">What you can do, or are expected to do, with data has changed.</span></span> <span data-ttu-id="0b4c7-110">Стоимость хранилища значительно снизилась, в то время как стоимость средств для сбора данных продолжает расти.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-110">The cost of storage has fallen dramatically, while the means by which data is collected keeps growing.</span></span> <span data-ttu-id="0b4c7-111">Некоторые данные поступают в ускоренном темпе, их постоянно нужно собирать и просматривать.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-111">Some data arrives at a rapid pace, constantly demanding to be collected and observed.</span></span> <span data-ttu-id="0b4c7-112">Другие данные поступают более медленно, но в очень больших блоках. Они часто содержат данные журналов за десятилетия.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-112">Other data arrives more slowly, but in very large chunks, often in the form of decades of historical data.</span></span> <span data-ttu-id="0b4c7-113">Вы может сталкиваться c проблемой расширенной аналитики или проблемой, для решения которой требуется использовать машинное обучение.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-113">You might be facing an advanced analytics problem, or one that requires machine learning.</span></span> <span data-ttu-id="0b4c7-114">Это задачи, которые архитектура для обработки больших данных предназначена решить.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-114">These are challenges that big data architectures seek to solve.</span></span>

<span data-ttu-id="0b4c7-115">Решения для обработки больших данных обычно предназначены для одного или нескольких из следующих типов рабочей нагрузки:</span><span class="sxs-lookup"><span data-stu-id="0b4c7-115">Big data solutions typically involve one or more of the following types of workload:</span></span>

- <span data-ttu-id="0b4c7-116">пакетная обработка источников неактивных больших данных;</span><span class="sxs-lookup"><span data-stu-id="0b4c7-116">Batch processing of big data sources at rest.</span></span>
- <span data-ttu-id="0b4c7-117">обработка больших данных в динамике в режиме реального времени;</span><span class="sxs-lookup"><span data-stu-id="0b4c7-117">Real-time processing of big data in motion.</span></span>
- <span data-ttu-id="0b4c7-118">интерактивное изучение больших данных;</span><span class="sxs-lookup"><span data-stu-id="0b4c7-118">Interactive exploration of big data.</span></span>
- <span data-ttu-id="0b4c7-119">прогнозная аналитика и машинное обучение.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-119">Predictive analytics and machine learning.</span></span>

<span data-ttu-id="0b4c7-120">Используйте архитектуру для обработки больших данных для следующих сценариев:</span><span class="sxs-lookup"><span data-stu-id="0b4c7-120">Consider big data architectures when you need to:</span></span>

- <span data-ttu-id="0b4c7-121">хранение и обработка данных в объемах, слишком больших для традиционной базы данных.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-121">Store and process data in volumes too large for a traditional database.</span></span>
- <span data-ttu-id="0b4c7-122">преобразование неструктурированных данных для анализа и создания отчетов;</span><span class="sxs-lookup"><span data-stu-id="0b4c7-122">Transform unstructured data for analysis and reporting.</span></span>
- <span data-ttu-id="0b4c7-123">запись, обработка и анализ непривязанных потоков данных в режиме реального времени или с низкой задержкой;</span><span class="sxs-lookup"><span data-stu-id="0b4c7-123">Capture, process, and analyze unbounded streams of data in real time, or with low latency.</span></span>

## <a name="components-of-a-big-data-architecture"></a><span data-ttu-id="0b4c7-124">Компоненты архитектуры для обработки больших данных</span><span class="sxs-lookup"><span data-stu-id="0b4c7-124">Components of a big data architecture</span></span>

<span data-ttu-id="0b4c7-125">На схеме ниже показаны логические компоненты, которые входят в архитектуру для обработки больших данных.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-125">The following diagram shows the logical components that fit into a big data architecture.</span></span> <span data-ttu-id="0b4c7-126">Отдельные решения могут не содержать все компоненты в этой схеме.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-126">Individual solutions may not contain every item in this diagram.</span></span>

![Общая схема конвейера данных](./images/big-data-pipeline.png)

<span data-ttu-id="0b4c7-128">Большинство архитектур для обработки больших данных включают некоторые или все перечисленные ниже компоненты.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-128">Most big data architectures include some or all of the following components:</span></span>

- <span data-ttu-id="0b4c7-129">**Источники данных.**</span><span class="sxs-lookup"><span data-stu-id="0b4c7-129">**Data sources**.</span></span> <span data-ttu-id="0b4c7-130">Все решения для обработки больших данных начинаются с одного или нескольких источников данных.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-130">All big data solutions start with one or more data sources.</span></span> <span data-ttu-id="0b4c7-131">Примеры приведены ниже.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-131">Examples include:</span></span>

  - <span data-ttu-id="0b4c7-132">Хранилища данных приложений, например реляционные базы данных.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-132">Application data stores, such as relational databases.</span></span>
  - <span data-ttu-id="0b4c7-133">Статические файлы, которые создаются приложениями, например файлы журнала веб-сервера.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-133">Static files produced by applications, such as web server log files.</span></span>
  - <span data-ttu-id="0b4c7-134">Источники данных с передачей в режиме реального времени, например устройства Интернета вещей.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-134">Real-time data sources, such as IoT devices.</span></span>

- <span data-ttu-id="0b4c7-135">**Хранилище данных.**</span><span class="sxs-lookup"><span data-stu-id="0b4c7-135">**Data storage**.</span></span> <span data-ttu-id="0b4c7-136">Данные для пакетной обработки обычно хранятся в распределенном хранилище файлов, где могут содержаться значительные объемы больших файлов в различных форматах.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-136">Data for batch processing operations is typically stored in a distributed file store that can hold high volumes of large files in various formats.</span></span> <span data-ttu-id="0b4c7-137">Этот тип хранилища часто называют *озером данных*.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-137">This kind of store is often called a *data lake*.</span></span> <span data-ttu-id="0b4c7-138">Такое хранилище можно реализовать с помощью Azure Data Lake Store или контейнеров больших двоичных объектов в службе хранилища Azure.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-138">Options for implementing this storage include Azure Data Lake Store or blob containers in Azure Storage.</span></span>

- <span data-ttu-id="0b4c7-139">**Пакетная обработка.**</span><span class="sxs-lookup"><span data-stu-id="0b4c7-139">**Batch processing**.</span></span> <span data-ttu-id="0b4c7-140">Так как наборы данных очень велики, часто в решении обрабатываются длительные пакетные задания. Для них выполняется фильтрация, статистическая обработка и другие процессы подготовки данных к анализу.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-140">Because the data sets are so large, often a big data solution must process data files using long-running batch jobs to filter, aggregate, and otherwise prepare the data for analysis.</span></span> <span data-ttu-id="0b4c7-141">Обычно в эти задания входит чтение исходных файлов, их обработка и запись выходных данных в новые файлы.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-141">Usually these jobs involve reading source files, processing them, and writing the output to new files.</span></span> <span data-ttu-id="0b4c7-142">Варианты: выполнение заданий U-SQL в Azure Data Lake Analytics, использование пользовательских заданий Hive, Pig или Map/Reduce в кластере HDInsight Hadoop и применение программ Java, Scala или Python в кластере HDInsight Spark.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-142">Options include running U-SQL jobs in Azure Data Lake Analytics, using Hive, Pig, or custom Map/Reduce jobs in an HDInsight Hadoop cluster, or using Java, Scala, or Python programs in an HDInsight Spark cluster.</span></span>

- <span data-ttu-id="0b4c7-143">**Прием сообщений в реальном времени.**</span><span class="sxs-lookup"><span data-stu-id="0b4c7-143">**Real-time message ingestion**.</span></span> <span data-ttu-id="0b4c7-144">Если решение содержит источники в режиме реального времени, в архитектуре должен быть предусмотрен способ сбора и сохранения сообщений в режиме реального времени для потоковой обработки.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-144">If the solution includes real-time sources, the architecture must include a way to capture and store real-time messages for stream processing.</span></span> <span data-ttu-id="0b4c7-145">Это может быть простое хранилище данных с папкой, в которую входящие сообщения помещаются для обработки.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-145">This might be a simple data store, where incoming messages are dropped into a folder for processing.</span></span> <span data-ttu-id="0b4c7-146">Но для приема сообщений многим решениям требуется хранилище, которое можно использовать в качестве буфера. Такое хранилище должно поддерживать обработку с горизонтальным масштабированием, надежную доставку и другую семантику очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-146">However, many solutions need a message ingestion store to act as a buffer for messages, and to support scale-out processing, reliable delivery, and other message queuing semantics.</span></span> <span data-ttu-id="0b4c7-147">Эта часть архитектуры потоковой передачи часто называется потоковой буферизацией.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-147">This portion of a streaming architecture is often referred to as stream buffering.</span></span> <span data-ttu-id="0b4c7-148">Варианты: Центры событий Azure, Центр Интернета вещей и Kafka.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-148">Options include Azure Event Hubs, Azure IoT Hub, and Kafka.</span></span>

- <span data-ttu-id="0b4c7-149">**Потоковая обработка.**</span><span class="sxs-lookup"><span data-stu-id="0b4c7-149">**Stream processing**.</span></span> <span data-ttu-id="0b4c7-150">Сохранив сообщения, поступающие в режиме реального времени, система выполняет для них фильтрацию, статистическую обработку и другие процессы подготовки данных к анализу.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-150">After capturing real-time messages, the solution must process them by filtering, aggregating, and otherwise preparing the data for analysis.</span></span> <span data-ttu-id="0b4c7-151">Затем обработанные потоковые данные записываются в выходной приемник.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-151">The processed stream data is then written to an output sink.</span></span> <span data-ttu-id="0b4c7-152">Azure Stream Analytics предоставляет управляемую службу потоковой обработки на основе постоянного выполнения запросов SQL для непривязанных потоков.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-152">Azure Stream Analytics provides a managed stream processing service based on perpetually running SQL queries that operate on unbounded streams.</span></span> <span data-ttu-id="0b4c7-153">Кроме того, для потоковой передачи можно использовать технологии Apache с открытым кодом, например Storm и Spark Streaming в кластере HDInsight.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-153">You can also use open source Apache streaming technologies like Storm and Spark Streaming in an HDInsight cluster.</span></span>

- <span data-ttu-id="0b4c7-154">**Хранилище аналитических данных.**</span><span class="sxs-lookup"><span data-stu-id="0b4c7-154">**Analytical data store**.</span></span> <span data-ttu-id="0b4c7-155">Во многих решениях для обработки больших данных данные подготавливаются к анализу. Затем обработанные данные структурируются в соответствии с форматом запросов для средств аналитики.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-155">Many big data solutions prepare data for analysis and then serve the processed data in a structured format that can be queried using analytical tools.</span></span> <span data-ttu-id="0b4c7-156">Хранилище аналитических данных, используемое для обработки таких запросов, может быть реляционной базой данных типа Kimball, как можно увидеть в большинстве традиционных решений бизнес-аналитики (BI).</span><span class="sxs-lookup"><span data-stu-id="0b4c7-156">The analytical data store used to serve these queries can be a Kimball-style relational data warehouse, as seen in most traditional business intelligence (BI) solutions.</span></span> <span data-ttu-id="0b4c7-157">Кроме того, данные можно представить с помощью технологии NoSQL с низкой задержкой, такой как HBase или интерактивная база данных Hive, которая предоставляет абстракцию метаданных для файлов данных в распределенном хранилище.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-157">Alternatively, the data could be presented through a low-latency NoSQL technology such as HBase, or an interactive Hive database that provides a metadata abstraction over data files in the distributed data store.</span></span> <span data-ttu-id="0b4c7-158">Хранилище данных SQL Azure предоставляет управляемую службу для хранения больших объемов данных в облаке.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-158">Azure SQL Data Warehouse provides a managed service for large-scale, cloud-based data warehousing.</span></span> <span data-ttu-id="0b4c7-159">HDInsight поддерживает Interactive Hive, HBase и Spark SQL, которые также можно использовать, чтобы предоставлять данные для анализа.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-159">HDInsight supports Interactive Hive, HBase, and Spark SQL, which can also be used to serve data for analysis.</span></span>

- <span data-ttu-id="0b4c7-160">**Анализ и создание отчетов.**</span><span class="sxs-lookup"><span data-stu-id="0b4c7-160">**Analysis and reporting**.</span></span> <span data-ttu-id="0b4c7-161">Большинство решений по обработке больших данных предназначены для анализа и составления отчетов, что позволяет получить важную информацию.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-161">The goal of most big data solutions is to provide insights into the data through analysis and reporting.</span></span> <span data-ttu-id="0b4c7-162">Чтобы расширить возможности анализа данных, можно включить в архитектуру слой моделирования, например модель таблицы или многомерного куба OLAP в Azure Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-162">To empower users to analyze the data, the architecture may include a data modeling layer, such as a multidimensional OLAP cube or tabular data model in Azure Analysis Services.</span></span> <span data-ttu-id="0b4c7-163">Также можно включить поддержку самостоятельной бизнес-аналитики с использованием технологий моделирования и визуализации в Microsoft Power BI или Microsoft Excel.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-163">It might also support self-service BI, using the modeling and visualization technologies in Microsoft Power BI or Microsoft Excel.</span></span> <span data-ttu-id="0b4c7-164">Анализ и создание отчетов также может выполняться путем интерактивного изучения данных специалистами по их анализу и обработке.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-164">Analysis and reporting can also take the form of interactive data exploration by data scientists or data analysts.</span></span> <span data-ttu-id="0b4c7-165">Для таких сценариев многие службы Azure поддерживают функции аналитического блокнота, например Jupyter, который позволяет пользователям применять свои навыки работы с Python или R. Для крупномасштабного изучения данных можно использовать Microsoft R Server (отдельно или со Spark).</span><span class="sxs-lookup"><span data-stu-id="0b4c7-165">For these scenarios, many Azure services support analytical notebooks, such as Jupyter, enabling these users to leverage their existing skills with Python or R. For large-scale data exploration, you can use Microsoft R Server, either standalone or with Spark.</span></span>

- <span data-ttu-id="0b4c7-166">**Оркестрация.**</span><span class="sxs-lookup"><span data-stu-id="0b4c7-166">**Orchestration**.</span></span> <span data-ttu-id="0b4c7-167">Большинство решений для обработки больших данных состоят из повторяющихся рабочих процессов, во время которых преобразуются исходные данные, данные перемещаются между несколькими источниками и приемниками, обработанные данные загружаются в хранилища аналитических данных либо же результаты передаются непосредственно в отчет или на панель мониторинга.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-167">Most big data solutions consist of repeated data processing operations, encapsulated in workflows, that transform source data, move data between multiple sources and sinks, load the processed data into an analytical data store, or push the results straight to a report or dashboard.</span></span> <span data-ttu-id="0b4c7-168">Чтобы автоматизировать эти рабочие процессы, вы можете использовать технологию оркестрации, такую как фабрика данных Azure или Apache Oozie и Sqoop.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-168">To automate these workflows, you can use an orchestration technology such Azure Data Factory or Apache Oozie and Sqoop.</span></span>

## <a name="lambda-architecture"></a><span data-ttu-id="0b4c7-169">Лямбда-архитектура</span><span class="sxs-lookup"><span data-stu-id="0b4c7-169">Lambda architecture</span></span>

<span data-ttu-id="0b4c7-170">При работе с очень большими наборами данных выполнение типа запросов, необходимых клиентам, может занять много времени.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-170">When working with very large data sets, it can take a long time to run the sort of queries that clients need.</span></span> <span data-ttu-id="0b4c7-171">Эти запросы нельзя выполнить в режиме реального времени. Они часто требуют алгоритмов, например [MapReduce](https://en.wikipedia.org/wiki/MapReduce), которые работают параллельно по всему набору данных.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-171">These queries can't be performed in real time, and often require algorithms such as [MapReduce](https://en.wikipedia.org/wiki/MapReduce) that operate in parallel across the entire data set.</span></span> <span data-ttu-id="0b4c7-172">Результаты затем сохраняются отдельно от необработанных данных и используются для выполнения запросов.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-172">The results are then stored separately from the raw data and used for querying.</span></span>

<span data-ttu-id="0b4c7-173">Недостатком этого подхода является то, что появляется задержка. Если обработка занимает несколько часов, запрос может возвращать результаты, которые были актуальными несколько часов назад.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-173">One drawback to this approach is that it introduces latency &mdash; if processing takes a few hours, a query may return results that are several hours old.</span></span> <span data-ttu-id="0b4c7-174">В идеале вам следует получить некоторые результаты в режиме реального времени (возможно, с некоторой потерей точности) и объединить их с результатами пакетной аналитики.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-174">Ideally, you would like to get some results in real time (perhaps with some loss of accuracy), and combine these results with the results from the batch analytics.</span></span>

<span data-ttu-id="0b4c7-175">**Лямбда-архитектура**, впервые предложенная Натаном Марцом (Nathan Marz), устраняет эту проблему путем создания двух путей для потока данных.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-175">The **lambda architecture**, first proposed by Nathan Marz, addresses this problem by creating two paths for data flow.</span></span> <span data-ttu-id="0b4c7-176">Все данные, поступающие в систему, проходят через эти два пути:</span><span class="sxs-lookup"><span data-stu-id="0b4c7-176">All data coming into the system goes through these two paths:</span></span>

- <span data-ttu-id="0b4c7-177">На **пакетном уровне** (холодный путь) все входящие данные хранятся в необработанном виде и выполняется их пакетная обработка.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-177">A **batch layer** (cold path) stores all of the incoming data in its raw form and performs batch processing on the data.</span></span> <span data-ttu-id="0b4c7-178">Результаты этой обработки сохраняются в **пакетном представлении**.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-178">The result of this processing is stored as a **batch view**.</span></span>

- <span data-ttu-id="0b4c7-179">На **уровне ускорения** (критический путь) данные анализируются в режиме реального времени.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-179">A **speed layer** (hot path) analyzes data in real time.</span></span> <span data-ttu-id="0b4c7-180">Этот уровень обеспечивает минимальную задержку, хотя и за счет точности.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-180">This layer is designed for low latency, at the expense of accuracy.</span></span>

<span data-ttu-id="0b4c7-181">Пакетный уровень предоставляет результаты для **уровня обслуживания**, который индексирует пакетное представление для эффективного выполнения запросов.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-181">The batch layer feeds into a **serving layer** that indexes the batch view for efficient querying.</span></span> <span data-ttu-id="0b4c7-182">Уровень ускорения обновляет уровень обслуживания, отправляя добавочные обновления (с учетом последних данных).</span><span class="sxs-lookup"><span data-stu-id="0b4c7-182">The speed layer updates the serving layer with incremental updates based on the most recent data.</span></span>

![Схема лямбда-архитектуры](./images/lambda.png)

<span data-ttu-id="0b4c7-184">Данные, которые поступают в критический путь, ограничены требованиями к задержке, наложенными уровнем ускорения, чтобы их можно было обработать как можно быстрее.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-184">Data that flows into the hot path is constrained by latency requirements imposed by the speed layer, so that it can be processed as quickly as possible.</span></span> <span data-ttu-id="0b4c7-185">Часто в этом случае следует обеспечить компромисс: некоторая потеря точности в пользу получения готовых данных как можно быстрее.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-185">Often, this requires a tradeoff of some level of accuracy in favor of data that is ready as quickly as possible.</span></span> <span data-ttu-id="0b4c7-186">Например, рассмотрите сценарий Интернета вещей, где большое количество датчиков температуры отправляют данные телеметрии.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-186">For example, consider an IoT scenario where a large number of temperature sensors are sending telemetry data.</span></span> <span data-ttu-id="0b4c7-187">Уровень ускорения можно использовать для обработки скользящего временного окна входных данных.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-187">The speed layer may be used to process a sliding time window of the incoming data.</span></span>

<span data-ttu-id="0b4c7-188">На данные, которые поступают в холодный путь, с другой стороны, не распространяются те же требования к низкой задержке.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-188">Data flowing into the cold path, on the other hand, is not subject to the same low latency requirements.</span></span> <span data-ttu-id="0b4c7-189">Это обеспечивает высокую точность вычисления больших наборов данных, однако занимает много времени.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-189">This allows for high accuracy computation across large data sets, which can be very time intensive.</span></span>

<span data-ttu-id="0b4c7-190">В результате критический и холодный пути объединяются в клиентском приложении аналитики.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-190">Eventually, the hot and cold paths converge at the analytics client application.</span></span> <span data-ttu-id="0b4c7-191">Если клиент должен отображать результаты своевременно, но потенциально с менее точными данными в режиме реального времени, он будет получать результаты из критического пути.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-191">If the client needs to display timely, yet potentially less accurate data in real time, it will acquire its result from the hot path.</span></span> <span data-ttu-id="0b4c7-192">В противном случае он будет выбирать результаты из холодного пути, чтобы отображать более точные данные, однако не так своевременно.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-192">Otherwise, it will select results from the cold path to display less timely but more accurate data.</span></span> <span data-ttu-id="0b4c7-193">Другими словами, критический путь содержит данные за относительно небольшой промежуток времени, после которого результаты можно обновить более точными данными из критического пути.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-193">In other words, the hot path has data for a relatively small window of time, after which the results can be updated with more accurate data from the cold path.</span></span>

<span data-ttu-id="0b4c7-194">Необработанные данные, которые хранятся на пакетном уровне, являются неизменяемыми.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-194">The raw data stored at the batch layer is immutable.</span></span> <span data-ttu-id="0b4c7-195">Входящие данные всегда добавляются к имеющимся. Предыдущие данные никогда не перезаписываются.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-195">Incoming data is always appended to the existing data, and the previous data is never overwritten.</span></span> <span data-ttu-id="0b4c7-196">Любые изменения значения определенных данных хранятся в виде новой записи о событии с меткой времени.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-196">Any changes to the value of a particular datum are stored as a new timestamped event record.</span></span> <span data-ttu-id="0b4c7-197">Это позволяет в любой момент времени выполнить повторное вычисление в журнале собранных данных.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-197">This allows for recomputation at any point in time across the history of the data collected.</span></span> <span data-ttu-id="0b4c7-198">Возможность повторного вычисления пакетных представлений из исходных необработанных данных очень важна, так как это позволяет создавать представления по мере развития системы.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-198">The ability to recompute the batch view from the original raw data is important, because it allows for new views to be created as the system evolves.</span></span>

## <a name="kappa-architecture"></a><span data-ttu-id="0b4c7-199">Каппа-архитектура</span><span class="sxs-lookup"><span data-stu-id="0b4c7-199">Kappa architecture</span></span>

<span data-ttu-id="0b4c7-200">Недостатком лямбда-архитектуры является ее сложность.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-200">A drawback to the lambda architecture is its complexity.</span></span> <span data-ttu-id="0b4c7-201">Логика обработки применяется в двух различных местах, в холодном и критическом путях, с использованием различных структур.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-201">Processing logic appears in two different places &mdash; the cold and hot paths &mdash; using different frameworks.</span></span> <span data-ttu-id="0b4c7-202">Это приводит к дублированию логики вычислений и усложняет управление архитектурой для обоих путей.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-202">This leads to duplicate computation logic and the complexity of managing the architecture for both paths.</span></span>

<span data-ttu-id="0b4c7-203">**Каппа-архитектура** была предложена Джеем Крепсом (Jay Kreps) в качестве альтернативы лямбда-архитектуре.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-203">The **kappa architecture** was proposed by Jay Kreps as an alternative to the lambda architecture.</span></span> <span data-ttu-id="0b4c7-204">Она имеет такие же основные цели, что и лямбда-архитектура, но с одним важным отличием: используется система обработки потоковых данных и все данные проходят по одному пути.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-204">It has the same basic goals as the lambda architecture, but with an important distinction: All data flows through a single path, using a stream processing system.</span></span>

![Схема каппа-архитектуры](./images/kappa.png)

<span data-ttu-id="0b4c7-206">Имеется некоторое сходство с пакетным уровнем лямбда-архитектуры. Оно заключается в том, что данные являются неизменяемыми. Кроме того, собираются все данные, а не только их подмножество.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-206">There are some similarities to the lambda architecture's batch layer, in that the event data is immutable and all of it is collected, instead of a subset.</span></span> <span data-ttu-id="0b4c7-207">Данные принимаются как поток событий в распределенном и отказоустойчивом едином журнале.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-207">The data is ingested as a stream of events into a distributed and fault tolerant unified log.</span></span> <span data-ttu-id="0b4c7-208">Эти события упорядочиваются, и текущее состояние события изменяется только при добавлении нового события.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-208">These events are ordered, and the current state of an event is changed only by a new event being appended.</span></span> <span data-ttu-id="0b4c7-209">Аналогично уровню ускорения лямбда-архитектуры вся обработка событий выполняется во входном потоке и сохраняется как представление в режиме реального времени.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-209">Similar to a lambda architecture's speed layer, all event processing is performed on the input stream and persisted as a real-time view.</span></span>

<span data-ttu-id="0b4c7-210">Если необходимо повторно вычислить весь набор данных (аналогично тому, что происходит на пакетном уровне в лямбда-архитектуре), просто воспроизведите поток. Чтобы завершить вычисление вовремя, обычно используется параллелизм.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-210">If you need to recompute the entire data set (equivalent to what the batch layer does in lambda), you simply replay the stream, typically using parallelism to complete the computation in a timely fashion.</span></span>

## <a name="internet-of-things-iot"></a><span data-ttu-id="0b4c7-211">Интернет вещей.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-211">Internet of Things (IoT)</span></span>

<span data-ttu-id="0b4c7-212">С практической точки зрения Интернет вещей представляет все устройства, подключенные к Интернету.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-212">From a practical viewpoint, Internet of Things (IoT) represents any device that is connected to the Internet.</span></span> <span data-ttu-id="0b4c7-213">Сюда входят ПК, мобильный телефон, умные часы, умный термостат, умный холодильник, подключенный автомобиль, импланты для кардиомониторинга и все остальные устройства, которые подключены к Интернету и отправляют или получают данные.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-213">This includes your PC, mobile phone, smart watch, smart thermostat, smart refrigerator, connected automobile, heart monitoring implants, and anything else that connects to the Internet and sends or receives data.</span></span> <span data-ttu-id="0b4c7-214">Количество подключенных устройств растет каждый день, как и объем собираемых с них данных.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-214">The number of connected devices grows every day, as does the amount of data collected from them.</span></span> <span data-ttu-id="0b4c7-215">Часто эти данные собираются в среды с большим количеством ограничений, а иногда и с высокой задержкой.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-215">Often this data is being collected in highly constrained, sometimes high-latency environments.</span></span> <span data-ttu-id="0b4c7-216">В других случаях данные отправляются из сред с малой задержкой тысячами или миллионами устройств, требуя возможности быстро принимать данные и обрабатывать их соответствующим образом.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-216">In other cases, data is sent from low-latency environments by thousands or millions of devices, requiring the ability to rapidly ingest the data and process accordingly.</span></span> <span data-ttu-id="0b4c7-217">Таким образом, чтобы работать с этими ограничениями и уникальными требованиями, требуется продуманное планирование.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-217">Therefore, proper planning is required to handle these constraints and unique requirements.</span></span>

<span data-ttu-id="0b4c7-218">Управляемые событиями архитектуры очень удобны при работе с решениями Интернета вещей.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-218">Event-driven architectures are central to IoT solutions.</span></span> <span data-ttu-id="0b4c7-219">На следующей схеме представлены возможные варианты логической архитектуры для Интернета вещей.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-219">The following diagram shows a possible logical architecture for IoT.</span></span> <span data-ttu-id="0b4c7-220">Особое внимание в этой схеме уделяется компонентам архитектуры для потоковой передачи событий.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-220">The diagram emphasizes the event-streaming components of the architecture.</span></span>

![Архитектура Интернета вещей](../../guide/architecture-styles/images/iot.png)

<span data-ttu-id="0b4c7-222">**Облачный шлюз** принимает события от устройств на границе облака, используя надежную службу сообщений с низкой задержкой.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-222">The **cloud gateway** ingests device events at the cloud boundary, using a reliable, low latency messaging system.</span></span>

<span data-ttu-id="0b4c7-223">Устройства могут отправлять события в облачный шлюз напрямую или через **полевой шлюз**.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-223">Devices might send events directly to the cloud gateway, or through a **field gateway**.</span></span> <span data-ttu-id="0b4c7-224">Полевой шлюз — это специальное устройство или программа, обычно размещаемые рядом с устройствами, которые получают события и пересылают их в облачный шлюз.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-224">A field gateway is a specialized device or software, usually collocated with the devices, that receives events and forwards them to the cloud gateway.</span></span> <span data-ttu-id="0b4c7-225">Полевой шлюз может выполнять некоторую предварительную обработку событий, собираемых с устройств, например фильтрацию, статистическую обработку или преобразование протоколов.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-225">The field gateway might also preprocess the raw device events, performing functions such as filtering, aggregation, or protocol transformation.</span></span>

<span data-ttu-id="0b4c7-226">Полученные события проходят через один или несколько **обработчиков потока**, которые передают данные в другие системы (например, хранилище данных) или выполняют аналитическую или другую обработку.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-226">After ingestion, events go through one or more **stream processors** that can route the data (for example, to storage) or perform analytics and other processing.</span></span>

<span data-ttu-id="0b4c7-227">Ниже приводятся примеры типичных процессов обработки.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-227">The following are some common types of processing.</span></span> <span data-ttu-id="0b4c7-228">(Очевидно, что этот список не является исчерпывающим.)</span><span class="sxs-lookup"><span data-stu-id="0b4c7-228">(This list is certainly not exhaustive.)</span></span>

- <span data-ttu-id="0b4c7-229">Сохранение данных о событиях в "холодное" хранилище для архивации или пакетной аналитики.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-229">Writing event data to cold storage, for archiving or batch analytics.</span></span>

- <span data-ttu-id="0b4c7-230">Аналитика критического пути, то есть анализ потока событий почти в режиме реального времени для обнаружения аномалий, выявления закономерностей в скользящих диапазонах времени или создания оповещений при выполнении определенных условий в потоке.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-230">Hot path analytics, analyzing the event stream in (near) real time, to detect anomalies, recognize patterns over rolling time windows, or trigger alerts when a specific condition occurs in the stream.</span></span>

- <span data-ttu-id="0b4c7-231">Обработка специальных типов сообщений, не относящихся к телеметрии, например уведомлений и тревожных сигналов.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-231">Handling special types of nontelemetry messages from devices, such as notifications and alarms.</span></span>

- <span data-ttu-id="0b4c7-232">Машинное обучение.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-232">Machine learning.</span></span>

<span data-ttu-id="0b4c7-233">Серые блоки обозначают компоненты системы Интернета вещей, не связанные напрямую с потоковой передачей событий. Они включены в схему для полноты представления.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-233">The boxes that are shaded gray show components of an IoT system that are not directly related to event streaming, but are included here for completeness.</span></span>

- <span data-ttu-id="0b4c7-234">**Реестр устройств** — это база данных о подготовленных устройствах, которая содержит идентификаторы устройств и некоторые метаданные, например расположение.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-234">The **device registry** is a database of the provisioned devices, including the device IDs and usually device metadata, such as location.</span></span>

- <span data-ttu-id="0b4c7-235">**API подготовки** — это общий внешний интерфейс для подготовки и регистрации новых устройств.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-235">The **provisioning API** is a common external interface for provisioning and registering new devices.</span></span>

- <span data-ttu-id="0b4c7-236">В некоторых решениях Интернета вещей допускается отправка **управляющих сообщений** на устройства.</span><span class="sxs-lookup"><span data-stu-id="0b4c7-236">Some IoT solutions allow **command and control messages** to be sent to devices.</span></span>

<span data-ttu-id="0b4c7-237">Соответствующие службы Azure:</span><span class="sxs-lookup"><span data-stu-id="0b4c7-237">Relevant Azure services:</span></span>

- [<span data-ttu-id="0b4c7-238">Центр Интернета вещей Azure</span><span class="sxs-lookup"><span data-stu-id="0b4c7-238">Azure IoT Hub</span></span>](https://azure.microsoft.com/services/iot-hub/)
- [<span data-ttu-id="0b4c7-239">Центры событий Azure</span><span class="sxs-lookup"><span data-stu-id="0b4c7-239">Azure Event Hubs</span></span>](https://azure.microsoft.com/services/event-hubs/)
- [<span data-ttu-id="0b4c7-240">Azure Stream Analytics</span><span class="sxs-lookup"><span data-stu-id="0b4c7-240">Azure Stream Analytics</span></span>](https://azure.microsoft.com/services/stream-analytics/)  

<span data-ttu-id="0b4c7-241">Дополнительные сведения об Интернете вещей в Azure см. в статье об [эталонной архитектуре Интернета вещей Microsoft Azure](https://azure.microsoft.com/updates/microsoft-azure-iot-reference-architecture-available/).</span><span class="sxs-lookup"><span data-stu-id="0b4c7-241">Learn more about IoT on Azure by reading the [Azure IoT reference architecture](https://azure.microsoft.com/updates/microsoft-azure-iot-reference-architecture-available/).</span></span>
