---
title: Обработка в режиме реального времени
description: ''
author: zoinerTejada
ms.date: 02/12/2018
ms.topic: guide
ms.service: architecture-center
ms.subservice: cloud-fundamentals
ms.openlocfilehash: fa181700a250b3f957e038f8b5965ad02efd8979
ms.sourcegitcommit: c053e6edb429299a0ad9b327888d596c48859d4a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/20/2019
ms.locfileid: "58243615"
---
# <a name="real-time-processing"></a><span data-ttu-id="b9b06-102">Обработка в режиме реального времени</span><span class="sxs-lookup"><span data-stu-id="b9b06-102">Real time processing</span></span>

<span data-ttu-id="b9b06-103">Обработка в режиме реального времени выполняется для потоков данных, получаемых в реальном времени и обрабатываемых с минимальной задержкой для создания отчетов или автоматизированного реагирования в режиме реального времени (или приближенном к реальному времени).</span><span class="sxs-lookup"><span data-stu-id="b9b06-103">Real time processing deals with streams of data that are captured in real-time and processed with minimal latency to generate real-time (or near-real-time) reports or automated responses.</span></span> <span data-ttu-id="b9b06-104">Например, решение для мониторинга дорожного движения в режиме реального времени позволяет отслеживать зоны интенсивного движения по данным от датчиков.</span><span class="sxs-lookup"><span data-stu-id="b9b06-104">For example, a real-time traffic monitoring solution might use sensor data to detect high traffic volumes.</span></span> <span data-ttu-id="b9b06-105">На основе этих данных можно динамически обновлять карту с информацией о пробках или автоматического регулировать движение с помощью специальных полос или других систем управления дорожным движением.</span><span class="sxs-lookup"><span data-stu-id="b9b06-105">This data could be used to dynamically update a map to show congestion, or automatically initiate high-occupancy lanes or other traffic management systems.</span></span>

![Схема конвейера обработки в реальном времени](./images/real-time-pipeline.png)

<span data-ttu-id="b9b06-107">Обработкой в режиме реального времени считается обработка непривязанного потока входных данных с минимальным временем задержки &mdash; несколько миллисекунд или секунд.</span><span class="sxs-lookup"><span data-stu-id="b9b06-107">Real-time processing is defined as the processing of unbounded stream of input data, with very short latency requirements for processing &mdash; measured in milliseconds or seconds.</span></span> <span data-ttu-id="b9b06-108">Эти входящие данные обычно поступают в неструктурированном или полуструктурированном формате, например JSON. Требования к обработке здесь такие же, как и в случае [пакетной обработки](./batch-processing.md), кроме дополнительного ограничения по времени для поддержки использования в режиме реального времени.</span><span class="sxs-lookup"><span data-stu-id="b9b06-108">This incoming data typically arrives in an unstructured or semi-structured format, such as JSON, and has the same processing requirements as [batch processing](./batch-processing.md), but with shorter turnaround times to support real-time consumption.</span></span>

<span data-ttu-id="b9b06-109">Обработанные данные обычно сохраняются в хранилище аналитических данных, которое оптимизировано для анализа и визуализации.</span><span class="sxs-lookup"><span data-stu-id="b9b06-109">Processed data is often written to an analytical data store, which is optimized for analytics and visualization.</span></span> <span data-ttu-id="b9b06-110">Также обработанные данные можно напрямую принимать на слоях аналитической обработки и отчетности для анализа, бизнес-аналитики и визуализации на панелях мониторинга в режиме реального времени.</span><span class="sxs-lookup"><span data-stu-id="b9b06-110">The processed data can also be ingested directly into the analytics and reporting layer for analysis, business intelligence, and real-time dashboard visualization.</span></span>

## <a name="challenges"></a><span data-ttu-id="b9b06-111">Сложности</span><span class="sxs-lookup"><span data-stu-id="b9b06-111">Challenges</span></span>

<span data-ttu-id="b9b06-112">Одной из главных проблем в любой системе обработки в режиме реального времени является поддержание возможности приема и сохранения сообщений в режиме реального времени, особенно при больших объемах данных.</span><span class="sxs-lookup"><span data-stu-id="b9b06-112">One of the big challenges of real-time processing solutions is to ingest, process, and store messages in real time, especially at high volumes.</span></span> <span data-ttu-id="b9b06-113">Обработка должна выполняться так, чтобы не блокировать конвейер приема данных.</span><span class="sxs-lookup"><span data-stu-id="b9b06-113">Processing must be done in such a way that it does not block the ingestion pipeline.</span></span> <span data-ttu-id="b9b06-114">Нужно использовать хранилище данных, поддерживающее операции записи в больших объемах.</span><span class="sxs-lookup"><span data-stu-id="b9b06-114">The data store must support high-volume writes.</span></span> <span data-ttu-id="b9b06-115">Еще одна проблема — создание возможностей для быстрого реагирования, например для создания оповещений в режиме реального времени или представления данных на панели мониторинга в режиме реального времени (или приближенном к реальному времени).</span><span class="sxs-lookup"><span data-stu-id="b9b06-115">Another challenge is being able to act on the data quickly, such as generating alerts in real time or presenting the data in a real-time (or near-real-time) dashboard.</span></span>

## <a name="architecture"></a><span data-ttu-id="b9b06-116">Архитектура</span><span class="sxs-lookup"><span data-stu-id="b9b06-116">Architecture</span></span>

<span data-ttu-id="b9b06-117">Архитектура обработки в режиме реального времени состоит из следующих логических компонентов.</span><span class="sxs-lookup"><span data-stu-id="b9b06-117">A real-time processing architecture has the following logical components.</span></span>

- <span data-ttu-id="b9b06-118">**Прием сообщений в реальном времени**.</span><span class="sxs-lookup"><span data-stu-id="b9b06-118">**Real-time message ingestion.**</span></span> <span data-ttu-id="b9b06-119">Архитектура должна включать средства сбора и сохранения сообщений в режиме реального времени, доступные для объекта-получателя, обрабатывающего поток.</span><span class="sxs-lookup"><span data-stu-id="b9b06-119">The architecture must include a way to capture and store real-time messages to be consumed by a stream processing consumer.</span></span> <span data-ttu-id="b9b06-120">В простых случаях роль такой службы может выполнять обычное хранилище данных, в одной из папок которого размещаются новые сообщения.</span><span class="sxs-lookup"><span data-stu-id="b9b06-120">In simple cases, this service could be implemented as a simple data store in which new messages are deposited in a folder.</span></span> <span data-ttu-id="b9b06-121">Но чаще для этого компонента нужны специализированные брокеры обмена сообщениями, например Центры событий Azure, которые выполняют роль буфера для входящих сообщений.</span><span class="sxs-lookup"><span data-stu-id="b9b06-121">But often the solution requires a message broker, such as Azure Event Hubs, that acts as a buffer for the messages.</span></span> <span data-ttu-id="b9b06-122">Брокер обмена сообщениями должен поддерживать масштабируемую обработку и надежную доставку.</span><span class="sxs-lookup"><span data-stu-id="b9b06-122">The message broker should support scale-out processing and reliable delivery.</span></span>

- <span data-ttu-id="b9b06-123">**Потоковая обработка.**</span><span class="sxs-lookup"><span data-stu-id="b9b06-123">**Stream processing.**</span></span> <span data-ttu-id="b9b06-124">Сохранив сообщения, поступающие в режиме реального времени, система выполняет для них фильтрацию, статистическую обработку и другие процессы подготовки данных к анализу.</span><span class="sxs-lookup"><span data-stu-id="b9b06-124">After capturing real-time messages, the solution must process them by filtering, aggregating, and otherwise preparing the data for analysis.</span></span>

- <span data-ttu-id="b9b06-125">**Хранилище аналитических данных.**</span><span class="sxs-lookup"><span data-stu-id="b9b06-125">**Analytical data store.**</span></span> <span data-ttu-id="b9b06-126">Многие решения по обработке больших данных спроектированы так, чтобы подготавливать данные к анализу и предоставлять их в структурированном формате для запросов через средства аналитики.</span><span class="sxs-lookup"><span data-stu-id="b9b06-126">Many big data solutions are designed to prepare data for analysis and then serve the processed data in a structured format that can be queried using analytical tools.</span></span>

- <span data-ttu-id="b9b06-127">**Анализ и создание отчетов**.</span><span class="sxs-lookup"><span data-stu-id="b9b06-127">**Analysis and reporting.**</span></span> <span data-ttu-id="b9b06-128">Большинство решений по обработке больших данных предназначены для анализа и составления отчетов, что позволяет получить важную информацию.</span><span class="sxs-lookup"><span data-stu-id="b9b06-128">The goal of most big data solutions is to provide insights into the data through analysis and reporting.</span></span>

## <a name="technology-choices"></a><span data-ttu-id="b9b06-129">Выбор технологий</span><span class="sxs-lookup"><span data-stu-id="b9b06-129">Technology choices</span></span>

<span data-ttu-id="b9b06-130">Мы рекомендуем применять следующие технологии для обработки данных в режиме реального времени в Azure.</span><span class="sxs-lookup"><span data-stu-id="b9b06-130">The following technologies are recommended choices for real-time processing solutions in Azure.</span></span>

### <a name="real-time-message-ingestion"></a><span data-ttu-id="b9b06-131">Прием сообщений в реальном времени</span><span class="sxs-lookup"><span data-stu-id="b9b06-131">Real-time message ingestion</span></span>

- <span data-ttu-id="b9b06-132">**Центры событий Azure**.</span><span class="sxs-lookup"><span data-stu-id="b9b06-132">**Azure Event Hubs**.</span></span> <span data-ttu-id="b9b06-133">Центры событий Azure — это решение для управления очередями сообщений, позволяющее ежесекундно обрабатывать миллионы сообщений о событиях.</span><span class="sxs-lookup"><span data-stu-id="b9b06-133">Azure Event Hubs is a message queuing solution for ingesting millions of event messages per second.</span></span> <span data-ttu-id="b9b06-134">Собранные данные о событиях могут обрабатываться несколькими объектами-получателями в параллельном режиме.</span><span class="sxs-lookup"><span data-stu-id="b9b06-134">The captured event data can be processed by multiple consumers in parallel.</span></span>
- <span data-ttu-id="b9b06-135">**Центр Интернета вещей Azure**.</span><span class="sxs-lookup"><span data-stu-id="b9b06-135">**Azure IoT Hub**.</span></span> <span data-ttu-id="b9b06-136">Центр Интернета вещей Azure поддерживает двунаправленный обмен данными между устройствами, подключенными к Интернету, а также масштабируемую очередь сообщений от нескольких миллионов одновременно подключенных устройств.</span><span class="sxs-lookup"><span data-stu-id="b9b06-136">Azure IoT Hub provides bi-directional communication between Internet-connected devices, and a scalable message queue that can handle millions of simultaneously connected devices.</span></span>
- <span data-ttu-id="b9b06-137">**Apache Kafka**.</span><span class="sxs-lookup"><span data-stu-id="b9b06-137">**Apache Kafka**.</span></span> <span data-ttu-id="b9b06-138">Приложение с открытым кодом Kafka поддерживает очереди сообщений, потоковую обработку с возможностью масштабирования до нескольких миллионов сообщений в секунду от множества отправителей сообщений, и перенаправление их множеству объектов-получателей.</span><span class="sxs-lookup"><span data-stu-id="b9b06-138">Kafka is an open source message queuing and stream processing application that can scale to handle millions of messages per second from multiple message producers, and route them to multiple consumers.</span></span> <span data-ttu-id="b9b06-139">Kafka доступно в Azure как тип кластера HDInsight.</span><span class="sxs-lookup"><span data-stu-id="b9b06-139">Kafka is available in Azure as an HDInsight cluster type.</span></span>

<span data-ttu-id="b9b06-140">Дополнительные сведения см. в статье о [приеме сообщений в реальном времени](../technology-choices/real-time-ingestion.md).</span><span class="sxs-lookup"><span data-stu-id="b9b06-140">For more information, see [Real-time message ingestion](../technology-choices/real-time-ingestion.md).</span></span>

### <a name="data-storage"></a><span data-ttu-id="b9b06-141">Хранилище данных</span><span class="sxs-lookup"><span data-stu-id="b9b06-141">Data storage</span></span>

- <span data-ttu-id="b9b06-142">**Контейнеры хранилища BLOB-объектов Azure** или **Azure Data Lake Store**.</span><span class="sxs-lookup"><span data-stu-id="b9b06-142">**Azure Storage Blob Containers** or **Azure Data Lake Store**.</span></span> <span data-ttu-id="b9b06-143">Входящие данные в режиме реального времени обычно поступают в брокер обмена сообщениями (см. выше), но в некоторых случаях следует отслеживать создание новых файлов в папке и обрабатывать их по мере появления или обновления.</span><span class="sxs-lookup"><span data-stu-id="b9b06-143">Incoming real-time data is usually captured in a message broker (see above), but in some scenarios, it can make sense to monitor a folder for new files and process them as they are created or updated.</span></span> <span data-ttu-id="b9b06-144">Кроме того, многие системы обработки в режиме реального времени объединяют потоки данных с некоторыми статичными эталонными данными, которые удобно держать в хранилище файлов.</span><span class="sxs-lookup"><span data-stu-id="b9b06-144">Additionally, many real-time processing solutions combine streaming data with static reference data, which can be stored in a file store.</span></span> <span data-ttu-id="b9b06-145">И наконец, хранилище файлов можно применить как выходное назначение для собранных данных в реальном времени, где они будут архивироваться или подвергаться дополнительной пакетной обработке в [лямбда-архитектуре](../big-data/index.md#lambda-architecture).</span><span class="sxs-lookup"><span data-stu-id="b9b06-145">Finally, file storage may be used as an output destination for captured real-time data for archiving, or for further batch processing in a [lambda architecture](../big-data/index.md#lambda-architecture).</span></span>

<span data-ttu-id="b9b06-146">Дополнительные сведения см. в статье о [хранилище данных](../technology-choices/data-storage.md).</span><span class="sxs-lookup"><span data-stu-id="b9b06-146">For more information, see [Data storage](../technology-choices/data-storage.md).</span></span>

### <a name="stream-processing"></a><span data-ttu-id="b9b06-147">Потоковая обработка</span><span class="sxs-lookup"><span data-stu-id="b9b06-147">Stream processing</span></span>

- <span data-ttu-id="b9b06-148">**Azure Stream Analytics**.</span><span class="sxs-lookup"><span data-stu-id="b9b06-148">**Azure Stream Analytics**.</span></span> <span data-ttu-id="b9b06-149">Azure Stream Analytics может выполнять постоянные запросы к непривязанному потоку данных.</span><span class="sxs-lookup"><span data-stu-id="b9b06-149">Azure Stream Analytics can run perpetual queries against an unbounded stream of data.</span></span> <span data-ttu-id="b9b06-150">Эти запросы получают потоки данных из хранилища или от брокеров обмена сообщениями, фильтруют данные и статистически обрабатывают их по временным окнам, а затем записывают результаты в приемники, например в хранилище данных, базы данных или сразу в отчеты Power BI.</span><span class="sxs-lookup"><span data-stu-id="b9b06-150">These queries consume streams of data from storage or message brokers, filter and aggregate the data based on temporal windows, and write the results to sinks such as storage, databases, or directly to reports in Power BI.</span></span> <span data-ttu-id="b9b06-151">Stream Analytics использует язык запросов на основе SQL, который поддерживает темпоральные и геопространственные конструкции и которые могут быть расширены с помощью JavaScript.</span><span class="sxs-lookup"><span data-stu-id="b9b06-151">Stream Analytics uses a SQL-based query language that supports temporal and geospatial constructs, and can be extended using JavaScript.</span></span>
- <span data-ttu-id="b9b06-152">**Storm**.</span><span class="sxs-lookup"><span data-stu-id="b9b06-152">**Storm**.</span></span> <span data-ttu-id="b9b06-153">Платформа с открытым кодом Apache Storm выполняет потоковую обработку данных на основе топологии воронок и сит, позволяя использовать, обрабатывать и выводить результаты от источников потоковой передачи в режиме реального времени.</span><span class="sxs-lookup"><span data-stu-id="b9b06-153">Apache Storm is an open source framework for stream processing that uses a topology of spouts and bolts to consume, process, and output the results from real-time streaming data sources.</span></span> <span data-ttu-id="b9b06-154">Вы можете подготовить Storm в кластере Azure HDInsight, а топологию для него реализовать на Java или C#.</span><span class="sxs-lookup"><span data-stu-id="b9b06-154">You can provision Storm in an Azure HDInsight cluster, and implement a topology in Java or C#.</span></span>
- <span data-ttu-id="b9b06-155">**Потоковая передача Spark**.</span><span class="sxs-lookup"><span data-stu-id="b9b06-155">**Spark Streaming**.</span></span> <span data-ttu-id="b9b06-156">Распределенная платформа Apache Spark с открытым кодом предназначена для простой обработки данных.</span><span class="sxs-lookup"><span data-stu-id="b9b06-156">Apache Spark is an open source distributed platform for general data processing.</span></span> <span data-ttu-id="b9b06-157">Spark предоставляет API потоковой передачи Spark, в котором можно написать код на любом поддерживаемом Spark языке, включая Java, Python и Scala.</span><span class="sxs-lookup"><span data-stu-id="b9b06-157">Spark provides the Spark Streaming API, in which you can write code in any supported Spark language, including Java, Scala, and Python.</span></span> <span data-ttu-id="b9b06-158">Начиная с версии Spark 2.0 появился API структурированной потоковой передачи Spark, в котором реализована более простая и более согласованная модель программирования.</span><span class="sxs-lookup"><span data-stu-id="b9b06-158">Spark 2.0 introduced the Spark Structured Streaming API, which provides a simpler and more consistent programming model.</span></span> <span data-ttu-id="b9b06-159">Spark 2.0 доступен в кластере Azure HDInsight.</span><span class="sxs-lookup"><span data-stu-id="b9b06-159">Spark 2.0 is available in an Azure HDInsight cluster.</span></span>

<span data-ttu-id="b9b06-160">Дополнительные сведения см. в статье по [потоковой обработке](../technology-choices/stream-processing.md).</span><span class="sxs-lookup"><span data-stu-id="b9b06-160">For more information, see [Stream processing](../technology-choices/stream-processing.md).</span></span>

### <a name="analytical-data-store"></a><span data-ttu-id="b9b06-161">Хранилище аналитических данных</span><span class="sxs-lookup"><span data-stu-id="b9b06-161">Analytical data store</span></span>

- <span data-ttu-id="b9b06-162">**Хранилище данных SQL**, **HBase**, **Spark** или **Hive**.</span><span class="sxs-lookup"><span data-stu-id="b9b06-162">**SQL Data Warehouse**, **HBase**, **Spark**, or **Hive**.</span></span> <span data-ttu-id="b9b06-163">Обработанные данные в режиме реального времени можно хранить в реляционной базе данных, например в хранилище данных SQL Azure, в HBase или другом хранилище NoSQL, а также в виде файлов в распределенном хранилище, на основе которых можно определить и использовать таблицы Spark или Hive.</span><span class="sxs-lookup"><span data-stu-id="b9b06-163">Processed real-time data can be stored in a relational database such Azure SQL Data Warehouse, a NoSQL store such as HBase, or as files in distributed storage over which Spark or Hive tables can be defined and queried.</span></span>

<span data-ttu-id="b9b06-164">Дополнительные сведения см. в статье о [хранилище аналитических данных](../technology-choices/analytical-data-stores.md).</span><span class="sxs-lookup"><span data-stu-id="b9b06-164">For more information, see [Analytical data stores](../technology-choices/analytical-data-stores.md).</span></span>

### <a name="analytics-and-reporting"></a><span data-ttu-id="b9b06-165">Аналитика и отчетность</span><span class="sxs-lookup"><span data-stu-id="b9b06-165">Analytics and reporting</span></span>

- <span data-ttu-id="b9b06-166">**Azure Analysis Services**, **Power BI** и **Microsoft Excel**.</span><span class="sxs-lookup"><span data-stu-id="b9b06-166">**Azure Analysis Services**, **Power BI**, and **Microsoft Excel**.</span></span> <span data-ttu-id="b9b06-167">Обработанные данные в режиме реального времени, которые содержатся в хранилище аналитических данных, можно использовать для создания хронологических отчетов и аналитики таким же образом, как данные пакетной обработки.</span><span class="sxs-lookup"><span data-stu-id="b9b06-167">Processed real-time data that is stored in an analytical data store can be used for historical reporting and analysis in the same way as batch processed data.</span></span> <span data-ttu-id="b9b06-168">Кроме того, можно использовать Power BI для публикации отчетов и визуализации в режиме реального времени (или приближенном к реальному времени) на основе данных из источников аналитических данных с низкой задержкой, а иногда даже напрямую из выходных данных потоковой обработки.</span><span class="sxs-lookup"><span data-stu-id="b9b06-168">Additionally, Power BI can be used to publish real-time (or near-real-time) reports and visualizations from analytical data sources where latency is sufficiently low, or in some cases directly from the stream processing output.</span></span>

<span data-ttu-id="b9b06-169">Дополнительные сведения см. в статье [об аналитике и отчетности](../technology-choices/analysis-visualizations-reporting.md).</span><span class="sxs-lookup"><span data-stu-id="b9b06-169">For more information, see [Analytics and reporting](../technology-choices/analysis-visualizations-reporting.md).</span></span>

<span data-ttu-id="b9b06-170">В решении, полностью нацеленном на обработку в режиме реального времени, основную часть процессов оркестрации выполняют компоненты приема сообщений и обработки потоков.</span><span class="sxs-lookup"><span data-stu-id="b9b06-170">In a purely real-time solution, most of the processing orchestration is managed by the message ingestion and stream processing components.</span></span> <span data-ttu-id="b9b06-171">Но в лямбда-архитектуре, которая сочетает пакетную обработку и обработку в режиме реального времени, может потребоваться отдельная платформа оркестрации, например фабрика данных Azure или Apache Oozie и Sqoop, чтобы управлять рабочими процессами пакетной обработки для собранных данных в режиме реального времени.</span><span class="sxs-lookup"><span data-stu-id="b9b06-171">However, in a lambda architecture that combines batch processing and real-time processing, you may need to use an orchestration framework such as Azure Data Factory or Apache Oozie and Sqoop to manage batch workflows for captured real-time data.</span></span>

## <a name="next-steps"></a><span data-ttu-id="b9b06-172">Дополнительная информация</span><span class="sxs-lookup"><span data-stu-id="b9b06-172">Next steps</span></span>

<span data-ttu-id="b9b06-173">На следующей схеме эталонной архитектуры представлен сквозной конвейер потоков данных:</span><span class="sxs-lookup"><span data-stu-id="b9b06-173">The following reference architecture shows an end-to-end stream processing pipeline:</span></span>

- [<span data-ttu-id="b9b06-174">Обработка потоков данных с помощью Azure Stream Analytics</span><span class="sxs-lookup"><span data-stu-id="b9b06-174">Stream processing with Azure Stream Analytics</span></span>](../../reference-architectures/data/stream-processing-stream-analytics.md)