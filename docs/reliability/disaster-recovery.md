---
title: Сбой и аварийное восстановление для приложений Azure
description: Приближается к Обзор аварийного восстановления в Azure
author: MikeWasson
ms.date: 04/10/2019
ms.topic: article
ms.service: architecture-center
ms.subservice: cloud-design-principles
ms.openlocfilehash: f00341b06b8092c798d6260317226190cbace66b
ms.sourcegitcommit: 579c39ff4b776704ead17a006bf24cd4cdc65edd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59646652"
---
# <a name="failure-and-disaster-recovery-for-azure-applications"></a><span data-ttu-id="51dd6-103">Сбой и аварийное восстановление для приложений Azure</span><span class="sxs-lookup"><span data-stu-id="51dd6-103">Failure and disaster recovery for Azure applications</span></span>

<span data-ttu-id="51dd6-104">*Аварийное восстановление* — это процесс восстановления функциональности приложения в пробуждение существенной потери.</span><span class="sxs-lookup"><span data-stu-id="51dd6-104">*Disaster recovery* is the process of restoring application functionality in the wake of a catastrophic loss.</span></span>

<span data-ttu-id="51dd6-105">Касающимися устойчивости ограниченной функциональности во время аварии является бизнес-решения, отличное от одного приложения к другому.</span><span class="sxs-lookup"><span data-stu-id="51dd6-105">Your tolerance for reduced functionality during a disaster is a business decision that varies from one application to the next.</span></span> <span data-ttu-id="51dd6-106">Он может быть приемлемым для некоторых приложений недоступен полностью или частично доступен в режиме ограниченной функциональности или задержка при обработке в течение заданного времени.</span><span class="sxs-lookup"><span data-stu-id="51dd6-106">It might be acceptable for some applications to be completely unavailable or to be partially available with reduced functionality or delayed processing for a period of time.</span></span> <span data-ttu-id="51dd6-107">Любой ограниченной функциональности неприемлем для других приложений.</span><span class="sxs-lookup"><span data-stu-id="51dd6-107">For other applications, any reduced functionality is unacceptable.</span></span>

## <a name="disaster-recovery-plan"></a><span data-ttu-id="51dd6-108">План аварийного восстановления</span><span class="sxs-lookup"><span data-stu-id="51dd6-108">Disaster recovery plan</span></span>

<span data-ttu-id="51dd6-109">Начните с создания плана восстановления.</span><span class="sxs-lookup"><span data-stu-id="51dd6-109">Start by creating a recovery plan.</span></span> <span data-ttu-id="51dd6-110">План считается завершенной после он полностью протестирован.</span><span class="sxs-lookup"><span data-stu-id="51dd6-110">The plan is considered complete after it has been fully tested.</span></span> <span data-ttu-id="51dd6-111">Включать сотрудников, процессов и приложений, необходимых для восстановления функциональности в соглашение уровня обслуживания (SLA), вы определили для своих клиентов.</span><span class="sxs-lookup"><span data-stu-id="51dd6-111">Include the people, processes, and applications needed to restore functionality within the service-level agreement (SLA) you've defined for your customers.</span></span>

<span data-ttu-id="51dd6-112">Примите во внимание следующие рекомендации при создании и тестировании плана аварийного восстановления.</span><span class="sxs-lookup"><span data-stu-id="51dd6-112">Consider the following suggestions when creating and testing your disaster recovery plan:</span></span>

- <span data-ttu-id="51dd6-113">В плане включите процесс обращения в службу поддержки и эскалацию проблем.</span><span class="sxs-lookup"><span data-stu-id="51dd6-113">In your plan, include the process for contacting support and for escalating issues.</span></span> <span data-ttu-id="51dd6-114">Эта информация поможет избежать длительного простоя во время работы процесса восстановления в первый раз.</span><span class="sxs-lookup"><span data-stu-id="51dd6-114">This information will help to avoid prolonged downtime as you work out the recovery process for the first time.</span></span>
- <span data-ttu-id="51dd6-115">Оцените влияние сбоев приложения на бизнес.</span><span class="sxs-lookup"><span data-stu-id="51dd6-115">Evaluate the business impact of application failures.</span></span>
- <span data-ttu-id="51dd6-116">Выберите архитектуру между регионами восстановления для критически важных приложений.</span><span class="sxs-lookup"><span data-stu-id="51dd6-116">Choose a cross-region recovery architecture for mission-critical applications.</span></span>
- <span data-ttu-id="51dd6-117">Назначьте ответственного за реализацию плана аварийного восстановления, включая его автоматизацию и тестирование.</span><span class="sxs-lookup"><span data-stu-id="51dd6-117">Identify a specific owner of the disaster recovery plan, including automation and testing.</span></span>
- <span data-ttu-id="51dd6-118">Документирование процесса, особенно какие-то действия.</span><span class="sxs-lookup"><span data-stu-id="51dd6-118">Document the process, especially any manual steps.</span></span>
- <span data-ttu-id="51dd6-119">Автоматизируйте процесс настолько, насколько возможно.</span><span class="sxs-lookup"><span data-stu-id="51dd6-119">Automate the process as much as possible.</span></span>
- <span data-ttu-id="51dd6-120">Стратегии резервного копирования для всех ссылочных и транзакционных данных и восстановления резервных копий теста регулярно.</span><span class="sxs-lookup"><span data-stu-id="51dd6-120">Establish a backup strategy for all reference and transactional data, and test backup restoration regularly.</span></span>
- <span data-ttu-id="51dd6-121">Настройка оповещений для стека службы Azure, используемые вашим приложением.</span><span class="sxs-lookup"><span data-stu-id="51dd6-121">Set up alerts for the stack of the Azure services consumed by your application.</span></span>
- <span data-ttu-id="51dd6-122">Обучите линейных сотрудников для выполнения плана.</span><span class="sxs-lookup"><span data-stu-id="51dd6-122">Train operations staff to execute the plan.</span></span>
- <span data-ttu-id="51dd6-123">Моделирование аварийного регулярные проверить и улучшить план.</span><span class="sxs-lookup"><span data-stu-id="51dd6-123">Perform regular disaster simulations to validate and improve the plan.</span></span>

<span data-ttu-id="51dd6-124">Если вы используете [Azure Site Recovery](/azure/site-recovery/) для репликации виртуальных машин (ВМ), создать план полностью автоматического восстановления для отработки отказа всего приложения.</span><span class="sxs-lookup"><span data-stu-id="51dd6-124">If you're using [Azure Site Recovery](/azure/site-recovery/) to replicate virtual machines (VMs), create a fully automated recovery plan to fail over the entire application.</span></span>

## <a name="manual-responses"></a><span data-ttu-id="51dd6-125">Вручную ответов</span><span class="sxs-lookup"><span data-stu-id="51dd6-125">Manual responses</span></span>

<span data-ttu-id="51dd6-126">Несмотря на то, что идеально подходит автоматизации, некоторые стратегии для аварийного восстановления требуется вручную ответов.</span><span class="sxs-lookup"><span data-stu-id="51dd6-126">Although automation is ideal, some strategies for disaster recovery require manual responses.</span></span>

### <a name="alerts"></a><span data-ttu-id="51dd6-127">Оповещения</span><span class="sxs-lookup"><span data-stu-id="51dd6-127">Alerts</span></span>

<span data-ttu-id="51dd6-128">Отслеживайте приложение на предмет предупреждающих знаков, которые могут потребовать активного вмешательства.</span><span class="sxs-lookup"><span data-stu-id="51dd6-128">Monitor your application for warning signs that may require proactive intervention.</span></span> <span data-ttu-id="51dd6-129">Например если база данных SQL Azure или Azure Cosmos DB постоянно регулирует ваше приложение, может потребоваться увеличить емкость базы данных или оптимизировать запросы.</span><span class="sxs-lookup"><span data-stu-id="51dd6-129">For example, if Azure SQL Database or Azure Cosmos DB consistently throttles your application, you might need to increase your database capacity or optimize your queries.</span></span> <span data-ttu-id="51dd6-130">Несмотря на то, что приложение может обрабатывать ошибки регулирования прозрачно, данные телеметрии по-прежнему должны вызывать оповещение, чтобы вы могли предпринять ответные.</span><span class="sxs-lookup"><span data-stu-id="51dd6-130">Even though the application might handle the throttling errors transparently, your telemetry should still raise an alert so that you can follow up.</span></span>

<span data-ttu-id="51dd6-131">Ограничения службы и пороговые значения квот рекомендуется настроить оповещения на ресурсы Azure метрики и журналы диагностики.</span><span class="sxs-lookup"><span data-stu-id="51dd6-131">For service limits and quota thresholds, we recommend configuring alerts on Azure resources metrics and diagnostics logs.</span></span> <span data-ttu-id="51dd6-132">По возможности настройте оповещения для метрик, которые являются более низкую задержку, чем журналы диагностики.</span><span class="sxs-lookup"><span data-stu-id="51dd6-132">When possible, set up alerts on metrics, which are lower latency than diagnostics logs.</span></span>

<span data-ttu-id="51dd6-133">Через [работоспособности ресурсов](/azure/service-health/resource-health-checks-resource-types), Azure предоставляет некоторые встроенные работоспособности проверки состояния, которые могут помочь при диагностике проблем регулирования службы Azure.</span><span class="sxs-lookup"><span data-stu-id="51dd6-133">Through [Resource Health](/azure/service-health/resource-health-checks-resource-types), Azure provides some built-in health status checks that can help you diagnose Azure service throttling issues.</span></span>

### <a name="failover"></a><span data-ttu-id="51dd6-134">Отработка отказа</span><span class="sxs-lookup"><span data-stu-id="51dd6-134">Failover</span></span>

<span data-ttu-id="51dd6-135">Настройте стратегии аварийного восстановления для каждого приложения Azure и службами Azure.</span><span class="sxs-lookup"><span data-stu-id="51dd6-135">Configure a disaster recovery strategy for each Azure application and its Azure services.</span></span> <span data-ttu-id="51dd6-136">Рекомендации по развертыванию приемлемым для поддержки аварийного восстановления зависят от соглашения об уровне обслуживания, необходимые для всех компонентов каждого приложения.</span><span class="sxs-lookup"><span data-stu-id="51dd6-136">Acceptable deployment strategies to support disaster recovery may vary based on the SLAs required for all components of each application.</span></span>  

<span data-ttu-id="51dd6-137">Azure предоставляет различные возможности в пределах многих служб Azure, чтобы разрешить на другой ресурс вручную, таких как [geo реплики кэша radis](/azure/azure-cache-for-redis/cache-how-to-geo-replication), или для автоматической отработки отказа, такие как [группы автоматической отработки отказа SQL](/azure/sql-database/sql-database-auto-failover-group).</span><span class="sxs-lookup"><span data-stu-id="51dd6-137">Azure provides different features within many Azure services to allow for manual failover, such as [redis cache geo-replicas](/azure/azure-cache-for-redis/cache-how-to-geo-replication), or for automated failover, such as [SQL auto-failover groups](/azure/sql-database/sql-database-auto-failover-group).</span></span> <span data-ttu-id="51dd6-138">Например: </span><span class="sxs-lookup"><span data-stu-id="51dd6-138">For example:</span></span>

- <span data-ttu-id="51dd6-139">Для приложения, главным образом используются виртуальные машины можно использовать Azure Site Recovery для уровней web и логики.</span><span class="sxs-lookup"><span data-stu-id="51dd6-139">For an application that mainly uses virtual machines, you can use Azure Site Recovery for the web and logic tiers.</span></span> <span data-ttu-id="51dd6-140">Дополнительные сведения см. в разделе [архитектуры в Azure аварийного восстановления](/azure/site-recovery/azure-to-azure-architecture).</span><span class="sxs-lookup"><span data-stu-id="51dd6-140">For more information, see [Azure to Azure disaster recovery architecture](/azure/site-recovery/azure-to-azure-architecture).</span></span> <span data-ttu-id="51dd6-141">Для SQL Server на виртуальных машинах, использовать [группы обеспечения доступности SQL Server Always On](/azure/virtual-machines/windows/sql/virtual-machines-windows-portal-sql-availability-group-dr).</span><span class="sxs-lookup"><span data-stu-id="51dd6-141">For SQL Server on VMs, use [SQL Server Always On availability groups](/azure/virtual-machines/windows/sql/virtual-machines-windows-portal-sql-availability-group-dr).</span></span>
- <span data-ttu-id="51dd6-142">Для приложения, использующего службы приложений и базы данных SQL Azure можно использовать план службы приложений меньшего размера уровня, настроенный в дополнительном регионе, который автоматически масштабируется при отработке отказа.</span><span class="sxs-lookup"><span data-stu-id="51dd6-142">For an application that uses App Service and Azure SQL Database, you can use a smaller tier App Service plan configured in the secondary region, which autoscales when a failover occurs.</span></span> <span data-ttu-id="51dd6-143">Используйте группы отработки отказа на уровне базы данных.</span><span class="sxs-lookup"><span data-stu-id="51dd6-143">Use failover groups for the database tier.</span></span>

<span data-ttu-id="51dd6-144">В любом случае [диспетчера трафика Azure](/azure/traffic-manager/traffic-manager-overview) профиль предоставляет для автоматической отработки отказа между регионами.</span><span class="sxs-lookup"><span data-stu-id="51dd6-144">In either scenario, an [Azure Traffic Manager](/azure/traffic-manager/traffic-manager-overview) profile provides for the automated failover across regions.</span></span> <span data-ttu-id="51dd6-145">[Подсистемы балансировки нагрузки](/azure/load-balancer/load-balancer-overview) или [шлюзы приложений](/azure/application-gateway/overview) следует настроить в дополнительном регионе для обеспечения доступности быстрее при отработке отказа.</span><span class="sxs-lookup"><span data-stu-id="51dd6-145">[Load balancers](/azure/load-balancer/load-balancer-overview) or [application gateways](/azure/application-gateway/overview) should be set up in the secondary region to support faster availability upon failover.</span></span>

### <a name="operational-readiness-testing"></a><span data-ttu-id="51dd6-146">Тестирование готовности к эксплуатации</span><span class="sxs-lookup"><span data-stu-id="51dd6-146">Operational readiness testing</span></span>

<span data-ttu-id="51dd6-147">Выполните тест готовности к отработке отказа в дополнительный регион, а также для восстановления размещения в основном регионе.</span><span class="sxs-lookup"><span data-stu-id="51dd6-147">Perform an operational readiness test for failover to the secondary region and for failback to the primary region.</span></span> <span data-ttu-id="51dd6-148">Многие службы Azure поддерживают отработку отказа вручную или тестовую отработку отказа для аварийного восстановления.</span><span class="sxs-lookup"><span data-stu-id="51dd6-148">Many Azure services support manual failover or test failover for disaster recovery drills.</span></span> <span data-ttu-id="51dd6-149">Кроме того можно имитировать сбой, завершение работы или удалив служб Azure.</span><span class="sxs-lookup"><span data-stu-id="51dd6-149">Alternatively, you can simulate an outage by shutting down or removing Azure services.</span></span>

## <a name="application-failure"></a><span data-ttu-id="51dd6-150">Сбой приложения</span><span class="sxs-lookup"><span data-stu-id="51dd6-150">Application failure</span></span>

<span data-ttu-id="51dd6-151">Сбои приложений являются восстанавливаемых или неустранимая.</span><span class="sxs-lookup"><span data-stu-id="51dd6-151">Application failures are either recoverable or nonrecoverable.</span></span> <span data-ttu-id="51dd6-152">Этого можно избежать устранимая ошибка, но Неустранимая ошибки приводят к сбою приложения.</span><span class="sxs-lookup"><span data-stu-id="51dd6-152">You can mitigate a recoverable error, but nonrecoverable errors will bring down the application.</span></span>

- <span data-ttu-id="51dd6-153">Некоторые сбои могут направляться прозрачно автоматически обработка ошибок и применения альтернативных мер.</span><span class="sxs-lookup"><span data-stu-id="51dd6-153">Some failures can be addressed transparently by handling faults automatically and taking alternate actions.</span></span> <span data-ttu-id="51dd6-154">Например диспетчер трафика автоматически обрабатывает сбои, возникающие в результате базовом программном обеспечении оборудования или операционной системы на виртуальной машине узла.</span><span class="sxs-lookup"><span data-stu-id="51dd6-154">For example, Traffic Manager automatically handles failures that result from the underlying hardware or operating system software in the host virtual machine.</span></span>
- <span data-ttu-id="51dd6-155">С ошибками приложение может продолжить обработку запросов в режиме ограниченной функциональности.</span><span class="sxs-lookup"><span data-stu-id="51dd6-155">With some errors, the application can continue handling user requests with reduced functionality.</span></span>
- <span data-ttu-id="51dd6-156">Более серьезные сбои в работе служб могут визуализации приложения недоступен.</span><span class="sxs-lookup"><span data-stu-id="51dd6-156">More severe service disruptions might render the application unavailable.</span></span>

<span data-ttu-id="51dd6-157">Хорошо спроектированная система разделяет задачи на уровне службы &mdash; во время разработки и во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="51dd6-157">A well-designed system separates responsibilities at the service level &mdash; at design time and at runtime.</span></span> <span data-ttu-id="51dd6-158">Такое разделение предотвращает нарушения работы службы, зависимые от работы всего приложения.</span><span class="sxs-lookup"><span data-stu-id="51dd6-158">This separation prevents a dependent service disruption from bringing down the entire application.</span></span> <span data-ttu-id="51dd6-159">Например рассмотрим веб-приложения электронной коммерции с помощью следующих модулей:</span><span class="sxs-lookup"><span data-stu-id="51dd6-159">For example, consider a web commerce application with the following modules:</span></span>

![ДОБАВЛЕНИЕ ССЫЛКИ НА ИСКУССТВО](./_images/disaster-recovery.png)

<span data-ttu-id="51dd6-161">Если в базе данных для размещения заказов выходит из строя, служба обработки заказов не может обработать о проводках по продажам.</span><span class="sxs-lookup"><span data-stu-id="51dd6-161">If the database for hosting orders goes down, the Order Processing service can't process sales transactions.</span></span> <span data-ttu-id="51dd6-162">В зависимости от архитектуры может оказаться невозможным для служб приема и обработки заказов продолжить.</span><span class="sxs-lookup"><span data-stu-id="51dd6-162">Depending on the architecture, it might be impossible for the Order Submission and Order Processing services to continue.</span></span> <span data-ttu-id="51dd6-163">Тем не менее если продуктов данные хранятся в другом месте, каталога продуктов доступен, несмотря на то, что другие части приложения могут быть недоступны.</span><span class="sxs-lookup"><span data-stu-id="51dd6-163">However, if product data is stored in a different location, the Product Catalog is still available, even though other parts of the application might be unavailable.</span></span>

<span data-ttu-id="51dd6-164">Именно вы сможете легко определить, как приложение будет информировать пользователей о временных проблемах и соответствующие уведомления в систему сборки.</span><span class="sxs-lookup"><span data-stu-id="51dd6-164">It's up to you to determine how the application will inform users of any temporary problems and to build appropriate notifications into the system.</span></span> <span data-ttu-id="51dd6-165">В предыдущем примере приложение может разрешить для просмотра продуктов, а также для добавления их в корзину для покупок.</span><span class="sxs-lookup"><span data-stu-id="51dd6-165">In the previous example, the application might allow for viewing products and for adding them to a shopping cart.</span></span> <span data-ttu-id="51dd6-166">Тем не менее когда клиент пытается совершить покупку, приложение должно уведомить их обработка заказов временно недоступна.</span><span class="sxs-lookup"><span data-stu-id="51dd6-166">However, when the customer attempts to make a purchase, the application should notify them that the ordering functionality is temporarily unavailable.</span></span> <span data-ttu-id="51dd6-167">Хотя это не идеальное решение для клиента, этот подход позволяет избежать перебоев в работе служб на уровне приложения.</span><span class="sxs-lookup"><span data-stu-id="51dd6-167">Although not ideal for the customer, this approach prevents an application-wide service disruption.</span></span>

## <a name="data-corruption-and-restoration"></a><span data-ttu-id="51dd6-168">Повреждение данных и восстановления</span><span class="sxs-lookup"><span data-stu-id="51dd6-168">Data corruption and restoration</span></span>

<span data-ttu-id="51dd6-169">В случае сбоя в хранилище данных может существовать несогласованности данных, когда она снова станет доступным, особенно в том случае, если они были реплицированы.</span><span class="sxs-lookup"><span data-stu-id="51dd6-169">If a data store fails, there might be data inconsistencies when it becomes available again, especially if the data was replicated.</span></span> <span data-ttu-id="51dd6-170">Основные сведения о времени восстановления (RTO) и точки восстановления (RPO) цель хранилищ данных, реплицированной может помочь можно прогнозировать объем потери данных.</span><span class="sxs-lookup"><span data-stu-id="51dd6-170">Understanding the recovery time objective (RTO) and recovery point objective (RPO) of replicated data stores can help you predict the amount of data loss.</span></span>

<span data-ttu-id="51dd6-171">Чтобы понять, запущена ли отработка отказа между регионами вручную или корпорацией Майкрософт, просмотрите соглашений об уровне обслуживания Azure.</span><span class="sxs-lookup"><span data-stu-id="51dd6-171">To understand whether the cross-regional failover is started manually or by Microsoft, review the Azure service SLAs.</span></span> <span data-ttu-id="51dd6-172">Для служб с нет соглашения об уровне обслуживания для отработки отказа между регионами Корпорация Майкрософт обычно решает, когда для отработки отказа и обычно устанавливает приоритеты для восстановления данных в основном регионе.</span><span class="sxs-lookup"><span data-stu-id="51dd6-172">For services with no SLAs for cross-regional failover, Microsoft typically decides when to fail over and usually prioritizes recovery of data in the primary region.</span></span> <span data-ttu-id="51dd6-173">Если данные в основном регионе считается неустранимой, Майкрософт выполняет отработку отказа в дополнительный регион.</span><span class="sxs-lookup"><span data-stu-id="51dd6-173">If data in the primary region is deemed unrecoverable, Microsoft fails over to the secondary region.</span></span>

### <a name="restoring-data-from-backups"></a><span data-ttu-id="51dd6-174">Восстановление данных из резервных копий</span><span class="sxs-lookup"><span data-stu-id="51dd6-174">Restoring data from backups</span></span>

<span data-ttu-id="51dd6-175">Резервные копии защиты от потери в состав приложения из-за случайного удаления или повреждения данных.</span><span class="sxs-lookup"><span data-stu-id="51dd6-175">Backups protect you from losing a component of the application because of accidental deletion or data corruption.</span></span> <span data-ttu-id="51dd6-176">Они сохраняют более функциональной версии компонента из более раннее время, которое служит для его восстановления.</span><span class="sxs-lookup"><span data-stu-id="51dd6-176">They preserve a functional version of the component from an earlier time, which you can use to restore it.</span></span>

<span data-ttu-id="51dd6-177">Стратегии аварийного восстановления не являются заменой для резервных копий, но регулярно создавайте резервные копии данных приложения поддерживает некоторые сценарии аварийного восстановления.</span><span class="sxs-lookup"><span data-stu-id="51dd6-177">Disaster recovery strategies are not a replacement for backups, but regular backups of application data support some disaster recovery scenarios.</span></span> <span data-ttu-id="51dd6-178">Выбор хранилища резервных копий должно быть основано на своей стратегии аварийного восстановления.</span><span class="sxs-lookup"><span data-stu-id="51dd6-178">Your backup storage choices should be based on your disaster recovery strategy.</span></span>

<span data-ttu-id="51dd6-179">Частота архивации зависит RPO.</span><span class="sxs-lookup"><span data-stu-id="51dd6-179">The frequency of running the backup process determines your RPO.</span></span> <span data-ttu-id="51dd6-180">Например если вы ежечасно выполняете резервное копирование, а сбой происходит за две минуты до резервного копирования, вы потеряете данные за 58 минут.</span><span class="sxs-lookup"><span data-stu-id="51dd6-180">For example, if you perform hourly backups and a disaster occurs two minutes before the backup, you will lose 58 minutes of data.</span></span> <span data-ttu-id="51dd6-181">План аварийного восстановления должен включать как вы будете решать потерянные данные.</span><span class="sxs-lookup"><span data-stu-id="51dd6-181">Your disaster recovery plan should include how you will address lost data.</span></span>

<span data-ttu-id="51dd6-182">Довольно часто для данных в одном хранилище данных для ссылочных данных в другое хранилище.</span><span class="sxs-lookup"><span data-stu-id="51dd6-182">It's common for data in one data store to reference data in another store.</span></span> <span data-ttu-id="51dd6-183">Например рассмотрим базу данных SQL со столбцом, ссылающийся на большой двоичный объект в службе хранилища Azure.</span><span class="sxs-lookup"><span data-stu-id="51dd6-183">For example, consider a SQL Database with a column that links to a blob in Azure Storage.</span></span> <span data-ttu-id="51dd6-184">Если резервное копирование не осуществляется одновременно, база данных может содержать указатель на большой двоичный объект, не были архивированы до сбоя.</span><span class="sxs-lookup"><span data-stu-id="51dd6-184">If backups don't happen simultaneously, the database might have a pointer to a blob that wasn't backed up before the failure.</span></span> <span data-ttu-id="51dd6-185">Приложение или план аварийного восстановления должны реализовать процессы для обработки этой несогласованности после восстановления.</span><span class="sxs-lookup"><span data-stu-id="51dd6-185">The application or the disaster recovery plan must implement processes to handle this inconsistency after a recovery.</span></span>

> [!NOTE]
> <span data-ttu-id="51dd6-186">В некоторых сценариях, например, виртуальных машин, резервное копирование с использованием [резервного копирования Azure](/azure/backup/backup-azure-vms-first-look-arm), можно восстановить только из резервной копии в одном регионе.</span><span class="sxs-lookup"><span data-stu-id="51dd6-186">In some scenarios, such as that of VMs backed up using [Azure Backup](/azure/backup/backup-azure-vms-first-look-arm), you can restore only from a backup in the same region.</span></span> <span data-ttu-id="51dd6-187">Службы Azure, такие как [Azure кэша для Redis](/azure/azure-cache-for-redis/cache-how-to-geo-replication), предоставляют геореплицированных резервных копий, в которые можно использовать для восстановления службы в регионах.</span><span class="sxs-lookup"><span data-stu-id="51dd6-187">Other Azure services, such as [Azure Cache for Redis](/azure/azure-cache-for-redis/cache-how-to-geo-replication), provide geo-replicated backups, which you can use to restore services across regions.</span></span>

### <a name="azure-storage-and-azure-sql-database"></a><span data-ttu-id="51dd6-188">База данных SQL хранилища Azure и Azure</span><span class="sxs-lookup"><span data-stu-id="51dd6-188">Azure Storage and Azure SQL Database</span></span>

<span data-ttu-id="51dd6-189">Azure автоматически сохраняет данные хранилища Azure и базы данных SQL три раза в различных доменах сбоя в одном регионе.</span><span class="sxs-lookup"><span data-stu-id="51dd6-189">Azure automatically stores Azure Storage and SQL Database data three times within different fault domains in the same region.</span></span> <span data-ttu-id="51dd6-190">При использовании георепликации создаются еще три экземпляра данных в другом регионе.</span><span class="sxs-lookup"><span data-stu-id="51dd6-190">If you use geo-replication, the data is stored three additional times in a different region.</span></span> <span data-ttu-id="51dd6-191">Тем не менее если данные повреждена или удалена в первичной копии (например, из-за ошибки пользователя), в другие копии репликацию изменений.</span><span class="sxs-lookup"><span data-stu-id="51dd6-191">However, if the data is corrupted or deleted in the primary copy (for example, because of user error), the changes replicate to the other copies.</span></span>

<span data-ttu-id="51dd6-192">У вас есть два варианта управления возможным повреждением данных или удаления:</span><span class="sxs-lookup"><span data-stu-id="51dd6-192">You have two options for managing potential data corruption or deletion:</span></span>

- <span data-ttu-id="51dd6-193">**Создайте пользовательскую стратегию архивации.**</span><span class="sxs-lookup"><span data-stu-id="51dd6-193">**Create a custom backup strategy.**</span></span> <span data-ttu-id="51dd6-194">Можно хранить резервные копии в Azure или локально, в зависимости от бизнес-требований и нормативных.</span><span class="sxs-lookup"><span data-stu-id="51dd6-194">You can store your backups in Azure or on-premises, depending on your business requirements and governance regulations.</span></span>
- <span data-ttu-id="51dd6-195">**Использовать параметр восстановления на определенный момент** восстановление базы данных SQL.</span><span class="sxs-lookup"><span data-stu-id="51dd6-195">**Use the point-in-time restore option** to recover a SQL Database.</span></span>

#### <a name="azure-storage-recovery"></a><span data-ttu-id="51dd6-196">Восстановление хранилища Azure</span><span class="sxs-lookup"><span data-stu-id="51dd6-196">Azure Storage recovery</span></span>

<span data-ttu-id="51dd6-197">Можно разработать пользовательский процесс резервного копирования для службы хранилища Azure или использовать один из множества средств архивации сторонних.</span><span class="sxs-lookup"><span data-stu-id="51dd6-197">You can develop a custom backup process for Azure Storage or use one of many third-party backup tools.</span></span>

<span data-ttu-id="51dd6-198">Служба хранилища Azure обеспечивает устойчивость данных благодаря автоматическим репликам, но он не предотвращает коду приложения и пользователям повредить данные.</span><span class="sxs-lookup"><span data-stu-id="51dd6-198">Azure Storage provides data resiliency through automated replicas, but it doesn't prevent application code or users from corrupting data.</span></span> <span data-ttu-id="51dd6-199">Обслуживание точность данных после ошибки приложения или пользователя требуются более сложные приемы, например копирование данных в расположении дополнительного хранилища и ведение журнала аудита.</span><span class="sxs-lookup"><span data-stu-id="51dd6-199">Maintaining data fidelity after application or user error requires more advanced techniques, such as copying the data to a secondary storage location with an audit log.</span></span> <span data-ttu-id="51dd6-200">Доступно несколько параметров.</span><span class="sxs-lookup"><span data-stu-id="51dd6-200">You have several options:</span></span>

- [<span data-ttu-id="51dd6-201">**Блочные BLOB-объекты.**</span><span class="sxs-lookup"><span data-stu-id="51dd6-201">**Block blobs.**</span></span>](/rest/api/storageservices/understanding-block-blobs--append-blobs--and-page-blobs) <span data-ttu-id="51dd6-202">Создайте моментальный снимок на определенный момент каждого блочного BLOB-объекта.</span><span class="sxs-lookup"><span data-stu-id="51dd6-202">Create a point-in-time snapshot of each block blob.</span></span> <span data-ttu-id="51dd6-203">Для каждого моментального снимка плата только за хранилище, необходимое для хранения различий в большой двоичный объект с момента предыдущего состояния моментального снимка.</span><span class="sxs-lookup"><span data-stu-id="51dd6-203">For each snapshot, you are charged only for the storage required to store the differences within the blob since the previous snapshot state.</span></span> <span data-ttu-id="51dd6-204">Моментальные снимки зависят исходного большого двоичного объекта, поэтому мы рекомендуем копировать на другой большой двоичный объект или даже на другую учетную запись хранения.</span><span class="sxs-lookup"><span data-stu-id="51dd6-204">The snapshots are dependent on the original blob, so we recommend copying to another blob or even to another storage account.</span></span> <span data-ttu-id="51dd6-205">Такой подход обеспечивает защиту данных резервных копий от случайного удаления.</span><span class="sxs-lookup"><span data-stu-id="51dd6-205">This approach ensures that backup data is protected against accidental deletion.</span></span> <span data-ttu-id="51dd6-206">Используйте [AzCopy](/azure/storage/common/storage-use-azcopy) или [Azure PowerShell](/azure/storage/common/storage-powershell-guide-full) для копирования больших двоичных объектов в другую учетную запись хранения.</span><span class="sxs-lookup"><span data-stu-id="51dd6-206">Use [AzCopy](/azure/storage/common/storage-use-azcopy) or [Azure PowerShell](/azure/storage/common/storage-powershell-guide-full) to copy the blobs to another storage account.</span></span>

    <span data-ttu-id="51dd6-207">Дополнительные сведения см. в статье [Создание моментального снимка большого двоичного объекта](/rest/api/storageservices/creating-a-snapshot-of-a-blob).</span><span class="sxs-lookup"><span data-stu-id="51dd6-207">For more information, see [Creating a Snapshot of a Blob](/rest/api/storageservices/creating-a-snapshot-of-a-blob).</span></span>

- [<span data-ttu-id="51dd6-208">**Служба файлов Azure.**</span><span class="sxs-lookup"><span data-stu-id="51dd6-208">**Azure Files.**</span></span>](/azure/storage/files/storage-files-introduction) <span data-ttu-id="51dd6-209">Используйте [моментальные снимки общих ресурсов](/azure/storage/files/storage-snapshots-files), AzCopy или PowerShell для копирования файлов в другую учетную запись хранения.</span><span class="sxs-lookup"><span data-stu-id="51dd6-209">Use [share snapshots](/azure/storage/files/storage-snapshots-files), AzCopy, or PowerShell to copy your files to another storage account.</span></span>
- [<span data-ttu-id="51dd6-210">**Хранилище таблиц Azure.**</span><span class="sxs-lookup"><span data-stu-id="51dd6-210">**Azure Table storage.**</span></span>](/azure/storage/tables/table-storage-overview) <span data-ttu-id="51dd6-211">Используйте AzCopy для экспорта данных таблиц в другую учетную запись хранения, относящуюся к другому региону.</span><span class="sxs-lookup"><span data-stu-id="51dd6-211">Use AzCopy to export the table data into another storage account in another region.</span></span>

#### <a name="sql-database-recovery"></a><span data-ttu-id="51dd6-212">Восстановление базы данных SQL</span><span class="sxs-lookup"><span data-stu-id="51dd6-212">SQL Database recovery</span></span>

<span data-ttu-id="51dd6-213">Для защиты вашей компании от потери данных, базы данных SQL автоматически создает полные резервные копии каждую неделю, разностные резервные копии каждый час и журнала транзакций резервное копирование каждые 5 до 10 минут.</span><span class="sxs-lookup"><span data-stu-id="51dd6-213">To protect your business from data loss, SQL Database automatically performs a combination of full database backups weekly, differential database backups hourly, and transaction log backups every 5 to 10 minutes.</span></span> <span data-ttu-id="51dd6-214">Для уровней Basic, Standard и Premium базы данных SQL используйте в определенный момент времени восстановления для восстановления базы данных в более раннее время.</span><span class="sxs-lookup"><span data-stu-id="51dd6-214">For the Basic, Standard, and Premium SQL Database tiers, use point-in-time restore to restore a database to an earlier time.</span></span> <span data-ttu-id="51dd6-215">Дополнительные сведения см. в этих статьях:</span><span class="sxs-lookup"><span data-stu-id="51dd6-215">See the following articles for more information:</span></span>

- [<span data-ttu-id="51dd6-216">Восстановление базы данных Azure SQL с помощью создаваемых автоматически резервных копий</span><span class="sxs-lookup"><span data-stu-id="51dd6-216">Recover an Azure SQL database using automated database backups</span></span>](/azure/sql-database/sql-database-recovery-using-backups)
- [<span data-ttu-id="51dd6-217">Обзор обеспечения непрерывности бизнес-процессов с помощью базы данных SQL Azure</span><span class="sxs-lookup"><span data-stu-id="51dd6-217">Overview of business continuity with Azure SQL Database</span></span>](/azure/sql-database/sql-database-business-continuity)

<span data-ttu-id="51dd6-218">Другой вариант — использовать активную георепликацию для базы данных SQL, которая автоматически реплицирует изменения базы данных для базы данных-получатели в том же или другом регионе Azure.</span><span class="sxs-lookup"><span data-stu-id="51dd6-218">Another option is to use active geo-replication for SQL Database, which automatically replicates database changes to secondary databases in the same or different Azure region.</span></span> <span data-ttu-id="51dd6-219">Дополнительные сведения см. в разделе [Создание и использование активной георепликации](/azure/sql-database/sql-database-active-geo-replication).</span><span class="sxs-lookup"><span data-stu-id="51dd6-219">For more information, see [Creating and using active geo-replication](/azure/sql-database/sql-database-active-geo-replication).</span></span>

<span data-ttu-id="51dd6-220">Можно также использовать более ручной метод для резервного копирования и восстановления:</span><span class="sxs-lookup"><span data-stu-id="51dd6-220">You can also use a more manual approach for backup and restore:</span></span>

- <span data-ttu-id="51dd6-221">Используйте **КОПИЮ базы данных** команду, чтобы создать резервную копию базы данных с соблюдением транзакционной согласованности.</span><span class="sxs-lookup"><span data-stu-id="51dd6-221">Use the **DATABASE COPY** command to create a backup copy of the database with transactional consistency.</span></span>
- <span data-ttu-id="51dd6-222">Используйте Azure SQL Database импорта и экспорта Service, которая поддерживает экспорт базы данных в файлы BACPAC (сжатые файлы, содержащие схему базы данных и связанные данные), которые хранятся в хранилище BLOB-объектов Azure.</span><span class="sxs-lookup"><span data-stu-id="51dd6-222">Use the Azure SQL Database Import/Export Service, which supports exporting databases to BACPAC files (compressed files containing your database schema and associated data) that are stored in Azure Blob storage.</span></span> <span data-ttu-id="51dd6-223">Чтобы избежать нарушения работы службы на уровне региона, скопируйте файлы BACPAC в альтернативный регион.</span><span class="sxs-lookup"><span data-stu-id="51dd6-223">To protect against a region-wide service disruption, copy the BACPAC files to an alternate region.</span></span>

### <a name="sql-server-on-vms"></a><span data-ttu-id="51dd6-224">SQL Server на виртуальных машинах</span><span class="sxs-lookup"><span data-stu-id="51dd6-224">SQL Server on VMs</span></span>

<span data-ttu-id="51dd6-225">Для SQL Server на виртуальных машинах, у вас есть два варианта: традиционные резервные копии и доставка журналов.</span><span class="sxs-lookup"><span data-stu-id="51dd6-225">For SQL Server running on VMs, you have two options: traditional backups and log shipping.</span></span>

- <span data-ttu-id="51dd6-226">С помощью традиционных резервных копий можно восстановить до определенной точки во времени, но процесс восстановления выполняется медленно.</span><span class="sxs-lookup"><span data-stu-id="51dd6-226">With traditional backups, you can restore to a specific point in time, but the recovery process is slow.</span></span> <span data-ttu-id="51dd6-227">Восстановление традиционных резервных копий необходимо начать с первоначальной полной резервной копии и затем применить все добавочные резервные копии.</span><span class="sxs-lookup"><span data-stu-id="51dd6-227">Restoring traditional backups requires that you start with an initial full backup and then apply any incremental backups.</span></span>
- <span data-ttu-id="51dd6-228">Вы можете настроить сеанса доставки журналов для задержки восстановления резервных копий журналов.</span><span class="sxs-lookup"><span data-stu-id="51dd6-228">You can configure a log shipping session to delay the restore of log backups.</span></span> <span data-ttu-id="51dd6-229">Это предоставляет окно для восстановления после ошибок в первичной реплике.</span><span class="sxs-lookup"><span data-stu-id="51dd6-229">This provides a window to recover from errors made on the primary replica.</span></span>

### <a name="azure-database-for-mysql-and-azure-database-for-postgresql"></a><span data-ttu-id="51dd6-230">База данных Azure для MySQL и база данных Azure для PostgreSQL</span><span class="sxs-lookup"><span data-stu-id="51dd6-230">Azure Database for MySQL and Azure Database for PostgreSQL</span></span>

<span data-ttu-id="51dd6-231">В базе данных Azure для MySQL и база данных Azure для PostgreSQL службу базы данных автоматически создает резервную копию каждые пять минут.</span><span class="sxs-lookup"><span data-stu-id="51dd6-231">In Azure Database for MySQL and Azure Database for PostgreSQL, the database service automatically makes a backup every five minutes.</span></span> <span data-ttu-id="51dd6-232">Эти автоматические резервные копии можно использовать для восстановления сервера и его базы данных на более ранний момент времени на новом сервере.</span><span class="sxs-lookup"><span data-stu-id="51dd6-232">You can use these automated backups to restore the server and its databases from an earlier point in time to a new server.</span></span> <span data-ttu-id="51dd6-233">Дополнительные сведения можно найти в разделе </span><span class="sxs-lookup"><span data-stu-id="51dd6-233">For more information, see:</span></span>

- [<span data-ttu-id="51dd6-234">Как выполнить резервное копирование и восстановление сервера в базе данных Azure для MySQL с помощью портала Azure</span><span class="sxs-lookup"><span data-stu-id="51dd6-234">How to back up and restore a server in Azure Database for MySQL by using the Azure portal</span></span>](/azure/mysql/howto-restore-server-portal)
- [<span data-ttu-id="51dd6-235">Резервное копирование и восстановление сервера в базе данных Azure для PostgreSQL с помощью портала Azure</span><span class="sxs-lookup"><span data-stu-id="51dd6-235">How to back up and restore a server in Azure Database for PostgreSQL using the Azure portal</span></span>](/azure/postgresql/howto-restore-server-portal)

### <a name="azure-cosmos-db"></a><span data-ttu-id="51dd6-236">Azure Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="51dd6-236">Azure Cosmos DB</span></span>

<span data-ttu-id="51dd6-237">Cosmos DB автоматически создает резервную копию с регулярными интервалами.</span><span class="sxs-lookup"><span data-stu-id="51dd6-237">Cosmos DB automatically makes a backup at regular intervals.</span></span> <span data-ttu-id="51dd6-238">Резервные копии хранятся отдельно в другой службе хранилища и глобально реплицируются для защиты от региональных сбоев.</span><span class="sxs-lookup"><span data-stu-id="51dd6-238">Backups are stored separately in another storage service and are replicated globally to protect against regional disasters.</span></span> <span data-ttu-id="51dd6-239">Если вы случайно удалите данные или коллекцию, можете обратиться с запросом в службу поддержки или позвонить в службу поддержки Azure, чтобы восстановить данные из последней автоматически созданной резервной копии.</span><span class="sxs-lookup"><span data-stu-id="51dd6-239">If you accidentally delete your database or collection, you can file a support ticket or call Azure support to restore the data from the last automatic backup.</span></span> <span data-ttu-id="51dd6-240">Дополнительные сведения см. в разделе [оперативная архивация и восстановление по запросу в Azure Cosmos DB](/azure/cosmos-db/online-backup-and-restore).</span><span class="sxs-lookup"><span data-stu-id="51dd6-240">For more information, see [Online backup and on-demand restore in Azure Cosmos DB](/azure/cosmos-db/online-backup-and-restore).</span></span>

### <a name="azure-virtual-machines"></a><span data-ttu-id="51dd6-241">Виртуальные машины Azure</span><span class="sxs-lookup"><span data-stu-id="51dd6-241">Azure Virtual Machines</span></span>

<span data-ttu-id="51dd6-242">Для защиты виртуальных машин Azure от ошибок приложений и случайного удаления используйте [Azure Backup](/azure/backup/).</span><span class="sxs-lookup"><span data-stu-id="51dd6-242">To protect Azure Virtual Machines from application errors or accidental deletion, use [Azure Backup](/azure/backup/).</span></span> <span data-ttu-id="51dd6-243">Созданные резервные копии являются согласованными на нескольких дисках виртуальной Машины.</span><span class="sxs-lookup"><span data-stu-id="51dd6-243">The created backups are consistent across multiple VM disks.</span></span> <span data-ttu-id="51dd6-244">Кроме того хранилище службы архивации Azure можно реплицировать между регионами для поддержки восстановления после потери региональных.</span><span class="sxs-lookup"><span data-stu-id="51dd6-244">In addition, the Azure Backup vault can be replicated across regions to support recovery from a regional loss.</span></span>

## <a name="network-outage"></a><span data-ttu-id="51dd6-245">Сбой сети</span><span class="sxs-lookup"><span data-stu-id="51dd6-245">Network outage</span></span>

<span data-ttu-id="51dd6-246">Если части сети Azure недоступны, может не появиться возможность доступа к данным или приложению.</span><span class="sxs-lookup"><span data-stu-id="51dd6-246">When parts of the Azure network are inaccessible, you might not be able to access your application or data.</span></span> <span data-ttu-id="51dd6-247">В этом случае мы рекомендуем, Разработка стратегии аварийного восстановления для выполнения большинства приложений в режиме ограниченной функциональности.</span><span class="sxs-lookup"><span data-stu-id="51dd6-247">In this situation, we recommend designing the disaster recovery strategy to run most applications with reduced functionality.</span></span>

<span data-ttu-id="51dd6-248">Если ограничения функциональности невозможно, остается только простой приложения или отработки отказа в другой регион.</span><span class="sxs-lookup"><span data-stu-id="51dd6-248">If reducing functionality isn't an option, the remaining options are application downtime or failover to an alternate region.</span></span>

<span data-ttu-id="51dd6-249">В сценарии ограниченной функциональности:</span><span class="sxs-lookup"><span data-stu-id="51dd6-249">In a reduced functionality scenario:</span></span>

- <span data-ttu-id="51dd6-250">Если приложение не может получить доступ к его данные из-за сбоя сети Azure, можно запустить локально с ограниченной функциональностью, используя кэшированные данные.</span><span class="sxs-lookup"><span data-stu-id="51dd6-250">If your application can't access its data because of an Azure network outage, you might be able to run locally with reduced application functionality by using cached data.</span></span>
- <span data-ttu-id="51dd6-251">Возможно, вы сможете хранить данные в альтернативное расположение до восстановления подключения.</span><span class="sxs-lookup"><span data-stu-id="51dd6-251">You might be able to store data in an alternate location until connectivity is restored.</span></span>

## <a name="dependent-service-failure"></a><span data-ttu-id="51dd6-252">Сбой зависимых служб</span><span class="sxs-lookup"><span data-stu-id="51dd6-252">Dependent service failure</span></span>

<span data-ttu-id="51dd6-253">Для каждой зависимой службы необходимо понимать последствия нарушения работы службы и то, что приложение будет отвечать.</span><span class="sxs-lookup"><span data-stu-id="51dd6-253">For each dependent service, you should understand the implications of a service disruption and the way that the application will respond.</span></span> <span data-ttu-id="51dd6-254">Многие службы предоставляют возможности, которые поддерживают устойчивости и доступности, поэтому оценки каждой службы независимо друг от друга вероятнее всего улучшить свой план аварийного восстановления.</span><span class="sxs-lookup"><span data-stu-id="51dd6-254">Many services include features that support resiliency and availability, so evaluating each service independently is likely to improve your disaster recovery plan.</span></span> <span data-ttu-id="51dd6-255">Например, концентраторы событий Azure поддерживают [отработка отказа](/azure/event-hubs/event-hubs-geo-dr#setup-and-failover-flow) на дополнительное пространство.</span><span class="sxs-lookup"><span data-stu-id="51dd6-255">For example, Azure Event Hubs supports [failing over](/azure/event-hubs/event-hubs-geo-dr#setup-and-failover-flow) to the secondary namespace.</span></span>

## <a name="region-wide-service-disruptions"></a><span data-ttu-id="51dd6-256">Нарушения работы служб во всем регионе</span><span class="sxs-lookup"><span data-stu-id="51dd6-256">Region-wide service disruptions</span></span>

<span data-ttu-id="51dd6-257">Многие сбои являются управляемыми в одном регионе Azure.</span><span class="sxs-lookup"><span data-stu-id="51dd6-257">Many failures are manageable within the same Azure region.</span></span> <span data-ttu-id="51dd6-258">Тем не менее в маловероятном случае сбоя службы во всем регионе, локальные избыточные копии данных недоступны.</span><span class="sxs-lookup"><span data-stu-id="51dd6-258">However, in the unlikely event of a region-wide service disruption, the locally redundant copies of your data aren't available.</span></span> <span data-ttu-id="51dd6-259">Если вы включили функцию георепликации, существует три дополнительные копии больших двоичных объектов и таблиц в другом регионе.</span><span class="sxs-lookup"><span data-stu-id="51dd6-259">If you've enabled geo-replication, there are three additional copies of your blobs and tables in a different region.</span></span> <span data-ttu-id="51dd6-260">Если Майкрософт объявляет регионом утеряна, Azure перераспределяет все записи DNS в дополнительный регион.</span><span class="sxs-lookup"><span data-stu-id="51dd6-260">If Microsoft declares the region lost, Azure remaps all the DNS entries to the secondary region.</span></span>

> [!NOTE]
> <span data-ttu-id="51dd6-261">Этот процесс происходит только для нарушения работы служб во всем регионе, но в элементе управления.</span><span class="sxs-lookup"><span data-stu-id="51dd6-261">This process occurs only for region-wide service disruptions and is not within your control.</span></span> <span data-ttu-id="51dd6-262">Рекомендуем использовать [Azure Site Recovery](/azure/site-recovery/) для улучшения показателей RPO и RTO.</span><span class="sxs-lookup"><span data-stu-id="51dd6-262">Consider using [Azure Site Recovery](/azure/site-recovery/) to achieve better RPO and RTO.</span></span> <span data-ttu-id="51dd6-263">С помощью Site Recovery, вы решили, что сбой является допустимым и в момент перехода на реплицированные виртуальные машины.</span><span class="sxs-lookup"><span data-stu-id="51dd6-263">Using Site Recovery, you decide what is an acceptable outage and when to fail over to the replicated VMs.</span></span>

<span data-ttu-id="51dd6-264">Ответ на уровне региона перерывов в обслуживании зависит от вашего развертывания и план аварийного восстановления.</span><span class="sxs-lookup"><span data-stu-id="51dd6-264">Your response to a region-wide service disruption depends on your deployment and your disaster recovery plan.</span></span>

- <span data-ttu-id="51dd6-265">Как стратегию управления затратами для некритических приложений, которые не требуют гарантированного времени восстановления может быть целесообразно выполнить повторное развертывание в другом регионе.</span><span class="sxs-lookup"><span data-stu-id="51dd6-265">As a cost-control strategy, for non-critical applications that don't require a guaranteed recovery time, it might make sense to redeploy to a different region.</span></span>
- <span data-ttu-id="51dd6-266">Для приложений, размещенных в другом регионе с помощью ролей развернутого, но не распределения трафика по регионам (*активное или пассивное развертывание*), переключитесь в вторичная размещенная служба в альтернативном регионе.</span><span class="sxs-lookup"><span data-stu-id="51dd6-266">For applications that are hosted in another region with deployed roles but don't distribute traffic across regions (*active/passive deployment*), switch to the secondary hosted service in the alternate region.</span></span>
- <span data-ttu-id="51dd6-267">Для приложений, у полномасштабной дополнительной развернутой службы в другом регионе (*активное/активное развертывание*), маршрутизация трафика в этом регионе.</span><span class="sxs-lookup"><span data-stu-id="51dd6-267">For applications that have a full-scale secondary deployment in another region (*active/active deployment*), route traffic to that region.</span></span>

<span data-ttu-id="51dd6-268">Дополнительные сведения о восстановлении после прерывания работы служб во всем регионе, см. в разделе [восстановление после прерывания работы служб во всем регионе](../resiliency/recovery-loss-azure-region.md).</span><span class="sxs-lookup"><span data-stu-id="51dd6-268">To learn more about recovering from a region-wide service disruption, see [Recover from a region-wide service disruption](../resiliency/recovery-loss-azure-region.md).</span></span>

### <a name="vm-recovery"></a><span data-ttu-id="51dd6-269">Восстановление виртуальной Машины</span><span class="sxs-lookup"><span data-stu-id="51dd6-269">VM recovery</span></span>

<span data-ttu-id="51dd6-270">Для важных приложений необходимо запланировать для восстановления виртуальных машин в случае нарушения работы службы на уровне региона.</span><span class="sxs-lookup"><span data-stu-id="51dd6-270">For critical apps, plan for recovering VMs in the event of a region-wide service disruption.</span></span>

- <span data-ttu-id="51dd6-271">Использование службы архивации Azure или другой метод резервного копирования для создания резервных копий между регионами, которые соответствуют приложению.</span><span class="sxs-lookup"><span data-stu-id="51dd6-271">Use Azure Backup or another backup method to create cross-region backups that are application consistent.</span></span> <span data-ttu-id="51dd6-272">(Репликацию резервного хранилища необходимо настроить во время создания.)</span><span class="sxs-lookup"><span data-stu-id="51dd6-272">(Replication of the Backup vault must be configured at the time of creation.)</span></span>
- <span data-ttu-id="51dd6-273">Используйте Site Recovery для репликации по регионам для отработки отказа приложения одним щелчком и тестированию отработки отказа.</span><span class="sxs-lookup"><span data-stu-id="51dd6-273">Use Site Recovery to replicate across regions for one-click application failover and failover testing.</span></span>
- <span data-ttu-id="51dd6-274">Используйте диспетчер трафика для автоматизации отработки отказа трафика пользователей в другой регион.</span><span class="sxs-lookup"><span data-stu-id="51dd6-274">Use Traffic Manager to automate user traffic failover to another region.</span></span>

<span data-ttu-id="51dd6-275">Дополнительные сведения см. в разделе [восстановление после прерывания работы служб во всем регионе, виртуальные машины](../resiliency/recovery-loss-azure-region.md#virtual-machines).</span><span class="sxs-lookup"><span data-stu-id="51dd6-275">To learn more, see [Recover from a region-wide service disruption, Virtual machines](../resiliency/recovery-loss-azure-region.md#virtual-machines).</span></span>

### <a name="storage-recovery"></a><span data-ttu-id="51dd6-276">Восстановление хранилища</span><span class="sxs-lookup"><span data-stu-id="51dd6-276">Storage recovery</span></span>

<span data-ttu-id="51dd6-277">Для защиты хранилища в случае нарушения работы службы во всем регионе:</span><span class="sxs-lookup"><span data-stu-id="51dd6-277">To protect your storage in the event of a region-wide service disruption:</span></span>

- <span data-ttu-id="51dd6-278">Используйте геоизбыточное хранилище.</span><span class="sxs-lookup"><span data-stu-id="51dd6-278">Use geo-redundant storage.</span></span>
- <span data-ttu-id="51dd6-279">Знаете, где геореплицируемые изолированные хранилища.</span><span class="sxs-lookup"><span data-stu-id="51dd6-279">Know where your storage is geo-replicated.</span></span> <span data-ttu-id="51dd6-280">Это влияет на, где развертывать другие экземпляры данных, которые должны находиться в одном регионе с хранилищем.</span><span class="sxs-lookup"><span data-stu-id="51dd6-280">This affects where you deploy other instances of your data that require regional affinity with your storage.</span></span>
- <span data-ttu-id="51dd6-281">Проверьте данные на предмет согласованности после отработки отказа и при необходимости восстановить из резервной копии.</span><span class="sxs-lookup"><span data-stu-id="51dd6-281">Check data for consistency after failover and, if necessary, restore from a backup.</span></span>

<span data-ttu-id="51dd6-282">Дополнительные сведения см. в разделе [проектирование высокодоступных приложений с использованием RA-GRS](/azure/storage/common/storage-designing-ha-apps-with-ragrs).</span><span class="sxs-lookup"><span data-stu-id="51dd6-282">To learn more, see [Designing highly available applications using RA-GRS](/azure/storage/common/storage-designing-ha-apps-with-ragrs).</span></span>

### <a name="sql-database-and-sql-server"></a><span data-ttu-id="51dd6-283">База данных SQL и SQL Server</span><span class="sxs-lookup"><span data-stu-id="51dd6-283">SQL Database and SQL Server</span></span>

<span data-ttu-id="51dd6-284">База данных SQL Azure предоставляет два способа восстановления данных:</span><span class="sxs-lookup"><span data-stu-id="51dd6-284">Azure SQL Database provides two types of recovery:</span></span>

- <span data-ttu-id="51dd6-285">Использование геовосстановления для восстановления базы данных из резервной копии в другом регионе.</span><span class="sxs-lookup"><span data-stu-id="51dd6-285">Use geo-restore to restore a database from a backup copy in another region.</span></span> <span data-ttu-id="51dd6-286">Дополнительные сведения см. в разделе [восстановить базу данных Azure SQL, с помощью создаваемых автоматически резервных копий](/azure/sql-database/sql-database-recovery-using-backups).</span><span class="sxs-lookup"><span data-stu-id="51dd6-286">For more information, see [Recover an Azure SQL database using automated database backups](/azure/sql-database/sql-database-recovery-using-backups).</span></span>
- <span data-ttu-id="51dd6-287">Используйте активную георепликацию для отработки отказа для базы данных-получателя.</span><span class="sxs-lookup"><span data-stu-id="51dd6-287">Use active geo-replication to fail over to a secondary database.</span></span> <span data-ttu-id="51dd6-288">Дополнительные сведения см. в разделе [Создание и использование активной георепликации](/azure/sql-database/sql-database-active-geo-replication).</span><span class="sxs-lookup"><span data-stu-id="51dd6-288">For more information, see [Creating and using active geo-replication](/azure/sql-database/sql-database-active-geo-replication).</span></span>

<span data-ttu-id="51dd6-289">SQL Server на виртуальных машинах, см. в разделе [высокий уровень доступности и аварийное восстановление для SQL Server на виртуальных машинах Azure](/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr/).</span><span class="sxs-lookup"><span data-stu-id="51dd6-289">For SQL Server running on VMs, see [High availability and disaster recovery for SQL Server in Azure Virtual Machines](/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr/).</span></span>

## <a name="service-specific-guidance"></a><span data-ttu-id="51dd6-290">Рекомендации по отдельным службам</span><span class="sxs-lookup"><span data-stu-id="51dd6-290">Service-specific guidance</span></span>

<span data-ttu-id="51dd6-291">В следующих статьях описываются аварийного восстановления для определенных служб Azure:</span><span class="sxs-lookup"><span data-stu-id="51dd6-291">The following articles describe disaster recovery for specific Azure services:</span></span>

| <span data-ttu-id="51dd6-292">Service</span><span class="sxs-lookup"><span data-stu-id="51dd6-292">Service</span></span>                       | <span data-ttu-id="51dd6-293">Статья</span><span class="sxs-lookup"><span data-stu-id="51dd6-293">Article</span></span>                                                                                                                                                                                       |
|-------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="51dd6-294">База данных Azure для MySQL</span><span class="sxs-lookup"><span data-stu-id="51dd6-294">Azure Database for MySQL</span></span>      | [<span data-ttu-id="51dd6-295">Общие сведения об обеспечении непрерывности бизнес-процессов с помощью службы "База данных Azure для MySQL"</span><span class="sxs-lookup"><span data-stu-id="51dd6-295">Overview of business continuity with Azure Database for MySQL</span></span>](/azure/mysql/concepts-business-continuity)                                                  |
| <span data-ttu-id="51dd6-296">База данных Azure для PostgreSQL</span><span class="sxs-lookup"><span data-stu-id="51dd6-296">Azure Database for PostgreSQL</span></span> | [<span data-ttu-id="51dd6-297">Общие сведения об обеспечении непрерывности бизнес-процессов с помощью службы "База данных Azure для PostgreSQL"</span><span class="sxs-lookup"><span data-stu-id="51dd6-297">Overview of business continuity with Azure Database for PostgreSQL</span></span>](/azure/postgresql/concepts-business-continuity)                                        |
| <span data-ttu-id="51dd6-298">Облачные службы Azure</span><span class="sxs-lookup"><span data-stu-id="51dd6-298">Azure Cloud Services</span></span>          | [<span data-ttu-id="51dd6-299">Что делать, если прерывание работы службы Azure влияет на облачные службы Azure</span><span class="sxs-lookup"><span data-stu-id="51dd6-299">What to do in the event of an Azure service disruption that impacts Azure Cloud Services</span></span>](/azure/cloud-services/cloud-services-disaster-recovery-guidance) |
| <span data-ttu-id="51dd6-300">База данных Cosmos</span><span class="sxs-lookup"><span data-stu-id="51dd6-300">Cosmos DB</span></span>                     | [<span data-ttu-id="51dd6-301">Высокий уровень доступности с помощью Azure Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="51dd6-301">High availability with Azure Cosmos DB</span></span>](/azure/cosmos-db/high-availability)                                                                                |
| <span data-ttu-id="51dd6-302">Хранилище ключей Azure</span><span class="sxs-lookup"><span data-stu-id="51dd6-302">Azure Key Vault</span></span>               | [<span data-ttu-id="51dd6-303">Доступность и избыточность хранилища ключей Azure</span><span class="sxs-lookup"><span data-stu-id="51dd6-303">Azure Key Vault availability and redundancy</span></span>](/azure/key-vault/key-vault-disaster-recovery-guidance)                                                        |
| <span data-ttu-id="51dd6-304">Хранилище Azure</span><span class="sxs-lookup"><span data-stu-id="51dd6-304">Azure Storage</span></span>                 | <span data-ttu-id="51dd6-305">[Disaster recovery and storage account failover (preview) in Azure Storage](/azure/storage/common/storage-disaster-recovery-guidance) (Аварийное восстановление и отработка отказа учетной записи хранения (предварительная версия) в службе хранилища Azure)</span><span class="sxs-lookup"><span data-stu-id="51dd6-305">[Disaster recovery and storage account failover (preview) in Azure Storage](/azure/storage/common/storage-disaster-recovery-guidance)</span></span>                       |
| <span data-ttu-id="51dd6-306">База данных SQL</span><span class="sxs-lookup"><span data-stu-id="51dd6-306">SQL Database</span></span>                  | [<span data-ttu-id="51dd6-307">Восстановление базы данных SQL Azure или отработки отказа в дополнительный регион</span><span class="sxs-lookup"><span data-stu-id="51dd6-307">Restore an Azure SQL Database or failover to a secondary region</span></span>](/azure/sql-database/sql-database-disaster-recovery)                                       |
| <span data-ttu-id="51dd6-308">Виртуальные машины</span><span class="sxs-lookup"><span data-stu-id="51dd6-308">Virtual Machines</span></span>              | [<span data-ttu-id="51dd6-309">Что в случае Azure Если прерывание работы службы влияет на облако Azure</span><span class="sxs-lookup"><span data-stu-id="51dd6-309">What to do in the event of an Azure service disruption impacts Azure Cloud</span></span>](/azure/cloud-services/cloud-services-disaster-recovery-guidance)               |
| <span data-ttu-id="51dd6-310">Виртуальная сеть Azure</span><span class="sxs-lookup"><span data-stu-id="51dd6-310">Azure Virtual Network</span></span>         | [<span data-ttu-id="51dd6-311">Виртуальная сеть: непрерывность бизнес-процессов</span><span class="sxs-lookup"><span data-stu-id="51dd6-311">Virtual Network – Business Continuity</span></span>](/azure/virtual-network/virtual-network-disaster-recovery-guidance)                                                  |

## <a name="next-steps"></a><span data-ttu-id="51dd6-312">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="51dd6-312">Next steps</span></span>

- [<span data-ttu-id="51dd6-313">Восстановление данных после повреждения или случайного удаления</span><span class="sxs-lookup"><span data-stu-id="51dd6-313">Recover from data corruption or accidental deletion</span></span>](../resiliency/recovery-data-corruption.md)
- [<span data-ttu-id="51dd6-314">Восстановление после прерывания работы служб во всем регионе</span><span class="sxs-lookup"><span data-stu-id="51dd6-314">Recover from a region-wide service disruption</span></span>](../resiliency/recovery-loss-azure-region.md)