---
title: Тестирование приложений Azure для обеспечения устойчивости и доступности
description: Способы тестирования надежность приложений в Azure
author: MikeWasson
ms.date: 04/10/2019
ms.topic: article
ms.service: architecture-center
ms.subservice: cloud-design-principles
ms.openlocfilehash: cf33a859540810279b1cb85be5a6fb2ebe4500dc
ms.sourcegitcommit: 579c39ff4b776704ead17a006bf24cd4cdc65edd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59646638"
---
# <a name="testing-azure-applications-for-resiliency-and-availability"></a><span data-ttu-id="6d2b6-103">Тестирование приложений Azure для обеспечения устойчивости и доступности</span><span class="sxs-lookup"><span data-stu-id="6d2b6-103">Testing Azure applications for resiliency and availability</span></span>

<span data-ttu-id="6d2b6-104">Чтобы протестировать устойчивость, следует проверить, как рабочая нагрузка end-to-end выполняется в условиях Периодические сбои.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-104">To test resiliency, you should verify how the end-to-end workload performs under intermittent failure conditions.</span></span>

<span data-ttu-id="6d2b6-105">Выполнение тестов в рабочей среде с помощью обоих синтетические и реальных пользовательских данных.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-105">Run tests in production using both synthetic and real user data.</span></span> <span data-ttu-id="6d2b6-106">Тестирования и производственная среда редко идентичны, поэтому очень важно для проверки приложения в рабочей среде с помощью [сине зеленый](https://martinfowler.com/bliki/BlueGreenDeployment.html) или [раннее развертывание](https://martinfowler.com/bliki/CanaryRelease.html).</span><span class="sxs-lookup"><span data-stu-id="6d2b6-106">Test and production are rarely identical, so it's important to validate your application in production using a [blue-green](https://martinfowler.com/bliki/BlueGreenDeployment.html) or [canary deployment](https://martinfowler.com/bliki/CanaryRelease.html).</span></span> <span data-ttu-id="6d2b6-107">Таким образом, вы тестируете приложение в реальных условиях, поэтому можно быть уверенным, что она будет работать должным образом, когда полностью развернут.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-107">This way, you're testing the application under real conditions, so you can be sure that it will function as expected when fully deployed.</span></span>

<span data-ttu-id="6d2b6-108">Как часть плана тестирования включают:</span><span class="sxs-lookup"><span data-stu-id="6d2b6-108">As part of your test plan, include:</span></span>

- <span data-ttu-id="6d2b6-109">Автоматическое тестирование перед развертыванием</span><span class="sxs-lookup"><span data-stu-id="6d2b6-109">Automated predeployment testing</span></span>
- <span data-ttu-id="6d2b6-110">Тестирование посредством внесения ошибок</span><span class="sxs-lookup"><span data-stu-id="6d2b6-110">Fault injection testing</span></span>
- <span data-ttu-id="6d2b6-111">Нагрузочное тестирование (пик)</span><span class="sxs-lookup"><span data-stu-id="6d2b6-111">Peak load testing</span></span>
- <span data-ttu-id="6d2b6-112">При проверке аварийного восстановления</span><span class="sxs-lookup"><span data-stu-id="6d2b6-112">Disaster recovery testing</span></span>
- <span data-ttu-id="6d2b6-113">Сторонняя служба тестирования</span><span class="sxs-lookup"><span data-stu-id="6d2b6-113">Third-party service testing</span></span>

<span data-ttu-id="6d2b6-114">Тестирование — это итеративный процесс.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-114">Testing is an iterative process.</span></span> <span data-ttu-id="6d2b6-115">Протестируйте приложение, измерьте результат, проанализируйте и устраните все возникающие сбои и повторите процесс.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-115">Test the application, measure the outcome, analyze and address any failures that result, and repeat the process.</span></span>

## <a name="perform-fault-injection-testing"></a><span data-ttu-id="6d2b6-116">Выполните тестирование путем внедрения ошибки</span><span class="sxs-lookup"><span data-stu-id="6d2b6-116">Perform fault injection testing</span></span>

<span data-ttu-id="6d2b6-117">Тестирование посредством внесения ошибок, проверьте отказоустойчивость системы во время сбоев либо путем инициирования фактических сбоев, либо путем их имитации.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-117">For fault injection testing, check the resiliency of the system during failures, either by triggering actual failures or by simulating them.</span></span> <span data-ttu-id="6d2b6-118">Ниже приведены некоторые стратегии, позволяющие вызывать сбои.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-118">Here are some strategies to induce failures:</span></span>

- <span data-ttu-id="6d2b6-119">Завершение работы экземпляров виртуальной машины (VM).</span><span class="sxs-lookup"><span data-stu-id="6d2b6-119">Shut down virtual machine (VM) instances.</span></span>
- <span data-ttu-id="6d2b6-120">прекращение работы процессов;</span><span class="sxs-lookup"><span data-stu-id="6d2b6-120">Crash processes.</span></span>
- <span data-ttu-id="6d2b6-121">Завершите срок действия сертификатов.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-121">Expire certificates.</span></span>
- <span data-ttu-id="6d2b6-122">Измените ключи доступа.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-122">Change access keys.</span></span>
- <span data-ttu-id="6d2b6-123">Завершите работу службы DNS на контроллерах домена.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-123">Shut down the DNS service on domain controllers.</span></span>
- <span data-ttu-id="6d2b6-124">Ограничьте доступные системные ресурсы, такие как ОЗУ или количество потоков.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-124">Limit available system resources, such as RAM or number of threads.</span></span>
- <span data-ttu-id="6d2b6-125">Отключите диски.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-125">Unmount disks.</span></span>
- <span data-ttu-id="6d2b6-126">Повторно разверните виртуальную машину.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-126">Redeploy a VM.</span></span>

<span data-ttu-id="6d2b6-127">План тестирования должно предусматривать возможных точек сбоя определены на этапе проектирования, помимо распространенных ошибок:</span><span class="sxs-lookup"><span data-stu-id="6d2b6-127">Your test plan should incorporate possible failure points identified during the design phase, in addition to common failure scenarios:</span></span>

- <span data-ttu-id="6d2b6-128">Протестируйте приложение в среде, как можно ближе к рабочей среде, максимально.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-128">Test your application in an environment as close to production as possible.</span></span>
- <span data-ttu-id="6d2b6-129">Сбои при тестировании в сочетании.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-129">Test failures in combination.</span></span>
- <span data-ttu-id="6d2b6-130">Измерьте время восстановления и убедитесь, что ваши бизнес-требованиям.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-130">Measure the recovery times, and be sure that your business requirements are met.</span></span>
- <span data-ttu-id="6d2b6-131">Убедитесь, что сбои не каскадируются и обрабатываются изолированно.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-131">Verify that failures don't cascade and are handled in an isolated way.</span></span>

<span data-ttu-id="6d2b6-132">Дополнительные сведения о сценарии сбоев, см. в разделе [сбоя и аварийное восстановление для приложений Azure](./disaster-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="6d2b6-132">For more information about failure scenarios, see [Failure and disaster recovery for Azure applications](./disaster-recovery.md).</span></span>

## <a name="test-under-peak-loads"></a><span data-ttu-id="6d2b6-133">Тестирование при пиковых нагрузках</span><span class="sxs-lookup"><span data-stu-id="6d2b6-133">Test under peak loads</span></span>

<span data-ttu-id="6d2b6-134">Нагрузочное тестирование имеет решающее значение для обнаружения сбоев, которые происходят только под нагрузкой, таких как базы данных серверной части перегрузку или регулирования службы.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-134">Load testing is crucial for identifying failures that only happen under load, such as the back-end database being overwhelmed or service throttling.</span></span> <span data-ttu-id="6d2b6-135">Тестирование для пиковой нагрузки и ожидаемое увеличение пиковой нагрузки, используя рабочие данные или искусственные данные, как можно ближе к рабочих данных максимально.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-135">Test for peak load and anticipated increase in peak load, using production data or synthetic data that is as close to production data as possible.</span></span> <span data-ttu-id="6d2b6-136">Ваша цель состоит в том, как ведет себя приложение в реальных условиях.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-136">Your goal is to see how the application behaves under real-world conditions.</span></span>

## <a name="conduct-disaster-recovery-drills"></a><span data-ttu-id="6d2b6-137">Проведение аварийного восстановления</span><span class="sxs-lookup"><span data-stu-id="6d2b6-137">Conduct disaster recovery drills</span></span>

<span data-ttu-id="6d2b6-138">Начните с хорошего плана аварийного восстановления и проверить его периодически, чтобы убедиться, что оно работает.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-138">Start with a good disaster recovery plan, and test it periodically to make sure it works.</span></span>

<span data-ttu-id="6d2b6-139">Для виртуальных машин в Azure, можно использовать [Azure Site Recovery](/azure/site-recovery/azure-to-azure-quickstart/) для репликации и выполнить [аварийного восстановления](/azure/site-recovery/azure-to-azure-tutorial-dr-drill/) без влияния на рабочие приложения или текущую репликацию.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-139">For Azure Virtual Machines, you can use [Azure Site Recovery](/azure/site-recovery/azure-to-azure-quickstart/) to replicate and perform [disaster recovery drills](/azure/site-recovery/azure-to-azure-tutorial-dr-drill/) without impacting production applications or ongoing replication.</span></span>

### <a name="failover-and-failback-testing"></a><span data-ttu-id="6d2b6-140">Отработка отказа и восстановления размещения тестирования</span><span class="sxs-lookup"><span data-stu-id="6d2b6-140">Failover and failback testing</span></span>

<span data-ttu-id="6d2b6-141">Тестирование отработки отказа и восстановления размещения, чтобы убедиться, что зависимые службы в приложении восстановят работу синхронизировано во время аварийного восстановления.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-141">Test failover and failback to verify that your application's dependent services come back up in a synchronized manner during disaster recovery.</span></span> <span data-ttu-id="6d2b6-142">Изменения систем и операций могут повлиять на функции отработки отказа и восстановления размещения, но влияние может быть незамечен до сбой основной системы, или перегрузке.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-142">Changes to systems and operations may affect failover and failback functions, but the impact may not be detected until the main system fails or becomes overloaded.</span></span> <span data-ttu-id="6d2b6-143">Тестирование отработки отказа *перед* они необходимы для компенсации за это реальной ошибкой.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-143">Test failover capabilities *before* they are required to compensate for a live problem.</span></span> <span data-ttu-id="6d2b6-144">Кроме того, убедитесь, что зависимые службы отработка отказа и восстановление размещения в правильном порядке.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-144">Also be sure that dependent services fail over and fail back in the correct order.</span></span>

<span data-ttu-id="6d2b6-145">Если вы используете [Azure Site Recovery](/azure/site-recovery/) для репликации виртуальных машин, выполнять аварийное восстановление периодически, выполнив тестовую отработку отказа для проверки стратегии репликации.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-145">If you are using [Azure Site Recovery](/azure/site-recovery/) to replicate VMs, run disaster recovery drills periodically by doing test failovers to validate your replication strategy.</span></span> <span data-ttu-id="6d2b6-146">Тестовая отработка отказа не влияет на текущую репликацию виртуальных Машин или рабочую среду.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-146">A test failover does not affect the ongoing VM replication or your production environment.</span></span> <span data-ttu-id="6d2b6-147">Дополнительные сведения см. в разделе [выполнение отработки аварийного восстановления в Azure](/azure/site-recovery/site-recovery-test-failover-to-azure).</span><span class="sxs-lookup"><span data-stu-id="6d2b6-147">For more information, see [Run a disaster recovery drill to Azure](/azure/site-recovery/site-recovery-test-failover-to-azure).</span></span>

### <a name="simulation-testing"></a><span data-ttu-id="6d2b6-148">Имитационное тестирование</span><span class="sxs-lookup"><span data-stu-id="6d2b6-148">Simulation testing</span></span>

<span data-ttu-id="6d2b6-149">Имитационное тестирование подразумевает создание небольших, реальных ситуаций.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-149">Simulation testing involves creating small, real-life situations.</span></span> <span data-ttu-id="6d2b6-150">Моделирование демонстрации эффективности решения в плане восстановления и выделить все проблемы, которые не были обработаны должным образом.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-150">Simulations demonstrate the effectiveness of the solutions in the recovery plan and highlight any issues that weren't adequately addressed.</span></span>

<span data-ttu-id="6d2b6-151">При выполнении имитационное тестирование, следуйте рекомендациям.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-151">As you perform simulation testing, follow best practices:</span></span>

- <span data-ttu-id="6d2b6-152">Провести моделирование таким образом, чтобы не нарушали фактическую деятельность компании, но подчас реальной ситуации.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-152">Conduct simulations in a manner that doesn't disrupt actual business but feels like a real situation.</span></span>
- <span data-ttu-id="6d2b6-153">Убедитесь, что моделируемые сценарии являются полностью управляемыми.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-153">Make sure that simulated scenarios are completely controllable.</span></span> <span data-ttu-id="6d2b6-154">Если план восстановления, произошла ошибка, ситуацию можно восстановить нормальный режим работы без ущерба.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-154">If the recovery plan seems to be failing, you can restore the situation back to normal without causing damage.</span></span>
- <span data-ttu-id="6d2b6-155">Проинформируйте руководство о когда и как будет выполняться имитация.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-155">Inform management about when and how the simulation exercises will be conducted.</span></span> <span data-ttu-id="6d2b6-156">Ваш план подробно описать временные рамки и затрагиваемые ресурсы.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-156">Your plan should detail the time frame and the resources affected during the simulation.</span></span>

## <a name="test-health-probes-for-load-balancers-and-traffic-managers"></a><span data-ttu-id="6d2b6-157">Проверку работоспособности подсистемы балансировки нагрузки и диспетчеров трафика</span><span class="sxs-lookup"><span data-stu-id="6d2b6-157">Test health probes for load balancers and traffic managers</span></span>

<span data-ttu-id="6d2b6-158">Настройка и проверка пробы работоспособности для подсистемы балансировки нагрузки и диспетчеров трафика.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-158">Configure and test health probes for your load balancers and traffic managers.</span></span> <span data-ttu-id="6d2b6-159">Убедитесь, что конечная точка работоспособности проверяет важные части системы и реагирует соответствующим образом.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-159">Ensure that your health endpoint checks the critical parts of the system and responds appropriately.</span></span>

- <span data-ttu-id="6d2b6-160">Для [диспетчера трафика Azure](/azure/traffic-manager/traffic-manager-overview/), проверке работоспособности определяется, следует ли выполнить отработку отказа в другой регион.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-160">For [Azure Traffic Manager](/azure/traffic-manager/traffic-manager-overview/), the health probe determines whether to fail over to another region.</span></span> <span data-ttu-id="6d2b6-161">Конечная точка работоспособности должна проверять любые критические зависимости, которые развертываются в одном регионе.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-161">Your health endpoint should check any critical dependencies that are deployed within the same region.</span></span>
- <span data-ttu-id="6d2b6-162">Для [Azure Load Balancer](/azure/load-balancer/load-balancer-overview/), проверке работоспособности определяется, следует ли удалять виртуальную Машину из ротации.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-162">For [Azure Load Balancer](/azure/load-balancer/load-balancer-overview/), the health probe determines whether to remove a VM from rotation.</span></span> <span data-ttu-id="6d2b6-163">Конечная точка работоспособности должны сообщать о работоспособности виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-163">The health endpoint should report the health of the VM.</span></span> <span data-ttu-id="6d2b6-164">Не включайте в развертывание другие уровни или внешние службы.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-164">Don't include other tiers or external services.</span></span> <span data-ttu-id="6d2b6-165">В противном случае при сбое вне виртуальной машины подсистема балансировки нагрузки удалит виртуальную машину из ротации.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-165">Otherwise, a failure that occurs outside the VM will cause the load balancer to remove the VM from rotation.</span></span>

<span data-ttu-id="6d2b6-166">Инструкции по реализации мониторинга работоспособности в приложении см. в описании [шаблона мониторинга конечной точки работоспособности](../patterns/health-endpoint-monitoring.md).</span><span class="sxs-lookup"><span data-stu-id="6d2b6-166">For guidance on implementing health monitoring in your application, see [Health Endpoint Monitoring pattern](../patterns/health-endpoint-monitoring.md).</span></span>

## <a name="test-monitoring-systems"></a><span data-ttu-id="6d2b6-167">Тестирование системы мониторинга</span><span class="sxs-lookup"><span data-stu-id="6d2b6-167">Test monitoring systems</span></span>

<span data-ttu-id="6d2b6-168">Включите мониторинг систем в плане тестирования.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-168">Include monitoring systems in your test plan.</span></span> <span data-ttu-id="6d2b6-169">Автоматизированных систем отработки отказа и восстановления размещения зависят от того, правильность работы отслеживания и инструментирования.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-169">Automated failover and failback systems depend on the correct functioning of monitoring and instrumentation.</span></span> <span data-ttu-id="6d2b6-170">Панелей мониторинга для визуализации системные оповещения о работоспособности и оператор также зависит от того, наличие точной мониторинга и инструментирования.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-170">Dashboards to visualize system health and operator alerts also depend on having accurate monitoring and instrumentation.</span></span> <span data-ttu-id="6d2b6-171">Если происходит сбой этих элементов, они пропускают важную информацию или сообщают неточные данные, поэтому оператор может не понять, что система работает неправильно.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-171">If these elements fail, miss critical information, or report inaccurate data, an operator might not realize that the system is unhealthy or failing.</span></span>

## <a name="include-third-party-services-in-test-scenarios"></a><span data-ttu-id="6d2b6-172">Включить сторонние службы в сценарии тестирования</span><span class="sxs-lookup"><span data-stu-id="6d2b6-172">Include third-party services in test scenarios</span></span>

<span data-ttu-id="6d2b6-173">Если приложение имеет зависимости от сторонних служб, указать расположение и как эти службы может произойти сбой, и что в силу этих сбоев окажет на приложения.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-173">If your application has dependencies on third-party services, identify where and how these services can fail and what effect those failures will have on your application.</span></span> <span data-ttu-id="6d2b6-174">Имейте в виду уровня службы соглашение об уровне службы независимых производителей и влияние, возможно, во-первых, на ваш план аварийного восстановления.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-174">Keep in mind the service-level agreement (SLA) for the third-party service and the effect it might have on your disaster recovery plan.</span></span>

<span data-ttu-id="6d2b6-175">Сторонняя служба может не обеспечивать возможности мониторинга и диагностики, поэтому важно для входа свои вызовы и сопоставлять их с работоспособности приложений и ведения журналов с использованием уникального идентификатора диагностики.</span><span class="sxs-lookup"><span data-stu-id="6d2b6-175">A third-party service might not provide monitoring and diagnostics capabilities, so it's important to log your invocations of them and to correlate them with your application's health and diagnostic logging using a unique identifier.</span></span> <span data-ttu-id="6d2b6-176">Дополнительные сведения о методиках мониторинга и диагностики см. в разделе [руководство по мониторингу и диагностике](../best-practices/monitoring.md).</span><span class="sxs-lookup"><span data-stu-id="6d2b6-176">For more information on proven practices for monitoring and diagnostics, see [Monitoring and diagnostics guidance](../best-practices/monitoring.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="6d2b6-177">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="6d2b6-177">Next steps</span></span>

> [!div class="nextstepaction"]
> [<span data-ttu-id="6d2b6-178">Развертывание для обеспечения устойчивости и доступности</span><span class="sxs-lookup"><span data-stu-id="6d2b6-178">Deploy for resiliency and availability</span></span>](./deploy.md)
