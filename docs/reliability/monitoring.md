---
title: Наблюдение за работоспособностью приложений для обеспечения надежности в Azure
description: Как использовать мониторинг для повышения надежности приложений в Azure
author: MikeWasson
ms.date: 04/10/2019
ms.topic: article
ms.service: architecture-center
ms.subservice: cloud-design-principles
ms.openlocfilehash: 46f9f3fb623a2facf4b9f9c6ec57376ae59e41dc
ms.sourcegitcommit: 579c39ff4b776704ead17a006bf24cd4cdc65edd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59646675"
---
# <a name="monitoring-application-health-for-reliability-in-azure"></a><span data-ttu-id="85a46-103">Наблюдение за работоспособностью приложений для обеспечения надежности в Azure</span><span class="sxs-lookup"><span data-stu-id="85a46-103">Monitoring application health for reliability in Azure</span></span>

<span data-ttu-id="85a46-104">Мониторинг и диагностика важны для обеспечения устойчивости.</span><span class="sxs-lookup"><span data-stu-id="85a46-104">Monitoring and diagnostics are crucial for resiliency.</span></span> <span data-ttu-id="85a46-105">В случае отказа, необходимо знать *,* попытка не удалась, *при* попытка не удалась &mdash; и *почему*.</span><span class="sxs-lookup"><span data-stu-id="85a46-105">If something fails, you need to know *that* it failed, *when* it failed &mdash; and *why*.</span></span>

<span data-ttu-id="85a46-106">*Мониторинг* не является таким же, как *обнаружения сбоев*.</span><span class="sxs-lookup"><span data-stu-id="85a46-106">*Monitoring* is not the same as *failure detection*.</span></span> <span data-ttu-id="85a46-107">Например, приложение может обнаружить временную ошибку и повторить попытку, отсутствие простоев.</span><span class="sxs-lookup"><span data-stu-id="85a46-107">For example, your application might detect a transient error and retry, avoiding downtime.</span></span> <span data-ttu-id="85a46-108">Но оно также должно регистрировать операцию повтора, можно наблюдать за ее частота ошибок, чтобы получить общее представление о работоспособности приложения.</span><span class="sxs-lookup"><span data-stu-id="85a46-108">But it should also log the retry operation so that you can monitor the error rate to get an overall picture of application health.</span></span>

<span data-ttu-id="85a46-109">Процесс мониторинга и диагностики можно рассматривать как конвейер с четырех различных этапов: Инструментирование, сбора и хранения, анализа и диагностики и визуализация и оповещения.</span><span class="sxs-lookup"><span data-stu-id="85a46-109">Think of the monitoring and diagnostics process as a pipeline with four distinct stages: Instrumentation, collection and storage, analysis and diagnosis, and visualization and alerts.</span></span>

## <a name="instrumentation"></a><span data-ttu-id="85a46-110">Инструментирование</span><span class="sxs-lookup"><span data-stu-id="85a46-110">Instrumentation</span></span>

<span data-ttu-id="85a46-111">Это не позволяет наблюдать за приложением напрямую, поэтому инструментария является ключом.</span><span class="sxs-lookup"><span data-stu-id="85a46-111">It's not practical to monitor your application directly, so instrumentation is key.</span></span> <span data-ttu-id="85a46-112">Крупномасштабная распределенная система может работать на десятках виртуальных машин (ВМ), которые добавляются и удаляются с течением времени.</span><span class="sxs-lookup"><span data-stu-id="85a46-112">A large-scale distributed system might run on dozens of virtual machines (VMs), which are added and removed over time.</span></span> <span data-ttu-id="85a46-113">Аналогичным образом Облачное приложение может использовать несколько хранилищ данных и одно действие пользователя может охватывать несколько подсистем.</span><span class="sxs-lookup"><span data-stu-id="85a46-113">Likewise, a cloud application might use a number of data stores and a single user action might span multiple subsystems.</span></span>

<span data-ttu-id="85a46-114">Предоставьте расширенный инструментарий:</span><span class="sxs-lookup"><span data-stu-id="85a46-114">Provide rich instrumentation:</span></span>

- <span data-ttu-id="85a46-115">Для сбоев, которые, скорее всего, но еще не произошло, обеспечить достаточный объем данных, чтобы определить причину, уменьшить последствия ситуации и обеспечить доступность системы.</span><span class="sxs-lookup"><span data-stu-id="85a46-115">For failures that are likely but have not yet occurred, provide enough data to determine the cause, mitigate the situation, and ensure that the system remains available.</span></span>
- <span data-ttu-id="85a46-116">Для сбоев, которые уже произошли приложение должно возвращать соответствующее сообщение об ошибке пользователю, но следует попытаться продолжить выполнение, хотя и с ограниченными возможностями.</span><span class="sxs-lookup"><span data-stu-id="85a46-116">For failures that have already occurred, the application should return an appropriate error message to the user but should attempt to continue running, albeit with reduced functionality.</span></span>

<span data-ttu-id="85a46-117">Систем мониторинга должна записывать всеобъемлющие данные, чтобы приложения, которые могут восстанавливаться эффективно и, при необходимости, проектировщикам и разработчикам может изменить систему для предотвращения подобных ситуаций в будущем.</span><span class="sxs-lookup"><span data-stu-id="85a46-117">Monitoring systems should capture comprehensive details so that applications can be restored efficiently and, if necessary, designers and developers can modify the system to prevent the situation from recurring.</span></span>

<span data-ttu-id="85a46-118">Необработанные данные мониторинга могут поступать из различных источников, включая:</span><span class="sxs-lookup"><span data-stu-id="85a46-118">The raw data for monitoring can come from a variety of sources, including:</span></span>

- <span data-ttu-id="85a46-119">Журналы приложений, например созданные программой [Azure Application Insights](/azure/azure-monitor/app/app-insights-overview) службы.</span><span class="sxs-lookup"><span data-stu-id="85a46-119">Application logs, such as those produced by the [Azure Application Insights](/azure/azure-monitor/app/app-insights-overview) service.</span></span>
- <span data-ttu-id="85a46-120">Сбор показателей производительности операционной системы [Azure агентов мониторинга](/azure/azure-monitor/platform/agents-overview).</span><span class="sxs-lookup"><span data-stu-id="85a46-120">Operating system performance metrics collected by [Azure monitoring agents](/azure/azure-monitor/platform/agents-overview).</span></span>
- <span data-ttu-id="85a46-121">[Ресурсы Azure](/azure/azure-monitor/platform/metrics-supported), включая метрики собранные Azure Monitor.</span><span class="sxs-lookup"><span data-stu-id="85a46-121">[Azure resources](/azure/azure-monitor/platform/metrics-supported), including metrics collected by Azure Monitor.</span></span>
- <span data-ttu-id="85a46-122">[Служба работоспособности служб Azure](/azure/service-health/service-health-overview), который включает панель мониторинга, чтобы помочь вам отслеживать такие активные события.</span><span class="sxs-lookup"><span data-stu-id="85a46-122">[Azure Service Health](/azure/service-health/service-health-overview), which offers a dashboard to help you track active events.</span></span>
- <span data-ttu-id="85a46-123">[Журналы Azure AD](/azure/active-directory/reports-monitoring/howto-integrate-activity-logs-with-log-analytics) встроены в платформу Azure.</span><span class="sxs-lookup"><span data-stu-id="85a46-123">[Azure AD logs](/azure/active-directory/reports-monitoring/howto-integrate-activity-logs-with-log-analytics) built into the Azure platform.</span></span>

<span data-ttu-id="85a46-124">Большинство служб Azure имеют метрик и диагностических сведений, можно настроить для анализа и определить причину проблемы.</span><span class="sxs-lookup"><span data-stu-id="85a46-124">Most Azure services have metrics and diagnostics that you can configure to analyze and determine the cause of problems.</span></span> <span data-ttu-id="85a46-125">Дополнительные сведения см. в разделе [данные мониторинга собранные Azure Monitor](/azure/azure-monitor/platform/data-collection).</span><span class="sxs-lookup"><span data-stu-id="85a46-125">To learn more, see [Monitoring data collected by Azure Monitor](/azure/azure-monitor/platform/data-collection).</span></span>

## <a name="collection-and-storage"></a><span data-ttu-id="85a46-126">Сбор и хранение</span><span class="sxs-lookup"><span data-stu-id="85a46-126">Collection and storage</span></span>

<span data-ttu-id="85a46-127">Необработанные данные инструментирования могут храниться в различных расположениях и форматах, включая:</span><span class="sxs-lookup"><span data-stu-id="85a46-127">Raw instrumentation data can be held in various locations and formats, including:</span></span>

- <span data-ttu-id="85a46-128">Журналы трассировки приложений</span><span class="sxs-lookup"><span data-stu-id="85a46-128">Application trace logs</span></span>
- <span data-ttu-id="85a46-129">Журналы IIS</span><span class="sxs-lookup"><span data-stu-id="85a46-129">IIS logs</span></span>
- <span data-ttu-id="85a46-130">Счетчики производительности</span><span class="sxs-lookup"><span data-stu-id="85a46-130">Performance counters</span></span>

<span data-ttu-id="85a46-131">Эти разрозненные источники собираются, consolidated и поместить в хранилищах данных в Azure, например Application Insights, Azure Monitor метрики, работоспособность службы, учетные записи хранения и Azure Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="85a46-131">These disparate sources are collected, consolidated, and placed in reliable data stores in Azure, such as Application Insights, Azure Monitor metrics, Service Health, storage accounts, and Azure Log Analytics.</span></span>

## <a name="analysis-and-diagnosis"></a><span data-ttu-id="85a46-132">Анализ и диагностика</span><span class="sxs-lookup"><span data-stu-id="85a46-132">Analysis and diagnosis</span></span>

<span data-ttu-id="85a46-133">Анализ данных объединены в эти хранилища данных для устранения неполадок и получить общее представление о работоспособности приложения.</span><span class="sxs-lookup"><span data-stu-id="85a46-133">Analyze data consolidated in these data stores to troubleshoot issues and gain an overall view of application health.</span></span> <span data-ttu-id="85a46-134">Как правило, вы можете [искать и анализировать](/azure/azure-monitor/log-query/log-query-overview) данных в Application Insights и Log Analytics с помощью запросов Kusto или диаграммами предварительно настроенные представления, с помощью [решения по управлению](/azure/azure-monitor/insights/solutions-inventory).</span><span class="sxs-lookup"><span data-stu-id="85a46-134">Generally, you can [search for and analyze](/azure/azure-monitor/log-query/log-query-overview) the data in Application Insights and Log Analytics using Kusto queries or view preconfigured graphs using [management solutions](/azure/azure-monitor/insights/solutions-inventory).</span></span> <span data-ttu-id="85a46-135">Или использовать помощник по Azure, чтобы просмотреть рекомендации с упором на [устойчивости](/azure/advisor/advisor-high-availability-recommendations) и [производительности](/azure/advisor/advisor-performance-recommendations).</span><span class="sxs-lookup"><span data-stu-id="85a46-135">Or use Azure Advisor to view recommendations with a focus on [resiliency](/azure/advisor/advisor-high-availability-recommendations) and [performance](/azure/advisor/advisor-performance-recommendations).</span></span>

## <a name="visualization-and-alerts"></a><span data-ttu-id="85a46-136">Визуализация и оповещения</span><span class="sxs-lookup"><span data-stu-id="85a46-136">Visualization and alerts</span></span>

<span data-ttu-id="85a46-137">Представления данных телеметрии в формате, который позволяет легко оператор может заметить проблемы или тенденции, например оповещение в панели мониторинга или по электронной почте.</span><span class="sxs-lookup"><span data-stu-id="85a46-137">Present telemetry data in a format that makes it easy for an operator to notice problems or trends quickly, such as a dashboard or email alert.</span></span>

<span data-ttu-id="85a46-138">Получите полный стек представление о состоянии приложения с помощью [панелей мониторинга Azure](/azure/azure-portal/azure-portal-dashboards) создать консолидированное представление мониторинга графов из Application Insights, Log Analytics, метрик Azure Monitor и работоспособности службы.</span><span class="sxs-lookup"><span data-stu-id="85a46-138">Get a full-stack view of application state by using [Azure dashboards](/azure/azure-portal/azure-portal-dashboards) to create a consolidated view of monitoring graphs from Application Insights, Log Analytics, Azure Monitor metrics, and Service Health.</span></span> <span data-ttu-id="85a46-139">И использовать [оповещения Azure Monitor](/azure/azure-monitor/platform/alerts-overview) для создания уведомлений о работоспособности службы, служба работоспособности ресурсов, метрик Azure Monitor, журналы в Log Analytics и Application Insights.</span><span class="sxs-lookup"><span data-stu-id="85a46-139">And use [Azure Monitor alerts](/azure/azure-monitor/platform/alerts-overview) to create notifications on Service Health, resource health, Azure Monitor metrics, logs in Log Analytics, and Application Insights.</span></span>

<span data-ttu-id="85a46-140">Дополнительные сведения о мониторинге и диагностике см. в разделе [мониторинг и диагностика](../best-practices/monitoring.md).</span><span class="sxs-lookup"><span data-stu-id="85a46-140">For more information about monitoring and diagnostics, see [Monitoring and diagnostics](../best-practices/monitoring.md).</span></span>

## <a name="health-probes-and-check-functions"></a><span data-ttu-id="85a46-141">Проверки работоспособности и функции проверки</span><span class="sxs-lookup"><span data-stu-id="85a46-141">Health probes and check functions</span></span>

<span data-ttu-id="85a46-142">Работоспособность и производительность приложения может снижаться с течением времени и снижение может быть заметной пока не происходит сбой приложения.</span><span class="sxs-lookup"><span data-stu-id="85a46-142">The health and performance of an application can degrade over time, and degradation might not be noticeable until the application fails.</span></span>

<span data-ttu-id="85a46-143">Реализуйте проверочные или функций проверок и выполняйте их регулярно из вне приложения.</span><span class="sxs-lookup"><span data-stu-id="85a46-143">Implement probes or check functions, and run them regularly from outside the application.</span></span> <span data-ttu-id="85a46-144">Эти проверки может быть просто измерением времени ответа для приложения в целом, для отдельных частей приложения, для определенных служб, используемых приложением или для отдельных компонентов.</span><span class="sxs-lookup"><span data-stu-id="85a46-144">These checks can be as simple as measuring response time for the application as a whole, for individual parts of the application, for specific services that the application uses, or for separate components.</span></span>

<span data-ttu-id="85a46-145">Убедитесь, что функции можно выполнять процессы, чтобы убедиться, что они выдают правильные результаты, измерение задержки и проверка доступности и извлечения информации из системы.</span><span class="sxs-lookup"><span data-stu-id="85a46-145">Check functions can run processes to ensure that they produce valid results, measure latency and check availability, and extract information from the system.</span></span>

## <a name="long-running-workflow-failures"></a><span data-ttu-id="85a46-146">Сбои длительных рабочих процессов</span><span class="sxs-lookup"><span data-stu-id="85a46-146">Long-running workflow failures</span></span>

<span data-ttu-id="85a46-147">Длительно выполняемые рабочие процессы часто включают в себя несколько этапов, каждый из которых должны быть независимыми.</span><span class="sxs-lookup"><span data-stu-id="85a46-147">Long-running workflows often include multiple steps, each of which should be independent.</span></span>

<span data-ttu-id="85a46-148">Отслеживайте ход выполнения длительных рабочих процессов, чтобы свести к минимуму вероятность того, что весь рабочий процесс будет необходимо выполнить откат или что несколько компенсирующих транзакций необходимо выполнить.</span><span class="sxs-lookup"><span data-stu-id="85a46-148">Track the progress of long-running processes to minimize the likelihood that the entire workflow will need to be rolled back or that multiple compensating transactions will need to be executed.</span></span>

>[!TIP]
> <span data-ttu-id="85a46-149">Мониторинг и управление им ход выполнения длительных рабочих процессов, реализовав шаблон, такие как [планировщик, агент, контролер](../patterns/scheduler-agent-supervisor.md).</span><span class="sxs-lookup"><span data-stu-id="85a46-149">Monitor and manage the progress of long-running workflows by implementing a pattern such as [Scheduler Agent Supervisor](../patterns/scheduler-agent-supervisor.md).</span></span>

## <a name="application-logs"></a><span data-ttu-id="85a46-150">Журналы приложений</span><span class="sxs-lookup"><span data-stu-id="85a46-150">Application logs</span></span>

<span data-ttu-id="85a46-151">Журналы приложений являются важным источником данных диагностики.</span><span class="sxs-lookup"><span data-stu-id="85a46-151">Application logs are an important source of diagnostics data.</span></span> <span data-ttu-id="85a46-152">Для получения представления о нужный момент большинство, следуйте рекомендациям по ведению журнала приложения.</span><span class="sxs-lookup"><span data-stu-id="85a46-152">To gain insight when you need it most, follow best practices for application logging.</span></span>

### <a name="log-data-in-the-production-environment"></a><span data-ttu-id="85a46-153">Данные журнала в рабочей среде</span><span class="sxs-lookup"><span data-stu-id="85a46-153">Log data in the production environment</span></span>

<span data-ttu-id="85a46-154">Записывает данные, надежные данные телеметрии, пока приложение выполняется в рабочей среде, поэтому у вас есть достаточно данных для выявления причины возникновения проблем в рабочее состояние.</span><span class="sxs-lookup"><span data-stu-id="85a46-154">Capture robust telemetry data while the application is running in the production environment, so you have sufficient information to diagnose the cause of issues in the production state.</span></span>

### <a name="log-events-at-service-boundaries"></a><span data-ttu-id="85a46-155">События журнала в границах служб</span><span class="sxs-lookup"><span data-stu-id="85a46-155">Log events at service boundaries</span></span>

<span data-ttu-id="85a46-156">Включите идентификатор корреляции в границах служб.</span><span class="sxs-lookup"><span data-stu-id="85a46-156">Include a correlation ID that flows across service boundaries.</span></span> <span data-ttu-id="85a46-157">Если транзакции проходят через несколько служб и из них завершается ошибкой, корреляции, идентификатор помогает отслеживать запросы на приложения и указывает, почему произошел откат транзакции.</span><span class="sxs-lookup"><span data-stu-id="85a46-157">If a transaction flows through multiple services and one of them fails, the correlation ID helps you track requests across your application and pinpoints why the transaction failed.</span></span>

### <a name="use-semantic-structured-logging"></a><span data-ttu-id="85a46-158">Используйте семантическое ведение журнала (структурированные)</span><span class="sxs-lookup"><span data-stu-id="85a46-158">Use semantic (structured) logging</span></span>

<span data-ttu-id="85a46-159">С помощью структурированных журналов проще автоматизацию потребления и анализа данных журнала, что особенно важно в масштабе облака.</span><span class="sxs-lookup"><span data-stu-id="85a46-159">With structured logs, it's easier to automate the consumption and analysis of the log data, which is especially important at cloud scale.</span></span> <span data-ttu-id="85a46-160">Как правило рекомендуется хранить данные метрик и диагностики ресурсов Azure, в рабочей области Log Analytics, а не в учетной записи хранения.</span><span class="sxs-lookup"><span data-stu-id="85a46-160">Generally, we recommend storing Azure resources metrics and diagnostics data in a Log Analytics workspace rather than in a storage account.</span></span> <span data-ttu-id="85a46-161">Таким образом, можно использовать запросов Kusto получить данные, которые вы хотите быстро и в структурированном формате.</span><span class="sxs-lookup"><span data-stu-id="85a46-161">This way, you can use Kusto queries to obtain the data you want quickly and in a structured format.</span></span> <span data-ttu-id="85a46-162">Можно также использовать интерфейсы API Azure Monitor и API-интерфейсы Azure Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="85a46-162">You can also use Azure Monitor APIs and Azure Log Analytics APIs.</span></span>

### <a name="use-asynchronous-logging"></a><span data-ttu-id="85a46-163">Используйте асинхронное ведение журнала</span><span class="sxs-lookup"><span data-stu-id="85a46-163">Use asynchronous logging</span></span>

<span data-ttu-id="85a46-164">Синхронное ведение журнала операций иногда блокировать код приложения, запросов для резервного копирования, которые записываются журналы.</span><span class="sxs-lookup"><span data-stu-id="85a46-164">Synchronous logging operations sometimes block your application code, causing requests to back up as logs are written.</span></span> <span data-ttu-id="85a46-165">Используйте асинхронное ведение журнала для сохранения доступности во время ведения журнала приложения.</span><span class="sxs-lookup"><span data-stu-id="85a46-165">Use asynchronous logging to preserve availability during application logging.</span></span>

### <a name="separate-application-logging-from-auditing"></a><span data-ttu-id="85a46-166">Отдельное приложение ведения журнала аудита</span><span class="sxs-lookup"><span data-stu-id="85a46-166">Separate application logging from auditing</span></span>

<span data-ttu-id="85a46-167">Записи аудита обычно поддерживаются для соответствия требованиям или нормативным требованиям и должен быть завершен.</span><span class="sxs-lookup"><span data-stu-id="85a46-167">Audit records are commonly maintained for compliance or regulatory requirements and must be complete.</span></span> <span data-ttu-id="85a46-168">Чтобы избежать потерянных транзакций, ведение журналов аудита отдельно от журналов диагностики.</span><span class="sxs-lookup"><span data-stu-id="85a46-168">To avoid dropped transactions, maintain audit logs separately from diagnostic logs.</span></span>

## <a name="remote-call-statistics"></a><span data-ttu-id="85a46-169">Статистику удаленных вызовов</span><span class="sxs-lookup"><span data-stu-id="85a46-169">Remote call statistics</span></span>

<span data-ttu-id="85a46-170">Отслеживания и формирования отчетов удаленного вызова статистику в режиме реального времени и предоставляют простой способ просматривать эту информацию, чтобы рабочая группа имеет конкретное представление работоспособности приложения.</span><span class="sxs-lookup"><span data-stu-id="85a46-170">Track and report remote call statistics in real time and provide an easy way to review this information, so the operations team has an instantaneous view into the health of your application.</span></span> <span data-ttu-id="85a46-171">Суммируйте показатели удаленного вызова, такие как задержка, пропускная способность и ошибки в 99 и 95 процентили.</span><span class="sxs-lookup"><span data-stu-id="85a46-171">Summarize remote call metrics, such as latency, throughput, and errors in the 99 and 95 percentiles.</span></span>

## <a name="transient-exceptions-and-retries"></a><span data-ttu-id="85a46-172">Временные исключения и число повторных попыток</span><span class="sxs-lookup"><span data-stu-id="85a46-172">Transient exceptions and retries</span></span>

<span data-ttu-id="85a46-173">Отслеживайте количество временных исключений и повторений некоторое время, чтобы выявить проблемы или сбои в приложении логику повторных попыток.</span><span class="sxs-lookup"><span data-stu-id="85a46-173">Track the number of transient exceptions and retries over time to uncover issues or failures in your application's retry logic.</span></span> <span data-ttu-id="85a46-174">Тенденция увеличения исключений с течением времени может означать, что службы возникла проблема и может завершиться ошибкой.</span><span class="sxs-lookup"><span data-stu-id="85a46-174">A trend of increasing exceptions over time may indicate that the service is having an issue and may fail.</span></span> <span data-ttu-id="85a46-175">Дополнительные сведения см. в статье [Конкретные рекомендации по использованию механизма повторов](../best-practices/retry-service-specific.md).</span><span class="sxs-lookup"><span data-stu-id="85a46-175">For more information, see [Retry service specific guidance](../best-practices/retry-service-specific.md).</span></span>

## <a name="early-warning-system"></a><span data-ttu-id="85a46-176">Систему раннего предупреждения</span><span class="sxs-lookup"><span data-stu-id="85a46-176">Early warning system</span></span>

<span data-ttu-id="85a46-177">Мониторинг приложения для признаков, которые могут потребовать активного вмешательства.</span><span class="sxs-lookup"><span data-stu-id="85a46-177">Monitor your application for warning signs that might require proactive intervention.</span></span> <span data-ttu-id="85a46-178">Средства, которые оценки общей работоспособности приложения и его зависимости помогут вам быстро распознавать, когда системе или его компоненты внезапно становятся недоступными.</span><span class="sxs-lookup"><span data-stu-id="85a46-178">Tools that assess the overall health of the application and its dependencies help you to recognize quickly when a system or its components suddenly become unavailable.</span></span> <span data-ttu-id="85a46-179">Используйте их, чтобы реализовать систему раннего предупреждения.</span><span class="sxs-lookup"><span data-stu-id="85a46-179">Use them to implement an early warning system.</span></span>

1. <span data-ttu-id="85a46-180">Определите ключевые показатели эффективности по работоспособности приложений, таких как временные исключения и задержка удаленного вызова.</span><span class="sxs-lookup"><span data-stu-id="85a46-180">Identify the key performance indicators of your application's health, such as transient exceptions and remote call latency.</span></span>
1. <span data-ttu-id="85a46-181">Установить пороговые значения на уровнях, которые идентифицируют проблемы, прежде чем они станут критическими и потребуют мер восстановления.</span><span class="sxs-lookup"><span data-stu-id="85a46-181">Set thresholds at levels that identify issues before they become critical and require a recovery response.</span></span>
1. <span data-ttu-id="85a46-182">Отправьте оповещение операциям при достижении порогового значения.</span><span class="sxs-lookup"><span data-stu-id="85a46-182">Send an alert to operations when the threshold value is reached.</span></span>

<span data-ttu-id="85a46-183">Рассмотрите возможность [Microsoft System Center 2016](https://www.microsoft.com/cloud-platform/system-center) или сторонних средств для обеспечения возможности мониторинга.</span><span class="sxs-lookup"><span data-stu-id="85a46-183">Consider [Microsoft System Center 2016](https://www.microsoft.com/cloud-platform/system-center) or third-party tools to provide monitoring capabilities.</span></span> <span data-ttu-id="85a46-184">Большинство решений мониторинга отслеживают основные счетчики производительности, а также доступность службы.</span><span class="sxs-lookup"><span data-stu-id="85a46-184">Most monitoring solutions track key performance counters and service availability.</span></span> <span data-ttu-id="85a46-185">[Служба работоспособности ресурсов Azure](/azure/service-health/resource-health-checks-resource-types) предоставляет некоторые встроенные работоспособности проверки состояния, которые могут помочь диагностировать регулирования служб Azure.</span><span class="sxs-lookup"><span data-stu-id="85a46-185">[Azure resource health](/azure/service-health/resource-health-checks-resource-types) provides some built-in health status checks, which can help diagnose throttling of Azure services.</span></span>

## <a name="subscription-and-service-limitations"></a><span data-ttu-id="85a46-186">Ограничения подписки и службы</span><span class="sxs-lookup"><span data-stu-id="85a46-186">Subscription and service limitations</span></span>

<span data-ttu-id="85a46-187">Подписках Azure предусмотрены ограничения на определенные типы ресурсов, таких как количество групп ресурсов, ядер и учетные записи хранения.</span><span class="sxs-lookup"><span data-stu-id="85a46-187">Azure subscriptions have limits on certain resource types, such as number of resource groups, cores, and storage accounts.</span></span> <span data-ttu-id="85a46-188">Чтобы убедиться, что приложение не приходится сталкиваться ограничения подписки Azure, создайте оповещения, опрос для служб, близко к их ограничения и квоты.</span><span class="sxs-lookup"><span data-stu-id="85a46-188">To ensure that your application doesn't run up against Azure subscription limits, create alerts that poll for services nearing their limits and quotas.</span></span>

<span data-ttu-id="85a46-189">Устраните следующие ограничения подписки с предупреждениями.</span><span class="sxs-lookup"><span data-stu-id="85a46-189">Address the following subscription limits with alerts.</span></span>

### <a name="individual-services"></a><span data-ttu-id="85a46-190">Отдельные службы</span><span class="sxs-lookup"><span data-stu-id="85a46-190">Individual services</span></span>

<span data-ttu-id="85a46-191">Отдельные службы Azure имеют ограничения на использование хранилища, пропускной способности, число подключений, запросов в секунду и другие показатели.</span><span class="sxs-lookup"><span data-stu-id="85a46-191">Individual Azure services have consumption limits on storage, throughput, number of connections, requests per second, and other metrics.</span></span> <span data-ttu-id="85a46-192">Приложение не будет работать, если предпринимается попытка использовать ресурсы за пределами этих ограничений, приведет к простоям регулирования и возможных службы.</span><span class="sxs-lookup"><span data-stu-id="85a46-192">Your application will fail if it attempts to use resources beyond these limits, resulting in service throttling and possible downtime.</span></span>

<span data-ttu-id="85a46-193">В зависимости от конкретной службы и требований приложения можно часто превышают эти ограничения масштабирования (например, выбора другого уровня цен,) или горизонтального масштабирования (добавления новых экземпляров).</span><span class="sxs-lookup"><span data-stu-id="85a46-193">Depending on the specific service and your application requirements, you can often stay under these limits by scaling up (choosing another pricing tier, for example) or scaling out (adding new instances).</span></span>

### <a name="azure-storage-scalability-and-performance-targets"></a><span data-ttu-id="85a46-194">Целевые показатели масштабируемости и производительности хранилища Azure</span><span class="sxs-lookup"><span data-stu-id="85a46-194">Azure storage scalability and performance targets</span></span>

<span data-ttu-id="85a46-195">Azure позволяет максимальное количество учетных записей для подписки.</span><span class="sxs-lookup"><span data-stu-id="85a46-195">Azure allows a maximum number of storage accounts per subscription.</span></span> <span data-ttu-id="85a46-196">Если приложению требуется несколько учетных записей, чем в настоящее время доступны в вашей подписке, создайте новую подписку с помощью дополнительных учетных записей хранения.</span><span class="sxs-lookup"><span data-stu-id="85a46-196">If your application requires more storage accounts than are currently available in your subscription, create a new subscription with additional storage accounts.</span></span> <span data-ttu-id="85a46-197">Дополнительные сведения см. в статье [Подписка Azure, границы, квоты и ограничения службы](/azure/azure-subscription-service-limits/#storage-limits).</span><span class="sxs-lookup"><span data-stu-id="85a46-197">For more information, see [Azure subscription and service limits, quotas, and constraints](/azure/azure-subscription-service-limits/#storage-limits).</span></span>

<span data-ttu-id="85a46-198">Если вы превысите целевые показатели масштабируемости и производительности хранилища Azure, приложение будет отрегулировать хранилища.</span><span class="sxs-lookup"><span data-stu-id="85a46-198">If you exceed Azure storage scalability and performance targets, your application will experience storage throttling.</span></span> <span data-ttu-id="85a46-199">Дополнительные сведения см. в статье [Целевые показатели масштабируемости и производительности службы хранилища Azure](/azure/storage/storage-scalability-targets/).</span><span class="sxs-lookup"><span data-stu-id="85a46-199">For more information, see [Azure Storage scalability and performance targets](/azure/storage/storage-scalability-targets/).</span></span>

### <a name="scalability-targets-for-virtual-machine-disks"></a><span data-ttu-id="85a46-200">Целевые показатели масштабируемости для дисков виртуальной машины</span><span class="sxs-lookup"><span data-stu-id="85a46-200">Scalability targets for virtual machine disks</span></span>

<span data-ttu-id="85a46-201">Инфраструктуры как услуги (IaaS) виртуальной Машины Azure поддерживают подключение нескольких дисков данных, в зависимости от нескольких факторов, включая размер виртуальной Машины и тип учетной записи хранения.</span><span class="sxs-lookup"><span data-stu-id="85a46-201">An Azure infrastructure as a service (IaaS) VM supports attaching a number of data disks, depending on several factors, including the VM size and the type of storage account.</span></span> <span data-ttu-id="85a46-202">Если приложение превышает целевые показатели масштабируемости для дисков виртуальных машин, подготовьте дополнительные учетные записи хранения и создайте в них виртуальные диски.</span><span class="sxs-lookup"><span data-stu-id="85a46-202">If your application exceeds the scalability targets for virtual machine disks, provision additional storage accounts and create the virtual machine disks there.</span></span> <span data-ttu-id="85a46-203">Дополнительные сведения см. в статье [Целевые показатели масштабируемости и производительности службы хранилища Azure](/azure/storage/storage-scalability-targets/#scalability-targets-for-virtual-machine-disks).</span><span class="sxs-lookup"><span data-stu-id="85a46-203">For more information, see [Azure Storage scalability and performance targets](/azure/storage/storage-scalability-targets/#scalability-targets-for-virtual-machine-disks).</span></span>

### <a name="vm-size"></a><span data-ttu-id="85a46-204">Размер виртуальной машины</span><span class="sxs-lookup"><span data-stu-id="85a46-204">VM size</span></span>

<span data-ttu-id="85a46-205">Фактическое ЦП, памяти, диска и ввода-вывода ваших виртуальных машин ограничениям размера виртуальной Машины, ваше приложение может испытывать проблем с емкостью.</span><span class="sxs-lookup"><span data-stu-id="85a46-205">If the actual CPU, memory, disk, and I/O of your VMs approach the limits of the VM size, your application may experience capacity issues.</span></span> <span data-ttu-id="85a46-206">Для устранения проблем, увеличьте размер виртуальной Машины.</span><span class="sxs-lookup"><span data-stu-id="85a46-206">To correct the issues, increase the VM size.</span></span> <span data-ttu-id="85a46-207">Размеры виртуальных Машин описаны в [размеры виртуальных машин в Azure](/azure/virtual-machines/virtual-machines-windows-sizes/?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="85a46-207">VM sizes are described in [Sizes for virtual machines in Azure](/azure/virtual-machines/virtual-machines-windows-sizes/?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span></span>

<span data-ttu-id="85a46-208">Если рабочая нагрузка постоянно изменяется со временем, рассмотрите возможность с помощью масштабирования виртуальных машин задает автоматически масштабировать количество экземпляров виртуальных Машин.</span><span class="sxs-lookup"><span data-stu-id="85a46-208">If your workload fluctuates over time, consider using virtual machine scale sets to automatically scale the number of VM instances.</span></span> <span data-ttu-id="85a46-209">В противном случае необходимо вручную увеличить или уменьшить число виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="85a46-209">Otherwise, you need to manually increase or decrease the number of VMs.</span></span> <span data-ttu-id="85a46-210">Дополнительные сведения см. в разделе [Обзор масштабируемых наборов виртуальных машин](/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-overview/).</span><span class="sxs-lookup"><span data-stu-id="85a46-210">For more information, see the [virtual machine scale sets overview](/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-overview/).</span></span>

### <a name="azure-sql-database"></a><span data-ttu-id="85a46-211">Базы данных SQL Azure</span><span class="sxs-lookup"><span data-stu-id="85a46-211">Azure SQL Database</span></span>

<span data-ttu-id="85a46-212">Если уровень базы данных SQL Azure не достаточно удовлетворить требования приложения единицы транзакций базы данных (DTU), использование данных будет регулироваться.</span><span class="sxs-lookup"><span data-stu-id="85a46-212">If your Azure SQL Database tier isn't adequate to handle your application's Database Transaction Unit (DTU) requirements, your data use will be throttled.</span></span> <span data-ttu-id="85a46-213">Дополнительные сведения о выборе правильного плана обслуживания, см. в разделе [базы данных SQL Azure, приобретение моделей](/azure/sql-database/sql-database-service-tiers/).</span><span class="sxs-lookup"><span data-stu-id="85a46-213">For more information on selecting the correct service plan, see [Azure SQL Database purchasing models](/azure/sql-database/sql-database-service-tiers/).</span></span>

## <a name="third-party-services"></a><span data-ttu-id="85a46-214">Сторонние службы</span><span class="sxs-lookup"><span data-stu-id="85a46-214">Third-party services</span></span>

<span data-ttu-id="85a46-215">Если приложение имеет зависимости от сторонних служб, определите, как эти службы может произойти сбой, и сбоев эффект будет иметь на приложение.</span><span class="sxs-lookup"><span data-stu-id="85a46-215">If your application has dependencies on third-party services, identify how these services can fail and what effect failures will have on your application.</span></span>

<span data-ttu-id="85a46-216">Сторонняя служба могут не включать мониторинга и диагностики.</span><span class="sxs-lookup"><span data-stu-id="85a46-216">A third-party service might not include monitoring and diagnostics.</span></span> <span data-ttu-id="85a46-217">Журнал вызовов этих служб и сопоставлять их с работоспособности и ведение журналов диагностики с использованием уникального идентификатора приложения.</span><span class="sxs-lookup"><span data-stu-id="85a46-217">Log calls to these services and correlate them with your application's health and diagnostic logging using a unique identifier.</span></span> <span data-ttu-id="85a46-218">Дополнительные сведения о методиках мониторинга и диагностики см. в разделе [руководство по мониторингу и диагностике](../best-practices/monitoring.md).</span><span class="sxs-lookup"><span data-stu-id="85a46-218">For more information on proven practices for monitoring and diagnostics, see [Monitoring and diagnostics guidance](../best-practices/monitoring.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="85a46-219">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="85a46-219">Next steps</span></span>

> [!div class="nextstepaction"]
> [<span data-ttu-id="85a46-220">План аварийного восстановления</span><span class="sxs-lookup"><span data-stu-id="85a46-220">Plan for disaster recovery</span></span>](./disaster-recovery.md)
