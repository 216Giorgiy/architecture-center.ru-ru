---
title: Определение требований для устойчивых приложений Azure
description: Обзор сбора требований доступности и устойчивости для приложений Azure
author: MikeWasson
ms.date: 04/10/2019
ms.topic: article
ms.service: architecture-center
ms.subservice: cloud-design-principles
ms.openlocfilehash: 2af2ce4200c285abfda1395862d21efc3c17e577
ms.sourcegitcommit: 579c39ff4b776704ead17a006bf24cd4cdc65edd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59646633"
---
# <a name="developing-requirements-for-resilient-azure-applications"></a><span data-ttu-id="d1eab-103">Разработка требований для устойчивых приложений Azure</span><span class="sxs-lookup"><span data-stu-id="d1eab-103">Developing requirements for resilient Azure applications</span></span>

<span data-ttu-id="d1eab-104">Построение *устойчивости* (восстановление после сбоев) и *доступности* (запущенного в работоспособном состоянии без значительного увеличения времени простоя) в приложения начинается с сбора требований.</span><span class="sxs-lookup"><span data-stu-id="d1eab-104">Building *resiliency* (recovering from failures) and *availability* (running in a healthy state without significant downtime) into your apps begins with gathering requirements.</span></span> <span data-ttu-id="d1eab-105">Например какое время простоя приемлемо?</span><span class="sxs-lookup"><span data-stu-id="d1eab-105">For example, how much downtime is acceptable?</span></span> <span data-ttu-id="d1eab-106">Сколько стоит потенциального простоя вашего бизнеса?</span><span class="sxs-lookup"><span data-stu-id="d1eab-106">How much does potential downtime cost your business?</span></span> <span data-ttu-id="d1eab-107">Каковы требования к доступности ваших клиентов?</span><span class="sxs-lookup"><span data-stu-id="d1eab-107">What are your customer's availability requirements?</span></span> <span data-ttu-id="d1eab-108">Сколько вы инвестировать в создание приложения высокой доступности?</span><span class="sxs-lookup"><span data-stu-id="d1eab-108">How much do you invest in making your application highly available?</span></span> <span data-ttu-id="d1eab-109">Что такое риск и затраты?</span><span class="sxs-lookup"><span data-stu-id="d1eab-109">What is the risk versus the cost?</span></span>

## <a name="identify-distinct-workloads"></a><span data-ttu-id="d1eab-110">Определение различных рабочих нагрузок</span><span class="sxs-lookup"><span data-stu-id="d1eab-110">Identify distinct workloads</span></span>

<span data-ttu-id="d1eab-111">Облачные решения обычно состоят из нескольких приложений *рабочих нагрузок*.</span><span class="sxs-lookup"><span data-stu-id="d1eab-111">Cloud solutions typically consist of multiple application *workloads*.</span></span> <span data-ttu-id="d1eab-112">Рабочая нагрузка представляет уникальных возможностей или задачу, которая логически отделена от других задач с точки зрения бизнес-логику и данные хранилища требований.</span><span class="sxs-lookup"><span data-stu-id="d1eab-112">A workload is a distinct capability or task that is logically separated from other tasks in terms of business logic and data storage requirements.</span></span> <span data-ttu-id="d1eab-113">Например приложение электронной коммерции может иметь следующие рабочие нагрузки:</span><span class="sxs-lookup"><span data-stu-id="d1eab-113">For example, an e-commerce app might have the following workloads:</span></span>

- <span data-ttu-id="d1eab-114">просмотр и поиск в каталоге продукции;</span><span class="sxs-lookup"><span data-stu-id="d1eab-114">Browse and search a product catalog.</span></span>
- <span data-ttu-id="d1eab-115">создание и отслеживание заказов;</span><span class="sxs-lookup"><span data-stu-id="d1eab-115">Create and track orders.</span></span>
- <span data-ttu-id="d1eab-116">просмотр рекомендаций.</span><span class="sxs-lookup"><span data-stu-id="d1eab-116">View recommendations.</span></span>

<span data-ttu-id="d1eab-117">Каждая рабочая нагрузка имеет различные требования к доступности, масштабируемости, согласованности данных и аварийного восстановления.</span><span class="sxs-lookup"><span data-stu-id="d1eab-117">Each workload has different requirements for availability, scalability, data consistency, and disaster recovery.</span></span> <span data-ttu-id="d1eab-118">Сделать бизнес-решений, балансировки затраты и риски для каждой рабочей нагрузки.</span><span class="sxs-lookup"><span data-stu-id="d1eab-118">Make your business decisions by balancing cost versus risk for each workload.</span></span>

<span data-ttu-id="d1eab-119">Кроме того, разделяйте рабочие нагрузки, цель уровня обслуживания.</span><span class="sxs-lookup"><span data-stu-id="d1eab-119">Also decompose workloads by service-level objective.</span></span> <span data-ttu-id="d1eab-120">Если служба состоит из важных и менее важных рабочих нагрузок, управления ими по-разному и укажите функции службы и число экземпляров, необходимый для соблюдения требований к доступности.</span><span class="sxs-lookup"><span data-stu-id="d1eab-120">If a service is composed of critical and less-critical workloads, manage them differently and specify the service features and number of instances needed to meet their availability requirements.</span></span>

## <a name="plan-for-usage-patterns"></a><span data-ttu-id="d1eab-121">План для шаблонов использования</span><span class="sxs-lookup"><span data-stu-id="d1eab-121">Plan for usage patterns</span></span>

<span data-ttu-id="d1eab-122">Выявление различий в требованиях критических и некритических периоды.</span><span class="sxs-lookup"><span data-stu-id="d1eab-122">Identify differences in requirements during critical and non-critical periods.</span></span> <span data-ttu-id="d1eab-123">Существуют ли определенные критические периоды, когда система должна быть доступной?</span><span class="sxs-lookup"><span data-stu-id="d1eab-123">Are there certain critical periods when the system must be available?</span></span> <span data-ttu-id="d1eab-124">Например приложение заполнения налоговых деклараций не может завершиться ошибкой во время крайним сроком их подачи и служба потоковой передачи видео не следует запаздывания во время события прямой трансляции.</span><span class="sxs-lookup"><span data-stu-id="d1eab-124">For example, a tax-filing application can't fail during a filing deadline and a video streaming service shouldn't lag during a live event.</span></span> <span data-ttu-id="d1eab-125">В таких ситуациях взвесить издержки с риском.</span><span class="sxs-lookup"><span data-stu-id="d1eab-125">In these situations, weigh the cost against the risk.</span></span>

- <span data-ttu-id="d1eab-126">Для обеспечения бесперебойной работы и удовлетворения соглашение об уровне обслуживания (SLA) в критические периоды, планировать избыточность в нескольких регионах в случае сбоя одного, даже если он стоит дороже.</span><span class="sxs-lookup"><span data-stu-id="d1eab-126">To ensure uptime and meet service-level agreements (SLAs) in critical periods, plan redundancy across several regions in case one fails, even if it costs more.</span></span>
- <span data-ttu-id="d1eab-127">И наоборот некритические периоды, запустите приложение в одном регионе, чтобы свести к минимуму затраты.</span><span class="sxs-lookup"><span data-stu-id="d1eab-127">Conversely, during non-critical periods, run your application in a single region to minimize costs.</span></span>
- <span data-ttu-id="d1eab-128">В некоторых случаях можно избежать дополнительных расходов, с помощью современных бессерверных методов, имеющих выставления счетов на основе потребления.</span><span class="sxs-lookup"><span data-stu-id="d1eab-128">In some cases, you can mitigate additional expenses by using modern serverless techniques that have consumption-based billing.</span></span>

## <a name="establish-availability-and-recovery-metrics"></a><span data-ttu-id="d1eab-129">Установить показатели доступности и восстановления</span><span class="sxs-lookup"><span data-stu-id="d1eab-129">Establish availability and recovery metrics</span></span>

<span data-ttu-id="d1eab-130">Создание исходных значений для двух наборов метрик как часть процесса требования.</span><span class="sxs-lookup"><span data-stu-id="d1eab-130">Create baseline numbers for two sets of metrics as part of the requirements process.</span></span> <span data-ttu-id="d1eab-131">Первый набор поможет вам определить место добавления избыточность для облачных служб и какие соглашения об уровне обслуживания для обеспечения для клиентов.</span><span class="sxs-lookup"><span data-stu-id="d1eab-131">The first set helps you determine where to add redundancy to cloud services and which SLAs to provide to customers.</span></span> <span data-ttu-id="d1eab-132">Второй набор поможет при планировании аварийного восстановления.</span><span class="sxs-lookup"><span data-stu-id="d1eab-132">The second set helps you plan your disaster recovery.</span></span>

### <a name="availability-metrics"></a><span data-ttu-id="d1eab-133">Метрики доступности</span><span class="sxs-lookup"><span data-stu-id="d1eab-133">Availability metrics</span></span>

<span data-ttu-id="d1eab-134">Эти меры можно используйте для планирования для обеспечения избыточности и определить соглашения об уровне обслуживания клиентов.</span><span class="sxs-lookup"><span data-stu-id="d1eab-134">Use these measures to plan for redundancy and determine customer SLAs.</span></span>

- <span data-ttu-id="d1eab-135">**Среднее время восстановления (MTTR)** среднее время, необходимое для восстановления после сбоя компонента.</span><span class="sxs-lookup"><span data-stu-id="d1eab-135">**Mean time to recover (MTTR)** is the average time it takes to restore a component after a failure.</span></span>
- <span data-ttu-id="d1eab-136">**Среднее время между сбоев (MTBF)** , как долго компонент может рассчитывать на длительный период между простоев.</span><span class="sxs-lookup"><span data-stu-id="d1eab-136">**Mean time between failures (MTBF)** is the how long a component can reasonably expect to last between outages.</span></span>

### <a name="recovery-metrics"></a><span data-ttu-id="d1eab-137">Метрики восстановления</span><span class="sxs-lookup"><span data-stu-id="d1eab-137">Recovery metrics</span></span>

<span data-ttu-id="d1eab-138">Получение этих значений с Проведение оценки риска и убедитесь, что вы понимаете, стоимость и риск простоя и потерю данных.</span><span class="sxs-lookup"><span data-stu-id="d1eab-138">Derive these values by conducting a risk assessment, and make sure you understand the cost and risk of downtime and data loss.</span></span> <span data-ttu-id="d1eab-139">Это нефункциональные требования системы и зависит от бизнес-требований.</span><span class="sxs-lookup"><span data-stu-id="d1eab-139">These are nonfunctional requirements of a system and should be dictated by business requirements.</span></span>

- <span data-ttu-id="d1eab-140">**Время восстановления (RTO)** — это максимальное время допустимо, приложение недоступно после инцидента.</span><span class="sxs-lookup"><span data-stu-id="d1eab-140">**Recovery time objective (RTO)** is the maximum acceptable time an application is unavailable after an incident.</span></span>
- <span data-ttu-id="d1eab-141">**Точки восстановления (RPO)** — это максимальная продолжительность потери данных, которая является приемлемой во время аварии.</span><span class="sxs-lookup"><span data-stu-id="d1eab-141">**Recovery point objective (RPO)** is the maximum duration of data loss that's acceptable during a disaster.</span></span>

<span data-ttu-id="d1eab-142">Если значение MTTR *любой* наиболее важным компонентом в настройки с высокой доступностью превышает RTO система, сбой в системе может привести к неприемлемой бизнес-процессов.</span><span class="sxs-lookup"><span data-stu-id="d1eab-142">If the MTTR value of *any* critical component in a highly available setup exceeds the system RTO, a failure in the system might cause an unacceptable business disruption.</span></span> <span data-ttu-id="d1eab-143">То есть нельзя восстановить систему в пределах определенного RTO.</span><span class="sxs-lookup"><span data-stu-id="d1eab-143">That is, you can't restore the system within the defined RTO.</span></span>

## <a name="determine-workload-availability-targets"></a><span data-ttu-id="d1eab-144">Определение целевых показателей доступности рабочей нагрузки</span><span class="sxs-lookup"><span data-stu-id="d1eab-144">Determine workload availability targets</span></span>

<span data-ttu-id="d1eab-145">Определите свои собственные целевые соглашения об уровне обслуживания для каждой рабочей нагрузки в решении, чтобы можно было определить, соответствует ли архитектура бизнес-требования.</span><span class="sxs-lookup"><span data-stu-id="d1eab-145">Define your own target SLAs for each workload in your solution so you can determine whether the architecture meets the business requirements.</span></span>

### <a name="consider-cost-and-complexity"></a><span data-ttu-id="d1eab-146">Учитывать стоимость и сложность</span><span class="sxs-lookup"><span data-stu-id="d1eab-146">Consider cost and complexity</span></span>

<span data-ttu-id="d1eab-147">Равных, более высокая доступность лучше.</span><span class="sxs-lookup"><span data-stu-id="d1eab-147">Everything else being equal, higher availability is better.</span></span> <span data-ttu-id="d1eab-148">Однако как вы стремитесь к дополнительные девятки, стоимость и сложность увеличиваться.</span><span class="sxs-lookup"><span data-stu-id="d1eab-148">But as you strive for more nines, the cost and complexity grow.</span></span> <span data-ttu-id="d1eab-149">Время непрерывной работы 99,99% преобразуется около пяти минут общее время простоя в месяц.</span><span class="sxs-lookup"><span data-stu-id="d1eab-149">An uptime of 99.99% translates to about five minutes of total downtime per month.</span></span> <span data-ttu-id="d1eab-150">Стоит ли дополнительную сложность и стоимость для достижения 99,999%?</span><span class="sxs-lookup"><span data-stu-id="d1eab-150">Is it worth the additional complexity and cost to reach five nines?</span></span> <span data-ttu-id="d1eab-151">Ответ зависит от бизнес-требований.</span><span class="sxs-lookup"><span data-stu-id="d1eab-151">The answer depends on the business requirements.</span></span>

<span data-ttu-id="d1eab-152">Ниже приведены некоторые рекомендации по выбору SLA:</span><span class="sxs-lookup"><span data-stu-id="d1eab-152">Here are some other considerations when defining an SLA:</span></span>

- <span data-ttu-id="d1eab-153">Чтобы добиться четыре девятки (99,99%), нельзя полагаться на ручное вмешательство для восстановления после сбоев.</span><span class="sxs-lookup"><span data-stu-id="d1eab-153">To achieve four nines (99.99%), you can't rely on manual intervention to recover from failures.</span></span> <span data-ttu-id="d1eab-154">Приложение должно иметь возможности самостоятельной диагностики и самовосстановления.</span><span class="sxs-lookup"><span data-stu-id="d1eab-154">The application must be self-diagnosing and self-healing.</span></span>
- <span data-ttu-id="d1eab-155">За четыре девятки сложно обнаружении сбоев достаточно быстро, в соответствии с соглашением об уровне ОБСЛУЖИВАНИЯ.</span><span class="sxs-lookup"><span data-stu-id="d1eab-155">Beyond four nines, it's challenging to detect outages quickly enough to meet the SLA.</span></span>
- <span data-ttu-id="d1eab-156">Подумайте о временном окне, для которого измеряется SLA.</span><span class="sxs-lookup"><span data-stu-id="d1eab-156">Think about the time window that your SLA is measured against.</span></span> <span data-ttu-id="d1eab-157">Чем меньше окно, тем строже допуски.</span><span class="sxs-lookup"><span data-stu-id="d1eab-157">The smaller the window, the tighter the tolerances.</span></span> <span data-ttu-id="d1eab-158">Нет смысла определять SLA с точки зрения ежечасного или ежедневного времени работы.</span><span class="sxs-lookup"><span data-stu-id="d1eab-158">It doesn't make sense to define your SLA in terms of hourly or daily uptime.</span></span>
- <span data-ttu-id="d1eab-159">Проанализируйте результаты измерений MTBF и MTTR.</span><span class="sxs-lookup"><span data-stu-id="d1eab-159">Consider the MTBF and MTTR measurements.</span></span> <span data-ttu-id="d1eab-160">Чем выше уровень ОБСЛУЖИВАНИЯ, тем реже службы можно перейти и более быстрые необходимо восстановить службу.</span><span class="sxs-lookup"><span data-stu-id="d1eab-160">The higher your SLA, the less frequently the service can go down and the quicker the service must recover.</span></span>
- <span data-ttu-id="d1eab-161">Получить соглашение о заказчиках для целевых показателей доступности каждой части приложения и ее следует задокументировать.</span><span class="sxs-lookup"><span data-stu-id="d1eab-161">Get agreement from your customers for the availability targets of each piece of your application, and document it.</span></span> <span data-ttu-id="d1eab-162">В противном случае ваш проект может не соответствовать ожиданиям клиентов.</span><span class="sxs-lookup"><span data-stu-id="d1eab-162">Otherwise, your design may not meet the customers' expectations.</span></span>

### <a name="identify-dependencies"></a><span data-ttu-id="d1eab-163">Определить зависимости</span><span class="sxs-lookup"><span data-stu-id="d1eab-163">Identify dependencies</span></span>

<span data-ttu-id="d1eab-164">Выполните упражнения сопоставление зависимостей для определения внутренних и внешних зависимостях.</span><span class="sxs-lookup"><span data-stu-id="d1eab-164">Perform dependency-mapping exercises to identify internal and external dependencies.</span></span> <span data-ttu-id="d1eab-165">Примеры включают зависимости, относящиеся к безопасности или удостоверение, например Active Directory или сторонних служб, таких как поставщика платежных услуг или электронной почты службы обмена сообщениями.</span><span class="sxs-lookup"><span data-stu-id="d1eab-165">Examples include dependencies relating to security or identity, such as Active Directory, or third-party services such as a payment provider or e-mail messaging service.</span></span>

<span data-ttu-id="d1eab-166">Обратите особое внимание на внешние зависимости, которые могут представлять собой единую точку отказа или узких мест.</span><span class="sxs-lookup"><span data-stu-id="d1eab-166">Pay particular attention to external dependencies that might be a single point of failure or cause bottlenecks.</span></span> <span data-ttu-id="d1eab-167">Если рабочей нагрузки требуется 99,99%, но зависит от службы с 99,9% времени, эта служба не может быть единой точкой отказа в системе.</span><span class="sxs-lookup"><span data-stu-id="d1eab-167">If a workload requires 99.99% uptime but depends on a service with a 99.9% SLA, that service can't be a single point of failure in the system.</span></span> <span data-ttu-id="d1eab-168">Одним из средств защиты является наличие резервного пути в случае сбоя службы.</span><span class="sxs-lookup"><span data-stu-id="d1eab-168">One remedy is to have a fallback path in case the service fails.</span></span> <span data-ttu-id="d1eab-169">Кроме того можно принять другие меры для восстановления после сбоя в этой службе.</span><span class="sxs-lookup"><span data-stu-id="d1eab-169">Alternatively, take other measures to recover from a failure in that service.</span></span>

<span data-ttu-id="d1eab-170">В следующей таблице показано потенциальное суммарное время простоя для различных уровней SLA.</span><span class="sxs-lookup"><span data-stu-id="d1eab-170">The following table shows the potential cumulative downtime for various SLA levels.</span></span>

| <span data-ttu-id="d1eab-171">**Соглашение об уровне обслуживания**</span><span class="sxs-lookup"><span data-stu-id="d1eab-171">**SLA**</span></span> | <span data-ttu-id="d1eab-172">**Время простоя в неделю**</span><span class="sxs-lookup"><span data-stu-id="d1eab-172">**Downtime per week**</span></span> | <span data-ttu-id="d1eab-173">**Время простоя в месяц**</span><span class="sxs-lookup"><span data-stu-id="d1eab-173">**Downtime per month**</span></span> | <span data-ttu-id="d1eab-174">**Время простоя в год**</span><span class="sxs-lookup"><span data-stu-id="d1eab-174">**Downtime per year**</span></span> |
|---------|-----------------------|------------------------|-----------------------|
| <span data-ttu-id="d1eab-175">99 %</span><span class="sxs-lookup"><span data-stu-id="d1eab-175">99%</span></span>     | <span data-ttu-id="d1eab-176">1,68 часа</span><span class="sxs-lookup"><span data-stu-id="d1eab-176">1.68 hours</span></span>            | <span data-ttu-id="d1eab-177">7,2 часа</span><span class="sxs-lookup"><span data-stu-id="d1eab-177">7.2 hours</span></span>              | <span data-ttu-id="d1eab-178">3,65 дня</span><span class="sxs-lookup"><span data-stu-id="d1eab-178">3.65 days</span></span>             |
| <span data-ttu-id="d1eab-179">99,9 %</span><span class="sxs-lookup"><span data-stu-id="d1eab-179">99.9%</span></span>   | <span data-ttu-id="d1eab-180">10,1 минуты</span><span class="sxs-lookup"><span data-stu-id="d1eab-180">10.1 minutes</span></span>          | <span data-ttu-id="d1eab-181">43,2 мин</span><span class="sxs-lookup"><span data-stu-id="d1eab-181">43.2 minutes</span></span>           | <span data-ttu-id="d1eab-182">8,76 часа</span><span class="sxs-lookup"><span data-stu-id="d1eab-182">8.76 hours</span></span>            |
| <span data-ttu-id="d1eab-183">99,95 %</span><span class="sxs-lookup"><span data-stu-id="d1eab-183">99.95%</span></span>  | <span data-ttu-id="d1eab-184">5 мин</span><span class="sxs-lookup"><span data-stu-id="d1eab-184">5 minutes</span></span>             | <span data-ttu-id="d1eab-185">21,6 мин</span><span class="sxs-lookup"><span data-stu-id="d1eab-185">21.6 minutes</span></span>           | <span data-ttu-id="d1eab-186">4,38 часа</span><span class="sxs-lookup"><span data-stu-id="d1eab-186">4.38 hours</span></span>            |
| <span data-ttu-id="d1eab-187">99,99 %</span><span class="sxs-lookup"><span data-stu-id="d1eab-187">99.99%</span></span>  | <span data-ttu-id="d1eab-188">1,01 минуты</span><span class="sxs-lookup"><span data-stu-id="d1eab-188">1.01 minutes</span></span>          | <span data-ttu-id="d1eab-189">4,32 минуты</span><span class="sxs-lookup"><span data-stu-id="d1eab-189">4.32 minutes</span></span>           | <span data-ttu-id="d1eab-190">52,56 минуты</span><span class="sxs-lookup"><span data-stu-id="d1eab-190">52.56 minutes</span></span>         |
| <span data-ttu-id="d1eab-191">99,999 %</span><span class="sxs-lookup"><span data-stu-id="d1eab-191">99.999%</span></span> | <span data-ttu-id="d1eab-192">6 секунд</span><span class="sxs-lookup"><span data-stu-id="d1eab-192">6 seconds</span></span>             | <span data-ttu-id="d1eab-193">25,9 секунды</span><span class="sxs-lookup"><span data-stu-id="d1eab-193">25.9 seconds</span></span>           | <span data-ttu-id="d1eab-194">5,26 минуты</span><span class="sxs-lookup"><span data-stu-id="d1eab-194">5.26 minutes</span></span>          |

## <a name="understand-service-level-agreements"></a><span data-ttu-id="d1eab-195">Понять, соглашение об уровне обслуживания</span><span class="sxs-lookup"><span data-stu-id="d1eab-195">Understand service-level agreements</span></span>

<span data-ttu-id="d1eab-196">В Azure [соглашение об уровне обслуживания](https://azure.microsoft.com/en-us/support/legal/sla/) описываются обязательства корпорации Майкрософт в отношении доступности и подключения.</span><span class="sxs-lookup"><span data-stu-id="d1eab-196">In Azure, the [Service Level Agreement](https://azure.microsoft.com/en-us/support/legal/sla/) describes Microsoft's commitments for uptime and connectivity.</span></span> <span data-ttu-id="d1eab-197">Если соглашение об уровне ОБСЛУЖИВАНИЯ для конкретной службы составляет 99,9%, следует ожидать, служба будет доступна 99,9% времени.</span><span class="sxs-lookup"><span data-stu-id="d1eab-197">If the SLA for a particular service is 99.9%, you should expect the service to be available 99.9% of the time.</span></span> <span data-ttu-id="d1eab-198">Разные службы используют разные соглашения об уровне обслуживания.</span><span class="sxs-lookup"><span data-stu-id="d1eab-198">Different services have different SLAs.</span></span>

<span data-ttu-id="d1eab-199">Соглашение об уровне ОБСЛУЖИВАНИЯ Azure также включены положения о получении кредита на службу, если соглашение об уровне ОБСЛУЖИВАНИЯ не выполняются, а также конкретные определения *доступности* для каждой службы.</span><span class="sxs-lookup"><span data-stu-id="d1eab-199">The Azure SLA also includes provisions for obtaining a service credit if the SLA is not met, along with specific definitions of *availability* for each service.</span></span> <span data-ttu-id="d1eab-200">Этот аспект SLA действует как политика принудительного применения.</span><span class="sxs-lookup"><span data-stu-id="d1eab-200">That aspect of the SLA acts as an enforcement policy.</span></span>

### <a name="composite-slas"></a><span data-ttu-id="d1eab-201">Составные соглашения об уровне обслуживания</span><span class="sxs-lookup"><span data-stu-id="d1eab-201">Composite SLAs</span></span>

<span data-ttu-id="d1eab-202">*Составные соглашения об уровне обслуживания* задействовать несколько служб, которые поддерживает приложение, каждый с разным уровнем доступности.</span><span class="sxs-lookup"><span data-stu-id="d1eab-202">*Composite SLAs* involve multiple services supporting an application, each with differing levels of availability.</span></span> <span data-ttu-id="d1eab-203">Например рассмотрим веб-приложение службы приложений, который записывает в базу данных SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="d1eab-203">For example, consider an App Service web app that writes to Azure SQL Database.</span></span> <span data-ttu-id="d1eab-204">На момент написания статьи эти службы Azure имеют следующие соглашения об уровне обслуживания:</span><span class="sxs-lookup"><span data-stu-id="d1eab-204">At the time of this writing, these Azure services have the following SLAs:</span></span>

- <span data-ttu-id="d1eab-205">Веб-приложениях службы приложений — 99,95%</span><span class="sxs-lookup"><span data-stu-id="d1eab-205">App Service web apps = 99.95%</span></span>
- <span data-ttu-id="d1eab-206">База данных SQL — 99,99 %.</span><span class="sxs-lookup"><span data-stu-id="d1eab-206">SQL Database = 99.99%</span></span>

<span data-ttu-id="d1eab-207">Каково максимальное время простоя, ожидаемое для этого приложения?</span><span class="sxs-lookup"><span data-stu-id="d1eab-207">What is the maximum downtime you would expect for this application?</span></span> <span data-ttu-id="d1eab-208">Если какая-либо из служб завершается ошибкой, приложение также прекращает работу.</span><span class="sxs-lookup"><span data-stu-id="d1eab-208">If either service fails, the whole application fails.</span></span> <span data-ttu-id="d1eab-209">Вероятность сбоя каждой службы независима, поэтому составное SLA для этого приложения составляет 99,95% × 99,99% = 99,94%.</span><span class="sxs-lookup"><span data-stu-id="d1eab-209">The probability of each service failing is independent, so the composite SLA for this application is 99.95% × 99.99% = 99.94%.</span></span> <span data-ttu-id="d1eab-210">Это ниже, чем отдельные SLA, что не удивительно, так как приложение, которое зависит от нескольких служб имеет больше потенциальных точек отказа.</span><span class="sxs-lookup"><span data-stu-id="d1eab-210">That's lower than the individual SLAs, which isn't surprising because an application that relies on multiple services has more potential failure points.</span></span>

<span data-ttu-id="d1eab-211">Составное SLA можно усовершенствовать, создав независимые резервные пути.</span><span class="sxs-lookup"><span data-stu-id="d1eab-211">You can improve the composite SLA by creating independent fallback paths.</span></span> <span data-ttu-id="d1eab-212">Например, если база данных SQL недоступна, поместите транзакции в очереди для последующей обработки.</span><span class="sxs-lookup"><span data-stu-id="d1eab-212">For example, if SQL Database is unavailable, put transactions into a queue to be processed later.</span></span>

![Составное соглашение об уровне обслуживания](_images/composite-sla.png)

<span data-ttu-id="d1eab-214">При такой структуре приложение по-прежнему доступно, даже если оно не может подключиться к базе данных.</span><span class="sxs-lookup"><span data-stu-id="d1eab-214">With this design, the application is still available even if it can't connect to the database.</span></span> <span data-ttu-id="d1eab-215">Тем не менее, оно завершится сбоем, если одновременно произойдет сбой базы данных и очереди.</span><span class="sxs-lookup"><span data-stu-id="d1eab-215">However, it fails if the database and the queue both fail at the same time.</span></span> <span data-ttu-id="d1eab-216">Ожидаемый процент времени для одновременного сбоя является 0,0001 × 0,001, поэтому составное SLA для этого комбинированного пути:</span><span class="sxs-lookup"><span data-stu-id="d1eab-216">The expected percentage of time for a simultaneous failure is 0.0001 × 0.001, so the composite SLA for this combined path is:</span></span>

- <span data-ttu-id="d1eab-217">База данных *или* очередь = 1,0 − (0,0001 × 0,001) = 99,99999%</span><span class="sxs-lookup"><span data-stu-id="d1eab-217">Database *or* queue = 1.0 − (0.0001 × 0.001) = 99.99999%</span></span>

<span data-ttu-id="d1eab-218">Общий уровень SLA:</span><span class="sxs-lookup"><span data-stu-id="d1eab-218">The total composite SLA is:</span></span>

- <span data-ttu-id="d1eab-219">Веб-приложения *и* (база данных *или* очереди) = 99,95% x 99,99999% = \~99,95%</span><span class="sxs-lookup"><span data-stu-id="d1eab-219">Web app *and* (database *or* queue) = 99.95% × 99.99999% = \~99.95%</span></span>

<span data-ttu-id="d1eab-220">Не лишен недостатков этого подхода.</span><span class="sxs-lookup"><span data-stu-id="d1eab-220">There are tradeoffs to this approach.</span></span> <span data-ttu-id="d1eab-221">Логика приложения сложнее, вы платите за очереди и необходимо учитывать проблемы согласованности данных.</span><span class="sxs-lookup"><span data-stu-id="d1eab-221">The application logic is more complex, you are paying for the queue, and you need to consider data consistency issues.</span></span>

### <a name="slas-for-multiregion-deployments"></a><span data-ttu-id="d1eab-222">Соглашения об уровне обслуживания для развертываний в нескольких регионах</span><span class="sxs-lookup"><span data-stu-id="d1eab-222">SLAs for multiregion deployments</span></span>

<span data-ttu-id="d1eab-223">*Соглашения об уровне обслуживания для развертываний в нескольких регионах* включают в себя методика высокого уровня доступности развернуть приложение в нескольких регионах и использовать диспетчер трафика Azure для отработки отказа при сбое приложения в одном регионе.</span><span class="sxs-lookup"><span data-stu-id="d1eab-223">*SLAs for multiregion deployments* involve a high-availability technique to deploy the application in more than one region and use Azure Traffic Manager to fail over if the application fails in one region.</span></span>

<span data-ttu-id="d1eab-224">Для развертывания нескольких регионах составное SLA рассчитывается следующим образом:</span><span class="sxs-lookup"><span data-stu-id="d1eab-224">The composite SLA for a multiregion deployment is calculated as follows:</span></span>

- <span data-ttu-id="d1eab-225">*N* является составное SLA для приложения, развернутого в одном регионе.</span><span class="sxs-lookup"><span data-stu-id="d1eab-225">*N* is the composite SLA for the application deployed in one region.</span></span>
- <span data-ttu-id="d1eab-226">*R* является количество регионов, где развернуто приложение.</span><span class="sxs-lookup"><span data-stu-id="d1eab-226">*R* is the number of regions where the application is deployed.</span></span>

<span data-ttu-id="d1eab-227">Ожидаемая вероятность того, происходит сбой приложения во всех регионах, в то же время является ((1 − N) \^ R).</span><span class="sxs-lookup"><span data-stu-id="d1eab-227">The expected chance that the application fails in all regions at the same time is ((1 − N) \^ R).</span></span> <span data-ttu-id="d1eab-228">Например, если в одном регионе соглашение об уровне ОБСЛУЖИВАНИЯ — 99,95%:</span><span class="sxs-lookup"><span data-stu-id="d1eab-228">For example, if the single-region SLA is 99.95%:</span></span>

- <span data-ttu-id="d1eab-229">Объединенный соглашение об уровне ОБСЛУЖИВАНИЯ для двух регионов = (− 1 (1 − 0.9995) \^ 2) = 99.999975%</span><span class="sxs-lookup"><span data-stu-id="d1eab-229">The combined SLA for two regions = (1 − (1 − 0.9995) \^ 2) = 99.999975%</span></span>
- <span data-ttu-id="d1eab-230">Объединенный соглашение об уровне ОБСЛУЖИВАНИЯ для четырех регионах = (− 1 (1 − 0.9995) \^ 4) = 99.999999%</span><span class="sxs-lookup"><span data-stu-id="d1eab-230">The combined SLA for four regions =  (1 − (1 − 0.9995) \^ 4)  = 99.999999%</span></span>

<span data-ttu-id="d1eab-231">[Соглашение об уровне ОБСЛУЖИВАНИЯ для диспетчера трафика](https://azure.microsoft.com/en-us/support/legal/sla/traffic-manager/v1_0/) также является фактором.</span><span class="sxs-lookup"><span data-stu-id="d1eab-231">The [SLA for Traffic Manager](https://azure.microsoft.com/en-us/support/legal/sla/traffic-manager/v1_0/) is also a factor.</span></span> <span data-ttu-id="d1eab-232">Отработка отказа не происходит мгновенно в активно пассивной конфигурации, которые могут привести к простою во время отработки отказа.</span><span class="sxs-lookup"><span data-stu-id="d1eab-232">Failing over is not instantaneous in active-passive configurations, which can result in downtime during a failover.</span></span> <span data-ttu-id="d1eab-233">См. в разделе [мониторинг конечных точек диспетчера трафика](/azure/traffic-manager/traffic-manager-monitoring).</span><span class="sxs-lookup"><span data-stu-id="d1eab-233">See [Traffic Manager endpoint monitoring and failover](/azure/traffic-manager/traffic-manager-monitoring).</span></span>

## <a name="next-steps"></a><span data-ttu-id="d1eab-234">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="d1eab-234">Next steps</span></span>

> [!div class="nextstepaction"]
> [<span data-ttu-id="d1eab-235">Архитектор для обеспечения устойчивости и доступности</span><span class="sxs-lookup"><span data-stu-id="d1eab-235">Architect for resiliency and availability</span></span>](./architect.md)
