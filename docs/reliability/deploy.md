---
title: Развертывание приложения Azure для обеспечения устойчивости и доступности
description: Обзор методов создания надежного развертывания в Azure
author: MikeWasson
ms.date: 04/10/2019
ms.topic: article
ms.service: architecture-center
ms.subservice: cloud-design-principles
ms.openlocfilehash: d8df3fe1c3353c60462959a625ba13ae47b96cf8
ms.sourcegitcommit: 579c39ff4b776704ead17a006bf24cd4cdc65edd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59646647"
---
# <a name="deploying-azure-applications-for-resiliency-and-availability"></a>Развертывание приложения Azure для обеспечения устойчивости и доступности

Как подготовить и обновления ресурсов Azure, код приложения и параметры конфигурации, повторяемым и предсказуемым процесса поможет избежать ошибок и простоев. Мы рекомендуем использовать автоматизированные процессы для развертывания, которые можно выполнять по требованию и повторить запуск, если что-то происходит сбой. После развертывания процессы работают исправно, документация по процессу можно синхронизировать их таким образом.

## <a name="automate-processes"></a>Автоматизация процессов

Для активации ресурсов по требованию, быстрого развертывания решений, свести к минимуму человеческой ошибки и создавать согласованный и воспроизводимой результат, не забудьте автоматизации развертывания и обновления.

### <a name="automate-as-many-processes-as-possible"></a>Автоматизация процессов столько максимально

Самый надежный процессы развертывания автоматизированы и *идемпотентными* &mdash; т.е repeatable для дают одинаковые результаты.

- Для автоматизации подготовки ресурсов Azure, можно использовать [Terraform](/azure/virtual-machines/windows/infrastructure-automation#terraform), [Ansible](/azure/virtual-machines/windows/infrastructure-automation#ansible), [Chef](/azure/virtual-machines/windows/infrastructure-automation#chef), [Puppet](/azure/virtual-machines/windows/infrastructure-automation#puppet), [Azure PowerShell](/powershell/azure/overview), [интерфейса командной строки Azure (CLI)](/cli/azure), или [шаблонов Azure Resource Manager](/azure/azure-resource-manager/resource-group-overview#template-deployment).
- Чтобы настроить виртуальные машины, можно использовать [cloud-init](/azure/virtual-machines/windows/infrastructure-automation#cloud-init) (для виртуальных машин Linux) или [настройки состояния службы автоматизации Azure](/azure/automation/automation-dsc-overview) (DSC).
- Чтобы автоматизировать развертывание приложений, можно использовать [служб Azure DevOps](/azure/virtual-machines/windows/infrastructure-automation#azure-devops-services), [Jenkins](/azure/virtual-machines/windows/infrastructure-automation#jenkins), или другие решения CI/CD.

Как рекомендуется создайте репозиторий сценариев автоматизации по категориям для быстрого доступа, вместе с четким описанием параметров и примеры использования сценариев. Синхронизировать этой документации с развертываниями Azure и назначьте ответственного за управление в репозитории.

Сценарии автоматизации могут также активировать ресурсы по требованию для аварийного восстановления.

### <a name="use-code-to-provision-and-configure-infrastructure"></a>Используйте код, чтобы подготовить и настроить инфраструктуру

В этом практическом занятии вызывается *инфраструктура как код,* может использовать декларативный подход или императивный подход (или их сочетание).

- [Шаблоны Resource Manager](/azure/azure-resource-manager/resource-group-overview#template-deployment) являются примером декларативного подхода.
- [PowerShell](/powershell/azure/overview) сценарии являются примером императивного подхода.

### <a name="practice-immutable-infrastructure"></a>Неизменяемая инфраструктура практике

Другими словами не следует изменять инфраструктуру после ее развертывания в рабочей среде. После применения ситуативные изменения, вы можете не знать точно что изменилось, поэтому он может быть затруднено Устранение неполадок в системе.

### <a name="automate-and-test-deployment-and-maintenance-tasks"></a>Автоматизируйте и тестируйте задачи развертывания и обслуживания

Распределенные приложения состоят из нескольких частей, которые должны работать вместе. Развертывания следует воспользоваться преимуществами проверенных механизмов, таких как скрипты, которые можно обновить и проверить конфигурацию и автоматизировать процесс развертывания. Протестируйте все процессы полностью, чтобы удостовериться, что ошибки не приводят к дополнительным простоям.

### <a name="implement-deployment-security-measures"></a>Реализации мер безопасности развертывания

Все средства развертывания необходимо включить ограничения безопасности для защиты развернутого приложения. Определить и применяйте политики развертывания, тщательно и свести к минимуму необходимость вмешательства человека.

## <a name="deploy-to-multiple-regions-and-instances"></a>Развертывание в нескольких регионах и экземпляров

Приложения, зависящего на один экземпляр службы создается единая точка отказа. Чтобы повысить устойчивость и масштабируемость, подготовьте несколько экземпляров.

- Для [службы приложений Azure](/azure/app-service/app-service-value-prop-what-is/) выберите [план служб приложений](/azure/app-service/azure-web-sites-web-hosting-plans-in-depth-overview/), где есть несколько экземпляров.
- Для [облачных служб Azure](/azure/cloud-services/cloud-services-choose-me), настройте каждый из роли для применения [несколько экземпляров](/azure/cloud-services/cloud-services-choose-me/#scaling-and-management).
- Для [виртуальных машинах](/azure/virtual-machines/virtual-machines-windows-about/?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json), убедитесь, что архитектура виртуальных содержит несколько виртуальных Машин и что каждая виртуальная машина входит в [доступности](/azure/virtual-machines/virtual-machines-windows-manage-availability/).

### <a name="consider-deploying-across-multiple-regions"></a>Рассмотрите возможность развертывания в нескольких регионах

Мы рекомендуем развертывать все, но наименее важных приложений, так и для службы приложений в нескольких регионах. Если приложение развертывается в одном регионе, в редких случаях, когда весь регион становится недоступным, приложение также будет недоступна.

Если требуется выполнить развертывание в одном регионе, рассмотрите возможность подготовки для повторного развертывания в дополнительный регион в ответ на непредвиденный сбой.

### <a name="redeploy-to-a-secondary-region"></a>Повторное развертывание в дополнительном регионе

При запуске приложения и базы данных в единый, основной регион без репликации стратегии восстановления можно выполнить повторное развертывание в другом регионе. Это решение является доступной, но наиболее подходящий для некритических приложений, которые допускают более длительное время восстановления.

Если эта стратегия, автоматизировать процесс повторного развертывания максимально и включают в себя сценарии повторного развертывания в тестирование аварийного ответа.

Чтобы автоматизировать процесс повторного развертывания, рассмотрите возможность использования [Azure Site Recovery](/azure/site-recovery/).

## <a name="use-staging-and-production-environments"></a>Использование промежуточной и рабочей сред

Используйте промежуточной и рабочей сред позволяет передавать обновления в рабочей среде настоятельно контролируемым способом в и свести к минимуму простои из развертывания непредвиденных проблем.

- [*Сине зеленое развертывание*](https://martinfowler.com/bliki/BlueGreenDeployment.html) включает в себя развертывание обновления в рабочей среде отдельно от работающего приложения. После проверки развертывания переключите маршрутизацию трафика на обновленную версию. Один из способов сделать это позволяет использовать [промежуточные слоты](/azure/app-service/web-sites-staged-publishing) доступны в службе приложений Azure для размещения развертывания перед ее перемещением в рабочую среду.
- [*Ранние выпуски*](https://martinfowler.com/bliki/CanaryRelease.html) аналогичны развертывания blue-green. Вместо перенаправить весь трафик обновленного приложения, полученные только небольшую часть трафика к новому развертыванию. Если имеется проблема, вернуться к старому развертыванию. В противном случае постепенно маршрутизации большего объема трафика на новую версию. При использовании службы приложений Azure, можно использовать в рабочей среде функции тестирования для управления раннего выпуска.

## <a name="create-a-rollback-plan-for-deployment-and-updates"></a>Создать план отката развертывания и обновления

Если происходит сбой развертывания, приложение может стать недоступным. Чтобы свести к минимуму время простоя, создайте процесс отката, чтобы вернуться к рабочей версии последний известный. Включить стратегию для отката изменений к базам данных и другие службы, от которых зависит приложение.

При использовании службы приложений Azure, можно настроить слот последний известный удачному сайту и использовать его для отката из веб-роли или развертывания приложения API.

## <a name="log-and-audit-deployments"></a>Развертываний журнала и аудит

Для захвата как гораздо сведений о версии как можно реализуйте надежную стратегию ведения журнала. При использовании методов промежуточное развертывание, более одной версии приложения будут выполняться в рабочей среде. Если возникает проблема, определите, какая версия вызывает его.

## <a name="document-release-processes"></a>Процессы выпуска документа

Без подробного документирования процесса выпуска оператор может развернуть неправильное обновление или неправильно настроить параметры для вашего приложения. Четко определите и задокументируйте процесс выпуска и убедитесь, что он доступен для всей группы разработки.

## <a name="next-steps"></a>Дальнейшие действия

> [!div class="nextstepaction"]
> [Мониторинга работоспособности для обеспечения надежности](./monitoring.md)
