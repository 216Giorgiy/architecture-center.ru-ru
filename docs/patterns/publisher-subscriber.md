---
title: Шаблон издателя и подписчика
description: Настройка в приложении возможности объявлять событие для нескольких объектов-получателей одновременно.
keywords: Конструктивный шаблон
author: alexbuckgit
ms.date: 12/07/2018
ms.topic: design-pattern
ms.service: architecture-center
ms.subservice: cloud-fundamentals
ms.openlocfilehash: f3d15d65aeab41977e6d30b8141baaa956da29d3
ms.sourcegitcommit: 579c39ff4b776704ead17a006bf24cd4cdc65edd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59640776"
---
# <a name="publisher-subscriber-pattern"></a><span data-ttu-id="94f6b-104">Шаблон издателя и подписчика</span><span class="sxs-lookup"><span data-stu-id="94f6b-104">Publisher-Subscriber pattern</span></span>

<span data-ttu-id="94f6b-105">Позволяют приложению информировать о событиях, чтобы несколько потребителей заинтересованные асинхронно, без взаимозависимость отправителями получателям.</span><span class="sxs-lookup"><span data-stu-id="94f6b-105">Enable an application to announce events to multiple interested consumers asynchronously, without coupling the senders to the receivers.</span></span>

<span data-ttu-id="94f6b-106">**Также называется**: обмен сообщениями с публикацией и подпиской.</span><span class="sxs-lookup"><span data-stu-id="94f6b-106">**Also called**: Pub/sub messaging</span></span>

## <a name="context-and-problem"></a><span data-ttu-id="94f6b-107">Контекст и проблема</span><span class="sxs-lookup"><span data-stu-id="94f6b-107">Context and problem</span></span>

<span data-ttu-id="94f6b-108">В облачных и распределенных приложениях при возникновении событий компоненты системы часто должны предоставлять сведения об этом другим компонентам.</span><span class="sxs-lookup"><span data-stu-id="94f6b-108">In cloud-based and distributed applications, components of the system often need to provide information to other components as events happen.</span></span>

<span data-ttu-id="94f6b-109">Асинхронный обмен сообщениями — это эффективный способ отделить отправителей от объектов-получателей и избежать блокирования отправителя для ожидания ответа.</span><span class="sxs-lookup"><span data-stu-id="94f6b-109">Asynchronous messaging is an effective way to decouple senders from consumers, and avoid blocking the sender to wait for a response.</span></span> <span data-ttu-id="94f6b-110">Тем не менее использование выделенной очереди сообщений для каждого объекта-получателя не масштабируется эффективным образом для нескольких объектов-получателей.</span><span class="sxs-lookup"><span data-stu-id="94f6b-110">However, using a dedicated message queue for each consumer does not effectively scale to many consumers.</span></span> <span data-ttu-id="94f6b-111">Кроме того, некоторые объекты-получатели могут быть заинтересованы только в подмножестве данных.</span><span class="sxs-lookup"><span data-stu-id="94f6b-111">Also, some of the consumers might be interested in only a subset of the information.</span></span> <span data-ttu-id="94f6b-112">Как может отправитель объявлять о событиях для всех заинтересованных объектов-получателей, не зная их удостоверений?</span><span class="sxs-lookup"><span data-stu-id="94f6b-112">How can the sender announce events to all interested consumers without knowing their identities?</span></span>

## <a name="solution"></a><span data-ttu-id="94f6b-113">Решение</span><span class="sxs-lookup"><span data-stu-id="94f6b-113">Solution</span></span>

<span data-ttu-id="94f6b-114">Представляем систему асинхронного обмена сообщениями, которая включает в себя следующее:</span><span class="sxs-lookup"><span data-stu-id="94f6b-114">Introduce an asynchronous messaging subsystem that includes the following:</span></span>

- <span data-ttu-id="94f6b-115">Входной канал обмена сообщениями, используемый отправителем.</span><span class="sxs-lookup"><span data-stu-id="94f6b-115">An input messaging channel used by the sender.</span></span> <span data-ttu-id="94f6b-116">Отправитель упаковывает события в сообщения, используя известный формат сообщений, и отправляет их через входной канал.</span><span class="sxs-lookup"><span data-stu-id="94f6b-116">The sender packages events into messages, using a known message format, and sends these messages via the input channel.</span></span> <span data-ttu-id="94f6b-117">Отправитель в этом шаблоне также называется *издателем*.</span><span class="sxs-lookup"><span data-stu-id="94f6b-117">The sender in this pattern is also called the *publisher*.</span></span>

  > [!NOTE]
  > <span data-ttu-id="94f6b-118">*Сообщение* — это пакет данных.</span><span class="sxs-lookup"><span data-stu-id="94f6b-118">A *message* is a packet of data.</span></span> <span data-ttu-id="94f6b-119">*Событие* представляет собой сообщение, которое уведомляет другие компоненты об изменении или действии, которое было выполнено.</span><span class="sxs-lookup"><span data-stu-id="94f6b-119">An *event* is a message that notifies other components about a change or an action that has taken place.</span></span>

- <span data-ttu-id="94f6b-120">Один выходной канал обмена сообщениями на объект-получателя.</span><span class="sxs-lookup"><span data-stu-id="94f6b-120">One output messaging channel per consumer.</span></span> <span data-ttu-id="94f6b-121">Объекты-получатели известны как *подписчики*.</span><span class="sxs-lookup"><span data-stu-id="94f6b-121">The consumers are known as *subscribers*.</span></span>

- <span data-ttu-id="94f6b-122">Механизм копирования каждого сообщения из входящего канала в выходные для всех подписчиков, заинтересованных в этом сообщении.</span><span class="sxs-lookup"><span data-stu-id="94f6b-122">A mechanism for copying each message from the input channel to the output channels for all subscribers interested in that message.</span></span> <span data-ttu-id="94f6b-123">Эта операция обычно обрабатывается посредником, например брокером сообщений или шиной событий.</span><span class="sxs-lookup"><span data-stu-id="94f6b-123">This operation is typically handled by a intermediary such as a message broker or event bus.</span></span>

<span data-ttu-id="94f6b-124">На следующей схеме показаны логические компоненты этого шаблона:</span><span class="sxs-lookup"><span data-stu-id="94f6b-124">The following diagram shows the logical components of this pattern:</span></span>

![Шаблон публикации-подписки с использованием брокера сообщений](./_images/publish-subscribe.png)
 
<span data-ttu-id="94f6b-126">Обмен сообщениями c публикацией и подпиской имеет указанные ниже преимущества:</span><span class="sxs-lookup"><span data-stu-id="94f6b-126">Pub/sub messaging has the following benefits:</span></span>

- <span data-ttu-id="94f6b-127">Разделение подсистем, которые по-прежнему должны взаимодействовать.</span><span class="sxs-lookup"><span data-stu-id="94f6b-127">It decouples subsystems that still need to communicate.</span></span> <span data-ttu-id="94f6b-128">Подсистемами можно управлять независимо друг от друга, и сообщениями можно должным образом управлять, даже если один или несколько получателей находятся в автономном режиме.</span><span class="sxs-lookup"><span data-stu-id="94f6b-128">Subsystems can be managed independently, and messages can be properly managed even if one or more receivers are offline.</span></span>

- <span data-ttu-id="94f6b-129">Увеличение масштабируемости и повышение отклика отправителя.</span><span class="sxs-lookup"><span data-stu-id="94f6b-129">It increases scalability and improves responsiveness of the sender.</span></span> <span data-ttu-id="94f6b-130">Отправитель может быстро отправить одно сообщение во входной канал, а затем вернуться к своим основным обязанностям обработки.</span><span class="sxs-lookup"><span data-stu-id="94f6b-130">The sender can quickly send a single message to the input channel, then return to its core processing responsibilities.</span></span> <span data-ttu-id="94f6b-131">Инфраструктура обмена сообщениями отвечает за обеспечение доставки сообщений заинтересованным подписчикам.</span><span class="sxs-lookup"><span data-stu-id="94f6b-131">The messaging infrastructure is responsible for ensuring messages are delivered to interested subscribers.</span></span>

- <span data-ttu-id="94f6b-132">Это повышает надежность.</span><span class="sxs-lookup"><span data-stu-id="94f6b-132">It improves reliability.</span></span> <span data-ttu-id="94f6b-133">Асинхронный обмен сообщениями помогает приложениям продолжать работать без проблем под повышенной нагрузкой и более эффективно обрабатывать временные сбои.</span><span class="sxs-lookup"><span data-stu-id="94f6b-133">Asynchronous messaging helps applications continue to run smoothly under increased loads and handle intermittent failures more effectively.</span></span>

- <span data-ttu-id="94f6b-134">Поддержка отложенной обработки или обработки по расписанию.</span><span class="sxs-lookup"><span data-stu-id="94f6b-134">It allows for deferred or scheduled processing.</span></span> <span data-ttu-id="94f6b-135">Подписчики могут ждать нерабочего времени, чтобы получить сообщения, или же сообщения могут направляться либо обрабатываться согласно заданному расписанию.</span><span class="sxs-lookup"><span data-stu-id="94f6b-135">Subscribers can wait to pick up messages until off-peak hours, or messages can be routed or processed according to a specific schedule.</span></span>

- <span data-ttu-id="94f6b-136">Обеспечение более простой интеграции между системами, использующими различные платформы, языки или протоколы связи, как и между локальными системами и приложениями, работающими в облаке.</span><span class="sxs-lookup"><span data-stu-id="94f6b-136">It enables simpler integration between systems using different platforms, programming languages, or communication protocols, as well as between on-premises systems and applications running in the cloud.</span></span>

- <span data-ttu-id="94f6b-137">Обеспечение выполнения асинхронных рабочих процессов по всему предприятию.</span><span class="sxs-lookup"><span data-stu-id="94f6b-137">It facilitates asynchronous workflows across an enterprise.</span></span>

- <span data-ttu-id="94f6b-138">Улучшение возможности тестирования.</span><span class="sxs-lookup"><span data-stu-id="94f6b-138">It improves testability.</span></span> <span data-ttu-id="94f6b-139">Можно отслеживать каналы и проверять или регистрировать сообщения как часть общей стратегии тестирования интеграции.</span><span class="sxs-lookup"><span data-stu-id="94f6b-139">Channels can be monitored and messages can be inspected or logged as part of an overall integration test strategy.</span></span>

- <span data-ttu-id="94f6b-140">Разделение областей ответственности для ваших приложений.</span><span class="sxs-lookup"><span data-stu-id="94f6b-140">It provides separation of concerns for your applications.</span></span> <span data-ttu-id="94f6b-141">Каждое приложение может сосредоточиться на основных возможностях, пока инфраструктура обмена сообщениями обрабатывает все необходимое для надежного перенаправления сообщений нескольким объектам-получателям.</span><span class="sxs-lookup"><span data-stu-id="94f6b-141">Each application can focus on its core capabilities, while the messaging infrastructure handles everything required to reliably route messages to multiple consumers.</span></span> 

## <a name="issues-and-considerations"></a><span data-ttu-id="94f6b-142">Проблемы и рекомендации</span><span class="sxs-lookup"><span data-stu-id="94f6b-142">Issues and considerations</span></span>

<span data-ttu-id="94f6b-143">При принятии решения о реализации этого шаблона необходимо учитывать следующие моменты.</span><span class="sxs-lookup"><span data-stu-id="94f6b-143">Consider the following points when deciding how to implement this pattern:</span></span>

- <span data-ttu-id="94f6b-144">**Существующие технологии.**</span><span class="sxs-lookup"><span data-stu-id="94f6b-144">**Existing technologies.**</span></span> <span data-ttu-id="94f6b-145">Настоятельно рекомендуется использовать доступные продукты и службы для обмена сообщениями, поддерживающие модель с публикацией и подпиской, а не создавать собственные.</span><span class="sxs-lookup"><span data-stu-id="94f6b-145">It is strongly recommended to use available messaging products and services that support a publish-subscribe model, rather than building your own.</span></span> <span data-ttu-id="94f6b-146">В Azure рассмотрите возможность использования [Служебной шины](/azure/service-bus-messaging/) или [Сетки событий](/azure/event-grid/).</span><span class="sxs-lookup"><span data-stu-id="94f6b-146">In Azure, consider using [Service Bus](/azure/service-bus-messaging/) or [Event Grid](/azure/event-grid/).</span></span> <span data-ttu-id="94f6b-147">К другим технологиях, которые могут использоваться для обмена сообщениями c публикацией и подпиской, относятся Redis, RabbitMQ и Apache Kafka.</span><span class="sxs-lookup"><span data-stu-id="94f6b-147">Other technologies that can be used for pub/sub messaging include Redis, RabbitMQ, and Apache Kafka.</span></span>

- <span data-ttu-id="94f6b-148">**Обработка подписки.**</span><span class="sxs-lookup"><span data-stu-id="94f6b-148">**Subscription handling.**</span></span> <span data-ttu-id="94f6b-149">Инфраструктура обмена сообщениями должна предоставить механизмы, которые объекты-получатели могут использовать для подписки или отмены подписки на доступные каналы.</span><span class="sxs-lookup"><span data-stu-id="94f6b-149">The messaging infrastructure must provide mechanisms that consumers can use to subscribe to or unsubscribe from available channels.</span></span>

- <span data-ttu-id="94f6b-150">**Безопасность.**</span><span class="sxs-lookup"><span data-stu-id="94f6b-150">**Security.**</span></span> <span data-ttu-id="94f6b-151">Подключение к любому каналу сообщений должно быть ограничено политикой безопасности для предотвращения перехвата со стороны неавторизованных пользователей или приложений.</span><span class="sxs-lookup"><span data-stu-id="94f6b-151">Connecting to any message channel must be restricted by security policy to prevent eavesdropping by unauthorized users or applications.</span></span>

- <span data-ttu-id="94f6b-152">**Подмножества сообщений.**</span><span class="sxs-lookup"><span data-stu-id="94f6b-152">**Subsets of messages.**</span></span> <span data-ttu-id="94f6b-153">Подписчики обычно заинтересованы только в подмножестве сообщений, распределяемых издателем.</span><span class="sxs-lookup"><span data-stu-id="94f6b-153">Subscribers are usually only interested in subset of the messages distributed by a publisher.</span></span> <span data-ttu-id="94f6b-154">Службы обмена сообщениями часто позволяют подписчикам сузить набор получаемых сообщений следующим образом:</span><span class="sxs-lookup"><span data-stu-id="94f6b-154">Messaging services often allow subscribers to narrow the set of messages received by:</span></span>

  - <span data-ttu-id="94f6b-155">**По разделам.**</span><span class="sxs-lookup"><span data-stu-id="94f6b-155">**Topics.**</span></span> <span data-ttu-id="94f6b-156">Каждый раздел имеет выделенный выходной канал, и каждого объекта-получателя можно подписать на все соответствующие разделы.</span><span class="sxs-lookup"><span data-stu-id="94f6b-156">Each topic has a dedicated output channel, and each consumer can subscribe to all relevant topics.</span></span>
  - <span data-ttu-id="94f6b-157">**Путем фильтрации содержимого.**</span><span class="sxs-lookup"><span data-stu-id="94f6b-157">**Content filtering.**</span></span> <span data-ttu-id="94f6b-158">Сообщения проверяются и распределяются на основе содержимого каждого из них.</span><span class="sxs-lookup"><span data-stu-id="94f6b-158">Messages are inspected and distributed based on the content of each message.</span></span> <span data-ttu-id="94f6b-159">Каждый подписчик может указать интересующее его содержимое.</span><span class="sxs-lookup"><span data-stu-id="94f6b-159">Each subscriber can specify the content it is interested in.</span></span>

- <span data-ttu-id="94f6b-160">**Подписчики с подстановочными знаками.**</span><span class="sxs-lookup"><span data-stu-id="94f6b-160">**Wildcard subscribers.**</span></span> <span data-ttu-id="94f6b-161">Рассмотреть возможность разрешения подписчикам подписываться на несколько разделов с помощью подстановочных знаков.</span><span class="sxs-lookup"><span data-stu-id="94f6b-161">Consider allowing subscribers to subscribe to multiple topics via wildcards.</span></span>

- <span data-ttu-id="94f6b-162">**Двусторонняя связь.**</span><span class="sxs-lookup"><span data-stu-id="94f6b-162">**Bi-directional communication.**</span></span> <span data-ttu-id="94f6b-163">Каналы в системе с публикацией и подпиской рассматриваются как однонаправленные.</span><span class="sxs-lookup"><span data-stu-id="94f6b-163">The channels in a publish-subscribe system are treated as unidirectional.</span></span> <span data-ttu-id="94f6b-164">Если конкретному подписчику необходимо отправить подтверждение или сообщить о состоянии издателю, рассмотрите возможность использования [шаблона "запрос — ответ"](http://www.enterpriseintegrationpatterns.com/patterns/messaging/RequestReply.html).</span><span class="sxs-lookup"><span data-stu-id="94f6b-164">If a specific subscriber needs to send acknowledgement or communicate status back to the publisher, consider using the [Request/Reply Pattern](http://www.enterpriseintegrationpatterns.com/patterns/messaging/RequestReply.html).</span></span> <span data-ttu-id="94f6b-165">Этот шаблон использует один канал для отправки сообщения подписчику и отдельный канал ответа для обратной связи с издателем.</span><span class="sxs-lookup"><span data-stu-id="94f6b-165">This pattern uses one channel to send a message to the subscriber, and a separate reply channel for communicating back to the publisher.</span></span>

- <span data-ttu-id="94f6b-166">**Упорядочивание сообщений.**</span><span class="sxs-lookup"><span data-stu-id="94f6b-166">**Message ordering.**</span></span> <span data-ttu-id="94f6b-167">Порядок, в котором экземпляры объекта-получателя получают сообщения, ненадежный и не обязательно должен совпадать с порядком создания сообщений.</span><span class="sxs-lookup"><span data-stu-id="94f6b-167">The order in which consumer instances receive messages isn't guaranteed, and doesn't necessarily reflect the order in which the messages were created.</span></span> <span data-ttu-id="94f6b-168">Разработайте систему, чтобы гарантировать идемпотентную обработку сообщений. Это поможет исключить любые зависимости в порядке обработки сообщений.</span><span class="sxs-lookup"><span data-stu-id="94f6b-168">Design the system to ensure that message processing is idempotent to help eliminate any dependency on the order of message handling.</span></span>

- <span data-ttu-id="94f6b-169">**Приоритет сообщений.**</span><span class="sxs-lookup"><span data-stu-id="94f6b-169">**Message priority.**</span></span> <span data-ttu-id="94f6b-170">Некоторые решения могут требовать обработки сообщений в определенном порядке.</span><span class="sxs-lookup"><span data-stu-id="94f6b-170">Some solutions may require that messages are processed in a specific order.</span></span> <span data-ttu-id="94f6b-171">[Шаблон очереди с приоритетом](priority-queue.md) предоставляет механизм, обеспечивающий доставку определенных сообщений раньше других.</span><span class="sxs-lookup"><span data-stu-id="94f6b-171">The [Priority Queue pattern](priority-queue.md) provides a mechanism for ensuring specific messages are delivered before others.</span></span>

- <span data-ttu-id="94f6b-172">**Сообщения о сбое.**</span><span class="sxs-lookup"><span data-stu-id="94f6b-172">**Poison messages.**</span></span> <span data-ttu-id="94f6b-173">Неправильно сформированные сообщения или задачи, которым требуется доступ к недоступным ресурсам, могут вызвать сбой экземпляра службы.</span><span class="sxs-lookup"><span data-stu-id="94f6b-173">A malformed message, or a task that requires access to resources that aren't available, can cause a service instance to fail.</span></span> <span data-ttu-id="94f6b-174">Система должна предотвращать возвращение в очередь таких сообщений.</span><span class="sxs-lookup"><span data-stu-id="94f6b-174">The system should prevent such messages being returned to the queue.</span></span> <span data-ttu-id="94f6b-175">Поэтому записывайте и храните сведения об этих сообщениях в другом месте, чтобы их можно было анализировать при необходимости.</span><span class="sxs-lookup"><span data-stu-id="94f6b-175">Instead, capture and store the details of these messages elsewhere so that they can be analyzed if necessary.</span></span>

- <span data-ttu-id="94f6b-176">**Повторяющиеся сообщения**.</span><span class="sxs-lookup"><span data-stu-id="94f6b-176">**Repeated messages.**</span></span> <span data-ttu-id="94f6b-177">То же сообщение может быть отправлено более одного раза.</span><span class="sxs-lookup"><span data-stu-id="94f6b-177">The same message might be sent more than once.</span></span> <span data-ttu-id="94f6b-178">Например, отправитель может завершить работу ошибкой после публикации сообщения.</span><span class="sxs-lookup"><span data-stu-id="94f6b-178">For example, the sender might fail after posting a message.</span></span> <span data-ttu-id="94f6b-179">Затем новый экземпляр отправителя может запуститься и повторить сообщение.</span><span class="sxs-lookup"><span data-stu-id="94f6b-179">Then a new instance of the sender might start up and repeat the message.</span></span> <span data-ttu-id="94f6b-180">Инфраструктура обмена сообщениями должна реализовать обнаружение и удаление (также известное как удаление повторов) дубликатов сообщений на основе идентификаторов сообщений для обеспечения одноразовой доставки сообщений.</span><span class="sxs-lookup"><span data-stu-id="94f6b-180">The messaging infrastructure should implement duplicate message detection and removal (also known as de-duping) based on message IDs in order to provide at-most-once delivery of messages.</span></span>

- <span data-ttu-id="94f6b-181">**Срок действия сообщений.**</span><span class="sxs-lookup"><span data-stu-id="94f6b-181">**Message expiration.**</span></span> <span data-ttu-id="94f6b-182">Сообщение может иметь ограниченное время существования.</span><span class="sxs-lookup"><span data-stu-id="94f6b-182">A message might have a limited lifetime.</span></span> <span data-ttu-id="94f6b-183">Если оно не обрабатывается в течение этого периода, оно может быть недействительными и его следует отменить.</span><span class="sxs-lookup"><span data-stu-id="94f6b-183">If it isn't processed within this period, it might no longer be relevant and should be discarded.</span></span> <span data-ttu-id="94f6b-184">Отправитель можно указать срок действия как часть данных в сообщении.</span><span class="sxs-lookup"><span data-stu-id="94f6b-184">A sender can specify an expiration time as part of the data in the message.</span></span> <span data-ttu-id="94f6b-185">Получатель может проверить эту информацию, прежде чем решить, следует ли выполнять бизнес-логику, связанную с сообщением.</span><span class="sxs-lookup"><span data-stu-id="94f6b-185">A receiver can examine this information before deciding whether to perform the business logic associated with the message.</span></span>

- <span data-ttu-id="94f6b-186">**Планирование сообщений.**</span><span class="sxs-lookup"><span data-stu-id="94f6b-186">**Message scheduling.**</span></span> <span data-ttu-id="94f6b-187">Сообщение может быть временно запрещено и не будет обрабатываться до определенных даты и времени.</span><span class="sxs-lookup"><span data-stu-id="94f6b-187">A message might be temporarily embargoed and should not be processed until a specific date and time.</span></span> <span data-ttu-id="94f6b-188">Сообщение не должно быть доступным получателю до этого времени.</span><span class="sxs-lookup"><span data-stu-id="94f6b-188">The message should not be available to a receiver until this time.</span></span>

## <a name="when-to-use-this-pattern"></a><span data-ttu-id="94f6b-189">Когда следует использовать этот шаблон</span><span class="sxs-lookup"><span data-stu-id="94f6b-189">When to use this pattern</span></span>

<span data-ttu-id="94f6b-190">Используйте этот шаблон в следующих случаях:</span><span class="sxs-lookup"><span data-stu-id="94f6b-190">Use this pattern when:</span></span>

- <span data-ttu-id="94f6b-191">Приложению требуется распространить информацию значительному числу объектов-получателей.</span><span class="sxs-lookup"><span data-stu-id="94f6b-191">An application needs to broadcast information to a significant number of consumers.</span></span>

- <span data-ttu-id="94f6b-192">Приложению требуется взаимодействовать с одним или несколькими независимо разработанными приложениями или службами, которые могут использовать различные платформы, языки программирования и протоколы связи.</span><span class="sxs-lookup"><span data-stu-id="94f6b-192">An application needs to communicate with one or more independently-developed applications or services, which may use different platforms, programming languages, and communication protocols.</span></span>

- <span data-ttu-id="94f6b-193">Приложение может отправить объектам-получателям сведения, не требуя от них ответов в режиме реального времени.</span><span class="sxs-lookup"><span data-stu-id="94f6b-193">An application can send information to consumers without requiring real-time responses from the consumers.</span></span>

- <span data-ttu-id="94f6b-194">Интегрируемые системы предназначены для поддержки модели итоговой согласованности для своих данных.</span><span class="sxs-lookup"><span data-stu-id="94f6b-194">The systems being integrated are designed to support an eventual consistency model for their data.</span></span>

- <span data-ttu-id="94f6b-195">Приложению требуется передавать информацию нескольким объектам-получателям, которые могут иметь другие требования к доступности или расписания бесперебойной работы, чем отправитель.</span><span class="sxs-lookup"><span data-stu-id="94f6b-195">An application needs to communicate information to multiple consumers, which may have different availability requirements or uptime schedules than the sender.</span></span>

<span data-ttu-id="94f6b-196">Этот шаблон может оказаться неэффективным в следующих случаях:</span><span class="sxs-lookup"><span data-stu-id="94f6b-196">This pattern might not be useful when:</span></span>

- <span data-ttu-id="94f6b-197">Приложение имеет только несколько объектов-получателей, которым требуются сведения, значительно отличающиеся от приложения-производителя.</span><span class="sxs-lookup"><span data-stu-id="94f6b-197">An application has only a few consumers who need significantly different information from the producing application.</span></span>

- <span data-ttu-id="94f6b-198">Приложение требует взаимодействия с объектами-получателями почти в реальном времени.</span><span class="sxs-lookup"><span data-stu-id="94f6b-198">An application requires near real-time interaction with consumers.</span></span>

## <a name="example"></a><span data-ttu-id="94f6b-199">Пример</span><span class="sxs-lookup"><span data-stu-id="94f6b-199">Example</span></span>

<span data-ttu-id="94f6b-200">На следующей схеме показана архитектура корпоративной интеграции, которая использует Служебную шину для координации рабочих процессов, а Сетка событий уведомляет подсистемы о возникающих событиях.</span><span class="sxs-lookup"><span data-stu-id="94f6b-200">The following diagram shows an enterprise integration architecture that uses Service Bus to coordinate workflows, and Event Grid notify subsystems of events that occur.</span></span> <span data-ttu-id="94f6b-201">Дополнительные сведения см. в статье [Корпоративная интеграция в Azure с использованием очередей сообщений и событий](../reference-architectures/enterprise-integration/queues-events.md).</span><span class="sxs-lookup"><span data-stu-id="94f6b-201">For more information, see [Enterprise integration on Azure using message queues and events](../reference-architectures/enterprise-integration/queues-events.md).</span></span>

![Архитектура корпоративной интеграции](../reference-architectures/enterprise-integration/_images/enterprise-integration-queues-events.png)

## <a name="related-patterns-and-guidance"></a><span data-ttu-id="94f6b-203">Связанные шаблоны и рекомендации</span><span class="sxs-lookup"><span data-stu-id="94f6b-203">Related patterns and guidance</span></span>

<span data-ttu-id="94f6b-204">При реализации этого шаблона следует принять во внимание следующие шаблоны и рекомендации.</span><span class="sxs-lookup"><span data-stu-id="94f6b-204">The following patterns and guidance might be relevant when implementing this pattern:</span></span>

- <span data-ttu-id="94f6b-205">[Выбор между службами обмена сообщениями Azure](/azure/event-grid/compare-messaging-services).</span><span class="sxs-lookup"><span data-stu-id="94f6b-205">[Choose between Azure services that deliver messages](/azure/event-grid/compare-messaging-services).</span></span>

- <span data-ttu-id="94f6b-206">В [стиле архитектуры, управляемом событиями](../guide/architecture-styles/event-driven.md), используется обмен сообщениями с публикацией и подпиской.</span><span class="sxs-lookup"><span data-stu-id="94f6b-206">The [Event-driven architecture style](../guide/architecture-styles/event-driven.md) is an architecture style that uses pub/sub messaging.</span></span>

- <span data-ttu-id="94f6b-207">[Руководство по асинхронному обмену сообщениями](https://msdn.microsoft.com/library/dn589781.aspx).</span><span class="sxs-lookup"><span data-stu-id="94f6b-207">[Asynchronous Messaging Primer](https://msdn.microsoft.com/library/dn589781.aspx).</span></span> <span data-ttu-id="94f6b-208">Очереди сообщений — это механизмы для асинхронного обмена данными.</span><span class="sxs-lookup"><span data-stu-id="94f6b-208">Message queues are an asynchronous communications mechanism.</span></span> <span data-ttu-id="94f6b-209">Если службе потребителя необходимо отправить ответ в приложение, может потребоваться реализовать некоторые варианты обмена сообщениями через ответы.</span><span class="sxs-lookup"><span data-stu-id="94f6b-209">If a consumer service needs to send a reply to an application, it might be necessary to implement some form of response messaging.</span></span> <span data-ttu-id="94f6b-210">Руководство по асинхронному обмену сообщениями предоставляет сведения о реализации обмена сообщениями через запрос или ответ с помощью очередей сообщения.</span><span class="sxs-lookup"><span data-stu-id="94f6b-210">The Asynchronous Messaging Primer provides information on how to implement request/reply messaging using message queues.</span></span>

- <span data-ttu-id="94f6b-211">[Шаблон наблюдателя](https://en.wikipedia.org/wiki/Observer_pattern).</span><span class="sxs-lookup"><span data-stu-id="94f6b-211">[Observer Pattern](https://en.wikipedia.org/wiki/Observer_pattern).</span></span> <span data-ttu-id="94f6b-212">Шаблон с публикацией и подпиской основан на шаблоне наблюдателя с отделением субъектов от наблюдателей через асинхронный обмен сообщениями.</span><span class="sxs-lookup"><span data-stu-id="94f6b-212">The Publish-Subscribe pattern builds on the Observer pattern by decoupling subjects from observers via asynchronous messaging.</span></span>

- <span data-ttu-id="94f6b-213">[Шаблон брокера сообщений](https://en.wikipedia.org/wiki/Message_broker).</span><span class="sxs-lookup"><span data-stu-id="94f6b-213">[Message Broker Pattern](https://en.wikipedia.org/wiki/Message_broker).</span></span> <span data-ttu-id="94f6b-214">Многие подсистемы обмена сообщениями, которые поддерживают публикации-подписки модели реализуются через брокер сообщений.</span><span class="sxs-lookup"><span data-stu-id="94f6b-214">Many messaging subsystems that support a publish-subscribe model are implemented via a message broker.</span></span>
