---
title: Руководство по автоматическому масштабированию
description: Рекомендации относительно автоматического масштабирования для динамического распределения ресурсов, необходимых приложению.
author: dragon119
ms.date: 05/17/2017
pnp.series.title: Best Practices
ms.openlocfilehash: a8489aaabab2b8523fbc9f026f4f435bb6d1ad29
ms.sourcegitcommit: 3d9ee03e2dda23753661a80c7106d1789f5223bb
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/23/2018
ms.locfileid: "29478465"
---
# <a name="autoscaling"></a><span data-ttu-id="e71a8-103">Автомасштабирование</span><span class="sxs-lookup"><span data-stu-id="e71a8-103">Autoscaling</span></span>
[!INCLUDE [header](../_includes/header.md)]

<span data-ttu-id="e71a8-104">Автомасштабированием называется процесс динамического выделения ресурсов в соответствии с требованиями к производительности.</span><span class="sxs-lookup"><span data-stu-id="e71a8-104">Autoscaling is the process of dynamically allocating resources to match performance requirements.</span></span> <span data-ttu-id="e71a8-105">При увеличении объема работ приложению требуются дополнительные ресурсы, чтобы поддерживать необходимый уровень производительности и удовлетворять требования соглашений об уровне обслуживания (SLA).</span><span class="sxs-lookup"><span data-stu-id="e71a8-105">As the volume of work grows, an application may need additional resources to maintain the desired performance levels and satisfy service-level agreements (SLAs).</span></span> <span data-ttu-id="e71a8-106">При снижении нагрузки исчезает и потребность в дополнительных ресурсах, а значит их можно освободить для экономии средств.</span><span class="sxs-lookup"><span data-stu-id="e71a8-106">As demand slackens and the additional resources are no longer needed, they can be de-allocated to minimize costs.</span></span>

<span data-ttu-id="e71a8-107">Автоматическое масштабирование использует преимущества эластичности облачной среды и сокращает издержки на управление,</span><span class="sxs-lookup"><span data-stu-id="e71a8-107">Autoscaling takes advantage of the elasticity of cloud-hosted environments while easing management overhead.</span></span> <span data-ttu-id="e71a8-108">так как оператору не нужно отслеживать производительность системы и принимать решения о добавлении или удалении ресурсов.</span><span class="sxs-lookup"><span data-stu-id="e71a8-108">It reduces the need for an operator to continually monitor the performance of a system and make decisions about adding or removing resources.</span></span>

<span data-ttu-id="e71a8-109">Масштабировать приложение можно двумя способами:</span><span class="sxs-lookup"><span data-stu-id="e71a8-109">There are two main ways that an application can scale:</span></span> 

* <span data-ttu-id="e71a8-110">**Вертикальное масштабирование** (увеличение или уменьшение масштаба), означает изменение производительности ресурса.</span><span class="sxs-lookup"><span data-stu-id="e71a8-110">**Vertical scaling**, also called scaling up and down, means changing the capacity of a resource.</span></span> <span data-ttu-id="e71a8-111">Например, вы можете перенести приложение на виртуальную машину большего размера.</span><span class="sxs-lookup"><span data-stu-id="e71a8-111">For example, you could move an application to a larger VM size.</span></span> <span data-ttu-id="e71a8-112">Вертикальное масштабирование обычно сопряжено с временной неработоспособностью системы на период изменений в развертывании.</span><span class="sxs-lookup"><span data-stu-id="e71a8-112">Vertical scaling often requires making the system temporarily unavailable while it is being redeployed.</span></span> <span data-ttu-id="e71a8-113">По этой причине вертикальное масштабирование редко выполняется автоматически.</span><span class="sxs-lookup"><span data-stu-id="e71a8-113">Therefore, it's less common to automate vertical scaling.</span></span>
* <span data-ttu-id="e71a8-114">**Горизонтальное масштабирование** (развертывание и свертывание), означает добавление или удаление экземпляров ресурса.</span><span class="sxs-lookup"><span data-stu-id="e71a8-114">**Horizontal scaling**, also called scaling out and in, means adding or removing instances of a resource.</span></span> <span data-ttu-id="e71a8-115">При подготовке новых ресурсов приложение будет работать без перерывов.</span><span class="sxs-lookup"><span data-stu-id="e71a8-115">The application continues running without interruption as new resources are provisioned.</span></span> <span data-ttu-id="e71a8-116">Когда процесс подготовки завершится, решение будет развернуто на новых дополнительных ресурсах.</span><span class="sxs-lookup"><span data-stu-id="e71a8-116">When the provisioning process is complete, the solution is deployed on these additional resources.</span></span> <span data-ttu-id="e71a8-117">Если нагрузка снижается, дополнительные ресурсы можно выключить и отключить штатным образом.</span><span class="sxs-lookup"><span data-stu-id="e71a8-117">If demand drops, the additional resources can be shut down cleanly and deallocated.</span></span> 

<span data-ttu-id="e71a8-118">Многие облачные системы, включая Microsoft Azure, поддерживают автоматизацию горизонтального масштабирования.</span><span class="sxs-lookup"><span data-stu-id="e71a8-118">Many cloud-based systems, including Microsoft Azure, support automatic horizontal scaling.</span></span> <span data-ttu-id="e71a8-119">Оставшаяся часть этой статьи посвящена именно горизонтальному масштабированию.</span><span class="sxs-lookup"><span data-stu-id="e71a8-119">The rest of this article focuses on horizontal scaling.</span></span>

> [!NOTE]
> <span data-ttu-id="e71a8-120">Автоматическое масштабирование относится в основном к вычислительным ресурсам.</span><span class="sxs-lookup"><span data-stu-id="e71a8-120">Autoscaling mostly applies to compute resources.</span></span> <span data-ttu-id="e71a8-121">Базу данных или очередь сообщений также можно масштабировать горизонтально, но обычно это подразумевает [секционирование данных][data-partitioning], которое не так просто автоматизировать.</span><span class="sxs-lookup"><span data-stu-id="e71a8-121">While it's possible to horizontally scale a database or message queue, this usually involves [data partitioning][data-partitioning], which is generally not automated.</span></span>
>

## <a name="overview"></a><span data-ttu-id="e71a8-122">Обзор</span><span class="sxs-lookup"><span data-stu-id="e71a8-122">Overview</span></span>

<span data-ttu-id="e71a8-123">Стратегия автомасштабирования обычно включает следующие компоненты:</span><span class="sxs-lookup"><span data-stu-id="e71a8-123">An autoscaling strategy typically involves the following pieces:</span></span>

* <span data-ttu-id="e71a8-124">Системы инструментирования и мониторинга на уровне приложения, службы и инфраструктуры.</span><span class="sxs-lookup"><span data-stu-id="e71a8-124">Instrumentation and monitoring systems at the application, service, and infrastructure levels.</span></span> <span data-ttu-id="e71a8-125">Эти системы фиксируют такие ключевые метрики, как время ответа, длина очередей, использование ЦП и памяти.</span><span class="sxs-lookup"><span data-stu-id="e71a8-125">These systems capture key metrics, such as response times, queue lengths, CPU utilization, and memory usage.</span></span>
* <span data-ttu-id="e71a8-126">Логика принятия решений, которая сравнивает метрики с предопределенными пороговыми значениями или расписаниями и принимает решения о масштабировании.</span><span class="sxs-lookup"><span data-stu-id="e71a8-126">Decision-making logic that evaluates these metrics against predefined thresholds or schedules, and decides whether to scale.</span></span>
* <span data-ttu-id="e71a8-127">Компоненты, которые масштабируют систему.</span><span class="sxs-lookup"><span data-stu-id="e71a8-127">Components that scale the system.</span></span>
* <span data-ttu-id="e71a8-128">Тестирование, мониторинг и настройка стратегии автоматического масштабирования, чтобы убедиться в том, что она работает ожидаемым образом.</span><span class="sxs-lookup"><span data-stu-id="e71a8-128">Testing, monitoring, and tuning of the autoscaling strategy to ensure that it functions as expected.</span></span>

<span data-ttu-id="e71a8-129">Azure предлагает встроенные механизмы для автомасштабирования, разработанные для многих распространенных сценариев.</span><span class="sxs-lookup"><span data-stu-id="e71a8-129">Azure provides built-in autoscaling mechanisms that address common scenarios.</span></span> <span data-ttu-id="e71a8-130">Если какая-то служба или технология не имеет встроенных средств автомасштабирования или если ваши требования не соответствуют их возможностям, вы можете создать пользовательскую реализацию.</span><span class="sxs-lookup"><span data-stu-id="e71a8-130">If a particular service or technology does not have built-in autoscaling functionality, or if you have specific autoscaling requirements beyond its capabilities, you might consider a custom implementation.</span></span> <span data-ttu-id="e71a8-131">Ваша система может собирать рабочие и системные метрики, анализировать их и выполнять масштабирование ресурсов соответствующим образом.</span><span class="sxs-lookup"><span data-stu-id="e71a8-131">A custom implementation would collect operational and system metrics, analyze the metrics, and then scale resources accordingly.</span></span>

## <a name="configure-autoscaling-for-an-azure-solution"></a><span data-ttu-id="e71a8-132">Автоматическое масштабирование в решении Azure</span><span class="sxs-lookup"><span data-stu-id="e71a8-132">Configure autoscaling for an Azure solution</span></span>

<span data-ttu-id="e71a8-133">Azure поддерживает встроенное автомасштабирование для большинства вычислительных технологий.</span><span class="sxs-lookup"><span data-stu-id="e71a8-133">Azure provides built-in autoscaling for most compute options.</span></span>

* <span data-ttu-id="e71a8-134">**Виртуальные машины** поддерживают автомасштабирование с использованием [масштабируемых наборов виртуальных машин][vm-scale-sets], которые позволяют управлять набором виртуальных машин Azure как группой.</span><span class="sxs-lookup"><span data-stu-id="e71a8-134">**Virtual Machines** support autoscaling through the use of [VM Scale Sets][vm-scale-sets], which are a way to manage a set of Azure virtual machines as a group.</span></span> <span data-ttu-id="e71a8-135">См. статью [Как использовать автомасштабирование и масштабируемые наборы виртуальных машин][vm-scale-sets-autoscale].</span><span class="sxs-lookup"><span data-stu-id="e71a8-135">See [How to use automatic scaling and Virtual Machine Scale Sets][vm-scale-sets-autoscale].</span></span>

* <span data-ttu-id="e71a8-136">**Service Fabric** также поддерживает автомасштабирование с использованием масштабируемых наборов виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="e71a8-136">**Service Fabric** also supports auto-scaling through VM Scale Sets.</span></span> <span data-ttu-id="e71a8-137">Каждый тип узла в кластере Service Fabric настраивается как отдельный масштабируемый набор виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="e71a8-137">Every node type in a Service Fabric cluster is set up as a separate VM scale set.</span></span> <span data-ttu-id="e71a8-138">Это позволяет свертывать и развертывать каждый тип узла независимо от других типов.</span><span class="sxs-lookup"><span data-stu-id="e71a8-138">That way, each node type can be scaled in or out independently.</span></span> <span data-ttu-id="e71a8-139">См. статью [Масштабирование кластера Service Fabric с помощью правил автомасштабирования][service-fabric-autoscale].</span><span class="sxs-lookup"><span data-stu-id="e71a8-139">See [Scale a Service Fabric cluster in or out using auto-scale rules][service-fabric-autoscale].</span></span>

* <span data-ttu-id="e71a8-140">В **службе приложений Azure** реализован встроенный механизм автомасштабирования.</span><span class="sxs-lookup"><span data-stu-id="e71a8-140">**Azure App Service** has built-in autoscaling.</span></span> <span data-ttu-id="e71a8-141">Параметры автомасштабирования применяются ко всем приложениям в службе приложений.</span><span class="sxs-lookup"><span data-stu-id="e71a8-141">Autoscale settings apply to all of the apps within an App Service.</span></span> <span data-ttu-id="e71a8-142">См. статью [Масштабирование числа экземпляров вручную или автоматически][app-service-autoscale].</span><span class="sxs-lookup"><span data-stu-id="e71a8-142">See [Scale instance count manually or automatically][app-service-autoscale].</span></span>

* <span data-ttu-id="e71a8-143">В **облачных службах Azure** реализован встроенный механизм автомасштабирования на уровне роли.</span><span class="sxs-lookup"><span data-stu-id="e71a8-143">**Azure Cloud Services** has built-in autoscaling at the role level.</span></span> <span data-ttu-id="e71a8-144">См. статью [Как настроить автомасштабирование для облачной службы на портале][cloud-services-autoscale].</span><span class="sxs-lookup"><span data-stu-id="e71a8-144">See [How to configure auto scaling for a Cloud Service in the portal][cloud-services-autoscale].</span></span>

<span data-ttu-id="e71a8-145">Все эти вычислительные системы используют функцию [автомасштабирования Azure Monitor][monitoring], которая включает стандартный набор возможностей для автомасштабирования.</span><span class="sxs-lookup"><span data-stu-id="e71a8-145">These compute options all use [Azure Monitor autoscale][monitoring] to provide a common set of autoscaling functionality.</span></span>

* <span data-ttu-id="e71a8-146">Решение **Функции Azure** отличается от предыдущих вариантов тем, что для него не нужно настраивать правила автомасштабирования.</span><span class="sxs-lookup"><span data-stu-id="e71a8-146">**Azure Functions** differs from the previous compute options, because you don't need to configure any autoscale rules.</span></span> <span data-ttu-id="e71a8-147">Вместо этого оно автоматически распределяет вычислительную мощность при выполнении кода, при необходимости развертывая ресурсы в соответствии с нагрузкой.</span><span class="sxs-lookup"><span data-stu-id="e71a8-147">Instead, Azure Functions automatically allocates compute power when your code is running, scaling out as necessary to handle load.</span></span> <span data-ttu-id="e71a8-148">Дополнительные сведения см. в статье [Выбор подходящего плана размещения для Функций Azure][functions-scale].</span><span class="sxs-lookup"><span data-stu-id="e71a8-148">For more information, see [Choose the correct hosting plan for Azure Functions][functions-scale].</span></span>

<span data-ttu-id="e71a8-149">И наконец, иногда есть смысл создать пользовательское решение для автомасштабирования.</span><span class="sxs-lookup"><span data-stu-id="e71a8-149">Finally, a custom autoscaling solution can sometimes be useful.</span></span> <span data-ttu-id="e71a8-150">Например, вы можете использовать службы диагностики Azure и метрики приложений, чтобы в пользовательском коде отслеживать и экспортировать нужные метрики приложений.</span><span class="sxs-lookup"><span data-stu-id="e71a8-150">For example, you could use Azure diagnostics and application-based metrics, along with custom code to monitor and export the application metrics.</span></span> <span data-ttu-id="e71a8-151">На основе этих метрик можно определять пользовательские правила, которые с помощью API REST диспетчера ресурсов будут запускать автомасштабирование.</span><span class="sxs-lookup"><span data-stu-id="e71a8-151">Then you could define custom rules based on these metrics, and use Resource Manager REST APIs to trigger autoscaling.</span></span> <span data-ttu-id="e71a8-152">Однако пользовательское решение не так просто реализовать, и его следует рассматривать только в том случае, если ни один из предыдущих подходов вас не устраивает.</span><span class="sxs-lookup"><span data-stu-id="e71a8-152">However, a custom solution is not simple to implement, and should be considered only if none of the previous approaches can fulfill your requirements.</span></span>

<span data-ttu-id="e71a8-153">Используйте встроенные возможности платформы для автомасштабирования, если они отвечают вашим требованиям.</span><span class="sxs-lookup"><span data-stu-id="e71a8-153">Use the built-in autoscaling features of the platform, if they meet your requirements.</span></span> <span data-ttu-id="e71a8-154">Если же вы планируете применять более сложные функции масштабирования, оцените их целесообразность.</span><span class="sxs-lookup"><span data-stu-id="e71a8-154">If not, carefully consider whether you really need more complex scaling features.</span></span> <span data-ttu-id="e71a8-155">Могут появиться, например, такие дополнительные требования, как более точный контроль, разные способы обнаружения событий триггеров для масштабирования, масштабирование с использованием нескольких подписок или масштабирование ресурсов других типов.</span><span class="sxs-lookup"><span data-stu-id="e71a8-155">Examples of additional requirements may include more granularity of control, different ways to detect trigger events for scaling, scaling across subscriptions, and scaling other types of resources.</span></span>

## <a name="use-azure-monitor-autoscale"></a><span data-ttu-id="e71a8-156">Использование автомасштабирования Azure Monitor</span><span class="sxs-lookup"><span data-stu-id="e71a8-156">Use Azure Monitor autoscale</span></span>

<span data-ttu-id="e71a8-157">[Автомасштабирование Azure Monitor][monitoring] предоставляет стандартный набор функций для автоматического масштабирования масштабируемых наборов виртуальных машин, службы приложений Azure и облачной службы Azure.</span><span class="sxs-lookup"><span data-stu-id="e71a8-157">[Azure Monitor autoscale][monitoring] provide a common set of autoscaling functionality for VM Scale Sets, Azure App Service, and Azure Cloud Service.</span></span> <span data-ttu-id="e71a8-158">Масштабирование можно выполнять по расписанию или на основе метрик среды выполнения, таких как загрузка ЦП или использование памяти.</span><span class="sxs-lookup"><span data-stu-id="e71a8-158">Scaling can be performed on a schedule, or based on a runtime metric, such as CPU or memory usage.</span></span> <span data-ttu-id="e71a8-159">Примеры:</span><span class="sxs-lookup"><span data-stu-id="e71a8-159">Examples:</span></span>

- <span data-ttu-id="e71a8-160">Развертывание до 10 экземпляров в рабочие дни и свертывание до 4 экземпляров в субботу и воскресенье.</span><span class="sxs-lookup"><span data-stu-id="e71a8-160">Scale out to 10 instances on weekdays, and scale in to 4 instances on Saturday and Sunday.</span></span> 
- <span data-ttu-id="e71a8-161">Развертывание одного дополнительного экземпляра, если средняя загрузка ЦП превышает 70 %, и свертывание одного экземпляра, если загрузка ЦП опускается ниже 50 %.</span><span class="sxs-lookup"><span data-stu-id="e71a8-161">Scale out by one instance if average CPU usage is above 70%, and scale in by one instance if CPU usage falls below 50%.</span></span>
- <span data-ttu-id="e71a8-162">Развертывание одного экземпляра, если число сообщений в очереди превышает определенный порог.</span><span class="sxs-lookup"><span data-stu-id="e71a8-162">Scale out by one instance if the number of messages in a queue exceeds a certain threshold.</span></span>

<span data-ttu-id="e71a8-163">Список встроенных метрик см. в статье [Общие метрики автомасштабирования Azure Monitor][autoscale-metrics].</span><span class="sxs-lookup"><span data-stu-id="e71a8-163">For a list of built-in metrics, see [Azure Monitor autoscaling common metrics][autoscale-metrics].</span></span> <span data-ttu-id="e71a8-164">Вы можете создать собственные метрики с помощью Application Insights.</span><span class="sxs-lookup"><span data-stu-id="e71a8-164">You can also implement custom metrics by  using Application Insights.</span></span> 

<span data-ttu-id="e71a8-165">Автомасштабирование можно настроить с помощью PowerShell, Azure CLI, шаблонов Azure Resource Manager или портала Azure.</span><span class="sxs-lookup"><span data-stu-id="e71a8-165">You can configure autoscaling by using PowerShell, the Azure CLI, an Azure Resource Manager template, or the Azure portal.</span></span> <span data-ttu-id="e71a8-166">Для более точного управления используйте [REST API Azure Resource Manager](https://msdn.microsoft.com//library/azure/dn790568.aspx).</span><span class="sxs-lookup"><span data-stu-id="e71a8-166">For more detailed control, use the [Azure Resource Manager REST API](https://msdn.microsoft.com//library/azure/dn790568.aspx).</span></span> <span data-ttu-id="e71a8-167">[Библиотека управления службами мониторинга Azure](http://www.nuget.org/packages/Microsoft.WindowsAzure.Management.Monitoring) и [библиотека аналитики Microsoft](https://www.nuget.org/packages/Microsoft.Azure.Insights/) (в предварительной версии) — это пакеты SDK, которые позволяют собирать показатели различных ресурсов и выполнять автоматическое масштабирование, используя интерфейсы REST API.</span><span class="sxs-lookup"><span data-stu-id="e71a8-167">The [Azure Monitoring Service Management Library](http://www.nuget.org/packages/Microsoft.WindowsAzure.Management.Monitoring) and the [Microsoft Insights Library](https://www.nuget.org/packages/Microsoft.Azure.Insights/) (in preview) are SDKs that allow collecting metrics from different resources, and perform autoscaling by making use of the REST APIs.</span></span> <span data-ttu-id="e71a8-168">Для ресурсов, которые не поддерживают Azure Resource Manager, или при использовании облачных служб Azure для автоматического масштабирования можно воспользоваться REST API управления службами.</span><span class="sxs-lookup"><span data-stu-id="e71a8-168">For resources where Azure Resource Manager support isn't available, or if you are using Azure Cloud Services, the Service Management REST API can be used for autoscaling.</span></span> <span data-ttu-id="e71a8-169">Во всех остальных случаях для автоматического масштабирования рекомендуется применять Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="e71a8-169">In all other cases, use Azure Resource Manager.</span></span>

<span data-ttu-id="e71a8-170">При использовании автомасштабирования учитывайте следующие аспекты.</span><span class="sxs-lookup"><span data-stu-id="e71a8-170">Consider the following points when using Azure autoscale:</span></span>

* <span data-ttu-id="e71a8-171">Определите, есть ли у вас возможность прогнозировать нагрузку на приложение с достаточной точностью, чтобы использовать автомасштабирование по расписанию, заранее добавляя и удаляя экземпляры в соответствии с ожидаемыми всплесками нагрузки.</span><span class="sxs-lookup"><span data-stu-id="e71a8-171">Consider whether you can predict the load on the application well enough to use scheduled autoscaling, adding and removing instances to meet anticipated peaks in demand.</span></span> <span data-ttu-id="e71a8-172">Если это невозможно, используйте автомасштабирование на основе метрик среды выполнения, чтобы оперативно реагировать на непредсказуемые изменения спроса.</span><span class="sxs-lookup"><span data-stu-id="e71a8-172">If this isn't possible, use reactive autoscaling based on runtime metrics, in order to handle unpredictable changes in demand.</span></span> <span data-ttu-id="e71a8-173">Но обычно мы советуем объединить эти подходы.</span><span class="sxs-lookup"><span data-stu-id="e71a8-173">Typically, you can combine these approaches.</span></span> <span data-ttu-id="e71a8-174">Например, можно создать стратегию, которая по расписанию добавляет ресурсы перед известными периодами максимальной загрузки приложения.</span><span class="sxs-lookup"><span data-stu-id="e71a8-174">For example, create a strategy that adds resources based on a schedule of the times when you know the application is most busy.</span></span> <span data-ttu-id="e71a8-175">Так вы обеспечите достаточную производительность в нужный момент без задержек, связанных с запуском новых экземпляров.</span><span class="sxs-lookup"><span data-stu-id="e71a8-175">This helps to ensure that capacity is available when required, without any delay from starting new instances.</span></span> <span data-ttu-id="e71a8-176">В дополнение к каждому запланированному правилу определите метрики для оперативного автомасштабирования на период действия этого правила, чтобы приложение могло обрабатывать длительные и непредсказуемые всплески нагрузки.</span><span class="sxs-lookup"><span data-stu-id="e71a8-176">For each scheduled rule, define metrics that allow reactive autoscaling during that period to ensure that the application can handle sustained but unpredictable peaks in demand.</span></span>
* <span data-ttu-id="e71a8-177">Зачастую сложно понять связь между метриками и требованиями к мощности, особенно в случае, если приложение изначально развернуто.</span><span class="sxs-lookup"><span data-stu-id="e71a8-177">It's often difficult to understand the relationship between metrics and capacity requirements, especially when an application is initially deployed.</span></span> <span data-ttu-id="e71a8-178">Для начала выделите мощность с некоторым запасом, а затем наблюдайте и корректируйте работу правил автомасштабирования, чтобы выделяемая мощность как можно точнее соответствовала реальной нагрузке.</span><span class="sxs-lookup"><span data-stu-id="e71a8-178">Provision a little extra capacity at the beginning, and then monitor and tune the autoscaling rules to bring the capacity closer to the actual load.</span></span>
* <span data-ttu-id="e71a8-179">Настройте правила автомасштабирования, а затем отслеживайте изменения в производительности приложения.</span><span class="sxs-lookup"><span data-stu-id="e71a8-179">Configure the autoscaling rules, and then monitor the performance of your application over time.</span></span> <span data-ttu-id="e71a8-180">Используйте результаты такого отслеживания для настройки способа масштабирования системы при необходимости.</span><span class="sxs-lookup"><span data-stu-id="e71a8-180">Use the results of this monitoring to adjust the way in which the system scales if necessary.</span></span> <span data-ttu-id="e71a8-181">Однако помните, что автоматическое масштабирование не выполняется мгновенно.</span><span class="sxs-lookup"><span data-stu-id="e71a8-181">However, keep in mind that autoscaling is not an instantaneous process.</span></span> <span data-ttu-id="e71a8-182">Требуется время, чтобы среагировать на метрики, такие как средняя загрузка ЦП, превышающая указанное пороговое значение (или находящаяся ниже него).</span><span class="sxs-lookup"><span data-stu-id="e71a8-182">It takes time to react to a metric such as average CPU utilization exceeding (or falling below) a specified threshold.</span></span>
* <span data-ttu-id="e71a8-183">Правила автоматического масштабирования, использующие механизм обнаружения на основе измеренного атрибута триггера (например, загрузка ЦП или длина очереди), применяют агрегированное значение по времени, а не конкретное значение, чтобы запустить действие автоматического масштабирования.</span><span class="sxs-lookup"><span data-stu-id="e71a8-183">Autoscaling rules that use a detection mechanism based on a measured trigger attribute (such as CPU usage or queue length) use an aggregated value over time, rather than instantaneous values, to trigger an autoscaling action.</span></span> <span data-ttu-id="e71a8-184">По умолчанию агрегированное значение — это среднее значение.</span><span class="sxs-lookup"><span data-stu-id="e71a8-184">By default, the aggregate is an average of the values.</span></span> <span data-ttu-id="e71a8-185">Это позволяет предотвратить слишком быстрое реагирование системы или появление быстрых колебаний.</span><span class="sxs-lookup"><span data-stu-id="e71a8-185">This prevents the system from reacting too quickly, or causing rapid oscillation.</span></span> <span data-ttu-id="e71a8-186">При этом новым экземплярам, которые запускаются автоматически, также предоставляется время на переход в режим выполнения, что предотвращает выполнение дополнительных действий автоматического масштабирования в то время, когда происходит запуск новых экземпляров.</span><span class="sxs-lookup"><span data-stu-id="e71a8-186">It also allows time for new instances that are auto-started to settle into running mode, preventing additional autoscaling actions from occurring while the new instances are starting up.</span></span> <span data-ttu-id="e71a8-187">Для облачных служб и виртуальных машин Azure период агрегирования по умолчанию составляет 45 минут, поэтому для запуска метрикой автоматического масштабирования в ответ на пиковую нагрузку может потребоваться как раз такое время.</span><span class="sxs-lookup"><span data-stu-id="e71a8-187">For Azure Cloud Services and Azure Virtual Machines, the default period for the aggregation is 45 minutes, so it can take up to this period of time for the metric to trigger autoscaling in response to spikes in demand.</span></span> <span data-ttu-id="e71a8-188">Период агрегирования можно изменить с помощью пакета SDK, но помните, что период длительностью менее 25 минут может привести к непредсказуемым результатам. Дополнительные сведения см. в статье [Auto Scaling Cloud Services on CPU Percentage with the Azure Monitoring Services Management Library](http://rickrainey.com/2013/12/15/auto-scaling-cloud-services-on-cpu-percentage-with-the-windows-azure-monitoring-services-management-library/) (Автоматическое масштабирование облачных служб на основе загрузки ЦП с помощью библиотеки управления службами мониторинга Azure).</span><span class="sxs-lookup"><span data-stu-id="e71a8-188">You can change the aggregation period by using the SDK, but be aware that periods of fewer than 25 minutes may cause unpredictable results (for more information, see [Auto Scaling Cloud Services on CPU Percentage with the Azure Monitoring Services Management Library](http://rickrainey.com/2013/12/15/auto-scaling-cloud-services-on-cpu-percentage-with-the-windows-azure-monitoring-services-management-library/)).</span></span> <span data-ttu-id="e71a8-189">Для веб-приложений средний период намного меньше, благодаря чему новые экземпляры доступны приблизительно в течение пяти минут после изменения среднего показателя триггера.</span><span class="sxs-lookup"><span data-stu-id="e71a8-189">For Web Apps, the averaging period is much shorter, allowing new instances to be available in about five minutes after a change to the average trigger measure.</span></span>
* <span data-ttu-id="e71a8-190">Если вы настраиваете автомасштабирование с помощью пакета SDK, а не на портале, вы можете указать более подробное расписание для использования правил.</span><span class="sxs-lookup"><span data-stu-id="e71a8-190">If you configure autoscaling using the SDK rather than the portal, you can specify a more detailed schedule during which the rules are active.</span></span> <span data-ttu-id="e71a8-191">Можно также создать свои собственные метрики и использовать их как отдельно, так и в сочетании с любыми метриками, существующими в правилах автоматического масштабирования.</span><span class="sxs-lookup"><span data-stu-id="e71a8-191">You can also create your own metrics and use them with or without any of the existing ones in your autoscaling rules.</span></span> <span data-ttu-id="e71a8-192">Например, можно использовать альтернативные счетчики (числа запросов в секунду, объема доступной памяти и т. д.), либо настраиваемые счетчики, измеряющие определенные бизнес-процессы.</span><span class="sxs-lookup"><span data-stu-id="e71a8-192">For example, you may wish to use alternative counters, such as the number of requests per second or the average memory availability, or use custom counters that measure specific business processes.</span></span>
* <span data-ttu-id="e71a8-193">Если вы настраиваете автомасштабирование для Service Fabric, учтите, что типы узлов в кластере соответствуют масштабируемым наборам виртуальных машин в серверной части. Это значит, что правила автомасштабирования нужно настраивать отдельно для каждого типа узлов.</span><span class="sxs-lookup"><span data-stu-id="e71a8-193">When autoscaling Service Fabric, the node types in your cluster are made of VM scale sets at the backend, so you need to set up auto-scale rules for each node type.</span></span> <span data-ttu-id="e71a8-194">Перед настройкой автомасштабирования обратите внимание на необходимое количество узлов.</span><span class="sxs-lookup"><span data-stu-id="e71a8-194">Take into account the number of nodes that you must have before you set up auto-scaling.</span></span> <span data-ttu-id="e71a8-195">Минимальное количество узлов, необходимое для основного типа узлов, зависит от выбранного уровня надежности.</span><span class="sxs-lookup"><span data-stu-id="e71a8-195">The minimum number of nodes that you must have for the primary node type is driven by the reliability level you have chosen.</span></span> <span data-ttu-id="e71a8-196">Дополнительные сведения см. в статье [Масштабирование кластера Service Fabric с помощью правил автомасштабирования](https://docs.microsoft.com/azure/service-fabric/service-fabric-cluster-scale-up-down).</span><span class="sxs-lookup"><span data-stu-id="e71a8-196">For more info, see [scale a Service Fabric cluster in or out using auto-scale rules](https://docs.microsoft.com/azure/service-fabric/service-fabric-cluster-scale-up-down).</span></span>
* <span data-ttu-id="e71a8-197">С помощью портала вы можете связать ресурсы (такие как экземпляры базы данных SQL и очереди) с экземпляром облачной службы.</span><span class="sxs-lookup"><span data-stu-id="e71a8-197">You can use the portal to link resources such as SQL Database instances and queues to a Cloud Service instance.</span></span> <span data-ttu-id="e71a8-198">Это позволяет упростить доступ к отдельным вариантам конфигурации масштабирования вручную и автоматически для всех связанных ресурсов.</span><span class="sxs-lookup"><span data-stu-id="e71a8-198">This allows you to more easily access the separate manual and automatic scaling configuration options for each of the linked resources.</span></span> <span data-ttu-id="e71a8-199">Дополнительные сведения см. в статье [Управление облачными службами](/azure/cloud-services/cloud-services-how-to-manage).</span><span class="sxs-lookup"><span data-stu-id="e71a8-199">For more information, see [How to: Link a resource to a cloud service](/azure/cloud-services/cloud-services-how-to-manage).</span></span>
* <span data-ttu-id="e71a8-200">При настройке нескольких политик и правил существует вероятность, что они могут конфликтовать друг с другом.</span><span class="sxs-lookup"><span data-stu-id="e71a8-200">When you configure multiple policies and rules, they could conflict with each other.</span></span> <span data-ttu-id="e71a8-201">Функция автоматического масштабирования использует следующие правила разрешения конфликтов, чтобы гарантировать, что всегда будет достаточное количество экземпляров.</span><span class="sxs-lookup"><span data-stu-id="e71a8-201">Autoscale uses the following conflict resolution rules to ensure that there is always a sufficient number of instances running:</span></span>
  * <span data-ttu-id="e71a8-202">Операции масштабирования наружу всегда имеют приоритет над операциями масштабирования внутрь.</span><span class="sxs-lookup"><span data-stu-id="e71a8-202">Scale out operations always take precedence over scale in operations.</span></span>
  * <span data-ttu-id="e71a8-203">При возникновении конфликта операций масштабирования наружу приоритет имеет правило, которое инициирует наибольшее увеличение числа экземпляров.</span><span class="sxs-lookup"><span data-stu-id="e71a8-203">When scale out operations conflict, the rule that initiates the largest increase in the number of instances takes precedence.</span></span>
  * <span data-ttu-id="e71a8-204">При возникновении конфликта операций масштабирования внутрь приоритет имеет правило, которое инициирует наименьшее уменьшение числа экземпляров.</span><span class="sxs-lookup"><span data-stu-id="e71a8-204">When scale in operations conflict, the rule that initiates the smallest decrease in the number of instances takes precedence.</span></span>
* <span data-ttu-id="e71a8-205">Чтобы определить правила автомасштабирования в среде службы приложений, можно использовать любые метрики рабочего пула или внешнего интерфейса.</span><span class="sxs-lookup"><span data-stu-id="e71a8-205">In an App Service Environment any worker pool or front-end metrics can be used to define autoscale rules.</span></span> <span data-ttu-id="e71a8-206">Дополнительные сведения см. в статье [Автомасштабирование и среда службы приложений версии 1](/azure/app-service/app-service-environment-auto-scale).</span><span class="sxs-lookup"><span data-stu-id="e71a8-206">For more information, see [Autoscaling and App Service Environment](/azure/app-service/app-service-environment-auto-scale).</span></span>

## <a name="application-design-considerations"></a><span data-ttu-id="e71a8-207">Рекомендации по проектированию приложений</span><span class="sxs-lookup"><span data-stu-id="e71a8-207">Application design considerations</span></span>
<span data-ttu-id="e71a8-208">Автоматическое масштабирование не реализуется мгновенно.</span><span class="sxs-lookup"><span data-stu-id="e71a8-208">Autoscaling isn't an instant solution.</span></span> <span data-ttu-id="e71a8-209">Простое добавление ресурсов в систему или ввод в эксплуатацию большего числа экземпляров процесса не гарантирует, что это приведет к повышению производительности системы.</span><span class="sxs-lookup"><span data-stu-id="e71a8-209">Simply adding resources to a system or running more instances of a process doesn't guarantee that the performance of the system will improve.</span></span> <span data-ttu-id="e71a8-210">При разработке стратегии автоматического масштабирования необходимо учитывать следующее.</span><span class="sxs-lookup"><span data-stu-id="e71a8-210">Consider the following points when designing an autoscaling strategy:</span></span>

* <span data-ttu-id="e71a8-211">Система должна поддерживать возможность горизонтального масштабирования.</span><span class="sxs-lookup"><span data-stu-id="e71a8-211">The system must be designed to be horizontally scalable.</span></span> <span data-ttu-id="e71a8-212">Избегайте делать предположения относительно определения экземпляра; не создавайте решения, которые требуют, чтобы код всегда выполнялся в конкретном экземпляре процесса.</span><span class="sxs-lookup"><span data-stu-id="e71a8-212">Avoid making assumptions about instance affinity; do not design solutions that require that the code is always running in a specific instance of a process.</span></span> <span data-ttu-id="e71a8-213">При масштабировании облачной службы или веб-сайта не следует предполагать, что последовательность запросов из одного и того же источника всегда будет направляться в один и тот же экземпляр.</span><span class="sxs-lookup"><span data-stu-id="e71a8-213">When scaling a cloud service or web site horizontally, don't assume that a series of requests from the same source will always be routed to the same instance.</span></span> <span data-ttu-id="e71a8-214">По этой же причине службы следует разрабатывать без сохранения состояния. Это позволит избежать того, чтобы серия запросов из приложения всегда направлялась в тот же экземпляр службы.</span><span class="sxs-lookup"><span data-stu-id="e71a8-214">For the same reason, design services to be stateless to avoid requiring a series of requests from an application to always be routed to the same instance of a service.</span></span> <span data-ttu-id="e71a8-215">При разработке службы, которая считывает сообщения из очереди и обрабатывает их, не делайте никаких предположений о том, какой экземпляр службы обрабатывает определенное сообщение.</span><span class="sxs-lookup"><span data-stu-id="e71a8-215">When designing a service that reads messages from a queue and processes them, don't make any assumptions about which instance of the service handles a specific message.</span></span> <span data-ttu-id="e71a8-216">Функция автоматического масштабирования может запустить дополнительные экземпляры службы при увеличении длины очереди.</span><span class="sxs-lookup"><span data-stu-id="e71a8-216">Autoscaling could start additional instances of a service as the queue length grows.</span></span> <span data-ttu-id="e71a8-217">В описании [шаблона конкурирующих потребителей][competing-consumers] показано решение для этого сценария.</span><span class="sxs-lookup"><span data-stu-id="e71a8-217">The [Competing Consumers Pattern][competing-consumers] describes how to handle this scenario.</span></span>
* <span data-ttu-id="e71a8-218">Если решение реализует длительно выполняемую задачу, то такую задачу следует создать так, чтобы она поддерживала как масштабирование наружу, так и масштабирование внутрь.</span><span class="sxs-lookup"><span data-stu-id="e71a8-218">If the solution implements a long-running task, design this task to support both scaling out and scaling in.</span></span> <span data-ttu-id="e71a8-219">Без соответствующей разработки такая задача может помешать аккуратному завершению работы экземпляра процесса при свертывании системы или привести к потере данных, если процесс принудительно завершен.</span><span class="sxs-lookup"><span data-stu-id="e71a8-219">Without due care, such a task could prevent an instance of a process from being shut down cleanly when the system scales in, or it could lose data if the process is forcibly terminated.</span></span> <span data-ttu-id="e71a8-220">В идеале для длительно выполняемой задачи следует выполнить рефакторинг и разбить процесс обработки, которую он выполняет, на отдельные фрагменты.</span><span class="sxs-lookup"><span data-stu-id="e71a8-220">Ideally, refactor a long-running task and break up the processing that it performs into smaller, discrete chunks.</span></span> <span data-ttu-id="e71a8-221">В описании [шаблона с каналами и фильтрами][pipes-and-filters] представлен пример того, как это можно сделать.</span><span class="sxs-lookup"><span data-stu-id="e71a8-221">The [Pipes and Filters Pattern][pipes-and-filters] provides an example of how you can achieve this.</span></span>
* <span data-ttu-id="e71a8-222">Кроме того, можно реализовать механизм контрольных точек, который регулярно записывает сведения о состоянии задачи через определенные интервалы времени, а затем сохраняет это состояние в долговременном хранилище, доступ к которому может получить любой экземпляр процесса, выполняющего задачу.</span><span class="sxs-lookup"><span data-stu-id="e71a8-222">Alternatively, you can implement a checkpoint mechanism that records state information about the task at regular intervals, and save this state in durable storage that can be accessed by any instance of the process running the task.</span></span> <span data-ttu-id="e71a8-223">Таким образом, если процесс завершен, работу, которую он выполнял, можно возобновить с последней контрольной точки с помощью другого экземпляра.</span><span class="sxs-lookup"><span data-stu-id="e71a8-223">In this way, if the process is shutdown, the work that it was performing can be resumed from the last checkpoint by using another instance.</span></span>
* <span data-ttu-id="e71a8-224">Когда фоновые задачи выполняются в отдельных вычислительных операциях, таких как рабочие роли облачных служб, в которых размещено приложение, может потребоваться масштабирование различных частей приложения с использованием различных политик масштабирования.</span><span class="sxs-lookup"><span data-stu-id="e71a8-224">When background tasks run on separate compute instances, such as in worker roles of a cloud services hosted application, you may need to scale different parts of the application using different scaling policies.</span></span> <span data-ttu-id="e71a8-225">Например, может потребоваться развернуть дополнительные вычислительные операции пользовательского интерфейса без увеличения числа фоновых экземпляров вычислительных операций или наоборот.</span><span class="sxs-lookup"><span data-stu-id="e71a8-225">For example, you may need to deploy additional user interface (UI) compute instances without increasing the number of background compute instances, or the opposite of this.</span></span> <span data-ttu-id="e71a8-226">Если предлагаются различные уровни обслуживания (например, пакеты служб Basic и Premium), может потребоваться масштабировать вычислительные ресурсы для пакетов служб Premium активнее, чем для пакета служб Basic, чтобы обеспечить соблюдение требований соглашения об уровне обслуживания.</span><span class="sxs-lookup"><span data-stu-id="e71a8-226">If you offer different levels of service (such as basic and premium service packages), you may need to scale out the compute resources for premium service packages more aggressively than those for basic service packages in order to meet SLAs.</span></span>
* <span data-ttu-id="e71a8-227">Рассмотрите возможность использования длины очереди, через которую взаимодействуют пользовательский интерфейс и фоновые вычислительные операции, в качестве ведущего критерия стратегии автоматического масштабирования.</span><span class="sxs-lookup"><span data-stu-id="e71a8-227">Consider using the length of the queue over which UI and background compute instances communicate as a criterion for your autoscaling strategy.</span></span> <span data-ttu-id="e71a8-228">Это лучший показатель несоответствия или различия между текущей нагрузкой и производительностью обработки фоновой задачи.</span><span class="sxs-lookup"><span data-stu-id="e71a8-228">This is the best indicator of an imbalance or difference between the current load and the processing capacity of the background task.</span></span>
* <span data-ttu-id="e71a8-229">Если стратегия автоматического масштабирования основана на счетчиках, измеряющих бизнес-процессы (например, количество заказов, размещенных в час, или среднее время выполнения сложной транзакции), убедитесь в том, что вы полностью понимаете связь между результатами, получаемыми от этих типов счетчиков, и требованиями к фактической емкости вычислительных ресурсов.</span><span class="sxs-lookup"><span data-stu-id="e71a8-229">If you base your autoscaling strategy on counters that measure business processes, such as the number of orders placed per hour or the average execution time of a complex transaction, ensure that you fully understand the relationship between the results from these types of counters and the actual compute capacity requirements.</span></span> <span data-ttu-id="e71a8-230">В ответ на изменения в данных, поступаемых от счетчиков бизнес-процессов, может потребоваться масштабировать несколько компонентов или единиц вычисления.</span><span class="sxs-lookup"><span data-stu-id="e71a8-230">It may be necessary to scale more than one component or compute unit in response to changes in business process counters.</span></span>  
* <span data-ttu-id="e71a8-231">Чтобы предотвратить попытки системы выполнить чрезмерное масштабирование и избежать затрат, связанных с выполнением тысяч экземпляров, рекомендуется ограничить максимальное количество экземпляров, которые можно добавлять автоматически.</span><span class="sxs-lookup"><span data-stu-id="e71a8-231">To prevent a system from attempting to scale out excessively, and to avoid the costs associated with running many thousands of instances, consider limiting the maximum number of instances that can be automatically added.</span></span> <span data-ttu-id="e71a8-232">Большинство механизмов автоматического масштабирования позволяют указать минимальное и максимальное число экземпляров для правила.</span><span class="sxs-lookup"><span data-stu-id="e71a8-232">Most autoscaling mechanisms allow you to specify the minimum and maximum number of instances for a rule.</span></span> <span data-ttu-id="e71a8-233">Кроме того, рекомендуется корректно снизить функциональные возможности системы, если развернуто максимальное количество экземпляров, но система по-прежнему перегружена.</span><span class="sxs-lookup"><span data-stu-id="e71a8-233">In addition, consider gracefully degrading the functionality that the system provides if the maximum number of instances have been deployed, and the system is still overloaded.</span></span>
* <span data-ttu-id="e71a8-234">Помните, что автоматическое масштабирование может оказаться не таким уж и полезным механизмом в случае внезапного резкого увеличения рабочей нагрузки.</span><span class="sxs-lookup"><span data-stu-id="e71a8-234">Keep in mind that autoscaling might not be the most appropriate mechanism to handle a sudden burst in workload.</span></span> <span data-ttu-id="e71a8-235">Для подготовки и запуска новых экземпляров службы или добавления ресурсов в систему требуется время, а к моменту, когда эти дополнительные ресурсы станут доступны, пик нагрузки может пройти.</span><span class="sxs-lookup"><span data-stu-id="e71a8-235">It takes time to provision and start new instances of a service or add resources to a system, and the peak demand may have passed by the time these additional resources have been made available.</span></span> <span data-ttu-id="e71a8-236">В этом случае лучше всего подходит регулирование службы.</span><span class="sxs-lookup"><span data-stu-id="e71a8-236">In this scenario, it may be better to throttle the service.</span></span> <span data-ttu-id="e71a8-237">Дополнительные сведения см. в описании [шаблона регулирования][throttling].</span><span class="sxs-lookup"><span data-stu-id="e71a8-237">For more information, see the [Throttling Pattern][throttling].</span></span>
* <span data-ttu-id="e71a8-238">И наоборот, если требуется вычислительная мощность для обработки всех запросов, когда объем изменяется достаточно быстро, а стоимость не является определяющим фактором, рассмотрите возможность использования стратегии агрессивного автоматического масштабирования, в рамках которой дополнительные экземпляры запускаются быстрее.</span><span class="sxs-lookup"><span data-stu-id="e71a8-238">Conversely, if you do need the capacity to process all requests when the volume fluctuates rapidly, and cost isn't a major contributing factor, consider using an aggressive autoscaling strategy that starts additional instances more quickly.</span></span> <span data-ttu-id="e71a8-239">Можно также использовать вариант применения запланированной политики, которая запускает достаточное количество экземпляров для обработки максимальной нагрузки до того, когда эта нагрузка ожидается.</span><span class="sxs-lookup"><span data-stu-id="e71a8-239">You can also use a scheduled policy that starts a sufficient number of instances to meet the maximum load before that load is expected.</span></span>
* <span data-ttu-id="e71a8-240">Механизм автоматического масштабирования должен контролировать процесс автоматического масштабирования и фиксировать подробные сведения о каждом событии (что стало причиной, какие ресурсы были добавлены или удалены и когда).</span><span class="sxs-lookup"><span data-stu-id="e71a8-240">The autoscaling mechanism should monitor the autoscaling process, and log the details of each autoscaling event (what triggered it, what resources were added or removed, and when).</span></span> <span data-ttu-id="e71a8-241">При создании настраиваемого механизма автоматического масштабирования обязательно реализуйте в нем эту функциональную возможность.</span><span class="sxs-lookup"><span data-stu-id="e71a8-241">If you create a custom autoscaling mechanism, ensure that it incorporates this capability.</span></span> <span data-ttu-id="e71a8-242">Полученные сведения можно проанализировать, чтобы измерить эффективность стратегии автоматического масштабирования и при необходимости адаптировать ее.</span><span class="sxs-lookup"><span data-stu-id="e71a8-242">Analyze the information to help measure the effectiveness of the autoscaling strategy, and tune it if necessary.</span></span> <span data-ttu-id="e71a8-243">Ее можно настроить как в краткосрочной перспективе, по мере того, как шаблоны использования становятся более очевидными, так и в долгосрочной перспективе, по мере расширения бизнеса или изменения требований приложения.</span><span class="sxs-lookup"><span data-stu-id="e71a8-243">You can tune both in the short term, as the usage patterns become more obvious, and over the long term, as the business expands or the requirements of the application evolve.</span></span> <span data-ttu-id="e71a8-244">Если приложение достигает верхнего предела, определенного для автоматического масштабирования, механизм может также оповестить оператора, который может при необходимости вручную запустить дополнительные ресурсы.</span><span class="sxs-lookup"><span data-stu-id="e71a8-244">If an application reaches the upper limit defined for autoscaling, the mechanism might also alert an operator who could manually start additional resources if necessary.</span></span> <span data-ttu-id="e71a8-245">Обратите внимание, что при этих обстоятельствах оператор также может отвечать за удаление этих ресурсов вручную после снижения рабочей нагрузки.</span><span class="sxs-lookup"><span data-stu-id="e71a8-245">Note that, under these circumstances, the operator may also be responsible for manually removing these resources after the workload eases.</span></span>

## <a name="related-patterns-and-guidance"></a><span data-ttu-id="e71a8-246">Связанные шаблоны и рекомендации</span><span class="sxs-lookup"><span data-stu-id="e71a8-246">Related patterns and guidance</span></span>
<span data-ttu-id="e71a8-247">При реализации автоматического масштабирования рекомендуется принять во внимание следующие шаблоны и рекомендации.</span><span class="sxs-lookup"><span data-stu-id="e71a8-247">The following patterns and guidance may also be relevant to your scenario when implementing autoscaling:</span></span>

* <span data-ttu-id="e71a8-248">[Шаблон регулирования][throttling].</span><span class="sxs-lookup"><span data-stu-id="e71a8-248">[Throttling Pattern][throttling].</span></span> <span data-ttu-id="e71a8-249">Этот шаблон описывает, каким образом приложение может продолжить работать и обеспечивать выполнение требований соглашений об уровне обслуживания по мере увеличения нагрузки на ресурсы.</span><span class="sxs-lookup"><span data-stu-id="e71a8-249">This pattern describes how an application can continue to function and meet SLAs when an increase in demand places an extreme load on resources.</span></span> <span data-ttu-id="e71a8-250">Регулирование можно использовать совместно с автоматическим масштабированием для предотвращения перегрузки системы во время ее масштабирования наружу.</span><span class="sxs-lookup"><span data-stu-id="e71a8-250">Throttling can be used with autoscaling to prevent a system from being overwhelmed while the system scales out.</span></span>
* <span data-ttu-id="e71a8-251">[Шаблон конкурирующих потребителей][competing-consumers].</span><span class="sxs-lookup"><span data-stu-id="e71a8-251">[Competing Consumers Pattern][competing-consumers].</span></span> <span data-ttu-id="e71a8-252">Этот шаблон описывает то, как реализуется пул экземпляров службы, которые могут обрабатывать сообщения от любого экземпляра приложения.</span><span class="sxs-lookup"><span data-stu-id="e71a8-252">This pattern describes how to implement a pool of service instances that can handle messages from any application instance.</span></span> <span data-ttu-id="e71a8-253">Автоматическое масштабирование можно использовать для запуска и остановки экземпляров службы в соответствии с ожидаемой рабочей нагрузкой.</span><span class="sxs-lookup"><span data-stu-id="e71a8-253">Autoscaling can be used to start and stop service instances to match the anticipated workload.</span></span> <span data-ttu-id="e71a8-254">Такой подход позволяет обрабатывать несколько сообщений одновременно, чтобы оптимизировать пропускную способность для повышения масштабируемости и доступности, а также для распределения рабочей нагрузки в системе.</span><span class="sxs-lookup"><span data-stu-id="e71a8-254">This approach enables a system to process multiple messages concurrently to optimize throughput, improve scalability and availability, and balance the workload.</span></span>
* <span data-ttu-id="e71a8-255">[Мониторинг и диагностика](./monitoring.md).</span><span class="sxs-lookup"><span data-stu-id="e71a8-255">[Monitoring and diagnostics](./monitoring.md).</span></span> <span data-ttu-id="e71a8-256">Инструментирование и телеметрия очень важны для сбора информации, которая требуется в процессе автоматического масштабирования.</span><span class="sxs-lookup"><span data-stu-id="e71a8-256">Instrumentation and telemetry are vital for gathering the information that can drive the autoscaling process.</span></span>


<!-- links -->

[monitoring]: /azure/monitoring-and-diagnostics/monitoring-overview-autoscale
[app-service-autoscale]: /azure/monitoring-and-diagnostics/insights-how-to-scale?toc=%2fazure%2fapp-service-web%2ftoc.json#scaling-based-on-a-pre-set-metric
[app-service-plan]: /azure/app-service/azure-web-sites-web-hosting-plans-in-depth-overview
[autoscale-metrics]: /azure/monitoring-and-diagnostics/insights-autoscale-common-metrics
[cloud-services-autoscale]: /azure/cloud-services/cloud-services-how-to-scale-portal
[competing-consumers]: ../patterns/competing-consumers.md
[data-partitioning]: ./data-partitioning.md
[functions-scale]: /azure/azure-functions/functions-scale
[link-resource-to-cloud-service]: /azure/cloud-services/cloud-services-how-to-manage#how-to-link-a-resource-to-a-cloud-service
[pipes-and-filters]: ../patterns/pipes-and-filters.md
[service-fabric-autoscale]: /azure/service-fabric/service-fabric-cluster-scale-up-down
[throttling]: ../patterns/throttling.md
[vm-scale-sets]: /azure/virtual-machine-scale-sets/virtual-machine-scale-sets-overview
[vm-scale-sets-autoscale]: /azure/virtual-machine-scale-sets/virtual-machine-scale-sets-autoscale-overview
