---
title: Руководство по сети доставки содержимого
titleSuffix: Best practices for cloud applications
description: Рекомендации по использованию сети доставки содержимого (CDN) для доставки содержимого, размещенного в Azure, по сети с высокой пропускной способностью.
author: dragon119
ms.date: 02/02/2018
ms.topic: best-practice
ms.service: architecture-center
ms.subservice: cloud-fundamentals
ms.custom: seodec18
ms.openlocfilehash: f4ffe9c5cdd7a53ab8359ef303076c5e53e9e45c
ms.sourcegitcommit: c053e6edb429299a0ad9b327888d596c48859d4a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/20/2019
ms.locfileid: "58249109"
---
# <a name="content-delivery-networks-cdns"></a><span data-ttu-id="c1847-103">Сети доставки содержимого (CDN)</span><span class="sxs-lookup"><span data-stu-id="c1847-103">Content delivery networks (CDNs)</span></span>

<span data-ttu-id="c1847-104">Сеть доставки содержимого (CDN) является распределенной сетью серверов, которая позволяет эффективно доставлять пользователям веб-содержимое.</span><span class="sxs-lookup"><span data-stu-id="c1847-104">A content delivery network (CDN) is a distributed network of servers that can efficiently deliver web content to users.</span></span> <span data-ttu-id="c1847-105">Сети CDN хранят кэшированное содержимое на пограничных серверах, расположенных рядом с пользователями, чтобы свести к минимуму задержки.</span><span class="sxs-lookup"><span data-stu-id="c1847-105">CDNs store cached content on edge servers that are close to end-users, to minimize latency.</span></span>

<span data-ttu-id="c1847-106">Обычно CDN применяются для доставки статического содержимого: изображений, таблиц стилей, документов, клиентских скриптов и HTML-страниц.</span><span class="sxs-lookup"><span data-stu-id="c1847-106">CDNs are typically used to deliver static content such as images, style sheets, documents, client-side scripts, and HTML pages.</span></span> <span data-ttu-id="c1847-107">В числе основных преимуществ CDN — низкая задержка и скорость доставки содержимого всем пользователям независимо от географического расстояния от центра обработки данных, в котором размещено приложение.</span><span class="sxs-lookup"><span data-stu-id="c1847-107">The major advantages of using a CDN are lower latency and faster delivery of content to users, regardless of their geographical location in relation to the datacenter where the application is hosted.</span></span> <span data-ttu-id="c1847-108">Кроме того, CDN помогают снизить нагрузку на веб-приложение, избавляя его от запросов на получение содержимого, размещенного в CDN.</span><span class="sxs-lookup"><span data-stu-id="c1847-108">CDNs can also help to reduce load on a web application, because the application does not have to service requests for the content that is hosted in the CDN.</span></span>

![Схема сети CDN](./images/cdn/CDN.png)

<span data-ttu-id="c1847-110">[Сеть доставки содержимого Azure](/azure/cdn/cdn-overview) предлагает глобальное решение CDN для доставки содержимого, требующего высокой пропускной способности, размещенного в Azure или любом другом расположении.</span><span class="sxs-lookup"><span data-stu-id="c1847-110">In Azure, the [Azure Content Delivery Network](/azure/cdn/cdn-overview) is a global CDN solution for delivering high-bandwidth content that is hosted in Azure or any other location.</span></span> <span data-ttu-id="c1847-111">Используя Azure CDN, вы можете кэшировать общедоступные объекты из хранилища BLOB-объектов Azure, веб-приложения, виртуальной машины или любого общедоступного веб-сервера.</span><span class="sxs-lookup"><span data-stu-id="c1847-111">Using Azure CDN, you can cache publicly available objects loaded from Azure blob storage, a web application, virtual machine, any publicly accessible web server.</span></span>

<span data-ttu-id="c1847-112">В этой статье описываются некоторые общие рекомендации и советы по использованию CDN.</span><span class="sxs-lookup"><span data-stu-id="c1847-112">This topic describes some general best practices and considerations when using a CDN.</span></span> <span data-ttu-id="c1847-113">Дополнительные сведения см. в документации по [Azure CDN](/azure/cdn/).</span><span class="sxs-lookup"><span data-stu-id="c1847-113">For more information, see [Azure CDN](/azure/cdn/).</span></span>

## <a name="how-and-why-a-cdn-is-used"></a><span data-ttu-id="c1847-114">Как и для чего используется CDN</span><span class="sxs-lookup"><span data-stu-id="c1847-114">How and why a CDN is used</span></span>

<span data-ttu-id="c1847-115">К типичным случаям использования CDN относятся:</span><span class="sxs-lookup"><span data-stu-id="c1847-115">Typical uses for a CDN include:</span></span>  

- <span data-ttu-id="c1847-116">Доставка статических ресурсов для клиентских приложений, часто с веб-сайта.</span><span class="sxs-lookup"><span data-stu-id="c1847-116">Delivering static resources for client applications, often from a website.</span></span> <span data-ttu-id="c1847-117">Это могут быть изображения, таблицы стилей, документы, файлы, клиентские скрипты, HTML-страницы, фрагменты HTML или любое другое содержимое, которое серверу не нужно изменять по каждому запросу.</span><span class="sxs-lookup"><span data-stu-id="c1847-117">These resources can be images, style sheets, documents, files, client-side scripts, HTML pages, HTML fragments, or any other content that the server does not need to modify for each request.</span></span> <span data-ttu-id="c1847-118">Приложение может создавать элементы во время выполнения и предоставлять их в сеть CDN (например, путем создания списка текущих новостей), но оно делает это не для каждого запроса.</span><span class="sxs-lookup"><span data-stu-id="c1847-118">The application can create items at runtime and make them available to the CDN (for example, by creating a list of current news headlines), but it does not do so for each request.</span></span>

- <span data-ttu-id="c1847-119">Доставка общедоступного статического и общего содержимого на устройства, например мобильные телефоны и планшетные компьютеры.</span><span class="sxs-lookup"><span data-stu-id="c1847-119">Delivering public static and shared content to devices such as mobile phones and tablet computers.</span></span> <span data-ttu-id="c1847-120">Само приложение является веб-службой, которая предоставляет доступ к API клиентам, запущенным на разных устройствах.</span><span class="sxs-lookup"><span data-stu-id="c1847-120">The application itself is a web service that offers an API to clients running on the various devices.</span></span> <span data-ttu-id="c1847-121">CDN также может доставлять статические наборы данных (через веб-службу) для использования клиентами, в том числе для создания пользовательского интерфейса клиента.</span><span class="sxs-lookup"><span data-stu-id="c1847-121">The CDN can also deliver static datasets (via the web service) for the clients to use, perhaps to generate the client UI.</span></span> <span data-ttu-id="c1847-122">Например, CDN можно использовать для распределения документов JSON или XML.</span><span class="sxs-lookup"><span data-stu-id="c1847-122">For example, the CDN could be used to distribute JSON or XML documents.</span></span>

- <span data-ttu-id="c1847-123">Предоставление веб-сайтов целиком (при условии, что они состоят только из общедоступного статического содержимого) клиентам без необходимости использовать выделенные вычислительные ресурсы.</span><span class="sxs-lookup"><span data-stu-id="c1847-123">Serving entire websites that consist of only public static content to clients, without requiring any dedicated compute resources.</span></span>

- <span data-ttu-id="c1847-124">Потоковая передача видеофайлов в клиент по запросу.</span><span class="sxs-lookup"><span data-stu-id="c1847-124">Streaming video files to the client on demand.</span></span> <span data-ttu-id="c1847-125">Видео передаются с низкой задержкой и по надежному подключению, доступному из центров обработки данных, расположенных по всему миру, которые предлагают подключения к сети CDN.</span><span class="sxs-lookup"><span data-stu-id="c1847-125">Video benefits from the low latency and reliable connectivity available from the globally located datacenters that offer CDN connections.</span></span> <span data-ttu-id="c1847-126">Службы мультимедиа Microsoft Azure (AMS) интегрируется с Azure CDN и напрямую доставляют в CDN содержимое для дальнейшего распространения.</span><span class="sxs-lookup"><span data-stu-id="c1847-126">Microsoft Azure Media Services (AMS) integrates with Azure CDN to deliver content directly to the CDN for further distribution.</span></span> <span data-ttu-id="c1847-127">Дополнительные сведения см. в статье [Общие сведения о конечных точках потоковой передачи](/azure/media-services/media-services-streaming-endpoints-overview).</span><span class="sxs-lookup"><span data-stu-id="c1847-127">For more information, see [Streaming endpoints overview](/azure/media-services/media-services-streaming-endpoints-overview).</span></span>

- <span data-ttu-id="c1847-128">Оптимизация взаимодействия для пользователей, особенно для тех, кто находится далеко от центра обработки, в котором размещено приложение.</span><span class="sxs-lookup"><span data-stu-id="c1847-128">Generally improving the experience for users, especially those located far from the datacenter hosting the application.</span></span> <span data-ttu-id="c1847-129">В противном случае такие пользователи могут испытывать большие задержки.</span><span class="sxs-lookup"><span data-stu-id="c1847-129">These users might otherwise suffer higher latency.</span></span> <span data-ttu-id="c1847-130">Большой объем содержимого в веб-приложении часто является статическим, а использование CDN поможет поддерживать производительность и общее качество взаимодействия с пользователями на нужном уровне, исключая при этом необходимость развертывания приложения в нескольких центрах обработки данных.</span><span class="sxs-lookup"><span data-stu-id="c1847-130">A large proportion of the total size of the content in a web application is often static, and using the CDN can help to maintain performance and overall user experience while eliminating the requirement to deploy the application to multiple data centers.</span></span> <span data-ttu-id="c1847-131">Список текущих расположений узлов Azure CDN см. в статье [Расположение узлов POP сети Azure CDN](/azure/cdn/cdn-pop-locations/).</span><span class="sxs-lookup"><span data-stu-id="c1847-131">For a list of Azure CDN node locations, see [Azure CDN POP Locations](/azure/cdn/cdn-pop-locations/).</span></span>

- <span data-ttu-id="c1847-132">Поддержка решений для Интернета вещей.</span><span class="sxs-lookup"><span data-stu-id="c1847-132">Supporting IoT (Internet of Things) solutions.</span></span> <span data-ttu-id="c1847-133">Огромное число устройств и другого оборудования, входящих в решение Интернета вещей, может привести к превышению возможностей приложения, если ему придется напрямую передавать на каждое устройство обновления встроенного ПО.</span><span class="sxs-lookup"><span data-stu-id="c1847-133">The huge numbers of devices and appliances involved in an IoT solution could easily overwhelm an application if it had to distribute firmware updates directly to each device.</span></span>

- <span data-ttu-id="c1847-134">Обработка пиковых нагрузок и бросков напряжения в использовании без масштабирования приложения и увеличения последующих затрат на его работу.</span><span class="sxs-lookup"><span data-stu-id="c1847-134">Coping with peaks and surges in demand without requiring the application to scale, avoiding the consequent increased running costs.</span></span> <span data-ttu-id="c1847-135">Например, при выпуске обновления операционной системы для оборудования (например, определенной модели маршрутизатора) либо пользовательского устройства (например, смарт-ТВ), возникает пиковое количество запросов, ведь оно скачивается миллионами пользователей и устройств за короткий период времени.</span><span class="sxs-lookup"><span data-stu-id="c1847-135">For example, when an update to an operating system is released for a hardware device such as a specific model of router, or for a consumer device such as a smart TV, there will be a huge peak in demand as it is downloaded by millions of users and devices over a short period.</span></span>

## <a name="challenges"></a><span data-ttu-id="c1847-136">Сложности</span><span class="sxs-lookup"><span data-stu-id="c1847-136">Challenges</span></span>

<span data-ttu-id="c1847-137">Если вы намерены применить CDN, не забудьте учесть некоторые сложности.</span><span class="sxs-lookup"><span data-stu-id="c1847-137">There are several challenges to take into account when planning to use a CDN.</span></span>

- <span data-ttu-id="c1847-138">**Развертывание**.</span><span class="sxs-lookup"><span data-stu-id="c1847-138">**Deployment**.</span></span> <span data-ttu-id="c1847-139">Определите источник, из которого CDN получает содержимое, а также решите, нужно ли развертывать содержимое больше, чем в одной системе хранения данных.</span><span class="sxs-lookup"><span data-stu-id="c1847-139">Decide the origin from which the CDN fetches the content, and whether you need to deploy the content in more than one storage system.</span></span> <span data-ttu-id="c1847-140">Учтите все процессы развертывания статического содержимого и ресурсов.</span><span class="sxs-lookup"><span data-stu-id="c1847-140">Take into account the process for deploying static content and resources.</span></span> <span data-ttu-id="c1847-141">Например, вам может понадобиться выполнить отдельное действие по загрузке содержимого в хранилище BLOB-объектов Azure.</span><span class="sxs-lookup"><span data-stu-id="c1847-141">For example, you may need to implement a separate step to load content into Azure blob storage.</span></span>

- <span data-ttu-id="c1847-142">**Управление версиями и кэшем**.</span><span class="sxs-lookup"><span data-stu-id="c1847-142">**Versioning and cache-control**.</span></span> <span data-ttu-id="c1847-143">Выберите способы обновления статического содержимого и развертывания новых версий.</span><span class="sxs-lookup"><span data-stu-id="c1847-143">Consider how you will update static content and deploy new versions.</span></span> <span data-ttu-id="c1847-144">Выясните, как в выбранной CDN выполняется кэширование и контроль срока жизни (TTL).</span><span class="sxs-lookup"><span data-stu-id="c1847-144">Understand how the CDN performs caching and time-to-live (TTL).</span></span> <span data-ttu-id="c1847-145">Для Azure CDN эти принципы описаны в статье [Как выполняется кэширование](/azure/cdn/cdn-how-caching-works).</span><span class="sxs-lookup"><span data-stu-id="c1847-145">For Azure CDN, see [How caching works](/azure/cdn/cdn-how-caching-works).</span></span>

- <span data-ttu-id="c1847-146">**Тестирование**.</span><span class="sxs-lookup"><span data-stu-id="c1847-146">**Testing**.</span></span> <span data-ttu-id="c1847-147">Выполнение локального тестирования параметров CDN при разработке и тестировании приложения локально или в промежуточной среде может представлять сложности.</span><span class="sxs-lookup"><span data-stu-id="c1847-147">It can be difficult to perform local testing of your CDN settings when developing and testing an application locally or in a staging environment.</span></span>

- <span data-ttu-id="c1847-148">**Оптимизация для поисковых систем (SEO)**.</span><span class="sxs-lookup"><span data-stu-id="c1847-148">**Search engine optimization (SEO)**.</span></span> <span data-ttu-id="c1847-149">Содержимое, например изображения и документы, передаются из другого домена при использовании CDN,</span><span class="sxs-lookup"><span data-stu-id="c1847-149">Content such as images and documents are served from a different domain when you use the CDN.</span></span> <span data-ttu-id="c1847-150">что может повлиять на SEO для этого содержимого.</span><span class="sxs-lookup"><span data-stu-id="c1847-150">This can have an effect on SEO for this content.</span></span>

- <span data-ttu-id="c1847-151">**Безопасность содержимого**.</span><span class="sxs-lookup"><span data-stu-id="c1847-151">**Content security**.</span></span> <span data-ttu-id="c1847-152">Не все CDN предлагают хоть какой-то метод управления доступом к содержимому.</span><span class="sxs-lookup"><span data-stu-id="c1847-152">Not all CDNs offer any form of access control for the content.</span></span> <span data-ttu-id="c1847-153">Некоторые службы CDN, включая Azure CDN, поддерживают аутентификацию на основе маркера для защиты содержимого CDN.</span><span class="sxs-lookup"><span data-stu-id="c1847-153">Some CDN services, including Azure CDN, support token-based authentication to protect CDN content.</span></span> <span data-ttu-id="c1847-154">Подробнее см. в статье [Защита ресурсов сети доставки содержимого Azure с помощью аутентификации на основе маркеров](/azure/cdn/cdn-token-auth).</span><span class="sxs-lookup"><span data-stu-id="c1847-154">For more information, see [Securing Azure Content Delivery Network assets with token authentication](/azure/cdn/cdn-token-auth).</span></span>

- <span data-ttu-id="c1847-155">**Безопасность клиента**.</span><span class="sxs-lookup"><span data-stu-id="c1847-155">**Client security**.</span></span> <span data-ttu-id="c1847-156">Клиенты могут подключаться из среды, которая не разрешает доступ к ресурсам в CDN.</span><span class="sxs-lookup"><span data-stu-id="c1847-156">Clients might connect from an environment that does not allow access to resources on the CDN.</span></span> <span data-ttu-id="c1847-157">Это может быть среда с правилами безопасности, которая предоставляет доступ только к набору известных ресурсов или которая предотвращает загрузку ресурсов из любого расположения, кроме исходной страницы.</span><span class="sxs-lookup"><span data-stu-id="c1847-157">This could be a security-constrained environment that limits access to only a set of known sources, or one that prevents loading of resources from anything other than the page origin.</span></span> <span data-ttu-id="c1847-158">В таких случаях требуется выполнить откат.</span><span class="sxs-lookup"><span data-stu-id="c1847-158">A fallback implementation is required to handle these cases.</span></span>

- <span data-ttu-id="c1847-159">**Устойчивость**.</span><span class="sxs-lookup"><span data-stu-id="c1847-159">**Resilience**.</span></span> <span data-ttu-id="c1847-160">CDN — это потенциальная единая точка отказа для приложения.</span><span class="sxs-lookup"><span data-stu-id="c1847-160">The CDN is a potential single point of failure for an application.</span></span>

<span data-ttu-id="c1847-161">Сценарии, в которых сеть CDN может быть менее эффективной.</span><span class="sxs-lookup"><span data-stu-id="c1847-161">Scenarios where CDN may be less useful include:</span></span>  

- <span data-ttu-id="c1847-162">Если содержимое используется редко, к нему выполняется мало обращений, пока оно остается действительным (в зависимости от указанного срока жизни).</span><span class="sxs-lookup"><span data-stu-id="c1847-162">If the content has a low hit rate, it might be accessed only few times while it is valid (determined by its time-to-live setting).</span></span>

- <span data-ttu-id="c1847-163">Если данные являются конфиденциальными, например в больших организациях или экосистемах цепочки поставок.</span><span class="sxs-lookup"><span data-stu-id="c1847-163">If the data is private, such as for large enterprises or supply chain ecosystems.</span></span>

## <a name="general-guidelines-and-good-practices"></a><span data-ttu-id="c1847-164">Общие инструкции и рекомендации</span><span class="sxs-lookup"><span data-stu-id="c1847-164">General guidelines and good practices</span></span>

<span data-ttu-id="c1847-165">Использование CDN позволяет минимизировать нагрузку на приложение и максимально повысить доступность и производительность.</span><span class="sxs-lookup"><span data-stu-id="c1847-165">Using a CDN is a good way to minimize the load on your application, and maximize availability and performance.</span></span> <span data-ttu-id="c1847-166">Попробуйте внедрить эту стратегию для всего содержимого и любых ресурсов, которые использует ваше приложение.</span><span class="sxs-lookup"><span data-stu-id="c1847-166">Consider adopting this strategy for all of the appropriate content and resources your application uses.</span></span> <span data-ttu-id="c1847-167">При разработке стратегии использования CDN необходимо учитывать сведения, описанные в следующих разделах.</span><span class="sxs-lookup"><span data-stu-id="c1847-167">Consider the points in the following sections when designing your strategy to use a CDN.</span></span>

### <a name="deployment"></a><span data-ttu-id="c1847-168">Развертывание</span><span class="sxs-lookup"><span data-stu-id="c1847-168">Deployment</span></span>

<span data-ttu-id="c1847-169">Может потребоваться подготовить и развернуть статическое содержимое независимо от приложения, если вы не включите его в пакет или процесс развертывания приложения.</span><span class="sxs-lookup"><span data-stu-id="c1847-169">Static content may need to be provisioned and deployed independently from the application if you do not include it in the application deployment package or process.</span></span> <span data-ttu-id="c1847-170">Рассмотрите, как это повлияет на подход к управлению версиями, который используется для компонентов приложения и содержимого статических ресурсов.</span><span class="sxs-lookup"><span data-stu-id="c1847-170">Consider how this will affect the versioning approach you use to manage both the application components and the static resource content.</span></span>

<span data-ttu-id="c1847-171">Оцените возможность использовать методы объединения и минификации, чтобы ускорить загрузку для клиентов.</span><span class="sxs-lookup"><span data-stu-id="c1847-171">Consider using bundling and minification techniques to reduce load times for clients.</span></span> <span data-ttu-id="c1847-172">Объединение позволяет объединить несколько файлов в один файл.</span><span class="sxs-lookup"><span data-stu-id="c1847-172">Bundling combines multiple files into a single file.</span></span> <span data-ttu-id="c1847-173">Минификация удаляет из скриптов и файлов CSS ненужные символы, не затрагивая их функциональность.</span><span class="sxs-lookup"><span data-stu-id="c1847-173">Minification removes unnecessary characters from scripts and CSS files without altering functionality.</span></span>

<span data-ttu-id="c1847-174">Если вам нужно развернуть содержимое в дополнительное расположение, это потребуется сделать в дополнительном шаге развертывания.</span><span class="sxs-lookup"><span data-stu-id="c1847-174">If you need to deploy the content to an additional location, this will be an extra step in the deployment process.</span></span> <span data-ttu-id="c1847-175">Если приложение обновляет содержимое для CDN регулярно или в ответ на событие, оно должно сохранять обновленное содержимое и конечную точку CDN во всех дополнительных расположениях.</span><span class="sxs-lookup"><span data-stu-id="c1847-175">If the application updates the content for the CDN, perhaps at regular intervals or in response to an event, it must store the updated content in any additional locations as well as the endpoint for the CDN.</span></span>

<span data-ttu-id="c1847-176">Оцените, как вы будете выполнять локальную разработку и тестирование, если часть статического содержимого предоставляется из CDN.</span><span class="sxs-lookup"><span data-stu-id="c1847-176">Consider how you will handle local development and testing when some static content is expected to be served from a CDN.</span></span> <span data-ttu-id="c1847-177">Например, можно предварительно развертывать такое содержимое в CDN из скрипта сборки.</span><span class="sxs-lookup"><span data-stu-id="c1847-177">For example, you could pre-deploy the content to the CDN as part of your build script.</span></span> <span data-ttu-id="c1847-178">Кроме того, можно воспользоваться директивами компилятора или флагами для управления процессами загрузки ресурсов в приложении.</span><span class="sxs-lookup"><span data-stu-id="c1847-178">Alternatively, use compile directives or flags to control how the application loads the resources.</span></span> <span data-ttu-id="c1847-179">Например, в режиме отладки приложение может получать статические ресурсы из локальной папки.</span><span class="sxs-lookup"><span data-stu-id="c1847-179">For example, in debug mode, the application could load static resources from a local folder.</span></span> <span data-ttu-id="c1847-180">В режиме выпуска это же приложение будет использовать CDN.</span><span class="sxs-lookup"><span data-stu-id="c1847-180">In release mode, the application would use the CDN.</span></span>

<span data-ttu-id="c1847-181">Рассмотрите возможности для сжатия файлов, например с помощью gzip (GNU zip).</span><span class="sxs-lookup"><span data-stu-id="c1847-181">Consider the options for file compression, such as gzip (GNU zip).</span></span> <span data-ttu-id="c1847-182">Сжатие может выполняться на сервере-источнике службой размещения веб-приложения или на пограничных серверах самой CDN.</span><span class="sxs-lookup"><span data-stu-id="c1847-182">Compression may be performed on the origin server by the web application hosting or directly on the edge servers by the CDN.</span></span> <span data-ttu-id="c1847-183">Подробнее см. в статье [Повышение производительности за счет сжатия файлов в Azure CDN](/azure/cdn/cdn-improve-performance).</span><span class="sxs-lookup"><span data-stu-id="c1847-183">For more information, see [Improve performance by compressing files in Azure CDN](/azure/cdn/cdn-improve-performance).</span></span>

### <a name="routing-and-versioning"></a><span data-ttu-id="c1847-184">Маршрутизация и управление версиями</span><span class="sxs-lookup"><span data-stu-id="c1847-184">Routing and versioning</span></span>

<span data-ttu-id="c1847-185">Вы можете использовать разные экземпляры CDN в разные моменты времени.</span><span class="sxs-lookup"><span data-stu-id="c1847-185">You may need to use different CDN instances at various times.</span></span> <span data-ttu-id="c1847-186">Например, при развертывании новой версии приложения можно использовать новую сеть CDN, а старую сеть CDN (вместе с содержимым в старом формате) оставить для предыдущих версий.</span><span class="sxs-lookup"><span data-stu-id="c1847-186">For example, when you deploy a new version of the application you may want to use a new CDN and retain the old CDN (holding content in an older format) for previous versions.</span></span> <span data-ttu-id="c1847-187">Если вы используете хранилище больших двоичных объектов Azure в качестве источника содержимого, вы можете создать отдельную учетную запись хранения или отдельный контейнер и указать его в качестве конечной точки CDN.</span><span class="sxs-lookup"><span data-stu-id="c1847-187">If you use Azure blob storage as the content origin, you can create a separate storage account or a separate container and point the CDN endpoint to it.</span></span>

<span data-ttu-id="c1847-188">Не используйте строку запроса для указания разных версий приложения в ссылках на ресурсы CDN, так как при получении содержимого из хранилища BLOB-объектов Azure строка запроса является частью имени ресурса (имени большого двоичного объекта).</span><span class="sxs-lookup"><span data-stu-id="c1847-188">Do not use the query string to denote different versions of the application in links to resources on the CDN because, when retrieving content from Azure blob storage, the query string is part of the resource name (the blob name).</span></span> <span data-ttu-id="c1847-189">Это может повлиять на способ кэширования ресурсов клиентом.</span><span class="sxs-lookup"><span data-stu-id="c1847-189">This approach can also affect how the client caches resources.</span></span>

<span data-ttu-id="c1847-190">Развертывание новых версий статического содержимого при обновлении приложения может представлять сложность, если предыдущие ресурсы кэшировались в CDN.</span><span class="sxs-lookup"><span data-stu-id="c1847-190">Deploying new versions of static content when you update an application can be a challenge if the previous resources are cached on the CDN.</span></span> <span data-ttu-id="c1847-191">Дополнительные сведения об управлении кэшем см. в разделе ниже.</span><span class="sxs-lookup"><span data-stu-id="c1847-191">For more information, see the section on cache control, below.</span></span>

<span data-ttu-id="c1847-192">Доступ к содержимому CDN можно ограничивать по странам.</span><span class="sxs-lookup"><span data-stu-id="c1847-192">Consider restricting the CDN content access by country.</span></span> <span data-ttu-id="c1847-193">Azure CDN позволяет отфильтровывать запросы на основе страны происхождения, ограничивая доставку содержимого.</span><span class="sxs-lookup"><span data-stu-id="c1847-193">Azure CDN allows you to filter requests based on the country of origin and restrict the content delivered.</span></span> <span data-ttu-id="c1847-194">Дополнительные сведения см. в статье [Ограничение доступа к содержимому по странам](/azure/cdn/cdn-restrict-access-by-country/).</span><span class="sxs-lookup"><span data-stu-id="c1847-194">For more information, see [Restrict access to your content by country](/azure/cdn/cdn-restrict-access-by-country/).</span></span>

### <a name="cache-control"></a><span data-ttu-id="c1847-195">управление кэшем;</span><span class="sxs-lookup"><span data-stu-id="c1847-195">Cache control</span></span>

<span data-ttu-id="c1847-196">Выберите способ управления кэшированием в системе.</span><span class="sxs-lookup"><span data-stu-id="c1847-196">Consider how to manage caching within the system.</span></span> <span data-ttu-id="c1847-197">Например, в Azure CDN вы можете задать глобальные правила кэширования и настроить отдельные правила кэширования для конечных точек определенного источника.</span><span class="sxs-lookup"><span data-stu-id="c1847-197">For example, in Azure CDN, you can set global caching rules, and then set custom caching for particular origin endpoints.</span></span> <span data-ttu-id="c1847-198">Вы также можете управлять кэшированием в CDN, отправляя заголовки с директивами кэша.</span><span class="sxs-lookup"><span data-stu-id="c1847-198">You can also control how caching is performed in a CDN by sending cache-directive headers at the origin.</span></span>

<span data-ttu-id="c1847-199">Дополнительные сведения см. в статье [Как выполняется кэширование](/azure/cdn/cdn-how-caching-works).</span><span class="sxs-lookup"><span data-stu-id="c1847-199">For more information, see [How caching works](/azure/cdn/cdn-how-caching-works).</span></span>

<span data-ttu-id="c1847-200">Чтобы запретить доступ к объектам через CDN, можно удалить эти объекты из источника, удалить или отключить конечную точку CDN, а при использовании хранилища BLOB-объектов — сделать контейнер или большой двоичный объект закрытым.</span><span class="sxs-lookup"><span data-stu-id="c1847-200">To prevent objects from being available on the CDN, you can delete them from the origin, remove or delete the CDN endpoint, or in the case of blob storage, make the container or blob private.</span></span> <span data-ttu-id="c1847-201">Тем не менее, элементы будут удалены только после истечения срока жизни.</span><span class="sxs-lookup"><span data-stu-id="c1847-201">However, items are not removed from the until the time-to-live expires.</span></span> <span data-ttu-id="c1847-202">Если потребуется, конечную точку CDN можно очистить вручную.</span><span class="sxs-lookup"><span data-stu-id="c1847-202">You can also manually purge a CDN endpoint.</span></span>

### <a name="security"></a><span data-ttu-id="c1847-203">Безопасность</span><span class="sxs-lookup"><span data-stu-id="c1847-203">Security</span></span>

<span data-ttu-id="c1847-204">CDN может доставлять содержимое по протоколу HTTPS (SSL), используя предоставленный CDN сертификат, а также по стандартному протоколу HTTP.</span><span class="sxs-lookup"><span data-stu-id="c1847-204">The CDN can deliver content over HTTPS (SSL), by using the certificate provided by the CDN, as well as over standard HTTP.</span></span> <span data-ttu-id="c1847-205">Чтобы избежать предупреждений браузера о смешанном содержимом, следует применять HTTPS для запроса статического содержимого на тех страницах, которые были получены по протоколу HTTPS.</span><span class="sxs-lookup"><span data-stu-id="c1847-205">To avoid browser warnings about mixed content, you might need to use HTTPS to request static content that is displayed in pages loaded through HTTPS.</span></span>

<span data-ttu-id="c1847-206">Если вы используете CDN для передачи статических активов, таких как файлы шрифтов, некоторые проблемы может вызвать политика одного источника, например при использовании *XMLHttpRequest* для получения ресурсов из другого домена.</span><span class="sxs-lookup"><span data-stu-id="c1847-206">If you deliver static assets such as font files by using the CDN, you might encounter same-origin policy issues if you use an *XMLHttpRequest* call to request these resources from a different domain.</span></span> <span data-ttu-id="c1847-207">Многие веб-браузеры предотвращают общий доступ к ресурсам независимо от источника (CORS), если сервер не настроен для задания соответствующих заголовков ответов.</span><span class="sxs-lookup"><span data-stu-id="c1847-207">Many web browsers prevent cross-origin resource sharing (CORS) unless the web server is configured to set the appropriate response headers.</span></span> <span data-ttu-id="c1847-208">Вы можете настроить в CDN поддержку CORS, используя любой из следующих методов.</span><span class="sxs-lookup"><span data-stu-id="c1847-208">You can configure the CDN to support CORS by using one of the following methods:</span></span>

- <span data-ttu-id="c1847-209">Настройте в CDN добавление заголовков CORS к ответам.</span><span class="sxs-lookup"><span data-stu-id="c1847-209">Configure the CDN to add CORS headers to the responses.</span></span> <span data-ttu-id="c1847-210">Дополнительные сведения см. в статье [Использование Azure CDN с CORS](/azure/cdn/cdn-cors).</span><span class="sxs-lookup"><span data-stu-id="c1847-210">For more information, see [Using Azure CDN with CORS](/azure/cdn/cdn-cors).</span></span>

- <span data-ttu-id="c1847-211">Если источником является хранилище больших двоичных объектов Azure, добавьте правила CORS на конечной точке хранилища.</span><span class="sxs-lookup"><span data-stu-id="c1847-211">If the origin is Azure blob storage, add CORS rules to the storage endpoint.</span></span> <span data-ttu-id="c1847-212">Дополнительные сведения см. в статье [Поддержка общего доступа к ресурсам независимо от источника (CORS) для служб хранилища Azure](/rest/api/storageservices/Cross-Origin-Resource-Sharing--CORS--Support-for-the-Azure-Storage-Services).</span><span class="sxs-lookup"><span data-stu-id="c1847-212">For more information, see [Cross-Origin Resource Sharing (CORS) Support for the Azure Storage Services](/rest/api/storageservices/Cross-Origin-Resource-Sharing--CORS--Support-for-the-Azure-Storage-Services).</span></span>

- <span data-ttu-id="c1847-213">В приложении настройте установку заголовков CORS.</span><span class="sxs-lookup"><span data-stu-id="c1847-213">Configure the application to set the CORS headers.</span></span> <span data-ttu-id="c1847-214">Например, примените рекомендации из раздела документации по ASP.NET Core, посвященного [включению запросов независимо от источника (CORS)](/aspnet/core/security/cors).</span><span class="sxs-lookup"><span data-stu-id="c1847-214">For example, see [Enabling Cross-Origin Requests (CORS)](/aspnet/core/security/cors) in the ASP.NET Core documentation.</span></span>

### <a name="cdn-fallback"></a><span data-ttu-id="c1847-215">Резервная сеть CDN</span><span class="sxs-lookup"><span data-stu-id="c1847-215">CDN fallback</span></span>

<span data-ttu-id="c1847-216">Оцените, как приложение будет обрабатывать сбои в CDN и (или) временную недоступность.</span><span class="sxs-lookup"><span data-stu-id="c1847-216">Consider how your application will cope with a failure or temporary unavailability of the CDN.</span></span> <span data-ttu-id="c1847-217">Клиентские приложения могут использовать копии ресурсов, которые были кэшированы локально (на клиенте) во время предыдущих запросов. Также вы можете включить код, который обнаруживает сбой и запрашивает ресурсы из источника (папки приложения или контейнера больших двоичных объектов Azure, в котором содержатся ресурсы), если сеть CDN недоступна.</span><span class="sxs-lookup"><span data-stu-id="c1847-217">Client applications may be able to use copies of the resources that were cached locally (on the client) during previous requests, or you can include code that detects failure and instead requests resources from the origin (the application folder or Azure blob container that holds the resources) if the CDN is unavailable.</span></span>
