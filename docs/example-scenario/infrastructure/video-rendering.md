---
title: Отрисовка трехмерного видео на портале Azure
description: Выполнение собственных рабочих нагрузок HPC в Azure с использованием пакетной службы Azure.
author: adamboeglin
ms.date: 07/13/2018
ms.custom: fasttrack
ms.openlocfilehash: 7dacefd5179c426912dd97af9af7b5a39505392d
ms.sourcegitcommit: a0e8d11543751d681953717f6e78173e597ae207
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/06/2018
ms.locfileid: "53004825"
---
# <a name="3d-video-rendering-on-azure"></a>Отрисовка трехмерного видео на портале Azure

Отрисовка трехмерных видео — это длительный процесс, для его завершения требуется значительное количество времени ЦП. На одном компьютере процесс создания видеофайла из статических ресурсов может занять часы или даже дни в зависимости от длины и сложности видео. Многие компании будут покупать либо ресурсоемкие высокопроизводительные настольные компьютеры для выполнения этих задач, либо инвестировать в крупные фермы рендеринга, в которые они могут отправлять задания. Однако при использовании пакетной службы Azure ресурсы доступны по требованию и они завершают работу, если в них нет надобности. И все это без каких-либо капиталовложений.

Пакетная служба предоставляет согласованные средства планирования заданий и управления ими для вычислительных узлов как с Windows Server, так и с Linux. С помощью пакетной службы вы можете использовать имеющиеся приложения Windows или Linux, включая AutoDesk Maya и Blender, чтобы выполнить крупномасштабную отрисовку заданий в Azure.

## <a name="relevant-use-cases"></a>Варианты соответствующего использования

Другие варианты использования:

* 3D-моделирование.
* Отрисовка визуальных эффектов (VFX).
* Перекодирование видео.
* Обработка изображений, цветокоррекция и изменение размера.

## <a name="architecture"></a>Архитектура

![Общие сведения об архитектуре компонентов, используемых в собственном облачном решении HPC с применением пакетной службы Azure][architecture]

Этот сценарий показывает рабочий процесс, в котором используется пакетная служба Azure. Путь потока данных выглядит следующим образом:

1. Передача входных файлов и приложений для обработки этих файлов в учетную запись службы хранилища Azure.
2. Создание пула вычислительных узлов пакетной службы в своей учетной записи пакетной службы, задание для выполнения рабочей нагрузки в пуле и задачи в задании.
3. Скачивание входных файлов и приложений для пакетной службы.
4. Мониторинг выполнения задач.
5. Отправка выходных данных задачи.
6. Скачивание выходных файлов.

Чтобы упростить этот процесс, можно также использовать [подключаемые модули пакетной службы для Maya и 3DS Max][batch-plugins]

### <a name="components"></a>Компоненты

Пакетная служба Azure построена на основе следующих технологий Azure.

* [Виртуальные сети](/azure/virtual-network/virtual-networks-overview) используются как для головного узла, так и для вычислительных ресурсов.
* [Учетные записи хранения Azure](/azure/storage/common/storage-introduction) используются для хранения данных и синхронизации.
* [Масштабируемые наборы виртуальных машин][vmss] используются CycleCloud для вычислительных ресурсов.

## <a name="considerations"></a>Рекомендации

### <a name="machine-sizes-available-for-azure-batch"></a>Доступный размер компьютеров для пакетной службы Azure

Хотя большинство клиентов, которым требуется рендеринг, выбирают ресурсы с ЦП большой мощности, для других рабочих нагрузок, использующих масштабируемые наборы виртуальных машин, им подойдут виртуальные машины с иными характеристиками. Выбор зависит от ряда факторов:

* Потребляет ли выполняемое приложение много памяти?
* Необходим ли GPU для работы приложения? 
* Требуется ли высокая степень параллелизма для выполнения заданий или организация подключения InfiniBand для тесно связанных заданий?
* Требуется ли быстрый ввод-вывод для доступа к службе хранилища на вычислительных узлах?

В Azure доступны виртуальные машины разных размеров, способные удовлетворить любое из перечисленных выше требований, предъявляемых приложениями. Некоторые из этих виртуальных машин предназначены для высокопроизводительных вычислений, но даже виртуальные машины самых маленьких размеров могут быть эффективными для реализации сетки:

* [Размеры виртуальных машин для высокопроизводительных вычислений][compute-hpc]. Из-за высоких требований к мощности ЦП при рендеринге Майкрософт рекомендует для этих целей использовать виртуальные машины Azure серии H. Они предназначены специально для высокопроизводительных вычислений и оснащены виртуальными ЦП с 8 или 16 ядрами на основе ЦП Intel Haswell E5, оперативной памятью DDR4 и временным хранилищем на SSD-дисках.
* [Размеры виртуальных машин с GPU][compute-gpu]. Размеры виртуальных машин с оптимизацией GPU — это специализированные виртуальные машины с одним или несколькими GPU NVIDIA. Эти размеры предназначены для рабочих нагрузок с большим объемом вычислений, графической обработки и визуализаций.
* Размеры NC, NCv2, NCv3 и ND оптимизированы для приложений и алгоритмов, требующих ресурсоемких вычислений и высокой пропускной способности сети, включая приложения и моделирование на базе CUDA и OpenCL, а также ИИ и глубокое обучение. Размеры NV оптимизированы и предназначены для удаленной визуализации, потоковой передачи, игр, кодирования и сценариев VDI, которые используют такие платформы, как OpenGL и DirectX.
* [Размеры виртуальных машин, оптимизированных для операций в памяти][compute-memory]. Такие виртуальные машины имеют высокий показатель объема памяти в расчете на одно ядро ЦП и подходят для операций, требующих большого объема памяти.
* [Размеры виртуальных машин общего назначения][compute-general]. Такие виртуальные машины имеют сбалансированный показатель объема памяти на ядро ЦП.

### <a name="alternatives"></a>Альтернативные варианты

Если вам требуется больше контроля над средой отрисовки в Azure или нужна гибридная реализация, тогда вычисления CycleCloud могут помочь оркестрировать сетку IaaS в облаке. Используя те же базовые технологии Azure, что и пакетная служба Azure, они позволяют эффективно создавать и поддерживать сетку IaaS. Для получения дополнительных сведений, в том числе о принципах проектирования, перейдите по этой ссылке:

Полный обзор всех доступных в Azure решений для высокопроизводительных вычислений см. в статье [Использование HPC, пакетной службы и больших вычислений][hpc-alt-solutions].

### <a name="availability"></a>Доступность

Мониторинг компонентов пакетной службы Azure доступен в целом ряде служб, средств и API. Дополнительные сведения см. в статье [Мониторинг решений пакетной службы][batch-monitor].

### <a name="scalability"></a>Масштабируемость

Пулы учетной записи пакетной службы Azure можно масштабировать автоматически по формуле на основе метрик службы или вручную. Дополнительные сведения см. в статье [Создание формулы автоматического масштабирования для масштабирования вычислительных узлов в пуле пакетной службы][batch-scaling].

### <a name="security"></a>Безопасность

Общие рекомендации по разработке безопасных решений см. в разделе [Azure Security Documentation][security].

### <a name="resiliency"></a>Устойчивость

Пакетная служба Azure сейчас не поддерживает отработку отказа, поэтому рекомендуется выполнить следующие действия для обеспечения доступности в случае сбоя:

* Создайте альтернативную учетную запись пакетной службы Azure в другом расположении Azure, используя другую учетную запись хранения.
* Создайте аналогичные узлы пулов с такими же именами, но без выделенных узлов.
* Убедитесь, что приложения создаются и обновляются в альтернативной учетной записи хранения.
* Отправьте входные файлы и задания в альтернативную учетную запись пакетной службы Azure.

## <a name="deploy-this-scenario"></a>Развертывание этого сценария

### <a name="creating-an-azure-batch-account-and-pools-manually"></a>Создание учетной записи и пулов пакетной службы Azure вручную

Этот сценарий демонстрирует работу пакетной службы Azure и возможность разработки пользовательского SaaS-решения в лабораториях пакетной службы Azure:

[Демонстрация с пакетной службой Azure][batch-labs-masterclass]

### <a name="deploying-the-example-scenario-using-an-azure-resource-manager-template"></a>Развертывание примера сценария с помощью шаблона Azure Resource Manager

Шаблон развертывает:

* Новую учетную запись пакетной службы Azure.
* Учетная запись хранения.
* Пул узла, связанный с учетной записью пакетной службы.
* Пул узла, который будет настроен для использования виртуальных машин A2 v2 с образами Canonical Ubuntu.
* Пул узла изначально не будет содержать виртуальных машин. Вам нужно будет выполнить масштабирование вручную для их добавления.

<a href="https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmspnp%2Fsolution-architectures%2Fmaster%2Fhpc%2Fbatchcreatewithpools.json" target="_blank">
    <img src="https://azuredeploy.net/deploybutton.png"/>
</a>

[См. дополнительные сведения о шаблонах Resource Manager][azure-arm-templates]

## <a name="pricing"></a>Цены

Стоимость использования пакетной службы Azure будет зависеть от размеров виртуальных машин в пулах и времени их фактической работы. Учетная запись пакетной службы Azure создается бесплатно. На стоимость также влияет объем исходящего трафика данных, в т. ч. хранилища.

Ниже приведены примеры взимаемых затрат для задания, выполняющегося за 8 часов с разным количеством серверов:

* 100 виртуальных машин с высокопроизводительным ЦП. [Примерная стоимость][hpc-est-high]

  100 x H16m (16 ядер, 225 ГБ ОЗУ, хранилище класса Premium на 512 ГБ), хранилище BLOB-объектов на 2 ТБ, 1 ТБ исходящего трафика

* 50 виртуальных машин с высокопроизводительным ЦП. [Примерная стоимость][hpc-est-med]

  50 x H16m (16 ядер, 225 ГБ ОЗУ, хранилище класса Premium на 512 ГБ), хранилище BLOB-объектов на 2 ТБ, 1 ТБ исходящего трафика

* 10 виртуальных машин с высокопроизводительным ЦП. [Примерная стоимость][hpc-est-low]

  10 x H16m (16 ядер, 225 ГБ ОЗУ, хранилище класса Premium на 512 ГБ), хранилище BLOB-объектов на 2 ТБ, 1 ТБ исходящего трафика

### <a name="pricing-for-low-priority-vms"></a>Цены на низкоприоритетные виртуальные машины

В пулах узлов пакетной службы Azure также можно использовать виртуальные машины с низким приоритетом, что может существенно снизить расходы. Дополнительные сведения, в том числе сравнение стоимости использования стандартных виртуальных машин и виртуальных машин с низким приоритетом см. на странице [расценок на пакетную службу Azure][batch-pricing].

> [!NOTE] 
> Низкоприоритетные виртуальные машины подходят только для определенных приложений и рабочих нагрузок.

## <a name="related-resources"></a>Связанные ресурсы

[Пакетная служба][batch-overview]

[Документация по пакетной службе][batch-doc]

[Использование контейнеров в пакетной службе Azure][batch-containers]

<!-- links -->
[architecture]: ./media/architecture-video-rendering.png
[resource-groups]: /azure/azure-resource-manager/resource-group-overview
[security]: /azure/security/
[resiliency]: /azure/architecture/resiliency/
[scalability]: /azure/architecture/checklist/scalability
[vmss]: /azure/virtual-machine-scale-sets/overview
[storage]: https://azure.microsoft.com/services/storage/
[batch]: https://azure.microsoft.com/services/batch/
[batch-arch]: https://azure.microsoft.com/solutions/architecture/big-compute-with-azure-batch/
[compute-hpc]: /azure/virtual-machines/windows/sizes-hpc
[compute-gpu]: /azure/virtual-machines/windows/sizes-gpu
[compute-compute]: /azure/virtual-machines/windows/sizes-compute
[compute-memory]: /azure/virtual-machines/windows/sizes-memory
[compute-general]: /azure/virtual-machines/windows/sizes-general
[compute-storage]: /azure/virtual-machines/windows/sizes-storage
[compute-acu]: /azure/virtual-machines/windows/acu
[compute=benchmark]: /azure/virtual-machines/windows/compute-benchmark-scores
[hpc-est-high]: https://azure.com/e/9ac25baf44ef49c3a6b156935ee9544c
[hpc-est-med]: https://azure.com/e/0286f1d6f6784310af4dcda5aec8c893
[hpc-est-low]: https://azure.com/e/e39afab4e71949f9bbabed99b428ba4a
[batch-labs-masterclass]: https://github.com/azurebigcompute/BigComputeLabs/tree/master/Azure%20Batch%20Masterclass%20Labs
[batch-scaling]: /azure/batch/batch-automatic-scaling
[hpc-alt-solutions]: /azure/virtual-machines/linux/high-performance-computing?toc=%2fazure%2fbatch%2ftoc.json
[batch-monitor]: /azure/batch/monitoring-overview
[batch-pricing]: https://azure.microsoft.com/pricing/details/batch/
[batch-doc]: /azure/batch/
[batch-overview]: https://azure.microsoft.com/services/batch/
[batch-containers]: https://github.com/Azure/batch-shipyard
[azure-arm-templates]: /azure/azure-resource-manager/resource-group-overview#template-deployment
[batch-plugins]: /azure/batch/batch-rendering-service#options-for-submitting-a-render-job