---
title: Безопасное веб-приложение Windows для отраслей с высокой степенью регулируемости
description: Проверенный сценарий для создания безопасного многоуровневого веб-приложения с использованием Windows Server в Azure, который использует масштабируемые наборы, Шлюз приложений и подсистемы балансировки нагрузки.
author: iainfoulds
ms.date: 07/11/2018
ms.openlocfilehash: 780b82791510b6ca06ef918b66d2547794dfcf87
ms.sourcegitcommit: 94d50043db63416c4d00cebe927a0c88f78c3219
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/28/2018
ms.locfileid: "47428760"
---
# <a name="secure-windows-web-application-for-regulated-industries"></a><span data-ttu-id="c55da-103">Безопасное веб-приложение Windows для отраслей с высокой степенью регулируемости</span><span class="sxs-lookup"><span data-stu-id="c55da-103">Secure Windows web application for regulated industries</span></span>

<span data-ttu-id="c55da-104">Этот пример сценария применяется для отраслей с высокой степенью регулируемости, в которых требуется обеспечить защиту многоуровневых приложений.</span><span class="sxs-lookup"><span data-stu-id="c55da-104">This sample scenario is applicable to regulated industries that have a need to secure multi-tier applications.</span></span> <span data-ttu-id="c55da-105">В этом случае интерфейсное приложение ASP.NET безопасно подключается к защищенному серверному кластеру Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="c55da-105">In this scenario, a front-end ASP.NET application securely connects to a protected back-end Microsoft SQL Server cluster.</span></span>

<span data-ttu-id="c55da-106">Примеры сценариев приложений включают запуск приложений для операционной, назначение пациентов и ведения записей, а также для назначения рецептов и оформления заказов.</span><span class="sxs-lookup"><span data-stu-id="c55da-106">Example application scenarios include running operating room applications, patient appointments and records keeping, or prescription refills and ordering.</span></span> <span data-ttu-id="c55da-107">В большинстве случаев организациям приходилось поддерживать устаревшие локальные приложения и службы для этих сценариев.</span><span class="sxs-lookup"><span data-stu-id="c55da-107">Traditionally, organizations had to maintain legacy on-premises applications and services for these scenarios.</span></span> <span data-ttu-id="c55da-108">Благодаря безопасному и масштабируемому способу развертывания этих приложений Windows Server в Azure организации могут модернизировать свои развертывания, снижая расходы на эксплуатацию и управление.</span><span class="sxs-lookup"><span data-stu-id="c55da-108">With a secure way and scalable way to deploy these Windows Server applications in Azure, organizations can modernize their deployments are reduce their on-premises operating costs and management overhead.</span></span>

## <a name="related-use-cases"></a><span data-ttu-id="c55da-109">Связанные варианты использования</span><span class="sxs-lookup"><span data-stu-id="c55da-109">Related use cases</span></span>

<span data-ttu-id="c55da-110">Рассмотрите этот сценарий для следующих вариантов использования:</span><span class="sxs-lookup"><span data-stu-id="c55da-110">Consider this scenario for the following use cases:</span></span>

* <span data-ttu-id="c55da-111">Модернизация развертываний приложений в безопасной облачной среде.</span><span class="sxs-lookup"><span data-stu-id="c55da-111">Modernizing application deployments in a secure cloud environment.</span></span>
* <span data-ttu-id="c55da-112">Уменьшение количества устаревших локальных средств управления приложениями и службами.</span><span class="sxs-lookup"><span data-stu-id="c55da-112">Reducing legacy on-premises application and service management.</span></span>
* <span data-ttu-id="c55da-113">Улучшение медицинского обслуживания и работы с пациентами с помощью новых платформ приложений.</span><span class="sxs-lookup"><span data-stu-id="c55da-113">Improving patient healthcare and experience with new application platforms.</span></span>

## <a name="architecture"></a><span data-ttu-id="c55da-114">Архитектура</span><span class="sxs-lookup"><span data-stu-id="c55da-114">Architecture</span></span>

![Обзор архитектуры компонентов Azure в многоуровневом приложении Windows Server для отраслей с высокой степенью регулируемости][architecture]

<span data-ttu-id="c55da-116">В этом сценарии рассматривается многоуровневое приложение для отраслей с высокой степенью регулируемости, использующее ASP.NET и Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="c55da-116">This scenario covers a multi-tier regulated industries application that uses ASP.NET and Microsoft SQL Server.</span></span> <span data-ttu-id="c55da-117">Данные передаются в сценарии следующим образом:</span><span class="sxs-lookup"><span data-stu-id="c55da-117">The data flows through the scenario as follows:</span></span>

1. <span data-ttu-id="c55da-118">С помощью шлюза приложений Azure пользователи получают доступ к интерфейсному приложению ASP.NET для отраслей с высокой степенью регулируемости.</span><span class="sxs-lookup"><span data-stu-id="c55da-118">Users access the frontend ASP.NET regulated industries application through an Azure Application Gateway.</span></span>
2. <span data-ttu-id="c55da-119">Шлюз приложений распределяет трафик к экземплярам виртуальных машин в масштабируемом наборе виртуальных машин Azure.</span><span class="sxs-lookup"><span data-stu-id="c55da-119">The Application Gateway distributes traffic to VM instances within an Azure virtual machine scale set.</span></span>
3. <span data-ttu-id="c55da-120">Приложение ASP.NET подключается к кластеру Microsoft SQL Server на уровне сервера через подсистему балансировки нагрузки Azure.</span><span class="sxs-lookup"><span data-stu-id="c55da-120">The ASP.NET application connects to Microsoft SQL Server cluster in a backend tier via an Azure load balancer.</span></span> <span data-ttu-id="c55da-121">Эти внутренние экземпляры SQL Server находятся в отдельной виртуальной сети Azure, защищенной с помощью правил группы безопасности сети, которые ограничивают трафик.</span><span class="sxs-lookup"><span data-stu-id="c55da-121">These backend SQL Server instances are in a separate Azure virtual network, secured by network security group rules that limit traffic flow.</span></span>
4. <span data-ttu-id="c55da-122">Подсистема балансировки нагрузки распределяет трафик SQL Server к экземплярам виртуальных машин в другом масштабируемом наборе виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="c55da-122">The load balancer distributes SQL Server traffic to VM instances in another virtual machine scale set.</span></span>
5. <span data-ttu-id="c55da-123">Хранилище BLOB-объектов Azure выступает в роли облака-свидетеля для кластера SQL Server на внутреннем уровне.</span><span class="sxs-lookup"><span data-stu-id="c55da-123">Azure Blob Storage acts as a Cloud Witness for the SQL Server cluster in the backend tier.</span></span>  <span data-ttu-id="c55da-124">Подключение из виртуальной сети осуществляется с помощью конечной точки службы виртуальной сети для службы хранилища Azure.</span><span class="sxs-lookup"><span data-stu-id="c55da-124">The connection from within the VNet is enabled with a VNet Service Endpoint for Azure Storage.</span></span>

### <a name="components"></a><span data-ttu-id="c55da-125">Компоненты</span><span class="sxs-lookup"><span data-stu-id="c55da-125">Components</span></span>

* <span data-ttu-id="c55da-126">[Шлюз приложений Azure][appgateway-docs] — это балансировщик нагрузки веб-трафика уровня 7, который поддерживает приложения и может распространять трафик на основе определенных правил маршрутизации.</span><span class="sxs-lookup"><span data-stu-id="c55da-126">[Azure Application Gateway][appgateway-docs] is a layer 7 web traffic load balancer that is application-aware and can distribute traffic based on specific routing rules.</span></span> <span data-ttu-id="c55da-127">Шлюз приложений также может обрабатывать разгрузку SSL для улучшения производительности веб-сервера.</span><span class="sxs-lookup"><span data-stu-id="c55da-127">App Gateway can also handle SSL offloading for improved web server performance.</span></span>
* <span data-ttu-id="c55da-128">[Виртуальная сеть Azure][vnet-docs] позволяет ресурсам (например, виртуальным машинам) обмениваться данными друг с другом через локальные сети и Интернет.</span><span class="sxs-lookup"><span data-stu-id="c55da-128">[Azure Virtual Network][vnet-docs] allows resources such as VMs to securely communicate with each other, the Internet, and on-premises networks.</span></span> <span data-ttu-id="c55da-129">Виртуальные сети обеспечивают изоляцию и сегментирование, фильтрацию и маршрутизацию трафика и позволяют устанавливать связь между расположениями.</span><span class="sxs-lookup"><span data-stu-id="c55da-129">Virtual networks provide isolation and segmentation, filter and route traffic, and allow connection between locations.</span></span> <span data-ttu-id="c55da-130">Две виртуальные сети в сочетании с соответствующими группами безопасности сети используются в этом сценарии для предоставления [сети периметра][dmz] и изоляции компонентов приложения.</span><span class="sxs-lookup"><span data-stu-id="c55da-130">Two virtual networks combined with the appropriate NSGs are used in this scenario to provide a [demilitarized zone][dmz] (DMZ) and isolation of the application components.</span></span> <span data-ttu-id="c55da-131">Пиринговая связь между виртуальными сетями соединяет вместе две сети.</span><span class="sxs-lookup"><span data-stu-id="c55da-131">Virtual network peering connects the two networks together.</span></span>
* <span data-ttu-id="c55da-132">[Масштабируемый набор виртуальных машин Azure][scaleset-docs] позволяет создавать и администрировать группы идентичных виртуальных машин с подсистемой балансировки нагрузки.</span><span class="sxs-lookup"><span data-stu-id="c55da-132">[Azure virtual machine scale set][scaleset-docs] lets you create and manager a group of identical, load balanced, VMs.</span></span> <span data-ttu-id="c55da-133">Число экземпляров виртуальных машин может автоматически увеличиваться или уменьшаться в зависимости от спроса или по определенному расписанию.</span><span class="sxs-lookup"><span data-stu-id="c55da-133">The number of VM instances can automatically increase or decrease in response to demand or a defined schedule.</span></span> <span data-ttu-id="c55da-134">В этом сценарии используются два отдельных масштабируемых набора виртуальных машин — один для интерфейсных экземпляров приложений ASP.NET и один для внешних экземпляров виртуальных машин кластера SQL Server.</span><span class="sxs-lookup"><span data-stu-id="c55da-134">Two separate virtual machine scale sets are used in this scenario - one for the frontend ASP.NET application instances, and one for the backend SQL Server cluster VM instances.</span></span> <span data-ttu-id="c55da-135">Настройка требуемого состояния PowerShell (DSC) или расширение пользовательских скриптов Azure может использоваться для подготовки экземпляров виртуальных машин с необходимым программным обеспечением и параметрами конфигурации.</span><span class="sxs-lookup"><span data-stu-id="c55da-135">PowerShell desired state configuration (DSC) or the Azure custom script extension can be used to provision the VM instances with the required software and configuration settings.</span></span>
* <span data-ttu-id="c55da-136">[Группы безопасности сети Azure][nsg-docs] содержат список правил безопасности, которые разрешают или запрещают входящий и исходящий трафик в зависимости от IP-адреса источника или назначения, порта и протокола.</span><span class="sxs-lookup"><span data-stu-id="c55da-136">[Azure network security groups][nsg-docs] contain a list of security rules that allow or deny inbound or outbound network traffic based on source or destination IP address, port, and protocol.</span></span> <span data-ttu-id="c55da-137">Виртуальные сети в этом сценарии защищены с помощью правил группы безопасности сети, которые ограничивают поток трафика между компонентами приложения.</span><span class="sxs-lookup"><span data-stu-id="c55da-137">The virtual networks in this scenario are secured with network security group rules that restrict the flow of traffic between the application components.</span></span>
* <span data-ttu-id="c55da-138">[Azure Load Balancer][loadbalancer-docs] распределяет входящий трафик в соответствии с правилами и проверками работоспособности.</span><span class="sxs-lookup"><span data-stu-id="c55da-138">[Azure load balancer][loadbalancer-docs] distributes inbound traffic according to rules and health probes.</span></span> <span data-ttu-id="c55da-139">Подсистема балансировки нагрузки обеспечивает низкую задержку и высокую пропускную способность, а также увеличение масштаба до миллионов потоков для всех приложений, которые используют протоколы TCP и UDP.</span><span class="sxs-lookup"><span data-stu-id="c55da-139">A load balancer provides low latency and high throughput, and scales up to millions of flows for all TCP and UDP applications.</span></span> <span data-ttu-id="c55da-140">В этом сценарии используется внутренний балансировщик нагрузки для распределения трафика на уровне интерфейсного приложения на сервер кластера SQL Server.</span><span class="sxs-lookup"><span data-stu-id="c55da-140">An internal load balancer is used in this scenario to distribute traffic from the frontend application tier to the backend SQL Server cluster.</span></span>
* <span data-ttu-id="c55da-141">[Хранилище BLOB-объектов Azure][cloudwitness-docs] действует как расположение облака-свидетеля для кластера SQL Server.</span><span class="sxs-lookup"><span data-stu-id="c55da-141">[Azure Blob Storage][cloudwitness-docs] acts a Cloud Witness location for the SQL Server cluster.</span></span> <span data-ttu-id="c55da-142">Этот свидетель используется для кластерных операций и решений, требующих дополнительного голосования для определения кворума.</span><span class="sxs-lookup"><span data-stu-id="c55da-142">This witness is used for cluster operations and decisions that require an additional vote to decide quorum.</span></span> <span data-ttu-id="c55da-143">Использование облака-свидетеля устраняет необходимость использования дополнительной виртуальной машины в качестве традиционного файлового ресурса-свидетеля.</span><span class="sxs-lookup"><span data-stu-id="c55da-143">Using Cloud Witness removes the need for an additional VM to act as a traditional File Share Witness.</span></span>

### <a name="alternatives"></a><span data-ttu-id="c55da-144">Альтернативные варианты</span><span class="sxs-lookup"><span data-stu-id="c55da-144">Alternatives</span></span>

* <span data-ttu-id="c55da-145">Вместо \*nix и Windows можно использовать другие операционные системы, так как инфраструктура не зависит от операционной системы.</span><span class="sxs-lookup"><span data-stu-id="c55da-145">\*nix, windows can easily be replaced by a variety of other operating systems as nothing in the infrastructure depends on the operating system.</span></span>

* <span data-ttu-id="c55da-146">[SQL Server для Linux][sql-linux] можно заменить серверным хранилищем данных.</span><span class="sxs-lookup"><span data-stu-id="c55da-146">[SQL Server for Linux][sql-linux] can replace the backend data store.</span></span>

* <span data-ttu-id="c55da-147">[Cosmos DB][cosmos] является еще одной альтернативой хранилищу данных.</span><span class="sxs-lookup"><span data-stu-id="c55da-147">[Cosmos DB][cosmos] is another alternative for the data store.</span></span>

## <a name="considerations"></a><span data-ttu-id="c55da-148">Рекомендации</span><span class="sxs-lookup"><span data-stu-id="c55da-148">Considerations</span></span>

### <a name="availability"></a><span data-ttu-id="c55da-149">Доступность</span><span class="sxs-lookup"><span data-stu-id="c55da-149">Availability</span></span>

<span data-ttu-id="c55da-150">Экземпляры виртуальных машин в этом сценарии развертываются в Зоны доступности.</span><span class="sxs-lookup"><span data-stu-id="c55da-150">The VM instances in this scenario are deployed across Availability Zones.</span></span> <span data-ttu-id="c55da-151">Каждая зона состоит из одного или нескольких центров обработки данных, оснащенных независимыми системами электроснабжения, охлаждения и сетевого взаимодействия.</span><span class="sxs-lookup"><span data-stu-id="c55da-151">Each zone is made up of one or more datacenters equipped with independent power, cooling, and networking.</span></span> <span data-ttu-id="c55da-152">Как минимум три зоны доступны во всех включенных регионах.</span><span class="sxs-lookup"><span data-stu-id="c55da-152">A minimum of three zones are available in all enabled regions.</span></span> <span data-ttu-id="c55da-153">Такое распределение экземпляров виртуальной машины в разных зонах обеспечивает высокую степень доступности для уровней приложений.</span><span class="sxs-lookup"><span data-stu-id="c55da-153">This distribution of VM instances across zones provides high availability to the application tiers.</span></span> <span data-ttu-id="c55da-154">Дополнительные сведения о том, что такое Зоны доступности, см. в [этой статье][azureaz-docs].</span><span class="sxs-lookup"><span data-stu-id="c55da-154">For more information, see [what are Availability Zones in Azure?][azureaz-docs]</span></span>

<span data-ttu-id="c55da-155">Уровень базы данных можно настроить для использования групп доступности Always On.</span><span class="sxs-lookup"><span data-stu-id="c55da-155">The database tier can be configured to use Always On availability groups.</span></span> <span data-ttu-id="c55da-156">Если в такой конфигурации SQL Server настроен с одной базой данных-источником в кластере, то он может иметь до восьми баз данных-получателей.</span><span class="sxs-lookup"><span data-stu-id="c55da-156">With this SQL Server configuration, one primary database within a cluster is configured with up to eight secondary databases.</span></span> <span data-ttu-id="c55da-157">Если в базе данных-источнике возникла проблема, кластер выполнит отработку отказа в одну из баз данных-получателей, что позволяет приложению оставаться доступным.</span><span class="sxs-lookup"><span data-stu-id="c55da-157">If an issue occurs with the primary database, the cluster fails over to one of the secondary databases, which allows the application to continue to be available.</span></span> <span data-ttu-id="c55da-158">Дополнительные сведения см. в статье [Обзор групп доступности AlwaysOn (SQL Server)][sqlalwayson-docs].</span><span class="sxs-lookup"><span data-stu-id="c55da-158">For more information, see [Overview of Always On availability groups for SQL Server][sqlalwayson-docs].</span></span>

<span data-ttu-id="c55da-159">Дополнительные сведения по другим вопросам доступности см. в статье [с контрольным списком для обеспечения доступности][availability] в Центре архитектуры Azure.</span><span class="sxs-lookup"><span data-stu-id="c55da-159">For other availability topics, see the [availability checklist][availability] in the Azure Architecture Center.</span></span>

### <a name="scalability"></a><span data-ttu-id="c55da-160">Масштабируемость</span><span class="sxs-lookup"><span data-stu-id="c55da-160">Scalability</span></span>

<span data-ttu-id="c55da-161">В этом сценарии используются масштабируемые наборы виртуальных машин для внешнего и внутреннего компонентов.</span><span class="sxs-lookup"><span data-stu-id="c55da-161">This scenario uses virtual machine scale sets for the frontend and backend components.</span></span> <span data-ttu-id="c55da-162">При использовании масштабируемых наборов количество экземпляров виртуальных машин, работающих на уровне интерфейсных приложений, можно автоматически масштабировать в ответ на потребности клиента или на основе определенного расписания.</span><span class="sxs-lookup"><span data-stu-id="c55da-162">With scale sets, the number of VM instances that run the frontend application tier can automatically scale in response to customer demand, or based on a defined schedule.</span></span> <span data-ttu-id="c55da-163">Дополнительные сведения см. в статье [Обзор автомасштабирования с помощью масштабируемых наборов виртуальных машин Azure][vmssautoscale-docs].</span><span class="sxs-lookup"><span data-stu-id="c55da-163">For more information, see [Overview of autoscale with virtual machine scale sets][vmssautoscale-docs].</span></span>

<span data-ttu-id="c55da-164">Для других вопросов масштабируемости, см. раздел [Контрольный список для обеспечения масштабируемости][scalability] в центре архитектуры Azure.</span><span class="sxs-lookup"><span data-stu-id="c55da-164">For other scalability topics, see the [scalability checklist][scalability] in the Azure Architecture Center.</span></span>

### <a name="security"></a><span data-ttu-id="c55da-165">Безопасность</span><span class="sxs-lookup"><span data-stu-id="c55da-165">Security</span></span>

<span data-ttu-id="c55da-166">Весь трафик виртуальных сетей на уровне интерфейсного приложения защищен группами безопасности сети.</span><span class="sxs-lookup"><span data-stu-id="c55da-166">All the virtual network traffic into the frontend application tier and protected by network security groups.</span></span> <span data-ttu-id="c55da-167">Правила ограничивают поток трафика, так что экземпляры виртуальных машин уровня интерфейсного приложения могут получить доступ к уровню серверной базы данных.</span><span class="sxs-lookup"><span data-stu-id="c55da-167">Rules limit the flow of traffic so that only the frontend application tier VM instances can access the backend database tier.</span></span> <span data-ttu-id="c55da-168">С уровня базы данных запрещено передавать исходящий интернет-трафик.</span><span class="sxs-lookup"><span data-stu-id="c55da-168">No outbound Internet traffic is allowed from the database tier.</span></span> <span data-ttu-id="c55da-169">Чтобы сократить площади атаки, прямые порты удаленного управления остаются закрытыми.</span><span class="sxs-lookup"><span data-stu-id="c55da-169">To reduce the attack footprint, no direct remote management ports are open.</span></span> <span data-ttu-id="c55da-170">Дополнительные сведения см. в статье [Группы безопасности приложений и сети][nsg-docs].</span><span class="sxs-lookup"><span data-stu-id="c55da-170">For more information, see [Azure network security groups][nsg-docs].</span></span>

<span data-ttu-id="c55da-171">Просмотрите рекомендации по развертыванию инфраструктуры в соответствии со [стандартами безопасности данных в индустрии платежных карт (PCI DSS 3.2)][pci-dss].</span><span class="sxs-lookup"><span data-stu-id="c55da-171">To view guidance on deploying Payment Card Industry Data Security Standards (PCI DSS 3.2) [compliant infrastructure][pci-dss].</span></span> <span data-ttu-id="c55da-172">Общие рекомендации по разработке безопасных сценариев см. в статье [Документация по системе безопасности Azure][security].</span><span class="sxs-lookup"><span data-stu-id="c55da-172">For general guidance on designing secure scenarios, see the [Azure Security Documentation][security].</span></span>

### <a name="resiliency"></a><span data-ttu-id="c55da-173">Устойчивость</span><span class="sxs-lookup"><span data-stu-id="c55da-173">Resiliency</span></span>

<span data-ttu-id="c55da-174">В сочетании с использованием Зон доступности и масштабируемых наборов виртуальных машин в этом сценарии используется Шлюз приложений Azure и балансировка нагрузки.</span><span class="sxs-lookup"><span data-stu-id="c55da-174">In combination with the use of Availability Zones and virtual machine scale sets, this scenario uses Azure Application Gateway and load balancer.</span></span> <span data-ttu-id="c55da-175">Эти два сетевых компонента распространяют трафик на подключенные экземпляры виртуальной машины и включают проверки работоспособности, которые гарантируют, что трафик распространяется только на работоспособные виртуальные машины.</span><span class="sxs-lookup"><span data-stu-id="c55da-175">These two networking components distribute traffic to the connected VM instances, and include health probes that ensure traffic is only distributed to healthy VMs.</span></span> <span data-ttu-id="c55da-176">Два экземпляра Шлюза приложений настроены в конфигурации "активный — пассивный", а также используется подсистема балансировки нагрузки, избыточная в пределах зоны.</span><span class="sxs-lookup"><span data-stu-id="c55da-176">Two Application Gateway instances are configured in an active-passive configuration, and a zone-redundant load balancer is used.</span></span> <span data-ttu-id="c55da-177">Эта конфигурация делает сетевые ресурсы и приложение устойчивыми к проблемам, которые в противном случае нарушали бы трафик и влияли бы на доступ пользователя.</span><span class="sxs-lookup"><span data-stu-id="c55da-177">This configuration makes the networking resources and application resilient to issues that would otherwise disrupt traffic and impact end-user access.</span></span>

<span data-ttu-id="c55da-178">Общие рекомендации по разработке устойчивых решений см. в [этой статье][resiliency].</span><span class="sxs-lookup"><span data-stu-id="c55da-178">For general guidance on designing resilient scenarios, see [Designing resilient applications for Azure][resiliency].</span></span>

## <a name="deploy-the-scenario"></a><span data-ttu-id="c55da-179">Развертывание сценария</span><span class="sxs-lookup"><span data-stu-id="c55da-179">Deploy the scenario</span></span>

<span data-ttu-id="c55da-180">**Предварительные требования**</span><span class="sxs-lookup"><span data-stu-id="c55da-180">**Prerequisites.**</span></span>

* <span data-ttu-id="c55da-181">Необходимо иметь учетную запись Azure.</span><span class="sxs-lookup"><span data-stu-id="c55da-181">You must have an existing Azure account.</span></span> <span data-ttu-id="c55da-182">Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись Azure](https://azure.microsoft.com/free/?WT.mc_id=A261C142F), прежде чем начинать работу.</span><span class="sxs-lookup"><span data-stu-id="c55da-182">If you don't have an Azure subscription, create a [free account](https://azure.microsoft.com/free/?WT.mc_id=A261C142F) before you begin.</span></span>
* <span data-ttu-id="c55da-183">Чтобы развернуть кластер SQL Server в серверном масштабируемом наборе, требуется домен в доменных службах Azure Active Directory (AD).</span><span class="sxs-lookup"><span data-stu-id="c55da-183">To deploy a SQL Server cluster into the backend scale set, you would need a domain in Azure Active Directory (AD) Domain Services.</span></span>

<span data-ttu-id="c55da-184">Чтобы развернуть базовую инфраструктуру для этого сценария с помощью шаблона Azure Resource Manager, выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="c55da-184">To deploy the core infrastructure for this scenario with an Azure Resource Manager template, perform the following steps.</span></span>

1. <span data-ttu-id="c55da-185">Выберите **Развертывание в Azure**:</span><span class="sxs-lookup"><span data-stu-id="c55da-185">Select the **Deploy to Azure** button:</span></span><br><a href="https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmspnp%2Fsolution-architectures%2Fmaster%2Finfrastructure%2Fregulated-multitier-app%2Fazuredeploy.json" target="_blank"><img src="https://azuredeploy.net/deploybutton.png"/></a>
2. <span data-ttu-id="c55da-186">Подождите, пока откроется развертывание шаблона на портале Azure, а затем выполните следующие шаги.</span><span class="sxs-lookup"><span data-stu-id="c55da-186">Wait for the template deployment to open in the Azure portal, then complete the following steps:</span></span>
   * <span data-ttu-id="c55da-187">Выберите **Создать** группу ресурсов, а затем укажите в текстовом поле имя, например *myWindowsscenario*.</span><span class="sxs-lookup"><span data-stu-id="c55da-187">Choose to **Create new** resource group, then provide a name such as *myWindowsscenario* in the text box.</span></span>
   * <span data-ttu-id="c55da-188">В раскрывающемся списке **Расположение** выберите регион.</span><span class="sxs-lookup"><span data-stu-id="c55da-188">Select a region from the **Location** drop-down box.</span></span>
   * <span data-ttu-id="c55da-189">Укажите имя пользователя и надежный пароль для экземпляров масштабируемых наборов виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="c55da-189">Provide a username and secure password for the virtual machine scale set instances.</span></span>
   * <span data-ttu-id="c55da-190">Прочтите условия использования и установите флажок **Я принимаю указанные выше условия**.</span><span class="sxs-lookup"><span data-stu-id="c55da-190">Review the terms and conditions, then check **I agree to the terms and conditions stated above**.</span></span>
   * <span data-ttu-id="c55da-191">Нажмите кнопку **Приобрести**.</span><span class="sxs-lookup"><span data-stu-id="c55da-191">Select the **Purchase** button.</span></span>

<span data-ttu-id="c55da-192">Развертывание может занять 15-20 мин.</span><span class="sxs-lookup"><span data-stu-id="c55da-192">It can take 15-20 minutes for the deployment to complete.</span></span>

## <a name="pricing"></a><span data-ttu-id="c55da-193">Цены</span><span class="sxs-lookup"><span data-stu-id="c55da-193">Pricing</span></span>

<span data-ttu-id="c55da-194">Чтобы изучить стоимость выполнения этого сценария, все услуги были предварительно сконфигурированы в калькуляторе стоимости.</span><span class="sxs-lookup"><span data-stu-id="c55da-194">To explore the cost of running this scenario, all of the services are pre-configured in the cost calculator.</span></span>  <span data-ttu-id="c55da-195">Чтобы узнать, как изменится цена для вашего конкретного варианта использования, измените соответствующие переменные в соответствии с ожидаемым трафиком.</span><span class="sxs-lookup"><span data-stu-id="c55da-195">To see how the pricing would change for your particular use case, change the appropriate variables to match your expected traffic.</span></span>

<span data-ttu-id="c55da-196">Мы предоставили три примера профилей затрат, основанных на количестве экземпляров масштабируемых наборов виртуальных машин для запуска приложений.</span><span class="sxs-lookup"><span data-stu-id="c55da-196">We have provided three sample cost profiles based on the number of scale set VM instances that run your applications.</span></span>

* <span data-ttu-id="c55da-197">[Небольшой][small-pricing]: этот пример тарификации предполагает наличие двух интерфейсных и двух серверных экземпляров виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="c55da-197">[Small][small-pricing]: this pricing example correlates to two frontend and two backend VM instances.</span></span>
* <span data-ttu-id="c55da-198">[Средний][medium-pricing]: этот пример тарификации предполагает наличие 20 интерфейсных и пяти серверных экземпляров виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="c55da-198">[Medium][medium-pricing]: this pricing example correlates to 20 frontend and 5 backend VM instances.</span></span>
* <span data-ttu-id="c55da-199">[Большой][large-pricing]: этот пример тарификации предполагает наличие 100 интерфейсных и 10 серверных экземпляров виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="c55da-199">[Large][large-pricing]: this pricing example correlates to 100 frontend and 10 backend VM instances.</span></span>

## <a name="related-resources"></a><span data-ttu-id="c55da-200">Связанные ресурсы</span><span class="sxs-lookup"><span data-stu-id="c55da-200">Related Resources</span></span>

<span data-ttu-id="c55da-201">В этом сценарий использовался серверный масштабируемый набор виртуальных машин, в котором выполнялся кластер Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="c55da-201">This scenario used a backend virtual machine scale set that runs a Microsoft SQL Server cluster.</span></span> <span data-ttu-id="c55da-202">Azure Cosmos DB также может использоваться в качестве масштабируемого безопасного уровня базы данных для данных приложения.</span><span class="sxs-lookup"><span data-stu-id="c55da-202">Azure Cosmos DB could also be used as a scalable and secure database tier for the application data.</span></span> <span data-ttu-id="c55da-203">[Конечная точка службы виртуальной сети Azure][vnetendpoint-docs] позволяет защищать критически важные ресурсы служб Azure в пределах ваших виртуальных сетей.</span><span class="sxs-lookup"><span data-stu-id="c55da-203">An [Azure virtual network service endpoint][vnetendpoint-docs] allows you to secure your critical Azure service resources to only your virtual networks.</span></span> <span data-ttu-id="c55da-204">В этом сценарии конечные точки виртуальной сети позволят обеспечить безопасность трафика между уровнем интерфейсного приложения и Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="c55da-204">In this scenario, VNet endpoints allow you to secure traffic between the frontend application tier and Cosmos DB.</span></span> <span data-ttu-id="c55da-205">Дополнительные сведения о Cosmos DB см. в статье [Добро пожаловать в базу данных Azure Cosmos DB][azurecosmosdb-docs].</span><span class="sxs-lookup"><span data-stu-id="c55da-205">For more information on Cosmos DB, see [Azure Cosmos DB overview][azurecosmosdb-docs].</span></span>

<span data-ttu-id="c55da-206">Кроме того, вы можете просмотреть [эталонную архитектуру для N-уровневого приложения с SQL Server][ntiersql-ra].</span><span class="sxs-lookup"><span data-stu-id="c55da-206">You also view a thorough [reference architecture for a generic N-tier application with SQL Server][ntiersql-ra].</span></span>

<!-- links -->
[appgateway-docs]: /azure/application-gateway/overview
[architecture]: ./media/regulated-multitier-app/architecture-regulated-multitier-app.png
[autoscaling]: /azure/architecture/best-practices/auto-scaling
[availability]: ../../checklist/availability.md
[azureaz-docs]: /azure/availability-zones/az-overview
[azurecosmosdb-docs]: /azure/cosmos-db/introduction
[cloudwitness-docs]: /windows-server/failover-clustering/deploy-cloud-witness
[loadbalancer-docs]: /azure/load-balancer/load-balancer-overview
[nsg-docs]: /azure/virtual-network/security-overview
[ntiersql-ra]: /azure/architecture/reference-architectures/n-tier/n-tier-sql-server
[resiliency]: /azure/architecture/resiliency/ 
[security]: /azure/security/
[scalability]: /azure/architecture/checklist/scalability 
[scaleset-docs]: /azure/virtual-machine-scale-sets/overview
[sqlalwayson-docs]: /sql/database-engine/availability-groups/windows/overview-of-always-on-availability-groups-sql-server
[vmssautoscale-docs]: /azure/virtual-machine-scale-sets/virtual-machine-scale-sets-autoscale-overview
[vnet-docs]: /azure/virtual-network/virtual-networks-overview
[vnetendpoint-docs]: /azure/virtual-network/virtual-network-service-endpoints-overview
[pci-dss]: /azure/security/blueprints/pcidss-iaaswa-overview
[dmz]: /azure/virtual-network/virtual-networks-dmz-nsg
[cosmos]: /azure/cosmos-db/
[sql-linux]: /sql/linux/sql-server-linux-overview?view=sql-server-linux-2017

[small-pricing]: https://azure.com/e/711bbfcbbc884ef8aa91cdf0f2caff72
[medium-pricing]: https://azure.com/e/b622d82d79b34b8398c4bce35477856f
[large-pricing]: https://azure.com/e/1d99d8b92f90496787abecffa1473a93