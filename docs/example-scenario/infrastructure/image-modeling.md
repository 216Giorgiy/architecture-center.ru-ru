---
title: Ускорение цифрового моделирования на основе изображений в Azure
titleSuffix: Azure Example Scenarios
description: Ускорение цифрового моделирования на основе изображений в Azure с помощью Avere и Agisoft PhotoScan
author: adamboeglin
ms.date: 01/11/2019
ms.topic: example-scenario
ms.service: architecture-center
ms.subservice: example-scenario
ms.custom: cat-team, Linux, HPC
social_image_url: /azure/architecture/example-scenario/infrastructure/media/architecture-image-modeling.png
ms.openlocfilehash: 981d9f01ef12f75d9b292196f754f3a0affa791a
ms.sourcegitcommit: 579c39ff4b776704ead17a006bf24cd4cdc65edd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59640385"
---
# <a name="accelerate-digital-image-based-modeling-on-azure"></a><span data-ttu-id="c7c56-103">Ускорение цифрового моделирования на основе изображений в Azure</span><span class="sxs-lookup"><span data-stu-id="c7c56-103">Accelerate digital image-based modeling on Azure</span></span>

<span data-ttu-id="c7c56-104">В этом примере представлены рекомендации по выбору архитектуры и разработке для любой организации, которой потребуется выполнять моделирование на основе изображений в службе IaaS (инфраструктура как услуга) Azure.</span><span class="sxs-lookup"><span data-stu-id="c7c56-104">This example scenario provides architecture and design guidance for any organization that wants to perform image-based modeling on Azure infrastructure-as-a-service (IaaS).</span></span> <span data-ttu-id="c7c56-105">Этот сценарий реализует программу фотограмметрии на виртуальных машинах Azure, к которым для ускорения обработки подключено высокопроизводительное хранилище.</span><span class="sxs-lookup"><span data-stu-id="c7c56-105">The scenario is designed for running photogrammetry software on Azure Virtual Machines (VMs) using high-performance storage that accelerates processing time.</span></span> <span data-ttu-id="c7c56-106">Можно увеличивать и уменьшать масштаб среды выполнения по мере необходимости, и она поддерживает хранилища объемом в несколько терабайт без ущерба для производительности.</span><span class="sxs-lookup"><span data-stu-id="c7c56-106">The environment can be scaled up and down as needed and supports terabytes of storage without sacrificing performance.</span></span>

## <a name="relevant-use-cases"></a><span data-ttu-id="c7c56-107">Варианты соответствующего использования</span><span class="sxs-lookup"><span data-stu-id="c7c56-107">Relevant use cases</span></span>

<span data-ttu-id="c7c56-108">Ниже перечислены возможные варианты использования.</span><span class="sxs-lookup"><span data-stu-id="c7c56-108">Relevant use cases include:</span></span>

- <span data-ttu-id="c7c56-109">Моделирование и измерение зданий, инженерных структур, а также сцен преступлений и происшествий.</span><span class="sxs-lookup"><span data-stu-id="c7c56-109">Modeling and measuring buildings, engineering structures, and forensic accident scenes.</span></span>
- <span data-ttu-id="c7c56-110">Создание визуальных эффектов для компьютерных игр и фильмов.</span><span class="sxs-lookup"><span data-stu-id="c7c56-110">Creating visual effects for computer games and movies.</span></span>
- <span data-ttu-id="c7c56-111">Использование цифровых изображений для косвенного измерения объектов разных масштабов для планирования городской застройки и других целей.</span><span class="sxs-lookup"><span data-stu-id="c7c56-111">Using digital images to indirectly generate measurements of objects of various scales as in urban planning and other applications.</span></span>

## <a name="architecture"></a><span data-ttu-id="c7c56-112">Архитектура</span><span class="sxs-lookup"><span data-stu-id="c7c56-112">Architecture</span></span>

<span data-ttu-id="c7c56-113">В этом примере описывается использование программного обеспечения Agisoft PhotoScan для фотограмметрии с подключенным хранилищем Avere vFXT.</span><span class="sxs-lookup"><span data-stu-id="c7c56-113">This example describes the use of Agisoft PhotoScan photogrammetry software backed by Avere vFXT storage.</span></span> <span data-ttu-id="c7c56-114">Мы выбрали PhotoScan как очень популярную платформу для приложений геоинформационных систем (GIS), документации по региональному наследию, разработки игр и производства визуальных эффектов.</span><span class="sxs-lookup"><span data-stu-id="c7c56-114">PhotoScan was chosen for its popularity in geographic information system (GIS) applications, cultural heritage documentation, game development, and visual effects production.</span></span> <span data-ttu-id="c7c56-115">Она поддерживает фотограмметрию как на близких расстояниях, так и с воздушной съемки.</span><span class="sxs-lookup"><span data-stu-id="c7c56-115">It is suitable for both close-range photogrammetry and aerial photogrammetry.</span></span>

<span data-ttu-id="c7c56-116">Описанные в этой статье концепции относятся к любой рабочей нагрузке высокопроизводительных вычислений (HPC), которая использует планировщик и рабочие узлы, управляемые как инфраструктура.</span><span class="sxs-lookup"><span data-stu-id="c7c56-116">The concepts in this article apply to any high-performance computing (HPC) workload based on a scheduler and worker nodes managed as infrastructure.</span></span>  <span data-ttu-id="c7c56-117">Для этой рабочей нагрузки мы выбрали хранилище Avere vFXT, руководствуясь его высокой производительностью по результатам тестов.</span><span class="sxs-lookup"><span data-stu-id="c7c56-117">For this workload, Avere vFXT was selected for its superior performance during benchmark tests.</span></span>  <span data-ttu-id="c7c56-118">Но в этом сценарии хранилище отделено от системы обработки, что позволяет применить любое другое решение хранения (см. [альтернативные варианты](#alternatives) далее в этой статье).</span><span class="sxs-lookup"><span data-stu-id="c7c56-118">However, the scenario decouples the storage from the processing so that other storage solutions can be used (see [alternatives](#alternatives) later in this document).</span></span>

<span data-ttu-id="c7c56-119">Эта архитектура также содержит контроллеры домена Active Directory, которые управляют доступом к ресурсам Azure и обеспечивают внутреннее разрешение имен через системы доменных имен (DNS).</span><span class="sxs-lookup"><span data-stu-id="c7c56-119">This architecture also includes Active Directory domain controllers to control access to Azure resources and provide internal name resolution through the Domain Name System (DNS).</span></span> <span data-ttu-id="c7c56-120">Серверы перехода предоставляют доступ с правами администратора к виртуальным машинам Windows и Linux, на которых выполняется это решение.</span><span class="sxs-lookup"><span data-stu-id="c7c56-120">Jump boxes provide administrator access to the Windows and Linux VMs that run the solution.</span></span>

![схема архитектуры](./media/architecture-image-modeling.png)

1. <span data-ttu-id="c7c56-122">Пользователь передает в PhotoScan некоторое количество изображений.</span><span class="sxs-lookup"><span data-stu-id="c7c56-122">User submits a number of images to PhotoScan.</span></span>
2. <span data-ttu-id="c7c56-123">Планировщик PhotoScan выполняется на виртуальной Машине Windows, которая назначена головным узлом, и управляет обработкой изображений пользователя.</span><span class="sxs-lookup"><span data-stu-id="c7c56-123">The PhotoScan Scheduler runs on a Windows VM that serves as the head node and directs processing of the user's images.</span></span>
3. <span data-ttu-id="c7c56-124">PhotoScan ищет на фотографиях общие точки и создает для них геометрию (сетку), используя узлы обработки PhotoScan на виртуальных машинах с графическими процессорами (GPU).</span><span class="sxs-lookup"><span data-stu-id="c7c56-124">PhotoScan searches for common points on the photographs and constructs the geometry (mesh) using the PhotoScan processing nodes running on VMs with graphics processing units (GPUs).</span></span>
4. <span data-ttu-id="c7c56-125">Avere vFXT предоставляет высокопроизводительное хранилище в Azure, основанное на сетевой файловой системе версии 3 (NFSv3) и состоящее не менее чем из четырех виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="c7c56-125">Avere vFXT provides a high-performance storage solution on Azure based on Network File System version 3 (NFSv3) and comprised of at least four VMs.</span></span>
5. <span data-ttu-id="c7c56-126">PhotoScan визуализирует модель.</span><span class="sxs-lookup"><span data-stu-id="c7c56-126">PhotoScan renders the model.</span></span>

### <a name="components"></a><span data-ttu-id="c7c56-127">Компоненты</span><span class="sxs-lookup"><span data-stu-id="c7c56-127">Components</span></span>

- <span data-ttu-id="c7c56-128">[Agisoft PhotoScan](http://www.agisoft.com/). Планировщик PhotoScan работает на виртуальной машине под управлением Windows Server 2016, а узлы обработки используют пять виртуальных машин с графическими процессорами под управлением CentOS Linux 7.5.</span><span class="sxs-lookup"><span data-stu-id="c7c56-128">[Agisoft PhotoScan](http://www.agisoft.com/): The PhotoScan Scheduler runs on a Windows 2016 Server VM, and the processing nodes use five VMs with GPUs that run CentOS Linux 7.5.</span></span>
- <span data-ttu-id="c7c56-129">[Avere vFXT](/azure/avere-vfxt/avere-vfxt-overview) представляет собой решение для кэширования файлов, которое использует хранилище объектов и традиционное запоминающее устройство, подключаемое к сети (NAS) для оптимизации хранения больших наборов данных.</span><span class="sxs-lookup"><span data-stu-id="c7c56-129">[Avere vFXT](/azure/avere-vfxt/avere-vfxt-overview) is a file caching solution that uses object storage and traditional network-attached storage (NAS) to optimize storage of large datasets.</span></span> <span data-ttu-id="c7c56-130"> Сюда входят:</span><span class="sxs-lookup"><span data-stu-id="c7c56-130">It includes:</span></span>
  - <span data-ttu-id="c7c56-131">Контроллер Avere.</span><span class="sxs-lookup"><span data-stu-id="c7c56-131">Avere Controller.</span></span> <span data-ttu-id="c7c56-132">Эта виртуальная машина выполняет скрипт установки кластера vFXT Avere и работает под управлением Ubuntu 18.04 LTS.</span><span class="sxs-lookup"><span data-stu-id="c7c56-132">This VM executes the script that installs the Avere vFXT cluster and runs Ubuntu 18.04 LTS.</span></span> <span data-ttu-id="c7c56-133">Эта виртуальная машина позволит позднее добавить или удалить узлы кластера, а также уничтожить весь кластер.</span><span class="sxs-lookup"><span data-stu-id="c7c56-133">The VM can be used later to add or remove cluster nodes and to destroy the cluster as well.</span></span>
  - <span data-ttu-id="c7c56-134">Кластер vFXT.</span><span class="sxs-lookup"><span data-stu-id="c7c56-134">vFXT cluster.</span></span> <span data-ttu-id="c7c56-135">Используются по крайней мере три виртуальные машины, по одной для каждого из узлов Avere vFXT на основе ОС Avere 5.0.2.1.</span><span class="sxs-lookup"><span data-stu-id="c7c56-135">At least three VMs are used, one for each of the Avere vFXT nodes based on Avere OS 5.0.2.1.</span></span> <span data-ttu-id="c7c56-136">Эти виртуальные машины формируют кластер vFXT, который прикреплен к хранилищу BLOB-объектов Azure.</span><span class="sxs-lookup"><span data-stu-id="c7c56-136">These VMs form the vFXT cluster, which is attached to Azure Blob storage.</span></span>
- <span data-ttu-id="c7c56-137">[Контроллеры домена Microsoft Active Directory](/windows/desktop/ad/active-directory-domain-services) позволяют узлу обращаться к ресурсам домена и обеспечивают разрешение имен DNS.</span><span class="sxs-lookup"><span data-stu-id="c7c56-137">[Microsoft Active Directory domain controllers](/windows/desktop/ad/active-directory-domain-services) allow the host access to domain resources and provide DNS name resolution.</span></span> <span data-ttu-id="c7c56-138">Avere vFXT добавляет несколько записей &mdash; к примеру, каждый объект записи в кластере vFXT указывает на IP-адрес каждого узла vFXT Avere.</span><span class="sxs-lookup"><span data-stu-id="c7c56-138">Avere vFXT adds a number of A records &mdash; for example, each A record in a vFXT cluster points to the IP address of each Avere vFXT node.</span></span> <span data-ttu-id="c7c56-139">В этой конфигурации все виртуальные машины обращаются к экспорту vFXT методом циклического перебора.</span><span class="sxs-lookup"><span data-stu-id="c7c56-139">In this setup, all VMs use the round-robin pattern to access vFXT exports.</span></span>
- <span data-ttu-id="c7c56-140">[Другие виртуальные машины](/azure/virtual-machines/) выступают в качестве серверов перехода, позволяя администратору получить доступ к узлам планировщика и узлам обработки.</span><span class="sxs-lookup"><span data-stu-id="c7c56-140">[Other VMs](/azure/virtual-machines/) serve as jump boxes used by the administrator to access the scheduler and processing nodes.</span></span> <span data-ttu-id="c7c56-141">Сервер перехода Windows является обязательным для доступа администратора к головному узлу через протокол удаленного рабочего стола.</span><span class="sxs-lookup"><span data-stu-id="c7c56-141">The Windows jumpbox is mandatory to allow the administrator to access the head node via remote desktop protocol.</span></span> <span data-ttu-id="c7c56-142">Второй (необязательный) сервер перехода работает под управлением Linux и используется для администрирования рабочих узлов.</span><span class="sxs-lookup"><span data-stu-id="c7c56-142">The second jumpbox is optional and runs Linux for administration of the worker nodes.</span></span>
- <span data-ttu-id="c7c56-143">[Группы безопасности сети](/azure/virtual-network/manage-network-security-group) (NSG) ограничивают доступ к общедоступным IP-адресам и разрешают использовать порты 3389 и 22 для доступа к виртуальным машинам, подключенным к подсети перехода.</span><span class="sxs-lookup"><span data-stu-id="c7c56-143">[Network security groups](/azure/virtual-network/manage-network-security-group) (NSGs) limit access to the public IP address (PIP) and allow ports 3389 and 22 for access to the VMs attached to the Jumpbox subnet.</span></span>
- <span data-ttu-id="c7c56-144">[Пиринг между виртуальными сетями](/azure/virtual-network/virtual-network-peering-overview) подключает виртуальную сеть PhotoScan к виртуальной сети Avere.</span><span class="sxs-lookup"><span data-stu-id="c7c56-144">[Virtual network peering](/azure/virtual-network/virtual-network-peering-overview) connects a PhotoScan virtual network to an Avere virtual network.</span></span>
- <span data-ttu-id="c7c56-145">[Хранилище BLOB-объектов Azure](/azure/storage/blobs/storage-blobs-introduction) выполняет для Avere vFXT функцию основного файлового хранилища для обрабатываемых зафиксированных данных.</span><span class="sxs-lookup"><span data-stu-id="c7c56-145">[Azure Blob storage](/azure/storage/blobs/storage-blobs-introduction) works with Avere vFXT as the core filer to store the committed data being processed.</span></span> <span data-ttu-id="c7c56-146">Avere vFXT находит в BLOB-объекте Azure активные данные и передает их на диски SSD, которые используются для кэширования на вычислительных узлах, пока выполняется задание PhotoScan.</span><span class="sxs-lookup"><span data-stu-id="c7c56-146">Avere vFXT identifies the active data stored in Azure Blob and tiers it into solid-state drives (SSD) used for caching in its compute nodes while a PhotoScan job is running.</span></span> <span data-ttu-id="c7c56-147">Измененные данные асинхронно фиксируются обратно в основном файловом хранилище.</span><span class="sxs-lookup"><span data-stu-id="c7c56-147">If changes are made, the data is asynchronously committed back to the core filer.</span></span>
- <span data-ttu-id="c7c56-148">[Azure Key Vault](/azure/key-vault/key-vault-overview) используется для хранения паролей администратора и кода активации PhotoScan.</span><span class="sxs-lookup"><span data-stu-id="c7c56-148">[Azure Key Vault](/azure/key-vault/key-vault-overview) is used to store the administrator passwords and PhotoScan activation code.</span></span>

### <a name="alternatives"></a><span data-ttu-id="c7c56-149">Альтернативные варианты</span><span class="sxs-lookup"><span data-stu-id="c7c56-149">Alternatives</span></span>

- <span data-ttu-id="c7c56-150">Чтобы воспользоваться службами Azure для управления кластером HPC, лучше применить Azure CycleCloud, пакетную службу Azure и другие специальные средства, а не управлять ресурсами с помощью шаблонов или скриптов.</span><span class="sxs-lookup"><span data-stu-id="c7c56-150">To take advantage of Azure services for managing an HPC cluster, use tools such as Azure CycleCloud or Azure Batch instead of managing the resources through templates or scripts.</span></span>
- <span data-ttu-id="c7c56-151">В качестве серверного хранилища разверните в Azure параллельную виртуальную файловую систему BeeGFS вместо Avere vFXT.</span><span class="sxs-lookup"><span data-stu-id="c7c56-151">Deploy the BeeGFS parallel virtual file system as the back-end storage on Azure instead of Avere vFXT.</span></span> <span data-ttu-id="c7c56-152">Используйте [шаблон BeeGFS](https://github.com/paulomarquesc/beegfs-template) для развертывания этого комплексного решения в Azure.</span><span class="sxs-lookup"><span data-stu-id="c7c56-152">Use the [BeeGFS template](https://github.com/paulomarquesc/beegfs-template) to deploy this end-to-end solution on Azure.</span></span>
- <span data-ttu-id="c7c56-153">Разверните любое решение хранилища, например GlusterFS, Lustre или Windows Storage Spaces Direct.</span><span class="sxs-lookup"><span data-stu-id="c7c56-153">Deploy the storage solution of your choice, such as GlusterFS, Lustre, or Windows Storage Spaces Direct.</span></span> <span data-ttu-id="c7c56-154">Для этого измените [шаблон PhotoScan](https://github.com/paulomarquesc/photoscan-template) для работы с нужным решением хранилища.</span><span class="sxs-lookup"><span data-stu-id="c7c56-154">To do this, edit the [PhotoScan template](https://github.com/paulomarquesc/photoscan-template) to work with the storage solution you want.</span></span>
- <span data-ttu-id="c7c56-155">Разверните рабочие узлы с операционной системой Windows вместо Linux, которая используется по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="c7c56-155">Deploy the worker nodes with the Windows operating system instead of Linux, the default option.</span></span> <span data-ttu-id="c7c56-156">Если вы выберете узлы Windows, шаблоны развертывания не будут применять параметры интеграции хранилища.</span><span class="sxs-lookup"><span data-stu-id="c7c56-156">When choosing Windows nodes, storage integration options are not executed by the deployment templates.</span></span> <span data-ttu-id="c7c56-157">Вам придется вручную интегрировать в среду существующее решение хранилища или настроить шаблон PhotoScan для дополнительной автоматизации, как описано в [этом репозитории](https://github.com/paulomarquesc/photoscan-template/blob/master/docs/AverePostDeploymentSteps.md).</span><span class="sxs-lookup"><span data-stu-id="c7c56-157">You must manually integrate the environment with an existing storage solution, or customize the PhotoScan template to provide such automation, as described in the [repository](https://github.com/paulomarquesc/photoscan-template/blob/master/docs/AverePostDeploymentSteps.md).</span></span>

## <a name="considerations"></a><span data-ttu-id="c7c56-158">Рекомендации</span><span class="sxs-lookup"><span data-stu-id="c7c56-158">Considerations</span></span>

<span data-ttu-id="c7c56-159">Этот сценарий предназначен специально для предоставления высокопроизводительного хранилища для рабочей нагрузки HPC, которая развернута на базе ОС Windows или Linux.</span><span class="sxs-lookup"><span data-stu-id="c7c56-159">This scenario is designed specifically to provide high-performance storage for an HPC workload, whether it is deployed on Windows or Linux.</span></span> <span data-ttu-id="c7c56-160">В общем случае конфигурация хранилища для рабочей нагрузки HPC должна соответствовать всем рекомендациям, которые применимы для локальных развертываний.</span><span class="sxs-lookup"><span data-stu-id="c7c56-160">In general, the storage configuration of the HPC workload should match the appropriate best practices used for on-premises deployments.</span></span>

<span data-ttu-id="c7c56-161">Рекомендации по развертыванию зависят от используемых приложений и служб с учетом описанных далее аспектов.</span><span class="sxs-lookup"><span data-stu-id="c7c56-161">Deployment considerations depend on the applications and services used, but a few notes apply:</span></span>

- <span data-ttu-id="c7c56-162">При создании приложений с высокой производительностью используйте хранилище Azure класса Premium и [оптимизируйте уровень приложения](/azure/virtual-machines/windows/premium-storage-performance).</span><span class="sxs-lookup"><span data-stu-id="c7c56-162">When building high-performance applications, use Azure Premium Storage and [optimize the application layer](/azure/virtual-machines/windows/premium-storage-performance).</span></span> <span data-ttu-id="c7c56-163">Оптимизируйте хранилище для частого доступа с помощью [горячего уровня доступа](/azure/storage/blobs/storage-blob-storage-tiers) для BLOB-объектов Azure.</span><span class="sxs-lookup"><span data-stu-id="c7c56-163">Optimize storage for frequent access using Azure Blob [hot tier access](/azure/storage/blobs/storage-blob-storage-tiers).</span></span>
- <span data-ttu-id="c7c56-164">Использовать хранилище с [варианта репликации](/azure/storage/common/storage-redundancy) , удовлетворяющей требования к доступности и производительности.</span><span class="sxs-lookup"><span data-stu-id="c7c56-164">Use a storage [replication option](/azure/storage/common/storage-redundancy) that meets your availability and performance requirements.</span></span> <span data-ttu-id="c7c56-165">В этом примере Avere vFXT настраивается для высокого уровня доступности (вариант по умолчанию) с локально избыточным хранилищем (LRS).</span><span class="sxs-lookup"><span data-stu-id="c7c56-165">In this example, Avere vFXT is configured for high availability by default, with locally redundant storage (LRS).</span></span> <span data-ttu-id="c7c56-166">Для балансировки нагрузки все виртуальные машины в этой конфигурации обращаются к экспорту vFXT методом циклического перебора.</span><span class="sxs-lookup"><span data-stu-id="c7c56-166">For load balancing, all VMs in this setup use the round-robin pattern to access vFXT exports.</span></span>
- <span data-ttu-id="c7c56-167">Если серверное хранилище будет использоваться одновременно для клиентов Windows и Linux, используйте серверы Samba для поддержки узлов Windows.</span><span class="sxs-lookup"><span data-stu-id="c7c56-167">If the backend storage will be consumed by both Windows clients and Linux clients, use Samba servers to support the Windows nodes.</span></span> <span data-ttu-id="c7c56-168">В другой [версии](https://github.com/paulomarquesc/beegfs-template) этого сценария, основанной на BeeGFS, Samba используется для поддержки узла планировщика для рабочей нагрузки HPC (PhotoScan), который работает под управлением Windows.</span><span class="sxs-lookup"><span data-stu-id="c7c56-168">A [version](https://github.com/paulomarquesc/beegfs-template) of this example scenario based on BeeGFS uses Samba to support the scheduler node of the HPC workload (PhotoScan) running on Windows.</span></span> <span data-ttu-id="c7c56-169">Также развернута подсистема балансировки нагрузки, которая выполняет роль более интеллектуальной замены метода циклического перебора DNS.</span><span class="sxs-lookup"><span data-stu-id="c7c56-169">A load balancer is deployed to act like a smart replacement for DNS round robin.</span></span>
- <span data-ttu-id="c7c56-170">Запустите приложения HPC, выбрав наиболее подходящий тип виртуальной машины для вашей рабочей нагрузки [Windows](/azure/virtual-machines/windows/sizes-hpc) или [Linux](/azure/virtual-machines/linux/sizes?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="c7c56-170">Run HPC applications using the VM type best suited for your [Windows](/azure/virtual-machines/windows/sizes-hpc) or [Linux](/azure/virtual-machines/linux/sizes?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) workload.</span></span>
- <span data-ttu-id="c7c56-171">Чтобы отделить рабочую нагрузку HPC от ресурсов хранения, развертывайте их в разных виртуальных сетях и настройте [пиринг](/azure/virtual-network/virtual-network-peering-overview) между виртуальными сетями, чтобы они могли взаимодействовать.</span><span class="sxs-lookup"><span data-stu-id="c7c56-171">To isolate the HPC workload from the storage resources, deploy each in its own virtual network, then use virtual network [peering](/azure/virtual-network/virtual-network-peering-overview) to connect the two.</span></span> <span data-ttu-id="c7c56-172">Пиринг создает подключение с низкой задержкой и высокой пропускной способностью между ресурсами в разных виртуальных сетях, направляя трафик через магистральную инфраструктуру корпорации Майкрософт и используя только частные IP-адреса.</span><span class="sxs-lookup"><span data-stu-id="c7c56-172">Peering creates a low-latency, high-bandwidth connection between resources in different virtual networks and routes traffic through the Microsoft backbone infrastructure through private IP addresses only.</span></span>

### <a name="security"></a><span data-ttu-id="c7c56-173">Безопасность</span><span class="sxs-lookup"><span data-stu-id="c7c56-173">Security</span></span>

<span data-ttu-id="c7c56-174">Этот пример посвящен развертыванию высокопроизводительного хранилища для рабочей нагрузки HPC и не учитывает многие вопросы безопасности.</span><span class="sxs-lookup"><span data-stu-id="c7c56-174">This example focuses on deploying a high-performance storage solution for an HPC workload and is not a security solution.</span></span> <span data-ttu-id="c7c56-175">При внесении любых изменений не забудьте проконсультироваться со специалистами по безопасности.</span><span class="sxs-lookup"><span data-stu-id="c7c56-175">Make sure to involve your security team for any changes.</span></span>

<span data-ttu-id="c7c56-176">Чтобы повысить безопасность, в этом примере инфраструктуры все виртуальные машины Windows присоединяются к домену и используют централизованную аутентификацию на основе Active Directory.</span><span class="sxs-lookup"><span data-stu-id="c7c56-176">For added security, this example infrastructure enables all the Windows VMs to be domain-joined and uses Active Directory for central authentication.</span></span> <span data-ttu-id="c7c56-177">Также здесь предоставляются настраиваемые службы DNS для всех виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="c7c56-177">It also provides custom DNS services for all VMs.</span></span> <span data-ttu-id="c7c56-178">Для защиты среды в этом шаблоне применяются [группы безопасности сети (NSG)](/azure/virtual-network/security-overview).</span><span class="sxs-lookup"><span data-stu-id="c7c56-178">To help protect the environment, this template relies on [network security groups (NSGs)](/azure/virtual-network/security-overview).</span></span> <span data-ttu-id="c7c56-179">Группы безопасности сети обеспечивают базовые фильтры трафика и правила безопасности.</span><span class="sxs-lookup"><span data-stu-id="c7c56-179">NSGs offer basic traffic filters and security rules.</span></span>

<span data-ttu-id="c7c56-180">Для улучшения безопасности в этом сценарии попробуйте применить следующие варианты:</span><span class="sxs-lookup"><span data-stu-id="c7c56-180">Consider the following options to further improve security in this scenario:</span></span>

- <span data-ttu-id="c7c56-181">Используйте виртуальные сетевые модули, например Fortinet, Checkpoint или Juniper.</span><span class="sxs-lookup"><span data-stu-id="c7c56-181">Use network virtual appliances such as Fortinet, Checkpoint, and Juniper.</span></span>
- <span data-ttu-id="c7c56-182">Примените к группам ресурсов [управление доступом на основе ролей](/azure/role-based-access-control/overview).</span><span class="sxs-lookup"><span data-stu-id="c7c56-182">Apply [role-based access control](/azure/role-based-access-control/overview) to the resource groups.</span></span>
- <span data-ttu-id="c7c56-183">Включите для виртуальной машины [JIT](/azure/security-center/security-center-just-in-time)-доступ, если серверы перехода доступны через Интернет.</span><span class="sxs-lookup"><span data-stu-id="c7c56-183">Enable VM [JIT](/azure/security-center/security-center-just-in-time) access if jump boxes are accessed via the Internet.</span></span>
- <span data-ttu-id="c7c56-184">Примените [Azure Key Vault](/azure/key-vault/quick-create-portal) для хранения паролей, используемых для учетных записей администраторов.</span><span class="sxs-lookup"><span data-stu-id="c7c56-184">Use [Azure Key Vault](/azure/key-vault/quick-create-portal) to store the passwords used by administrator accounts.</span></span>

## <a name="pricing"></a><span data-ttu-id="c7c56-185">Цены</span><span class="sxs-lookup"><span data-stu-id="c7c56-185">Pricing</span></span>

<span data-ttu-id="c7c56-186">Затраты на выполнение этого сценария может сильно различаться в зависимости от нескольких факторов.</span><span class="sxs-lookup"><span data-stu-id="c7c56-186">The cost of running this scenario can vary greatly depending on multiple factors.</span></span>  <span data-ttu-id="c7c56-187">На цену повлияют количество и размер виртуальных машин, требуемый объем хранилища, необходимое время на выполнение задания.</span><span class="sxs-lookup"><span data-stu-id="c7c56-187">The number and size of VMs, how much storage is required, and the amount of time to complete a job will determine your cost.</span></span>

<span data-ttu-id="c7c56-188">Следующий пример профиля стоимости в [калькуляторе цен Azure](https://azure.com/e/42362ddfd2e245a28a8e78bc609c80f3) основан на типичной конфигурации для Avere vFXT и PhotoScan.</span><span class="sxs-lookup"><span data-stu-id="c7c56-188">The following sample cost profile in the [Azure pricing calculator](https://azure.com/e/42362ddfd2e245a28a8e78bc609c80f3) is based on a typical configuration for Avere vFXT and PhotoScan:</span></span>

- <span data-ttu-id="c7c56-189">1 виртуальная машина A1\_v2 c Ubuntu для контроллера Avere.</span><span class="sxs-lookup"><span data-stu-id="c7c56-189">1 A1\_v2 Ubuntu VM to run the Avere controller.</span></span>
- <span data-ttu-id="c7c56-190">3 виртуальные машины D16s\_v3 с Avere ОС, по одной для каждого узла в кластере Avere vFXT.</span><span class="sxs-lookup"><span data-stu-id="c7c56-190">3 D16s\_v3 Avere OS VMs, one for each of the Avere vFXT nodes that form the vFXT cluster.</span></span>
- <span data-ttu-id="c7c56-191">5 виртуальных машин NC24\_v2 с ОС Linux, которые предоставляют GPU для вычислительных узлов PhotoScan.</span><span class="sxs-lookup"><span data-stu-id="c7c56-191">5 NC24\_v2 Linux VMs to provide the GPUs needed by the PhotoScan processing nodes.</span></span>
- <span data-ttu-id="c7c56-192">1 виртуальная машина D8s\_v3 с ОС CentOS для узла планировщика PhotoScan.</span><span class="sxs-lookup"><span data-stu-id="c7c56-192">1 D8s\_v3 CentOS VM for the PhotoScan scheduler node.</span></span>
- <span data-ttu-id="c7c56-193">1 виртуальная машина DS2\_v2 с ОС CentOS в качестве сервера перехода для администратора.</span><span class="sxs-lookup"><span data-stu-id="c7c56-193">1 DS2\_v2 CentOS used as administrator jumpbox.</span></span>
- <span data-ttu-id="c7c56-194">2 виртуальные машины DS2\_v2 для контроллеров домена Active Directory.</span><span class="sxs-lookup"><span data-stu-id="c7c56-194">2 DS2\_v2 VMs for the Active Directory domain controllers.</span></span>
- <span data-ttu-id="c7c56-195">Управляемые диски уровня "Премиум".</span><span class="sxs-lookup"><span data-stu-id="c7c56-195">Premium managed disks.</span></span>
- <span data-ttu-id="c7c56-196">Хранилище BLOB-объектов общего назначения версии 2 (GPv2) с локально избыточным хранилищем (LRS) и горячим уровнем доступа (только учетные записи хранения GPv2 предоставляют атрибут уровня доступа Access Tier).</span><span class="sxs-lookup"><span data-stu-id="c7c56-196">General purpose v2 (GPv2) Blob storage with LRS and hot tier access (only GPv2 storage accounts expose the Access Tier attribute).</span></span>
- <span data-ttu-id="c7c56-197">Виртуальная сеть с поддержкой передачи данных до 10 ТБ.</span><span class="sxs-lookup"><span data-stu-id="c7c56-197">Virtual network with support for 10 TB data transfer.</span></span>

<span data-ttu-id="c7c56-198">Дополнительные сведения об этой архитектуре см. в [этой электронной книге](https://azure.microsoft.com/en-us/resources/deploy-agisoft-photoscan-on-azure-with-azere-vfxt-for-azure-or-beegfs/).</span><span class="sxs-lookup"><span data-stu-id="c7c56-198">For details about this architecture, see the [ebook](https://azure.microsoft.com/en-us/resources/deploy-agisoft-photoscan-on-azure-with-azere-vfxt-for-azure-or-beegfs/).</span></span> <span data-ttu-id="c7c56-199">Чтобы узнать, как изменится цена для конкретного варианта использования, измените размер виртуальных машин в калькуляторе цен в соответствии с ожидаемым развертыванием.</span><span class="sxs-lookup"><span data-stu-id="c7c56-199">To see how the pricing would change for your particular use case, choose different VM sizes in the pricing calculator to match your expected deployment.</span></span>

## <a name="deployment"></a><span data-ttu-id="c7c56-200">Развертывание</span><span class="sxs-lookup"><span data-stu-id="c7c56-200">Deployment</span></span>

<span data-ttu-id="c7c56-201">Пошаговые инструкции по развертыванию этой архитектуры, включая все необходимые компоненты для использования Avere FxT или BeeGFS, вы можете скачать в формате электронной книги: [Deploy Agisoft PhotoScan on Azure With Avere vFXT for Azure or BeeGFS](https://azure.microsoft.com/en-us/resources/deploy-agisoft-photoscan-on-azure-with-azere-vfxt-for-azure-or-beegfs/) (Развертывание Agisoft PhotoScan на Azure с помощью Avere vFXT для Azure или BeeGFS).</span><span class="sxs-lookup"><span data-stu-id="c7c56-201">For step-by-step instructions for deploying this architecture, including all the prerequisites for using either Avere FxT or BeeGFS, download the ebook: [Deploy Agisoft PhotoScan on Azure With Avere vFXT for Azure or BeeGFS](https://azure.microsoft.com/en-us/resources/deploy-agisoft-photoscan-on-azure-with-azere-vfxt-for-azure-or-beegfs/).</span></span>

## <a name="related-resources"></a><span data-ttu-id="c7c56-202">Связанные ресурсы</span><span class="sxs-lookup"><span data-stu-id="c7c56-202">Related resources</span></span>

<span data-ttu-id="c7c56-203">Следующие ресурсы предоставят дополнительные сведения о компонентах для этого сценария и ряд альтернативных подходов к пакетной обработке в Azure.</span><span class="sxs-lookup"><span data-stu-id="c7c56-203">The following resources will provide more information on the components utilized in this scenario, along with alternative approaches for batch computing on Azure.</span></span>

- <span data-ttu-id="c7c56-204">Общие сведения об [Avere vFXT для Azure](/azure/avere-vfxt/avere-vfxt-overview).</span><span class="sxs-lookup"><span data-stu-id="c7c56-204">Overview of [Avere vFXT for Azure](/azure/avere-vfxt/avere-vfxt-overview)</span></span>
- <span data-ttu-id="c7c56-205">Домашняя страница [Agisoft PhotoScan](https://www.agisoft.com/).</span><span class="sxs-lookup"><span data-stu-id="c7c56-205">[Agisoft PhotoScan](https://www.agisoft.com/) home Page</span></span>
- [<span data-ttu-id="c7c56-206">Производительность службы хранилища Azure и контрольный список масштабируемости</span><span class="sxs-lookup"><span data-stu-id="c7c56-206">Azure Storage Performance and Scalability Checklist</span></span>](/azure/storage/common/storage-performance-checklist)
- <span data-ttu-id="c7c56-207">[Parallel Virtual File Systems on Microsoft Azure: Performance tests of Lustre, GlusterFS, and BeeGFS](https://azure.microsoft.com/mediahandler/files/resourcefiles/parallel-virtual-file-systems-on-microsoft-azure/Parallel_Virtual_File_Systems_on_Microsoft_Azure.pdf) (PDF-файл) (Параллельные виртуальные файловые системы в Microsoft Azure: тесты производительности Lustre, GlusterFS и BeeGFS)</span><span class="sxs-lookup"><span data-stu-id="c7c56-207">[Parallel Virtual File Systems on Microsoft Azure: Performance tests of Lustre, GlusterFS, and BeeGFS](https://azure.microsoft.com/mediahandler/files/resourcefiles/parallel-virtual-file-systems-on-microsoft-azure/Parallel_Virtual_File_Systems_on_Microsoft_Azure.pdf) (PDF)</span></span>
- <span data-ttu-id="c7c56-208">Пример сценария для [автоматизированного проектирования в Azure](/azure/architecture/example-scenario/apps/hpc-saas)</span><span class="sxs-lookup"><span data-stu-id="c7c56-208">An example scenario for [computer-aided engineering (CAE) on Azure](/azure/architecture/example-scenario/apps/hpc-saas)</span></span>
- <span data-ttu-id="c7c56-209">Домашняя страница [HPC в Azure](https://azure.microsoft.com/en-us/solutions/high-performance-computing/)</span><span class="sxs-lookup"><span data-stu-id="c7c56-209">[HPC on Azure](https://azure.microsoft.com/en-us/solutions/high-performance-computing/) home page</span></span>
- <span data-ttu-id="c7c56-210">Обзор [Большие вычисления: высокая производительность и пакетная служба](https://azure.microsoft.com/en-us/solutions/big-compute/)</span><span class="sxs-lookup"><span data-stu-id="c7c56-210">Overview of [Big Compute: HPC &amp; Microsoft Batch](https://azure.microsoft.com/en-us/solutions/big-compute/)</span></span>