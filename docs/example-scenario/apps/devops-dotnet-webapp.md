---
title: Конвейер CI/CD c VSTS
description: Пример сборки и запуска приложения .NET в веб-приложениях Azure
author: christianreddington
ms.date: 07/11/18
ms.openlocfilehash: aea757087f4a505a8c52658abe1841c5455977cc
ms.sourcegitcommit: c49aeef818d7dfe271bc4128b230cfc676f05230
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/11/2018
ms.locfileid: "44389284"
---
# <a name="cicd-pipeline-with-vsts"></a><span data-ttu-id="4b6b1-103">Конвейер CI/CD c VSTS</span><span class="sxs-lookup"><span data-stu-id="4b6b1-103">CI/CD pipeline with VSTS</span></span>

<span data-ttu-id="4b6b1-104">Технология DevOps предусматривает интеграцию функций разработки, контроля качества и ИТ-операций.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-104">DevOps is the integration of development, quality assurance, and IT operations.</span></span> <span data-ttu-id="4b6b1-105">DevOps требует единой среды и набора параметров для предоставления программного обеспечения.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-105">DevOps requires both unified culture and a strong set of processes for delivering software.</span></span>

<span data-ttu-id="4b6b1-106">В этом примере сценария показано, как команды разработчиков могут использовать Visual Studio Team Services для развертывания двухуровневого веб-приложения .NET в Службе приложений Azure.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-106">This example scenario demonstrates how development teams can use Visual Studio Team Services to deploy a .NET two-tier web application to Azure App Service.</span></span> <span data-ttu-id="4b6b1-107">Такое веб-приложение будет зависеть от подчиненных служб платформы Azure (PaaS).</span><span class="sxs-lookup"><span data-stu-id="4b6b1-107">The Web Application depends on downstream Azure Platform as a Service (PaaS) services.</span></span> <span data-ttu-id="4b6b1-108">В этом документе также указываются важные особенности, которые нужно отметить при разработке такого сценария с помощью платформы как услуги (PaaS) Azure.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-108">This document also points out some considerations that you should make when designing such a scenario using Azure Platform as a Service (PaaS).</span></span>

<span data-ttu-id="4b6b1-109">Внедрение современного подхода к разработке приложений на базе непрерывной интеграции (CI) и непрерывного развертывания (CD) ускоряет создание решений для пользователей благодаря использованию надежной службы, объединяющей функции сборки, тестирования, развертывания и мониторинга.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-109">Adopting a modern approach to application development using Continuous Integration (CI) and Continuous Deployment (CD), helps you to accelerate the delivery of value to your users through a robust build, test, deployment, and monitoring service.</span></span> <span data-ttu-id="4b6b1-110">С помощью платформы, такой как служба Visual Studio Team Services, в дополнение к таким службам Azure, как Служба приложений, организации могут уделить больше внимания разработке сценария, а не управлению инфраструктурой для его реализации.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-110">By using a platform such as Visual Studio Team Services in addition to Azure services such as App Service, organizations can ensure they remain focused on the development of their scenario, rather than the management of the infrastructure to enable it.</span></span>

## <a name="related-use-cases"></a><span data-ttu-id="4b6b1-111">Связанные варианты использования</span><span class="sxs-lookup"><span data-stu-id="4b6b1-111">Related use cases</span></span>

<span data-ttu-id="4b6b1-112">Применяйте DevOps в следующих вариантах использования:</span><span class="sxs-lookup"><span data-stu-id="4b6b1-112">Consider DevOps for the following use cases:</span></span>

* <span data-ttu-id="4b6b1-113">Ускорение разработки приложений и жизненных циклов развертывания.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-113">Speeding up application development and development life cycles</span></span>
* <span data-ttu-id="4b6b1-114">Внедрение механизмов проверки качества и согласованности в автоматизированный процесс сборки и выпуска.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-114">Building quality and consistency into an automated build and release process</span></span>

## <a name="architecture"></a><span data-ttu-id="4b6b1-115">Архитектура</span><span class="sxs-lookup"><span data-stu-id="4b6b1-115">Architecture</span></span>

![Обзор архитектуры компонентов Azure, участвующих в сценарии DevOps, с помощью Visual Studio Team Services и Службы приложений Azure][architecture]

<span data-ttu-id="4b6b1-117">В этом сценарии рассматривается конвейер DevOps для веб-приложения .NET с использованием Visual Studio Team Services (VSTS).</span><span class="sxs-lookup"><span data-stu-id="4b6b1-117">This scenario covers a DevOps pipeline for a .NET web application using Visual Studio Team Services (VSTS).</span></span> <span data-ttu-id="4b6b1-118">Данные передаются в сценарии следующим образом:</span><span class="sxs-lookup"><span data-stu-id="4b6b1-118">The data flows through the scenario as follows:</span></span>

1. <span data-ttu-id="4b6b1-119">Изменение исходного кода приложения.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-119">Change application source code.</span></span>
2. <span data-ttu-id="4b6b1-120">Фиксация кода приложения и файла web.config веб-приложений.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-120">Commit application code and Web Apps web.config file.</span></span>
3. <span data-ttu-id="4b6b1-121">Непрерывная интеграция активирует сборку приложений и модульные тесты.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-121">Continuous integration triggers application build and unit tests.</span></span>
4. <span data-ttu-id="4b6b1-122">Триггер непрерывного развертывания управляет развертыванием артефактов приложения с использованием *параметризованных значений конфигурации для конкретной среды*.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-122">Continuous deployment trigger orchestrates deployment of application artifacts *with environment-specific parameterized configuration values*.</span></span>
5. <span data-ttu-id="4b6b1-123">Развертывание в Службе приложений Azure.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-123">Deployment to Azure App Service.</span></span>
6. <span data-ttu-id="4b6b1-124">Служба Azure Application Insights собирает и анализирует данные о работоспособности, производительности и использовании ресурсов.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-124">Azure Application Insights collects and analyzes health, performance, and usage data.</span></span>
7. <span data-ttu-id="4b6b1-125">Просмотр сведений о работоспособности, производительности и использовании ресурсов.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-125">Review health, performance, and usage information.</span></span>

### <a name="components"></a><span data-ttu-id="4b6b1-126">Компоненты</span><span class="sxs-lookup"><span data-stu-id="4b6b1-126">Components</span></span>

* <span data-ttu-id="4b6b1-127">[Группы ресурсов][resource-groups] — это логические контейнеры для ресурсов Azure, обеспечивающие ограничение управления доступом в плоскости управления. Рассматривайте группу ресурсов как представление единицы развертывания.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-127">[Resource Groups][resource-groups] are a logical container for Azure resources and also provide an access control boundary for the management plane - think of a Resource Group as representing a "unit of deployment".</span></span>
* <span data-ttu-id="4b6b1-128">[Visual Studio Team Services (VSTS)][vsts] — это служба, которая позволяет управлять жизненным циклом разработки от начала и до конца, начиная с планирования и управления проектом до управления кодом, сборки и выпуска.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-128">[Visual Studio Team Services (VSTS)][vsts] is a service that enables you to manage your development life cycle end-to-end; from planning and project management, to code management, through to build and release.</span></span>
* <span data-ttu-id="4b6b1-129">[Веб-приложения Azure][web-apps] — это служба, реализованная по схеме "платформа как услуга" (PaaS) и предназначенная для размещения веб-приложений, REST API и серверной части мобильных решений.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-129">[Azure Web Apps][web-apps] is a Platform as a Service (PaaS) service for hosting web applications, REST APIs, and mobile backends.</span></span> <span data-ttu-id="4b6b1-130">Хотя в этой статье основное внимание уделяется .NET, есть несколько дополнительных поддерживаемых вариантов платформ разработки.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-130">While this article focuses on .NET, there are several additional development platform options supported.</span></span>
* <span data-ttu-id="4b6b1-131">[Application Insights][application-insights] — это расширяемая служба управления производительностью приложений (APM), получающая данные напрямую из источника и предназначенная для веб-разработчиков на нескольких платформах.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-131">[Application Insights][application-insights] is a first-party, extensible Application Performance Management (APM) service for web developers on multiple platforms.</span></span>

### <a name="alternative-devops-tooling-options"></a><span data-ttu-id="4b6b1-132">Альтернативные варианты инструментария DevOps</span><span class="sxs-lookup"><span data-stu-id="4b6b1-132">Alternative DevOps tooling options</span></span>

<span data-ttu-id="4b6b1-133">Хотя эта статья посвящена Visual Studio Team Services, [Team Foundation Server][team-foundation-server] может использоваться в качестве локального средства для замены.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-133">Whilst this article focuses on Visual Studio Team Services, [Team Foundation Server][team-foundation-server] could be used as on premises substitute.</span></span> <span data-ttu-id="4b6b1-134">Кроме того, можно также найти набор технологий, используемый вместе с конвейером разработки с открытым кодом [Jenkins][jenkins-on-azure].</span><span class="sxs-lookup"><span data-stu-id="4b6b1-134">Alternatively, you may also find a collection of technologies being used together for an Open Source development pipeline leveraging [Jenkins][jenkins-on-azure].</span></span>

<span data-ttu-id="4b6b1-135">В контексте инфраструктуры как кода [шаблоны Azure Resource Manager ][arm-templates] являются частью проекта Azure DevOps, но вы также можете использовать [Terraform][terraform] или [Chef][chef], если вы инвестировали в эти решения.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-135">From an Infrastructure as Code perspective, [Azure Resource Manager Templates][arm-templates] are included as part of the Azure DevOps project, but you could consider [Terraform][terraform] or [Chef][chef] if you have investments here.</span></span> <span data-ttu-id="4b6b1-136">Если вы предпочитаете развертывание по схеме "инфраструктура как услуга" (IaaS) и вам требуется управления конфигурацией, можно использовать службу [Настройка состояния службы автоматизации Azure][desired-state-configuration], [Ansible][ansible] или [Chef][chef].</span><span class="sxs-lookup"><span data-stu-id="4b6b1-136">If you prefer an Infrastructure as a Service (IaaS) based deployment and require configuration management, then you could consider either [Azure Automation State Configuration][desired-state-configuration], [Ansible][ansible] or [Chef][chef].</span></span>

### <a name="alternatives-to-web-app-hosting"></a><span data-ttu-id="4b6b1-137">Альтернативы размещению в веб-приложениях</span><span class="sxs-lookup"><span data-stu-id="4b6b1-137">Alternatives to Web App Hosting</span></span>

<span data-ttu-id="4b6b1-138">Альтернативы размещению в веб-приложениях Azure следующие:</span><span class="sxs-lookup"><span data-stu-id="4b6b1-138">Alternatives to hosting in Azure Web Apps:</span></span>

* <span data-ttu-id="4b6b1-139">[Виртуальная машина][compare-vm-hosting] — используется для рабочих нагрузок, требующих высокой степени управляемости или зависимых от компонентов операционной системы или служб, что невозможно реализовать в веб-приложениях Azure (например Windows GAC или COM).</span><span class="sxs-lookup"><span data-stu-id="4b6b1-139">[VM][compare-vm-hosting] - For workloads that require a high degree of control, or depend on OS components / services that are not possible with Web Apps (for example, the Windows GAC, or COM)</span></span>
* <span data-ttu-id="4b6b1-140">[Размещение в контейнере][azure-containers] — если есть зависимости операционной системы и требуется определенный уровень мобильности или плотности при размещении.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-140">[Container Hosting][azure-containers] - Where there are OS dependencies and hosting portability, or hosting density, are also requirements.</span></span>
* <span data-ttu-id="4b6b1-141">[Service Fabric][service-fabric] — это хороший вариант, если архитектура рабочей нагрузки предназначена для распределенных компонентов, которые получают преимущества от развертывания и выполнения в кластере с высокой степенью управления.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-141">[Service Fabric][service-fabric] - A good option if the workload architecture is focused around distributed components that benefit from being deployed and run across a cluster with a high degree of control.</span></span> <span data-ttu-id="4b6b1-142">Service Fabric также может использоваться для размещения контейнеров.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-142">Service Fabric can also be used to host containers.</span></span>
* <span data-ttu-id="4b6b1-143">[Бессерверные функции Azure][azure-functions] — хороший вариант, если архитектура рабочей нагрузки сосредоточена на распределенных компонентах с высокой степенью детализации, требующих минимальных зависимостей, в которых отдельные компоненты должны выполняться только по требованию (не непрерывно), а оркестрация компонентов не требуется.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-143">[Serverless Azure functions][azure-functions] - A good option if the workload architecture is centered around fine grained distributed components, requiring minimal dependencies, where individual components are only required to run on demand (not continuously) and orchestration of components is not required.</span></span>

### <a name="devops"></a><span data-ttu-id="4b6b1-144">DevOps</span><span class="sxs-lookup"><span data-stu-id="4b6b1-144">DevOps</span></span>

<span data-ttu-id="4b6b1-145">**[Непрерывная интеграция (CI)][continuous-integration]** должна быть направлена ​​на демонстрацию стабильной сборки, при которой несколько отдельных разработчиков или команда постоянно совершают небольшие, но частые изменения в общей базе кода.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-145">**[Continuous Integration (CI)][continuous-integration]** should aim to demonstrate a stable build, with more than one individual developer or team continuously committing small, frequent changes to the shared codebase.</span></span>
<span data-ttu-id="4b6b1-146">В рамках конвейера непрерывной интеграции необходимо следующее:</span><span class="sxs-lookup"><span data-stu-id="4b6b1-146">As part of your Continuous Integration pipeline you should;</span></span>

* <span data-ttu-id="4b6b1-147">Регулярно записывать небольшие фрагменты кода после изменения (избегайте пакетной обработки больших и сложных изменений, так как их будет труднее объединить).</span><span class="sxs-lookup"><span data-stu-id="4b6b1-147">Check in small amounts of code frequently (avoid batching up larger or more complex changes as these can be harder to merge successfully)</span></span>
* <span data-ttu-id="4b6b1-148">Выполнить модульный тест компонентов приложения с достаточным объемом протестированного кода (включая пути с недостаточным качеством передачи данных).</span><span class="sxs-lookup"><span data-stu-id="4b6b1-148">Unit Test the components of your application with sufficient code coverage (including the unhappy paths)</span></span>
* <span data-ttu-id="4b6b1-149">Обеспечить выполнение сборки в общей основной (или внешней) ветви.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-149">Ensuring the build is run against the shared, master (or trunk) branch.</span></span> <span data-ttu-id="4b6b1-150">Эта ветвь должна работать стабильно и сохраняться как готовая к развертыванию.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-150">This branch should be stable and maintained as "deployment ready".</span></span> <span data-ttu-id="4b6b1-151">Неполные или выполняемые изменения следует изолировать в отдельной ветви с частыми объединениями прямой интеграции, чтобы избежать конфликтов позже.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-151">Incomplete or work-in-progress changes should be isolated in a separate branch with frequent 'forward integration' merges to avoid conflicts later.</span></span>

<span data-ttu-id="4b6b1-152">**[Непрерывная поставка (CD)][continuous-delivery]** должна демонстрировать не только стабильность сборки, но и стабильность развертывания.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-152">**[Continuous Delivery (CD)][continuous-delivery]** should aim to demonstrate not only a stable build but a stable deployment.</span></span> <span data-ttu-id="4b6b1-153">Это затрудняет реализацию CD, так как требуется конфигурация, предназначенная для конкретной среды, и механизм правильной установки значений.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-153">This makes realizing CD a little more difficult, environment-specific configuration is required and a mechanism for setting those values correctly.</span></span>

<span data-ttu-id="4b6b1-154">Кроме того, нужно провести достаточно тестов интеграции, чтобы обеспечить конфигурацию различных компонентов и их корректное взаимодействие.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-154">In addition, sufficient coverage of Integration Testing is required to ensure that the various components are configured and working correctly end-to-end.</span></span>

<span data-ttu-id="4b6b1-155">Для этого также может потребоваться настройка и сброс данных конкретной среды и управление версиями схемы базы данных.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-155">This may also require setting up and resetting environment-specific data and managing database schema versions.</span></span>

<span data-ttu-id="4b6b1-156">Непрерывная поставка может также расширится в среду нагрузочного тестирования и пользовательского приемочного тестирования.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-156">Continuous Delivery may also extend to Load Testing and User Acceptance Testing Environments.</span></span>

<span data-ttu-id="4b6b1-157">Непрерывная поставка получает преимущество от непрерывного мониторинга, в идеале — во всех средах.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-157">Continuous Delivery benefits from continuous Monitoring, ideally across all environments.</span></span>
<span data-ttu-id="4b6b1-158">Обеспечение согласованности и надежности развертываний и тестирования интеграции в средах упрощается благодаря написанию скриптов для создания и настройки инфраструктуры размещения (что значительно проще для облачных рабочих нагрузок; см. описание инфраструктуры Azure как кода). Это также называется методом [инфраструктура как код][infra-as-code].</span><span class="sxs-lookup"><span data-stu-id="4b6b1-158">The consistency and reliability of deployments and integration testing across environments is made easier by scripting the creation and configuration or the hosting infrastructure (something that is considerably easier for Cloud-based workloads, see Azure infrastructure as code) - this is also known as ["infrastructure-as-code"][infra-as-code].</span></span>

* <span data-ttu-id="4b6b1-159">Начните непрерывную доставку как можно раньше в жизненном цикле проекта.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-159">Start Continuous Delivery as early as possible in the project life-cycle.</span></span> <span data-ttu-id="4b6b1-160">Чем позже вы это сделаете, тем труднее будет.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-160">The later you leave it, the more difficult it will be.</span></span>
* <span data-ttu-id="4b6b1-161">Интеграция и модульные тесты должны иметь такой же приоритет, что функции проекта.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-161">Integration & unit tests should be given the same priority as the project features</span></span>
* <span data-ttu-id="4b6b1-162">Используйте независимые от среды пакеты развертывания и управляйте зависящими от среды конфигурациями в ходе выпуска.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-162">Use environment agnostic deployment packages and manage environment-specific configuration through the release process.</span></span>
* <span data-ttu-id="4b6b1-163">Защищайте конфиденциальные конфигурации в инструментарии управления выпусками или путем вызова HSM или [Key Vault][azure-key-vault] во время процесса выпуска.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-163">Protect sensitive configuration within the release management tooling or by calling out to a Hardware-security-module (HSM), or [Key Vault][azure-key-vault], during the release process.</span></span> <span data-ttu-id="4b6b1-164">Не храните конфиденциальные данные в системе управления версиями.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-164">Do not store sensitive configuration within source control.</span></span>

<span data-ttu-id="4b6b1-165">**Непрерывное обучение**. Самый эффективный мониторинг среды CD обеспечивается средствами наблюдения за производительностью приложений (APM для краткости), например [Application Insights][application-insights] корпорации Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-165">**Continuous Learning** - The most effective monitoring of a CD environment is provided by Application-Performance-Monitoring tools (APM for short), for example Microsoft's [Application Insights][application-insights].</span></span> <span data-ttu-id="4b6b1-166">Достаточная глубина мониторинга рабочей нагрузки приложения имеет решающее значение для понимания ошибок и производительности под нагрузкой.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-166">Sufficient depth of monitoring for an application workload is critical to understand bugs, performance under load.</span></span> <span data-ttu-id="4b6b1-167">[App Insights можно интегрировать с VSTS, чтобы включить непрерывный мониторинг конвейера CD][app-insights-cd-monitoring].</span><span class="sxs-lookup"><span data-stu-id="4b6b1-167">[App Insights can be integrated into VSTS to enable continuous monitoring of the CD pipeline][app-insights-cd-monitoring].</span></span> <span data-ttu-id="4b6b1-168">Это можно использовать для автоматического перехода на следующий этап без вмешательства человека или для отката при обнаружении предупреждения.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-168">This could be used to enable automatic progression to the next stage, without human intervention, or rollback if an alert is detected.</span></span>

## <a name="considerations"></a><span data-ttu-id="4b6b1-169">Рекомендации</span><span class="sxs-lookup"><span data-stu-id="4b6b1-169">Considerations</span></span>

### <a name="availability"></a><span data-ttu-id="4b6b1-170">Доступность</span><span class="sxs-lookup"><span data-stu-id="4b6b1-170">Availability</span></span>

<span data-ttu-id="4b6b1-171">Рассмотрите возможность использования [распространенных конструктивных шаблонов для обеспечения доступности][design-patterns-availability] при создании облачного приложения.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-171">Consider leveraging the [typical design patterns for availability][design-patterns-availability] when building your cloud application.</span></span>

<span data-ttu-id="4b6b1-172">Ознакомьтесь с вопросами доступности в соответствующем [описании эталонной архитектуры для веб-приложения в службе приложений][app-service-reference-architecture].</span><span class="sxs-lookup"><span data-stu-id="4b6b1-172">Review the availability considerations in the appropriate [App Service web application reference architecture][app-service-reference-architecture]</span></span>

<span data-ttu-id="4b6b1-173">Дополнительные сведения по другим вопросам доступности см. в статье [с контрольным списком для обеспечения доступности][availability] в Центре архитектуры Azure.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-173">For other availability topics, see the [availability checklist][availability] in the Azure Architecture Center.</span></span>

### <a name="scalability"></a><span data-ttu-id="4b6b1-174">Масштабируемость</span><span class="sxs-lookup"><span data-stu-id="4b6b1-174">Scalability</span></span>

<span data-ttu-id="4b6b1-175">При создании облачного приложения следует учитывать [распространенные конструктивные шаблоны для обеспечения масштабируемости][design-patterns-scalability].</span><span class="sxs-lookup"><span data-stu-id="4b6b1-175">When building a cloud application be aware of the [typical design patterns for scalability][design-patterns-scalability].</span></span>

<span data-ttu-id="4b6b1-176">Ознакомьтесь с вопросами масштабируемости в соответствующем [описании эталонной архитектуры для веб-приложения в службе приложений][app-service-reference-architecture].</span><span class="sxs-lookup"><span data-stu-id="4b6b1-176">Review the scalability considerations in the appropriate [App Service web application reference architecture][app-service-reference-architecture]</span></span>

<span data-ttu-id="4b6b1-177">Для других вопросов масштабируемости, см. раздел [Контрольный список для обеспечения масштабируемости][scalability] в центре архитектуры Azure.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-177">For other scalability topics, see the [scalability checklist][scalability] in the Azure Architecture Center.</span></span>

### <a name="security"></a><span data-ttu-id="4b6b1-178">Безопасность</span><span class="sxs-lookup"><span data-stu-id="4b6b1-178">Security</span></span>

<span data-ttu-id="4b6b1-179">Рассмотрите использование [распространенных конструктивных шаблонов для обеспечения безопасности][design-patterns-security] там, где уместно.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-179">Consider leveraging the [typical design patterns for security][design-patterns-security] where appropriate.</span></span>

<span data-ttu-id="4b6b1-180">Ознакомьтесь с вопросами безопасности в соответствующем [описании эталонной архитектуры для веб-приложения в службе приложений][app-service-reference-architecture].</span><span class="sxs-lookup"><span data-stu-id="4b6b1-180">Review the security considerations in the appropriate [App Service web application reference architecture][app-service-reference-architecture].</span></span>

<span data-ttu-id="4b6b1-181">Общие рекомендации по разработке безопасных решений см. в разделе [Azure Security Documentation][security].</span><span class="sxs-lookup"><span data-stu-id="4b6b1-181">For general guidance on designing secure solutions, see the [Azure Security Documentation][security].</span></span>

### <a name="resiliency"></a><span data-ttu-id="4b6b1-182">Устойчивость</span><span class="sxs-lookup"><span data-stu-id="4b6b1-182">Resiliency</span></span>

<span data-ttu-id="4b6b1-183">Ознакомьтесь с [распространенными конструктивными шаблонами для обеспечения устойчивости][design-patterns-resiliency] и реализуйте их, если это уместно.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-183">Review the [typical design patterns for resiliency][design-patterns-resiliency] and consider implementing these where appropriate.</span></span>

<span data-ttu-id="4b6b1-184">[Рекомендации по работе со Службой приложений Azure][resiliency-app-service] см. в Центре архитектуры Azure.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-184">You can find a number of [recommended practices for App Service][resiliency-app-service] in the Azure Architecture Center.</span></span>

<span data-ttu-id="4b6b1-185">Общее руководство по проектированию устойчивых решений см. в разделе [Проектирование устойчивых приложений для Azure][resiliency].</span><span class="sxs-lookup"><span data-stu-id="4b6b1-185">For general guidance on designing resilient solutions, see [Designing resilient applications for Azure][resiliency].</span></span>

## <a name="deploy-the-scenario"></a><span data-ttu-id="4b6b1-186">Развертывание сценария</span><span class="sxs-lookup"><span data-stu-id="4b6b1-186">Deploy the scenario</span></span>

### <a name="prerequisites"></a><span data-ttu-id="4b6b1-187">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="4b6b1-187">Prerequisites</span></span>

* <span data-ttu-id="4b6b1-188">Необходимо иметь учетную запись Azure.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-188">You must have an existing Azure account.</span></span> <span data-ttu-id="4b6b1-189">Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись][azure-free-account], прежде чем начинать работу.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-189">If you don't have an Azure subscription, create a [free account][azure-free-account] before you begin.</span></span>
* <span data-ttu-id="4b6b1-190">Необходима учетная запись Visual Studio Team Services (VSTS).</span><span class="sxs-lookup"><span data-stu-id="4b6b1-190">You must have an existing Visual Studio Team Services (VSTS) account.</span></span> <span data-ttu-id="4b6b1-191">Дополнительные сведения о создании учетной записи Visual Studio Team Services (VSTS) см. [в этой статье][vsts-account-create].</span><span class="sxs-lookup"><span data-stu-id="4b6b1-191">Find out more details about [creating a Visual Studio Team Services (VSTS) account][vsts-account-create].</span></span>

### <a name="walk-through"></a><span data-ttu-id="4b6b1-192">Пошаговое руководство</span><span class="sxs-lookup"><span data-stu-id="4b6b1-192">Walk through</span></span>

<span data-ttu-id="4b6b1-193">В этом сценарии для создания конвейера CI/CD используется проект DevOps Azure.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-193">In this scenario, you'll use the Azure DevOps Project to create your CI/CD pipeline.</span></span>

<span data-ttu-id="4b6b1-194">Проект развертывает план Службы приложений Azure, Службу приложений Azure и ресурс App Insights, а также настраивает проект Visual Studio Team Services.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-194">The DevOps project will deploy an App Service Plan, App Service, and an App Insights resource for you, as well as configure the Visual Studio Team Services Project for you.</span></span>

<span data-ttu-id="4b6b1-195">Когда вы развернете проект DevOps и завершите сборку, просмотрите связанные изменения кода, рабочие элементы и результаты тестов.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-195">Once you've deployed the DevOps project and the build is completed, review the associated code changes, work items, and test results.</span></span> <span data-ttu-id="4b6b1-196">Вы заметите, что результаты теста не отображаются, так как в коде нет никаких тестов для выполнения.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-196">You will notice no test results are displayed, as the code does not contain any tests to run.</span></span>

<span data-ttu-id="4b6b1-197">Просмотрите определения выпуска.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-197">Review the Release definitions.</span></span> <span data-ttu-id="4b6b1-198">Обратите внимание, что был настроен конвейер выпуска, который выпустил наше приложение в среду разработки.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-198">Notice that a release pipeline has been setup, releasing our application into Dev.</span></span> <span data-ttu-id="4b6b1-199">Обратите внимание на наличие **триггера непрерывного развертывания**, установленного из артефакта сборки **Drop** с помощью автоматических выпусков в средах разработки.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-199">Observe that there is a **continuous deployment trigger** set from the **Drop** build artifact, with automatic releases into the Dev environments.</span></span> <span data-ttu-id="4b6b1-200">В рамках процесса непрерывного развертывания можно увидеть разброс выпусков в нескольких средах.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-200">As part of a Continuous Deployment process, you may see releases span across multiple environments.</span></span> <span data-ttu-id="4b6b1-201">Выпуск может охватывать обе инфраструктуры (используя такие методы, как инфраструктура как код), а также развертывать необходимые пакеты приложений и все выполняемые после настройки задачи.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-201">A release can span both infrastructure (using techniques such as Infrastructure as Code), and also deploy the application packages required as well as any post-configuration tasks.</span></span>

<span data-ttu-id="4b6b1-202">**Дополнительные замечания**</span><span class="sxs-lookup"><span data-stu-id="4b6b1-202">**Additional Considerations.**</span></span>

* <span data-ttu-id="4b6b1-203">Рассмотрите возможность использования одной из [задач разметки][vsts-tokenization], которые доступны в VSTS marketplace.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-203">Consider leveraging one of the [tokenization tasks][vsts-tokenization] that are available in the VSTS marketplace.</span></span>
* <span data-ttu-id="4b6b1-204">Рассмотрите возможность использования задачи VSTS [Развертывание: Azure Key Vault][download-keyvault-secrets], чтобы скачать секреты из Azure Key Vault в свой выпуск.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-204">Consider using the [Deploy: Azure Key Vault][download-keyvault-secrets] VSTS task to download secrets from an Azure KeyVault into your release.</span></span> <span data-ttu-id="4b6b1-205">Затем эти секреты можно использовать в качестве переменных для своего определения выпуска. Их не следует хранить в системе управления версиями.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-205">You can then use those secrets as variables as part of your release definition, and should not be storing them in source control.</span></span>
* <span data-ttu-id="4b6b1-206">Рассмотрите возможность использования [переменных выпуска][vsts-release-variables] в определениях выпуска для изменения конфигурации среды.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-206">Consider using [release variables][vsts-release-variables] in your release definitions to drive configuration changes of your environments.</span></span> <span data-ttu-id="4b6b1-207">Переменные выпуска могут охватывать как весь выпуск, так и конкретную среду.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-207">Release variables can be scoped to an entire release or a given environment.</span></span> <span data-ttu-id="4b6b1-208">При использовании переменных для секретной информации убедитесь, что выбран значок с изображением замка.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-208">If using variables for secret information, ensure that you select the padlock icon.</span></span>
* <span data-ttu-id="4b6b1-209">Рассмотрите возможность использования [шлюзов развертывания][vsts-deployment-gates] в конвейере выпуска.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-209">Consider using [deployment gates][vsts-deployment-gates] in your release pipeline.</span></span> <span data-ttu-id="4b6b1-210">Это позволяет использовать данные мониторинга во внешних системах (например системах управления инцидентами или дополнительных пользовательских системах), чтобы определить, следует ли повысить уровень выпуска.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-210">This allows you to leverage monitoring data in association with external systems (for example, incident management or additional bespoke systems) to determine whether a release should be promoted.</span></span>
* <span data-ttu-id="4b6b1-211">Когда требуется вмешательство в конвейер выпуска, рассмотрите возможность использования функции [утверждений][vsts-approvals].</span><span class="sxs-lookup"><span data-stu-id="4b6b1-211">Where manual intervention in a release pipeline is required, consider using the [approvals][vsts-approvals] functionality.</span></span>
* <span data-ttu-id="4b6b1-212">При выпуске конвейера рассмотрите возможность использования [Application Insights][application-insights] и дополнительных средств мониторинга как можно раньше.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-212">Consider using [Application Insights][application-insights] and additional monitoring tooling as early as possible in your release pipeline.</span></span> <span data-ttu-id="4b6b1-213">Большинство организаций начинают мониторинг только в своей рабочей среде, хоть выявить возможные ошибки можно на более раннем этапе и предотвратить их воздействие на пользователей рабочей среды.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-213">Most organizations only begin monitoring in their production environment, though you could identify potential bugs earlier in the process and prevent impact to your users in production.</span></span>

## <a name="pricing"></a><span data-ttu-id="4b6b1-214">Цены</span><span class="sxs-lookup"><span data-stu-id="4b6b1-214">Pricing</span></span>

<span data-ttu-id="4b6b1-215">Расчет стоимости Visual Studio Team Services будет зависеть от количества пользователей в организации, которым требуется доступ, в дополнение к таким факторам, как количество параллельных требуемых выпусков и сборок, а также число тестовых пользователей.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-215">Your Visual Studio Team Services costing will depend upon the number of users in your organization that require access, in addition to factors such as the number of concurrent build/releases required, and number of test users.</span></span> <span data-ttu-id="4b6b1-216">Это описано [на странице цен VSTS][vsts-pricing-page].</span><span class="sxs-lookup"><span data-stu-id="4b6b1-216">These are detailed further on the [VSTS pricing page][vsts-pricing-page].</span></span>

* <span data-ttu-id="4b6b1-217">[Visual Studio Team Services (VSTS)][vsts-pricing-calculator] — это служба, позволяющая вам управлять жизненным циклом разработки. Оплата производится ежемесячно для каждого пользователя.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-217">[Visual Studio Team Services (VSTS)][vsts-pricing-calculator] is a service that enables you to manage your development life cycle and is paid for on a per user, per month basis.</span></span> <span data-ttu-id="4b6b1-218">В дополнение к оплате за дополнительных тестовых пользователей или базовые пользовательские лицензии может взиматься плата в зависимости от требуемых параллельных конвейеров.</span><span class="sxs-lookup"><span data-stu-id="4b6b1-218">There may be additional charges dependent upon concurrent pipelines needed, in addition to any additional test users, or user basic licenses.</span></span>

## <a name="related-resources"></a><span data-ttu-id="4b6b1-219">Связанные ресурсы</span><span class="sxs-lookup"><span data-stu-id="4b6b1-219">Related Resources</span></span>

* <span data-ttu-id="4b6b1-220">[What is DevOps?][devops-whatis] (Что такое DevOps?)</span><span class="sxs-lookup"><span data-stu-id="4b6b1-220">[What is DevOps?][devops-whatis]</span></span>
* <span data-ttu-id="4b6b1-221">[DevOps at Microsoft][devops-microsoft] (DevOps в корпорации Майкрософт)</span><span class="sxs-lookup"><span data-stu-id="4b6b1-221">[DevOps at Microsoft - How we work with Visual Studio Team Services][devops-microsoft]</span></span>
* <span data-ttu-id="4b6b1-222">[DevOps with Visual Studio Team Services][devops-with-vsts] (DevOps с использованием Visual Studio Team Services)</span><span class="sxs-lookup"><span data-stu-id="4b6b1-222">[Step-by-step Tutorials: DevOps with Visual Studio Team Services][devops-with-vsts]</span></span>
* <span data-ttu-id="4b6b1-223">[Создание конвейера CI/CD для .NET с помощью проекта Azure DevOps][devops-project-create]</span><span class="sxs-lookup"><span data-stu-id="4b6b1-223">[Create a CI/CD pipeline for .NET with the Azure DevOps project][devops-project-create]</span></span>

<!-- links -->
[ansible]: /azure/ansible/
[application-insights]: /azure/application-insights/app-insights-overview
[app-service-reference-architecture]: /azure/architecture/reference-architectures/app-service-web-app/
[azure-free-account]: https://azure.microsoft.com/free/?WT.mc_id=A261C142F
[arm-templates]: /azure/azure-resource-manager/resource-group-overview#template-deployment
[architecture]: ./media/devops-dotnet-webapp/architecture-devops-dotnet-webapp.png
[availability]: /azure/architecture/checklist/availability
[chef]: /azure/chef/
[design-patterns-availability]: /azure/architecture/patterns/category/availability
[design-patterns-resiliency]: /azure/architecture/patterns/category/resiliency
[design-patterns-scalability]: /azure/architecture/patterns/category/performance-scalability
[design-patterns-security]: /azure/architecture/patterns/category/security
[desired-state-configuration]: /azure/automation/automation-dsc-overview
[devops-microsoft]: /azure/devops/devops-at-microsoft/
[devops-with-vsts]: https://almvm.azurewebsites.net/labs/vsts/
[application-insights]: https://azure.microsoft.com/en-gb/services/application-insights/
[cloud-based-load-testing]: https://visualstudio.microsoft.com/team-services/cloud-load-testing/
[cloud-based-load-testing-on-premises]: /vsts/test/load-test/clt-with-private-machines?view=vsts
[jenkins-on-azure]: /azure/jenkins/
[devops-whatis]: /azure/devops/what-is-devops
[download-keyvault-secrets]: /vsts/pipelines/tasks/deploy/azure-key-vault?view=vsts
[resource-groups]: /azure/azure-resource-manager/resource-group-overview
[resiliency-app-service]: /azure/architecture/checklist/resiliency-per-service#app-service
[resiliency]: /azure/architecture/checklist/resiliency
[scalability]: /azure/architecture/checklist/scalability
[vsts]: /vsts/?view=vsts#pivot=services
[continuous-integration]: /azure/devops/what-is-continuous-integration
[continuous-delivery]: /azure/devops/what-is-continuous-delivery
[web-apps]: /azure/app-service/app-service-web-overview
[terraform]: /azure/terraform/
[vsts-account-create]: /vsts/organizations/accounts/create-account-msa-or-work-student?view=vsts
[vsts-approvals]: /vsts/pipelines/release/approvals/approvals?view=vsts
[devops-project]: https://portal.azure.com/?feature.customportal=false#create/Microsoft.AzureProject
[vsts-deployment-gates]: /vsts/pipelines/release/approvals/gates?view=vsts
[vsts-pricing-calculator]: https://azure.com/e/498aa024454445a8a352e75724f900b1
[vsts-pricing-page]: https://azure.microsoft.com/en-us/pricing/details/visual-studio-team-services/
[vsts-release-variables]: /vsts/pipelines/release/variables?view=vsts&tabs=batch
[vsts-tokenization]: https://marketplace.visualstudio.com/search?term=token&target=VSTS&category=All%20categories&sortBy=Relevance
[azure-key-vault]: /azure/key-vault/key-vault-overview
[infra-as-code]: https://blogs.msdn.microsoft.com/mvpawardprogram/2018/02/13/infrastructure-as-code/
[team-foundation-server]: https://visualstudio.microsoft.com/tfs/
[infra-as-code]: https://blogs.msdn.microsoft.com/mvpawardprogram/2018/02/13/infrastructure-as-code/
[service-fabric]:/azure/service-fabric/
[azure-functions]:/azure/azure-functions/
[azure-containers]:https://azure.microsoft.com/en-us/overview/containers/
[compare-vm-hosting]:/azure/app-service/choose-web-site-cloud-service-vm
[app-insights-cd-monitoring]:/azure/application-insights/app-insights-vsts-continuous-monitoring
[azure-region-pair-bcdr]:/azure/best-practices-availability-paired-regions
[devops-project-create]: /vsts/pipelines/apps/cd/azure/azure-devops-project-aspnetcore?view=vsts
[security]: /azure/security/