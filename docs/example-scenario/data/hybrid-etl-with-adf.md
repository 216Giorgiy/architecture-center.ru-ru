---
title: Гибридное извлечение, преобразование и загрузка данных с помощью существующих локальных служб SSIS и Фабрики данных Azure
titleSuffix: Azure Example Scenarios
description: Гибридное извлечение, преобразование и загрузка данных с помощью существующих локальных служб SQL Server Integration Services (SSIS) и Фабрики данных Azure.
author: alhieng
ms.date: 09/20/2018
ms.topic: example-scenario
ms.service: architecture-center
ms.subservice: example-scenario
ms.custom: tsp-team
social_image_url: /azure/architecture/example-scenario/data/media/architecture-diagram-hybrid-etl-with-adf.png
ms.openlocfilehash: 354b8ee14f82631842902da3de852f777b1954cc
ms.sourcegitcommit: c053e6edb429299a0ad9b327888d596c48859d4a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/20/2019
ms.locfileid: "58248499"
---
# <a name="hybrid-etl-with-existing-on-premises-ssis-and-azure-data-factory"></a>Гибридное извлечение, преобразование и загрузка данных с помощью существующих локальных служб SSIS и Фабрики данных Azure

Организации, которые переносят свои базы данных SQL Server в облако, могут добиться невероятного сокращения расходов, прироста производительности, дополнительной гибкости и масштабируемости. При этом изменение существующих процессов извлечения, преобразования и загрузки данных (ETL), выполняемых с помощью SQL Server Integration Services (SSIS), может сделать миграцию невозможной. В других случаях для загрузки данных требуется сложная логика и (или) специальные средства работы с данными, которые пока не поддерживаются в Фабрике данных Azure версии 2. К часто используемым возможностям служб SSIS относятся преобразования нечетких уточняющих запросов и нечетких группирований, отслеживание измененных данных (CDC), медленно изменяющиеся измерения (SCD) и Data Quality Services (DQS).

Чтобы упростить перенос существующей базы данных SQL по методу lift-and-shift, лучше всего использовать гибридный подход ETL. В этом случае Фабрика данных Azure выступает в роли основного механизма оркестрации, а имеющиеся пакеты SSIS продолжают использоваться для очистки данных и работы с локальными ресурсами. В рамках этого подхода для перемещения в облако существующих баз данных по методу lift-and-shift используется среда выполнения интеграции SQL Server Фабрики данных, задействуя существующий код и пакеты SSIS.

Такой сценарий подходит для организаций, которые перемещают базы данных в облако и планируют использовать Фабрику данных в качестве основного облачного механизма извлечения, преобразования и загрузки, интегрируя при этом существующие пакеты служб SSIS в новый рабочий процесс на основе облачных данных. Многие организации вкладывают значительные средства в разработку пакетов ETL SSIS в соответствии с определенными задачами, и процесс их изменения сопряжен со многими трудностями. Кроме того, многие существующие пакеты кода имеют зависимости локальных ресурсов, что также делает невозможной миграцию в облако.

Фабрика данных позволяет клиентам использовать существующие пакеты извлечения, преобразования и загрузки, минимизируя затраты на их локальную разработку. В этом примере рассматриваются возможные варианты использования существующих пакетов SSIS в рамках нового рабочего процесса на основе облачных данных с помощью Фабрики данных Azure версии 2.

## <a name="potential-use-cases"></a>Потенциальные варианты использования

Многие специалисты по работе с данным, использующие SQL Server, предпочитают выполнять извлечение, преобразование и загрузку данных с помощью SSIS. Иногда для ускорения разработки применяются определенные компоненты SSIS или сторонние подключаемые компоненты. Замена или изменение этих пакетов не поможет решить проблему, так как в итоге перемещение баз данных в облако становится невозможным. Клиентам нужны действенные способы перемещения существующих баз данных в облако и возможность использования существующих пакетов SSIS.

Ниже перечислены несколько возможных вариантов локального использования:

- загрузка журналов маршрутизаторов сети в базу данных для анализа;
- подготовка данных о сотрудниках для аналитических отчетов;
- загрузка данных о товарах и продажах в базу данных хранилища данных для прогнозирования продаж;
- автоматизация загрузки хранилищ операционных данных или баз данных хранилищ данных для финансовой и бухгалтерской отчетности.

## <a name="architecture"></a>Архитектура

![Общие сведения об архитектуре гибридного процесса ETL с помощью Фабрики данных Azure][architecture-diagram]

1. Данные поступают из хранилища BLOB-объектов в Фабрику данных Azure.
2. Конвейер Фабрики данных вызывает хранимую процедуру для выполнения задания SSIS (локальное размещение) в интегрированной среде выполнения.
3. Затем выполняются задания очистки данных, подготавливаемых для дальнейшего использования.
4. После успешного завершения очистки запускается задача копирования данных, которая загружает очищенные данные в Azure.
5. Затем данные загружаются в таблицы Хранилища данных SQL.

### <a name="components"></a>Компоненты

- [Хранилище BLOB-объектов][docs-blob-storage] предназначено для хранения файлов. Это источник данных для Фабрики данных.
- [Службы SQL Server Integration Services][docs-ssis] содержат локальные пакеты ETL, используемые для выполнения рабочих нагрузок для определенных задач.
- [Фабрика данных Azure][docs-data-factory] — это средство облачной оркестрации, которое принимает данные из нескольких источников, а затем объединяет, организует и загружает их в базу данных хранилища данных.
- [Хранилище данных SQL][docs-sql-data-warehouse] централизует данные в облаке, упрощая доступ к ним с использованием стандартных запросов ANSI SQL.

### <a name="alternatives"></a>Альтернативные варианты

Фабрика данных может вызывать процедуры очистки данных, реализованные с помощью других технологий, включая записные книжки Databricks, скрипты Python или экземпляры SSIS, работающие на виртуальных машинах. [Установка платных или лицензионных пользовательских компонентов для среды выполнения интеграции SSIS в Azure](/azure/data-factory/how-to-develop-azure-ssis-ir-licensed-components) может быть реальной альтернативой гибридному подходу.

## <a name="considerations"></a>Рекомендации

Существуют две модели размещения интегрированной среды выполнения (IR) — локально и в Azure. Сначала вам необходимо выбрать один из этих вариантов. Локальная среда IR является более бюджетным вариантом, но ее использование сопряжено с дополнительными затратами на обслуживание и управление. См. дополнительные сведения о [локальной среде IR](/azure/data-factory/concepts-integration-runtime#self-hosted-integration-runtime). См. дополнительные сведения о [выборе среды IR](/azure/data-factory/concepts-integration-runtime#determining-which-ir-to-use).

При использовании среды IR, размещаемой в Azure, необходимо решить, какие ресурсы требуются для обработки данных. В этом случае вы можете выбрать размер виртуальной машины в процессе настройки. См. дополнительные сведения о [выборе размеров виртуальных машин](/azure/cloud-services/cloud-services-sizes-specs#performance-considerations).

Задача упрощается, если у вас уже есть готовые пакеты SSIS с локальными зависимостями, включая источники данных или файлы, которые недоступны из Azure. В этом случае единственный вариант — локальная среда IR. Такой подход обеспечивает наибольшую гибкость при использовании облака в качестве средства оркестрации. При этом вам не нужно изменять существующие пакеты.

В конечном счете ваша задача — переместить обработанные данные в облако для дальнейшей очистки или объединения с другими данными, хранимыми в облаке. В ходе разработки отслеживайте количество действий, используемых в конвейерах Фабрики данных. См. дополнительные сведения о [конвейерах и действиях в фабрике данных Azure](/azure/data-factory/concepts-pipelines-activities).

## <a name="pricing"></a>Цены

Фабрика данных – экономичное решение для оркестрации перемещения данных в облако. Стоимость ее использования зависит от нескольких факторов:

- количество выполнений конвейера;
- количество сущностей или действий в конвейере;
- количество операций мониторинга;
- количество выполнений интеграции (IR, размещаемая в Azure, или локальная среда IR).

Счета выставляются за использование Фабрики данных. Таким образом, плата взимается только во время выполнений конвейера и мониторинга. Выполнение базового конвейера обойдется всего в 50 центов, а мониторинг — в 25 центов. [Калькулятор цен](https://azure.microsoft.com/pricing/calculator/) поможет точно оценить затраты с учетом конкретной рабочей нагрузки.

При выполнении рабочей нагрузки ETL необходимо учитывать стоимость виртуальной машины, используемой для размещения пакетов SSIS. Стоимость зависит от размера виртуальной машины: от D1v2 (1 ядро, 3,5 ГБ ОЗУ, 50 ГБ дискового пространства) до E64V3 (64 ядра, 432 ГБ ОЗУ, 1600 ГБ дискового пространства). См. дополнительные рекомендации по [выбору подходящего размера виртуальной машины](/azure/cloud-services/cloud-services-sizes-specs#performance-considerations).

## <a name="next-steps"></a>Дальнейшие действия

- См. подробное описание [Фабрики данных Azure](https://azure.microsoft.com/services/data-factory/).
- Начните работу с Фабрикой данных Azure с помощью [пошагового руководства](/azure/data-factory/#step-by-step-tutorials).
- [Подготовьте Integration Runtime Azure–SSIS в Фабрике данных Azure](/azure/data-factory/tutorial-deploy-ssis-packages-azure).

<!-- links -->
[architecture-diagram]: ./media/architecture-diagram-hybrid-etl-with-adf.png
[small-pricing]: https://azure.com/e/
[medium-pricing]: https://azure.com/e/
[large-pricing]: https://azure.com/e/
[availability]: /azure/architecture/checklist/availability
[resource-groups]: /azure/azure-resource-manager/resource-group-overview
[resiliency]: /azure/architecture/resiliency/
[security]: /azure/security/
[scalability]: /azure/architecture/checklist/scalability
[docs-blob-storage]: /azure/storage/blobs/
[docs-data-factory]: /azure/data-factory/introduction
[docs-resource-groups]: /azure/azure-resource-manager/resource-group-overview
[docs-ssis]: /sql/integration-services/sql-server-integration-services
[docs-sql-data-warehouse]: /azure/sql-data-warehouse/sql-data-warehouse-overview-what-is
