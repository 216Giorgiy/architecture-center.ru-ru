---
title: Виртуальный собеседник Azure для резервирования отелей
description: Создание чат-ботов для коммерческих приложений с помощью службы Azure Bot.
author: iainfoulds
ms.date: 07/05/2018
ms.openlocfilehash: a922a75d621672fcac95296b1d99112d68c91107
ms.sourcegitcommit: 0a31fad9b68d54e2858314ca5fe6cba6c6b95ae4
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/13/2018
ms.locfileid: "51610776"
---
# <a name="conversational-chatbot-for-hotel-reservations-on-azure"></a>Виртуальный собеседник Azure для резервирования отелей

Этот пример сценария применим к предприятиям, которым нужно интегрировать виртуальный чат-бот в приложение. В этом сценарии чат-бот C#, который позволяет клиентам проверить доступность и зарезервировать жилье через веб-приложение или мобильное приложение, используется для сети отелей.

Варианты использования включают предоставление клиентам возможности просматривать удобства отеля и бронировать номера, просматривать в ресторане меню на вынос и заказывать еду, а также искать и заказывать распечатку фотографий. Чтобы реагировать на такие запросы клиентов, обычно компаниям нужно было нанимать и обучать специалистов службы поддержки, а клиентам приходилось ждать, пока представитель освободится и сможет оказать помощь.

Используя службы Azure, например службу Azure Bot и службы "Распознавание речи" или SAPI, компании могут помогать клиентам и обрабатывать заказы или резервирования с помощью автоматизированных масштабируемых ботов.

## <a name="relevant-use-cases"></a>Варианты соответствующего использования

Другие варианты использования:

* просмотр в ресторане меню на вынос и оформление заказа;
* проверка удобства отеля и бронирование комнаты;
* поиск и печать доступных фотографий.

## <a name="architecture"></a>Архитектура

![Обзор архитектуры компонентов Azure в системе виртуального собеседника][architecture]

Этот сценарий включает виртуального собеседника, который исполняет функции консьержа в отеле. Данные передаются в сценарии следующим образом:

1. Клиент может обращаться с чат-ботом с помощью мобильного телефона или веб-приложения.
2. Пользователь аутентифицируется с помощью Azure Active Directory B2C (бизнес для клиента).
3. Взаимодействуя со службой программ-роботов, пользователь может запросить информацию об удобствах отеля.
4. Cognitive Services обрабатывает запросы естественного языка, чтобы понять о чем говорит клиент.
5. Когда пользователь удовлетворен результатом, приложение-бот обновляет резервирование клиента в базе данных SQL Azure.
6. Служба Application Insights собирает данные телеметрии во время процесса, чтобы дать команде DevOps сведения о производительности бота и его использовании.

### <a name="components"></a>Компоненты

* [Azure Active Directory][aad-docs] — это мультитенантный облачный каталог и служба управления удостоверениями корпорации Майкрософт. Azure AD поддерживает соединитель B2C, позволяющий идентифицировать тех, кто использует внешние идентификаторы, например, Google, Facebook или учетную запись Microsoft.
* [Служба приложений Azure][appservice-docs] позволяет создавать и размещать веб-приложения на любых языках программирования без необходимости управлять инфраструктурой.
* [Служба программ-роботов][botservice-docs] предоставляет средства для создания, тестирования, развертывания и управления интеллектуальными ботами.
* [Cognitive Services][cognitive-docs] позволяют использовать интеллектуальные алгоритмы, чтобы видеть, слышать, говорить, понимать и интерпретировать потребности клиентов с помощью обычных средств связи.
* [База данных SQL][sqldatabase-docs] — это полностью управляемая облачная реляционная база данных, которая обеспечивает совместимость с ядром SQL Server.
* [Application Insights][appinsights-docs] — это расширяемая служба управления производительностью приложений (APM), которая позволяет контролировать производительность приложений, таких как чат-бот.

### <a name="alternatives"></a>Альтернативные варианты

* [API распознавания речи Microsoft][speech-api] может использоваться для изменения взаимодействия клиентов с ботом.
* [QnA Maker][qna-maker] можно использовать для быстрого добавления бота набора знаний из полуструктурированного содержимого, например, раздела "Вопросы и ответы".
* [Перевод текстов][translator] — это служба, которая может легко добавить для бота многоязычную поддержку.

## <a name="considerations"></a>Рекомендации

### <a name="availability"></a>Доступность

Этот сценарий использует Базу данных SQL Azure для хранения данных о резервировании клиента. База данных SQL включает базу данных избыточную в пределах зоны, группы отработки отказа и георепликацию. Дополнительные сведения см. в статье [Azure SQL Database availability capabilities][sqlavailability-docs] (Возможности доступности базы данных Azure SQL).

Дополнительные сведения по другим вопросам доступности см. в статье [с контрольным списком для обеспечения доступности][availability] в Центре архитектуры Azure.

### <a name="scalability"></a>Масштабируемость

Этот сценарий использует Службу приложений Azure. С помощью службы приложений можно автоматически масштабировать количество экземпляров, которые запускает бот. Эта функциональность позволяет не отставать от потребительского спроса на веб-приложение и чат-бот. См. дополнительные сведения об [автоматическом масштабирование][autoscaling] в центре архитектуры Azure.

Для других вопросов масштабируемости, см. раздел [Контрольный список для обеспечения масштабируемости][scalability] в центре архитектуры Azure.

### <a name="security"></a>Безопасность

Для проверки подлинности пользователей в этом сценарии используется Azure Active Directory B2C (бизнес для клиента). С помощью AAD B2C чат-бот не будет хранить конфиденциальной информации учетной записи или учетных данных. Дополнительные сведения см. в статье [Azure Active Directory B2C: регистрация и вход пользователей в приложения][aadb2c-docs].

Информация, хранящаяся в Azure SQL Database, шифруются при хранении с помощью прозрачного шифрования данных (TDE). База данных SQL также предлагает функцию Always Encrypted, которая шифрует данные при выполнении и обработке запросов. Дополнительные сведения о безопасности базы данных SQL, см. в разделе [What is the Azure SQL Database service? Availability capabilities][sqlsecurity-docs] (Обзор службы базы данных SQL Azure. Возможности доступности).

Общие рекомендации по разработке безопасных решений см. в разделе [Azure Security Documentation][security].

### <a name="resiliency"></a>Устойчивость

Этот сценарий использует Базу данных SQL Azure для хранения данных о резервировании клиента. База данных SQL включает базу данных избыточную в пределах зоны, группы отработки отказа, георепликацию и автоматические резервные копии. Эти функции позволяют приложению продолжать работу, когда происходят события обслуживания или отключения. Дополнительные сведения см. в статье [Azure SQL Database availability capabilities][sqlavailability-docs] (Возможности доступности базы данных Azure SQL).

Для мониторинга работоспособности приложения этот сценарий использует Application Insights. С помощью Application Insights можно создавать оповещения и реагировать на проблемы с производительностью, которые будут влиять на качество обслуживания и доступность чат-бота. Для дополнительных сведений см. [Что такое Application Insights?][appinsights-docs]

Общее руководство по проектированию устойчивых решений см. в разделе [Проектирование устойчивых приложений для Azure][resiliency].

## <a name="deploy-the-scenario"></a>Развертывание сценария

Этот сценарий состоит из трех компонентов для изучения областей, на которых вы сосредоточены больше всего.

* [Компоненты инфраструктуры](#deploy-infrastructure-components). Используйте шаблон Azure Resource Manager для развертывания основных компонентов инфраструктуры службы приложений, веб-приложений, Application Insights, учетной записи хранения, SQL Server и базы данных.
* [Чат-бот веб-приложения](#deploy-web-app-chatbot). Используйте Azure CLI для развертывания бота с помощью службы Azure Bot и приложения Интеллектуальной службы распознавания речи (LUIS).
* [Пример приложения чат-бота C#](#deploy-chatbot-c-application-code). Используйте Visual Studio, чтобы просмотреть образец кода C# бронирование отеля, и разверните бот в Azure.

**Предварительные требования** Необходимо иметь учетную запись Azure. Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись Azure](https://azure.microsoft.com/free/?WT.mc_id=A261C142F), прежде чем начинать работу.

### <a name="deploy-infrastructure-components"></a>Развертывание компонентов инфраструктуры

Чтобы развернуть компоненты инфраструктуры с помощью шаблона Resource Manager, выполните следующие действия.

1. Нажмите кнопку **Развертывание в Azure**.<br><a href="https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmspnp%2Fsolution-architectures%2Fmaster%2Fapps%2Fcommerce-chatbot.json" target="_blank"><img src="https://azuredeploy.net/deploybutton.png"/></a>
2. Подождите, пока откроется развертывание шаблона на портале Azure, а затем выполните следующие шаги.
   * Выберите **Создать** группу ресурсов, а затем укажите в текстовом поле имя, например *myCommerceChatBotInfrastructure*.
   * В раскрывающемся списке **Расположение** выберите регион.
   * Укажите имя пользователя и надежный пароль для учетной записи администратора SQL Server.
   * Прочтите условия использования и установите флажок **Я принимаю указанные выше условия**.
   * Нажмите кнопку **Приобрести**.

Подождите несколько минут до завершения развертывания.

### <a name="deploy-web-app-chatbot"></a>Развертывание чат-бота веб-приложения

Чтобы создать чат-бот, используйте Azure CLI. В следующем примере показано установку расширения CLI для службы программ-роботов, создание группы ресурсов, а затем развертывание бота, который использует Application Insights. При поступлении соответствующего запроса системы, подтвердите подлинность своей учетной записи Microsoft и разрешите боту зарегистрировать себя в службе Azure Bot и приложении Интеллектуальной службы распознавания речи (LUIS).

```azurecli-interactive
# Install the Azure CLI extension for the Bot Service
az extension add --name botservice --yes

# Create a resource group
az group create --name myCommerceChatbot --location eastus

# Create a Web App Chatbot that uses Application Insights
az bot create \
    --resource-group myCommerceChatbot \
    --name commerceChatbot \
    --location eastus \
    --kind webapp \
    --sku S1 \
    --insights eastus
```

### <a name="deploy-chatbot-c-application-code"></a>Развертывание кода приложения C# чат-бота

Пример приложения C# доступен в GitHub. 

* [Пример коммерческого бота C#](https://github.com/Microsoft/AzureBotServices-scenarios/tree/master/CSharp/Commerce/src)

Пример приложения включает в себя компоненты аутентификации Azure Active Directory и интеграцию с Интеллектуальной службой распознавания речи (LUIS), компонентом Cognitive Services. Приложению требуется Visual Studio для создания и развертывания сценария. Дополнительные сведения о настройке AAD B2C и приложения LUIS можно найти в документации репозитория GitHub.

## <a name="pricing"></a>Цены

Чтобы изучить стоимость выполнения этого сценария, все услуги были предварительно сконфигурированы в калькуляторе стоимости. Чтобы узнать, как изменится цена для вашего конкретного варианта использования, измените соответствующие переменные в соответствии с ожидаемым трафиком.

Доступны три примера профилей затрат на основе количества сообщений, которое должен обрабатывать чат-бот:

* [Небольшой][small-pricing]: этот пример тарификации предполагает обработку до 10 000 сообщений в месяц.
* [Средний][medium-pricing]: этот пример тарификации предполагает обработку до 500 000 сообщений в месяц.
* [Большой][large-pricing]: этот пример тарификации предполагает обработку до 10 млн сообщений в месяц.

## <a name="related-resources"></a>Связанные ресурсы

Для получения набора руководств по использованию службы Azure Bot, см. [этот раздел][botservice-docs] документации.


<!-- links -->
[aadb2c-docs]: /azure/active-directory-b2c/active-directory-b2c-overview
[aad-docs]: /azure/active-directory/
[appinsights-docs]: /azure/application-insights/app-insights-overview
[appservice-docs]: /azure/app-service/
[architecture]: ./media/architecture-commerce-chatbot.png
[autoscaling]: ../../best-practices/auto-scaling.md
[availability]: ../../checklist/availability.md
[botservice-docs]: /azure/bot-service/
[cognitive-docs]: /azure/cognitive-services/
[resiliency]: ../../resiliency/index.md
[resource-groups]: /azure/azure-resource-manager/resource-group-overview
[security]: /azure/security/
[scalability]: ../../checklist/scalability.md
[sqlavailability-docs]: /azure/sql-database/sql-database-technical-overview#availability-capabilities
[sqldatabase-docs]: /azure/sql-database/
[sqlsecurity-docs]: /azure/sql-database/sql-database-technical-overview#advanced-security-and-compliance
[qna-maker]: /azure/cognitive-services/QnAMaker/Overview/overview
[speech-api]: /azure/cognitive-services/speech/home
[translator]: /azure/cognitive-services/translator/translator-info-overview

[small-pricing]: https://azure.com/e/dce05b6184904c50b38e1a8654f726b6
[medium-pricing]: https://azure.com/e/304d17106afc480dbc414f9726078a03
[large-pricing]: https://azure.com/e/8319dd5e5e3d4f118f9029e32a80e887