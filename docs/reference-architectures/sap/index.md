---
title: Развертывание SAP NetWeaver и SAP HANA в Azure
description: Методики по запуску SAP HANA в среде с высоким уровнем доступности в Azure.
author: njray
ms.date: 06/29/2017
ms.openlocfilehash: 33171164c59a520a87ef3209c5bb1b208377221c
ms.sourcegitcommit: c441fd165e6bebbbbbc19854ec6f3676be9c3b25
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/30/2018
---
# <a name="deploy-sap-netweaver-and-sap-hana-on-azure"></a><span data-ttu-id="f2d62-103">Развертывание SAP NetWeaver и SAP HANA в Azure</span><span class="sxs-lookup"><span data-stu-id="f2d62-103">Deploy SAP NetWeaver and SAP HANA on Azure</span></span>

<span data-ttu-id="f2d62-104">В этой эталонной архитектуре показан набор методик по запуску SAP HANA в среде с высоким уровнем доступности в Azure.</span><span class="sxs-lookup"><span data-stu-id="f2d62-104">This reference architecture shows a set of proven practices for running SAP HANA in a high availability environment on Azure.</span></span> [<span data-ttu-id="f2d62-105">**Разверните это решение**.</span><span class="sxs-lookup"><span data-stu-id="f2d62-105">**Deploy this solution**.</span></span>](#deploy-the-solution)

<span data-ttu-id="f2d62-106">![0][0]</span><span class="sxs-lookup"><span data-stu-id="f2d62-106">![0][0]</span></span>

<span data-ttu-id="f2d62-107">*Скачайте [файл Visio][visio-download] этой архитектуры.*</span><span class="sxs-lookup"><span data-stu-id="f2d62-107">*Download a [Visio file][visio-download] of this architecture.*</span></span>

> [!NOTE]
> <span data-ttu-id="f2d62-108">Для развертывания этой эталонной архитектуры требуется соответствующее лицензирование продуктов SAP и другие технологии сторонних производителей.</span><span class="sxs-lookup"><span data-stu-id="f2d62-108">Deploying this reference architecture requires appropriate licensing of SAP products and other non-Microsoft technologies.</span></span> <span data-ttu-id="f2d62-109">Сведения о партнерстве между корпорацией Майкрософт и SAP см. в статье о [SAP HANA в Azure][sap-hana-on-azure].</span><span class="sxs-lookup"><span data-stu-id="f2d62-109">For information about the partnership between Microsoft and SAP, see [SAP HANA on Azure][sap-hana-on-azure].</span></span>

## <a name="architecture"></a><span data-ttu-id="f2d62-110">Архитектура</span><span class="sxs-lookup"><span data-stu-id="f2d62-110">Architecture</span></span>

<span data-ttu-id="f2d62-111">Архитектура состоит из следующих компонентов:</span><span class="sxs-lookup"><span data-stu-id="f2d62-111">The architecture consists of the following components.</span></span>

- <span data-ttu-id="f2d62-112">**Виртуальная сеть**.</span><span class="sxs-lookup"><span data-stu-id="f2d62-112">**Virtual network (VNet)**.</span></span> <span data-ttu-id="f2d62-113">Виртуальная сеть — это представление логически изолированной сети в Azure.</span><span class="sxs-lookup"><span data-stu-id="f2d62-113">A VNet is a representation of a logically isolated network in Azure.</span></span> <span data-ttu-id="f2d62-114">Все виртуальные машины в этой эталонной архитектуре развертываются в ту же виртуальную сеть.</span><span class="sxs-lookup"><span data-stu-id="f2d62-114">All of the VMs in this reference architecture are deployed to the same VNet.</span></span> <span data-ttu-id="f2d62-115">Затем виртуальная сеть подразделяется на подсети.</span><span class="sxs-lookup"><span data-stu-id="f2d62-115">The VNet is further subdivided into subnets.</span></span> <span data-ttu-id="f2d62-116">Создайте отдельную подсеть для каждого уровня, включая приложение (SAP NetWeaver), базу данных (SAP HANA), среду управления (jumpbox) и Active Directory.</span><span class="sxs-lookup"><span data-stu-id="f2d62-116">Create a separate subnet for each tier, including application (SAP NetWeaver), database (SAP HANA), management (the jumpbox), and Active Directory.</span></span>

- <span data-ttu-id="f2d62-117">**Виртуальные машины**.</span><span class="sxs-lookup"><span data-stu-id="f2d62-117">**Virtual machines (VMs)**.</span></span> <span data-ttu-id="f2d62-118">Виртуальные машины для этой архитектуры группируются в несколько различных уровней.</span><span class="sxs-lookup"><span data-stu-id="f2d62-118">The VMs for this architecture are grouped into several distinct tiers.</span></span>

    - <span data-ttu-id="f2d62-119">**SAP NetWeaver**.</span><span class="sxs-lookup"><span data-stu-id="f2d62-119">**SAP NetWeaver**.</span></span> <span data-ttu-id="f2d62-120">Включает SAP ASCS, веб-диспетчер SAP и серверы приложений SAP.</span><span class="sxs-lookup"><span data-stu-id="f2d62-120">Includes SAP ASCS, SAP Web Dispatcher, and the SAP application servers.</span></span> 
    
    - <span data-ttu-id="f2d62-121">**SAP HANA**.</span><span class="sxs-lookup"><span data-stu-id="f2d62-121">**SAP HANA**.</span></span> <span data-ttu-id="f2d62-122">Эталонная архитектура использует SAP HANA на уровне базы данных, работающем на одном экземпляре [GS5][vm-sizes-mem].</span><span class="sxs-lookup"><span data-stu-id="f2d62-122">This reference architecture uses SAP HANA for the database tier, running on a single [GS5][vm-sizes-mem] instance.</span></span> <span data-ttu-id="f2d62-123">SAP HANA сертифицирована для рабочих нагрузок OLAP на ВМ GS5 или в решении [Крупные экземпляры SAP HANA в Azure][azure-large-instances].</span><span class="sxs-lookup"><span data-stu-id="f2d62-123">SAP HANA is certified for production OLAP workloads on GS5 or [SAP HANA on Azure Large Instances][azure-large-instances].</span></span> <span data-ttu-id="f2d62-124">Эта эталонная архитектура предназначена для виртуальных машин Azure серии G и M.</span><span class="sxs-lookup"><span data-stu-id="f2d62-124">This reference architecture is for Azure virtual machines in the G-series and M-series.</span></span> <span data-ttu-id="f2d62-125">Дополнительные сведения о SAP HANA в крупных экземплярах Azure см. в статье [Обзор и описание архитектуры SAP HANA в Azure (крупные экземпляры)][azure-large-instances].</span><span class="sxs-lookup"><span data-stu-id="f2d62-125">For information about SAP HANA on Azure Large Instances, see [SAP HANA (large instances) overview and architecture on Azure][azure-large-instances].</span></span>
   
    - <span data-ttu-id="f2d62-126">**Jumpbox**.</span><span class="sxs-lookup"><span data-stu-id="f2d62-126">**Jumpbox**.</span></span> <span data-ttu-id="f2d62-127">Он также называется узлом-бастионом.</span><span class="sxs-lookup"><span data-stu-id="f2d62-127">Also called a bastion host.</span></span> <span data-ttu-id="f2d62-128">Это безопасная виртуальная машина в сети, которую администраторы используют для подключения к другим виртуальным машинам.</span><span class="sxs-lookup"><span data-stu-id="f2d62-128">This is a secure VM on the network that administrators use to connect to the other VMs.</span></span> 
     
    - <span data-ttu-id="f2d62-129">**Контроллеры домена Windows Server Active Directory (AD)**.</span><span class="sxs-lookup"><span data-stu-id="f2d62-129">**Windows Server Active Directory (AD) domain controllers.**</span></span> <span data-ttu-id="f2d62-130">Контроллеры домена используются для настройки отказоустойчивого кластера Windows Server (см. ниже).</span><span class="sxs-lookup"><span data-stu-id="f2d62-130">The domain controllers are used to configure the Windows Server Failover Cluster (see below).</span></span>
 
- <span data-ttu-id="f2d62-131">**Группы доступности**.</span><span class="sxs-lookup"><span data-stu-id="f2d62-131">**Availability sets**.</span></span> <span data-ttu-id="f2d62-132">Разместите виртуальные машины для ролей веб-диспетчера SAP, сервера приложения SAP и SAP ACSC в отдельные группы доступности, а также подготовьте по крайней мере две виртуальные машины для каждой роли.</span><span class="sxs-lookup"><span data-stu-id="f2d62-132">Place the VMs for the SAP Web Dispatcher, SAP application server, and SAP ACSC roles into separate availability sets, and provision at least two VMs for each role.</span></span> <span data-ttu-id="f2d62-133">Таким образом виртуальные машины станут подходящими для соглашения об уровне обслуживания (SLA) более высокого уровня.</span><span class="sxs-lookup"><span data-stu-id="f2d62-133">This makes the VMs eligible for a higher service level agreement (SLA).</span></span>
    
- <span data-ttu-id="f2d62-134">**Сетевые адаптеры**.</span><span class="sxs-lookup"><span data-stu-id="f2d62-134">**NICs.**</span></span> <span data-ttu-id="f2d62-135">Виртуальным машинам под управлением SAP NetWeaver и SAP HANA нужно два сетевых адаптера (NIC).</span><span class="sxs-lookup"><span data-stu-id="f2d62-135">The VMs that run SAP NetWeaver and SAP HANA require two network interfaces (NICs).</span></span> <span data-ttu-id="f2d62-136">Каждый сетевой адаптер присваивается другой подсети для разделения различных типов трафика.</span><span class="sxs-lookup"><span data-stu-id="f2d62-136">Each NIC is assigned to a different subnet, to segregate different types of traffic.</span></span> <span data-ttu-id="f2d62-137">Дополнительные сведения см. в [разделе рекомендаций](#recommendations).</span><span class="sxs-lookup"><span data-stu-id="f2d62-137">See [Recommendations](#recommendations) below for more information.</span></span>

- <span data-ttu-id="f2d62-138">**Отказоустойчивый кластер Windows Server**.</span><span class="sxs-lookup"><span data-stu-id="f2d62-138">**Windows Server Failover Cluster**.</span></span> <span data-ttu-id="f2d62-139">Виртуальные машины, выполняющие SAP ACSC, настроены в качестве отказоустойчивого кластера для обеспечения высокого уровня доступности.</span><span class="sxs-lookup"><span data-stu-id="f2d62-139">The VMs that run SAP ACSC are configured as a failover cluster for high availability.</span></span> <span data-ttu-id="f2d62-140">Чтобы поддержать отказоустойчивый кластер, SIOS DataKeeper Cluster Edition выполняет функции общего тома кластера (CSV), реплицируя независимые диски, принадлежащие узлам кластера.</span><span class="sxs-lookup"><span data-stu-id="f2d62-140">To support the failover cluster, SIOS DataKeeper Cluster Edition performs the cluster shared volume (CSV) function by replicating independent disks owned by the cluster nodes.</span></span> <span data-ttu-id="f2d62-141">Дополнительные сведения см. в записи блога о [запуске приложений SAP на платформе Майкрософт][running-sap].</span><span class="sxs-lookup"><span data-stu-id="f2d62-141">For details, see [Running SAP applications on the Microsoft platform][running-sap].</span></span>
    
- <span data-ttu-id="f2d62-142">**Подсистемы балансировки нагрузки.**</span><span class="sxs-lookup"><span data-stu-id="f2d62-142">**Load balancers.**</span></span> <span data-ttu-id="f2d62-143">Используется два экземпляра [Azure Load Balancer][azure-lb].</span><span class="sxs-lookup"><span data-stu-id="f2d62-143">Two [Azure Load Balancer][azure-lb] instances are used.</span></span> <span data-ttu-id="f2d62-144">Первый, который показан слева на схеме, распределяет трафик в виртуальные машины веб-диспетчера SAP.</span><span class="sxs-lookup"><span data-stu-id="f2d62-144">The first, shown on the left of the diagram, distributes traffic to the SAP Web Dispatcher VMs.</span></span> <span data-ttu-id="f2d62-145">Эта конфигурация реализует вариант параллельных веб-диспетчеров, описанный в статье [High Availability of the SAP Web Dispatcher][sap-dispatcher-ha] (Высокий уровень доступности веб-диспетчера SAP).</span><span class="sxs-lookup"><span data-stu-id="f2d62-145">This configuration implements the parallel web dispatcher option described in [High Availability of the SAP Web Dispatcher][sap-dispatcher-ha].</span></span> <span data-ttu-id="f2d62-146">Вторая подсистема балансировки нагрузки, показанная справа, включает отработку отказа на отказоустойчивом кластере Windows Server путем направления входящих подключений на работоспособный или активный узел.</span><span class="sxs-lookup"><span data-stu-id="f2d62-146">The second load balancer, shown on the right, enables failover in the Windows Server Failover Cluster, by directing incoming connections to the active/healthy node.</span></span>

- <span data-ttu-id="f2d62-147">**VPN-шлюз.**</span><span class="sxs-lookup"><span data-stu-id="f2d62-147">**VPN Gateway.**</span></span> <span data-ttu-id="f2d62-148">VPN-шлюз расширяет локальную сеть до виртуальной сети Azure.</span><span class="sxs-lookup"><span data-stu-id="f2d62-148">The VPN Gateway extends your on-premises network to the Azure VNet.</span></span> <span data-ttu-id="f2d62-149">Можно также использовать канал ExpressRoute, применяющий закрытое выделенное подключение, которое не проходит через общедоступный Интернет.</span><span class="sxs-lookup"><span data-stu-id="f2d62-149">You can also use ExpressRoute, which uses a dedicated private connection that does not go over the public Internet.</span></span> <span data-ttu-id="f2d62-150">Пример решения не развертывает шлюз.</span><span class="sxs-lookup"><span data-stu-id="f2d62-150">The example solution does not deploy the gateway.</span></span> <span data-ttu-id="f2d62-151">Дополнительные сведения см. в статье [Connect an on-premises network to Azure][hybrid-networking] (Подключение локальной сети к Azure).</span><span class="sxs-lookup"><span data-stu-id="f2d62-151">For more information, see [Connect an on-premises network to Azure][hybrid-networking].</span></span>

## <a name="recommendations"></a><span data-ttu-id="f2d62-152">Рекомендации</span><span class="sxs-lookup"><span data-stu-id="f2d62-152">Recommendations</span></span>

<span data-ttu-id="f2d62-153">Описанная здесь архитектура может не соответствовать вашим требованиям.</span><span class="sxs-lookup"><span data-stu-id="f2d62-153">Your requirements might differ from the architecture described here.</span></span> <span data-ttu-id="f2d62-154">Воспользуйтесь этими рекомендациями в качестве отправной точки.</span><span class="sxs-lookup"><span data-stu-id="f2d62-154">Use these recommendations as a starting point.</span></span>

### <a name="load-balancers"></a><span data-ttu-id="f2d62-155">Балансировщики нагрузки</span><span class="sxs-lookup"><span data-stu-id="f2d62-155">Load balancers</span></span>

<span data-ttu-id="f2d62-156">[Веб-диспетчер SAP][sap-dispatcher] обрабатывает балансировку нагрузки трафика HTTP(S) к серверам с двумя стеками (ABAP и Java).</span><span class="sxs-lookup"><span data-stu-id="f2d62-156">[SAP Web Dispatcher][sap-dispatcher] handles load balancing of HTTP(S) traffic to dual-stack servers (ABAP and Java).</span></span> <span data-ttu-id="f2d62-157">SAP много лет поддерживает серверы приложений с одним стеком, поэтому в настоящее время в модели развертывания с двумя стеками выполняется очень мало приложений.</span><span class="sxs-lookup"><span data-stu-id="f2d62-157">SAP has advocated single-stack application servers for years, so very few applications run on a dual-stack deployment model nowadays.</span></span> <span data-ttu-id="f2d62-158">Подсистема балансировки нагрузки Azure, показанная на схеме архитектуры, реализует кластер с высоким уровнем доступности для веб-диспетчера SAP.</span><span class="sxs-lookup"><span data-stu-id="f2d62-158">The Azure load balancer shown in the architecture diagram implements the high availability cluster for the SAP Web Dispatcher.</span></span>

<span data-ttu-id="f2d62-159">Балансировка нагрузки трафика на серверы приложений осуществляется в SAP.</span><span class="sxs-lookup"><span data-stu-id="f2d62-159">Load balancing of traffic to the application servers is handled within SAP.</span></span> <span data-ttu-id="f2d62-160">Для трафика от клиентов SAPGUI, подключающихся к серверу SAP через DIAG и удаленные вызовы функций (RFC), сервер сообщений SCS балансирует нагрузку путем создания [групп входа][logon-groups] сервера приложений SAP.</span><span class="sxs-lookup"><span data-stu-id="f2d62-160">For traffic from SAPGUI clients connecting to a SAP server via DIAG and Remote Function Calls (RFC), the SCS message server balances the load by creating SAP App Server [Logon Groups][logon-groups].</span></span> 

<span data-ttu-id="f2d62-161">SMLG — это транзакция SAP ABAP, используемая для управления возможностями балансировки нагрузки входа в систему центральных служб SAP.</span><span class="sxs-lookup"><span data-stu-id="f2d62-161">SMLG is an SAP ABAP transaction used to manage the logon load balancing capability of SAP Central Services.</span></span> <span data-ttu-id="f2d62-162">Внутренний пул группы входа имеет более одного сервера приложений ABAP.</span><span class="sxs-lookup"><span data-stu-id="f2d62-162">The backend pool of the logon group has more than one ABAP application server.</span></span> <span data-ttu-id="f2d62-163">Клиенты, получающие доступ к службам кластера ASCS, подключатся к балансировщику нагрузки Azure через интерфейсный IP-адрес.</span><span class="sxs-lookup"><span data-stu-id="f2d62-163">Clients accessing ASCS cluster services connect to the Azure load balancer through a frontend IP address.</span></span> <span data-ttu-id="f2d62-164">Имя виртуальной сети кластера ASCS также включает IP-адрес.</span><span class="sxs-lookup"><span data-stu-id="f2d62-164">The ASCS cluster virtual network name also has an IP address.</span></span> <span data-ttu-id="f2d62-165">При необходимости этот адрес можно связать с дополнительным IP-адресом в балансировщике нагрузки Azure, чтобы кластером можно было управлять удаленно.</span><span class="sxs-lookup"><span data-stu-id="f2d62-165">Optionally, this address can be associated with an additional IP address on the Azure load balancer, so that the cluster can be managed remotely.</span></span>  

### <a name="nics"></a><span data-ttu-id="f2d62-166">сетевые карты;</span><span class="sxs-lookup"><span data-stu-id="f2d62-166">NICs</span></span>

<span data-ttu-id="f2d62-167">Функции управления ландшафтом SAP требуют разделения трафика сервера на разные сетевые адаптеры.</span><span class="sxs-lookup"><span data-stu-id="f2d62-167">SAP landscape management functions require segregation of server traffic on different NICs.</span></span> <span data-ttu-id="f2d62-168">Например, бизнес-данные должны быть отделены от административного трафика и трафика резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="f2d62-168">For example, business data should be separated from administrative traffic and backup traffic.</span></span> <span data-ttu-id="f2d62-169">Назначение нескольких сетевых адаптеров в разные подсети обеспечивает это разделение данных.</span><span class="sxs-lookup"><span data-stu-id="f2d62-169">Assigning multiple NICs to different subnets enables this data segregation.</span></span> <span data-ttu-id="f2d62-170">Дополнительные сведения см. в разделе о сети технического руководства в формате PDF [Building High Availability for SAP NetWeaver and SAP HANA on Linux][sap-ha] (Обеспечение высокого уровня доступности для SAP NetWeaver и SAP HANA в Linux).</span><span class="sxs-lookup"><span data-stu-id="f2d62-170">For more information, see "Network" in [Building High Availability for SAP NetWeaver and SAP HANA][sap-ha] (PDF).</span></span>

<span data-ttu-id="f2d62-171">Присвойте сетевой адаптер администрирования подсети управления, а сетевой адаптер обмена данными отдельной подсети.</span><span class="sxs-lookup"><span data-stu-id="f2d62-171">Assign the administration NIC to the management subnet, and assign the data communication NIC to a separate subnet.</span></span> <span data-ttu-id="f2d62-172">Дополнительные сведения о конфигурации см. в статье [Создание виртуальной машины Windows, использующей несколько сетевых адаптеров, и управление ею][multiple-vm-nics].</span><span class="sxs-lookup"><span data-stu-id="f2d62-172">For configuration details, see [Create and manage a Windows virtual machine that has multiple NICs][multiple-vm-nics].</span></span>

### <a name="azure-storage"></a><span data-ttu-id="f2d62-173">Хранилище Azure</span><span class="sxs-lookup"><span data-stu-id="f2d62-173">Azure Storage</span></span>

<span data-ttu-id="f2d62-174">С виртуальными машинами сервера базы данных рекомендуется использовать хранилище Azure класса Premium для согласованных задержек чтения и записи.</span><span class="sxs-lookup"><span data-stu-id="f2d62-174">With all database server VMs, we recommend using Azure Premium Storage for consistent read/write latency.</span></span> <span data-ttu-id="f2d62-175">Для серверов приложений SAP, включая виртуальные машины (A)SCS, можно использовать службу хранилища Azure класса Standard, так как выполнение приложений происходит в памяти и диски используются только для ведения журнала.</span><span class="sxs-lookup"><span data-stu-id="f2d62-175">For SAP application servers, including the (A)SCS virtual machines, you can use Azure Standard Storage, because application execution takes place in memory and uses disks for logging only.</span></span>

<span data-ttu-id="f2d62-176">Для повышения надежности мы рекомендуем использовать [Управляемые диски Azure][managed-disks].</span><span class="sxs-lookup"><span data-stu-id="f2d62-176">For best reliability, we recommend using [Azure Managed Disks][managed-disks].</span></span> <span data-ttu-id="f2d62-177">Использование Управляемых дисков обеспечивает изоляцию дисков для виртуальных машин в группе доступности, что помогает избежать единых точек отказа.</span><span class="sxs-lookup"><span data-stu-id="f2d62-177">Managed disks ensure that the disks for VMs within an availability set are isolated to avoid single points of failure.</span></span>

> [!NOTE]
> <span data-ttu-id="f2d62-178">Сейчас в шаблоне Resource Manager для этой эталонной архитектуры управляемые диски не используются.</span><span class="sxs-lookup"><span data-stu-id="f2d62-178">Currently the Resource Manager template for this reference architecture does not use managed disks.</span></span> <span data-ttu-id="f2d62-179">Мы намерены обновить шаблон для использования управляемых дисков.</span><span class="sxs-lookup"><span data-stu-id="f2d62-179">We are planning to update the template to use managed disks.</span></span>

<span data-ttu-id="f2d62-180">Чтобы добиться высокой скорости операции ввода-вывода и лучшей пропускной способности диска, к структуре хранилища Azure применяются распространенные методы оптимизации производительности тома хранилища.</span><span class="sxs-lookup"><span data-stu-id="f2d62-180">To achieve high IOPS and disk bandwidth throughput, the common practices in storage volume performance optimization apply to Azure storage layout.</span></span> <span data-ttu-id="f2d62-181">Например, чередование нескольких дисков вместе для создания большего тома диска повышает производительность операций ввода-вывода.</span><span class="sxs-lookup"><span data-stu-id="f2d62-181">For example, striping multiple disks together to create a larger disk volume improves IO performance.</span></span> <span data-ttu-id="f2d62-182">Включение кэша чтения в содержимом хранилища, которое редко изменяется, повышает скорость извлечения данных.</span><span class="sxs-lookup"><span data-stu-id="f2d62-182">Enabling the read cache on storage content that changes infrequently enhances the speed of data retrieval.</span></span> <span data-ttu-id="f2d62-183">Дополнительные сведения о требованиях к производительности см. в [примечании SAP 1943937 о средстве проверки конфигурации оборудования][sap-1943937].</span><span class="sxs-lookup"><span data-stu-id="f2d62-183">For details about performance requirements, see [SAP note 1943937 - Hardware Configuration Check Tool][sap-1943937].</span></span>

<span data-ttu-id="f2d62-184">Для хранения данных резервных копий рекомендуется использовать [холодный уровень хранилища][cool-blob-storage] BLOB-объектов Azure.</span><span class="sxs-lookup"><span data-stu-id="f2d62-184">For the backup data store, we recommend using the [cool storage tier][cool-blob-storage] of Azure Blob storage.</span></span> <span data-ttu-id="f2d62-185">Холодный уровень хранилища — это эффективный метод хранения данных, которые редко используются и имеют большой срок хранения.</span><span class="sxs-lookup"><span data-stu-id="f2d62-185">The cool storage tier is a cost-effective way to store data that is less frequently accessed and long-lived.</span></span>

## <a name="scalability-considerations"></a><span data-ttu-id="f2d62-186">Вопросы масштабируемости</span><span class="sxs-lookup"><span data-stu-id="f2d62-186">Scalability considerations</span></span>

<span data-ttu-id="f2d62-187">На прикладном уровне SAP Azure предлагает широкий диапазон размеров виртуальных машин для масштабирования.</span><span class="sxs-lookup"><span data-stu-id="f2d62-187">At the SAP application layer, Azure offers a wide range of virtual machine sizes for scaling up.</span></span> <span data-ttu-id="f2d62-188">Полный список см. в [примечании SAP № 1928533 о поддерживаемых продуктах и типах виртуальных машин Azure для приложений SAP в Azure][sap-1928533].</span><span class="sxs-lookup"><span data-stu-id="f2d62-188">For an inclusive list, see [SAP note 1928533 - SAP Applications on Azure: Supported Products and Azure VM Types][sap-1928533].</span></span> <span data-ttu-id="f2d62-189">Выполняйте горизонтальное масштабирование путем добавления виртуальных машин в группу доступности.</span><span class="sxs-lookup"><span data-stu-id="f2d62-189">Scale out by adding more VMs to the availability set.</span></span>

<span data-ttu-id="f2d62-190">Для SAP HANA на виртуальных машинах Azure с приложениями SAP OLTP и OLAP размер виртуальной машины, сертифицированной SAP, — GS5 с единым экземпляром виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="f2d62-190">For SAP HANA on Azure virtual machines with both OLTP and OLAP SAP applications, the SAP-certified virtual machine size is GS5 with a single VM instance.</span></span> <span data-ttu-id="f2d62-191">Для больших рабочих нагрузок корпорация Майкрософт также предлагает [большие экземпляры Azure][azure-large-instances] для SAP HANA на физических серверах, расположенных в центре обработки данных, сертифицированном Microsoft Azure, который на данный момент предоставляет объем памяти до 4 ТБ для одного экземпляра.</span><span class="sxs-lookup"><span data-stu-id="f2d62-191">For larger workloads, Microsoft also offers [Azure Large Instances][azure-large-instances] for SAP HANA on physical servers co-located in a Microsoft Azure certified datacenter, which provides up to 4 TB of memory capacity for a single instance at this time.</span></span> <span data-ttu-id="f2d62-192">Также возможны конфигурации с несколькими узлами и общей емкостью памяти до 32 ТБ.</span><span class="sxs-lookup"><span data-stu-id="f2d62-192">Multi-node configuration is also possible with a total memory capacity of up to 32 TB.</span></span>

## <a name="availability-considerations"></a><span data-ttu-id="f2d62-193">Вопросы доступности</span><span class="sxs-lookup"><span data-stu-id="f2d62-193">Availability considerations</span></span>

<span data-ttu-id="f2d62-194">В этой распределенной установке приложения SAP в централизованной базе данных базовая установка реплицируется для обеспечения высокой доступности.</span><span class="sxs-lookup"><span data-stu-id="f2d62-194">In this distributed installation of the SAP application on a centralized database, the base installation is replicated to achieve high availability.</span></span> <span data-ttu-id="f2d62-195">Для каждого слоя архитектуры способ обеспечения высокого уровня доступности варьируется:</span><span class="sxs-lookup"><span data-stu-id="f2d62-195">For each layer of the architecture, the high availability design varies:</span></span>

- <span data-ttu-id="f2d62-196">**Веб-диспетчер.**</span><span class="sxs-lookup"><span data-stu-id="f2d62-196">**Web Dispatcher.**</span></span> <span data-ttu-id="f2d62-197">Высокий уровень доступности достигается с помощью избыточного количества экземпляров веб-диспетчера SAP с трафиком приложения SAP.</span><span class="sxs-lookup"><span data-stu-id="f2d62-197">High availability is achieved with redundant SAP Web Dispatcher instances with SAP application traffic.</span></span> <span data-ttu-id="f2d62-198">Дополнительные сведения см. в документации по [веб-диспетчеру SAP][swd].</span><span class="sxs-lookup"><span data-stu-id="f2d62-198">See [SAP Web Dispatcher][swd] in the SAP Documentation.</span></span>

- <span data-ttu-id="f2d62-199">**ASCS.**</span><span class="sxs-lookup"><span data-stu-id="f2d62-199">**ASCS.**</span></span> <span data-ttu-id="f2d62-200">Для высокого уровня доступности ASCS на виртуальных машинах Windows в Azure используется отказоустойчивая кластеризация Windows Sever с SIOS DataKeeper для реализации общего тома кластера.</span><span class="sxs-lookup"><span data-stu-id="f2d62-200">For high availability of ASCS on Azure Windows virtual machines, Windows Sever Failover Clustering is used with SIOS DataKeeper to implement the cluster shared volume.</span></span> <span data-ttu-id="f2d62-201">Дополнительные сведения о реализации см. в [этой статье][clustering].</span><span class="sxs-lookup"><span data-stu-id="f2d62-201">For implementation details, see [Clustering SAP ASCS on Azure][clustering].</span></span>

- <span data-ttu-id="f2d62-202">**Серверы приложений.**</span><span class="sxs-lookup"><span data-stu-id="f2d62-202">**Application servers.**</span></span> <span data-ttu-id="f2d62-203">Высокий уровень доступности достигается путем балансировки нагрузки трафика в пуле серверов приложений.</span><span class="sxs-lookup"><span data-stu-id="f2d62-203">High availability is achieved by load balancing traffic within a pool of application servers.</span></span>

- <span data-ttu-id="f2d62-204">**Уровень базы данных.**</span><span class="sxs-lookup"><span data-stu-id="f2d62-204">**Database tier.**</span></span> <span data-ttu-id="f2d62-205">Эта эталонная архитектура развертывает один экземпляр базы данных SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="f2d62-205">This reference architecture deploys a single SAP HANA database instance.</span></span> <span data-ttu-id="f2d62-206">Для обеспечения высокой доступности разверните более одного экземпляра и используйте систему репликации HANA для перехода на другой ресурс вручную.</span><span class="sxs-lookup"><span data-stu-id="f2d62-206">For high availability, deploy more than one instance and use HANA System Replication (HSR) to implement manual failover.</span></span> <span data-ttu-id="f2d62-207">Чтобы включить автоматический переход на другой ресурс, требуется расширение HA для определенного дистрибутива Linux.</span><span class="sxs-lookup"><span data-stu-id="f2d62-207">To enable automatic failover, an HA extension for the specific Linux distribution is required.</span></span>

### <a name="disaster-recovery-considerations"></a><span data-ttu-id="f2d62-208">Рекомендации по аварийному восстановлению</span><span class="sxs-lookup"><span data-stu-id="f2d62-208">Disaster recovery considerations</span></span>

<span data-ttu-id="f2d62-209">Каждый уровень использует разную стратегию обеспечения защиты посредством аварийного восстановления.</span><span class="sxs-lookup"><span data-stu-id="f2d62-209">Each tier uses a different strategy to provide disaster recovery (DR) protection.</span></span>

- <span data-ttu-id="f2d62-210">**Серверы приложений.**</span><span class="sxs-lookup"><span data-stu-id="f2d62-210">**Application servers.**</span></span> <span data-ttu-id="f2d62-211">Серверы приложений SAP не содержат бизнес-данных.</span><span class="sxs-lookup"><span data-stu-id="f2d62-211">SAP application servers don't contain business data.</span></span> <span data-ttu-id="f2d62-212">В Azure простой стратегией аварийного восстановления является создание серверов приложений SAP в другом регионе.</span><span class="sxs-lookup"><span data-stu-id="f2d62-212">On Azure, a simple DR strategy is to create SAP application servers in another region.</span></span> <span data-ttu-id="f2d62-213">При любых изменениях конфигурации или обновлениях ядра на основном сервере приложений те же изменения должны быть скопированы в виртуальные машины в регионе аварийного восстановления.</span><span class="sxs-lookup"><span data-stu-id="f2d62-213">Upon any configuration changes or kernel updates on the primary application server, the same changes must be copied to VMs in the DR region.</span></span> <span data-ttu-id="f2d62-214">Например, исполняемые файлы ядра копируются на виртуальные машины аварийного восстановления.</span><span class="sxs-lookup"><span data-stu-id="f2d62-214">For example, the kernel executables copied to the DR VMs.</span></span>

- <span data-ttu-id="f2d62-215">**Центральные службы SAP.**</span><span class="sxs-lookup"><span data-stu-id="f2d62-215">**SAP Central Services.**</span></span> <span data-ttu-id="f2d62-216">Этот компонент стека приложений SAP не сохраняет бизнес-данные.</span><span class="sxs-lookup"><span data-stu-id="f2d62-216">This component of the SAP application stack also doesn't persist business data.</span></span> <span data-ttu-id="f2d62-217">Можно создать виртуальную машину в регионе аварийного восстановления для выполнения роли SCS.</span><span class="sxs-lookup"><span data-stu-id="f2d62-217">You can build a VM in the DR region to run the SCS role.</span></span> <span data-ttu-id="f2d62-218">Единственное содержимое основного узла SCS, которое синхронизируется, — это общее содержимое **/sapmnt**.</span><span class="sxs-lookup"><span data-stu-id="f2d62-218">The only content from the primary SCS node to synchronize is the **/sapmnt** share content.</span></span> <span data-ttu-id="f2d62-219">Кроме того, если конфигурация изменяется или происходит обновление ядра на основных серверах SCS, их нужно повторить в SCS аварийного восстановления.</span><span class="sxs-lookup"><span data-stu-id="f2d62-219">Also, if configuration changes or kernel updates take place on the primary SCS servers, they must be repeated on the DR SCS.</span></span> <span data-ttu-id="f2d62-220">Чтобы синхронизировать два сервера, просто используйте регулярное запланированное задание копирования для копирования **/sapmnt** в экземпляр аварийного восстановления.</span><span class="sxs-lookup"><span data-stu-id="f2d62-220">To synchronize the two servers, simply use a regularly scheduled copy job to copy **/sapmnt** to the DR side.</span></span> <span data-ttu-id="f2d62-221">Сведения о процессе создания, копирования и тестирования отработки отказа можно получить, скачав документ [SAP NetWeaver: Building a Hyper-V & Microsoft Azure–based Disaster Recovery Solution][sap-netweaver-dr] (Создание решения аварийного восстановления на основе Microsoft Azure и Hyper-V в SAP NetWeaver) и просмотрев сведения в разделе 4.3</span><span class="sxs-lookup"><span data-stu-id="f2d62-221">For details about the build, copy, and test failover process, download [SAP NetWeaver: Building a Hyper-V and Microsoft Azure–based Disaster Recovery Solution][sap-netweaver-dr], and refer to "4.3.</span></span> <span data-ttu-id="f2d62-222">о слое единой точки отказа SAP (ASCS).</span><span class="sxs-lookup"><span data-stu-id="f2d62-222">SAP SPOF layer (ASCS)."</span></span>

- <span data-ttu-id="f2d62-223">**Уровень базы данных.**</span><span class="sxs-lookup"><span data-stu-id="f2d62-223">**Database tier.**</span></span> <span data-ttu-id="f2d62-224">Используйте поддерживаемые HANA решения репликации, такие как HSR или репликация хранилища.</span><span class="sxs-lookup"><span data-stu-id="f2d62-224">Use HANA-supported replication solutions such as HSR or Storage Replication.</span></span> 

## <a name="manageability-considerations"></a><span data-ttu-id="f2d62-225">Вопросы управляемости</span><span class="sxs-lookup"><span data-stu-id="f2d62-225">Manageability considerations</span></span>

<span data-ttu-id="f2d62-226">В SAP HANA есть функция резервного копирования, которая использует базовую инфраструктуру Azure.</span><span class="sxs-lookup"><span data-stu-id="f2d62-226">SAP HANA has a backup feature that uses the underlying Azure infrastructure.</span></span> <span data-ttu-id="f2d62-227">Чтобы создать резервную копию базы данных SAP HANA, выполняющейся на виртуальных машинах Azure, для обеспечения согласованности файлов резервных копий используются и моментальные снимки SAP HANA, и моментальные снимки хранилища Azure.</span><span class="sxs-lookup"><span data-stu-id="f2d62-227">To back up the SAP HANA database running on Azure virtual machines, both the SAP HANA snapshot and Azure storage snapshot are used to ensure the consistency of backup files.</span></span> <span data-ttu-id="f2d62-228">Дополнительные сведения см. в статье [Руководство по резервному копированию SAP HANA на виртуальных машинах Azure][hana-backup] и [Вопросы о службе архивации Azure][backup-faq].</span><span class="sxs-lookup"><span data-stu-id="f2d62-228">For details, see [Backup guide for SAP HANA on Azure Virtual Machines][hana-backup] and the [Azure Backup service FAQ][backup-faq].</span></span>

<span data-ttu-id="f2d62-229">Azure предоставляет несколько функций для [мониторинга и диагностики][monitoring] во всей инфраструктуре.</span><span class="sxs-lookup"><span data-stu-id="f2d62-229">Azure provides several functions for [monitoring and diagnostics][monitoring] of the overall infrastructure.</span></span> <span data-ttu-id="f2d62-230">Кроме того, расширенный мониторинг виртуальных машин Azure (Windows или Linux) обрабатывается с помощью Azure Operations Management Suite (OMS).</span><span class="sxs-lookup"><span data-stu-id="f2d62-230">Also, enhanced monitoring of Azure virtual machines (Linux or Windows) is handled by Azure Operations Management Suite (OMS).</span></span>

<span data-ttu-id="f2d62-231">Чтобы обеспечить мониторинг ресурсов на основе SAP и производительности инфраструктуры SAP, используйте расширение улучшенного мониторинга Azure для SAP.</span><span class="sxs-lookup"><span data-stu-id="f2d62-231">To provide SAP-based monitoring of resources and service performance of the SAP infrastructure, use the Azure SAP Enhanced Monitoring extension.</span></span> <span data-ttu-id="f2d62-232">Это расширение передает статистику мониторинга Azure в приложение SAP для мониторинга операционной системы и функций DBACockpit.</span><span class="sxs-lookup"><span data-stu-id="f2d62-232">This extension feeds Azure monitoring statistics into the SAP application for operating system monitoring and DBA Cockpit functions.</span></span> 

## <a name="security-considerations"></a><span data-ttu-id="f2d62-233">Вопросы безопасности</span><span class="sxs-lookup"><span data-stu-id="f2d62-233">Security considerations</span></span>

<span data-ttu-id="f2d62-234">SAP имеет свой собственный механизм управления пользователями для управления доступом на основе ролей и авторизации в приложении SAP.</span><span class="sxs-lookup"><span data-stu-id="f2d62-234">SAP has its own Users Management Engine (UME) to control role-based access and authorization within the SAP application.</span></span> <span data-ttu-id="f2d62-235">Дополнительные сведения см. в статье [SAP HANA Security - An Overview][sap-security] (Обзор безопасности SAP HANA).</span><span class="sxs-lookup"><span data-stu-id="f2d62-235">For details, see [SAP HANA Security - An Overview][sap-security].</span></span> <span data-ttu-id="f2d62-236">(Для доступа необходима учетная запись SAP Service Marketplace.)</span><span class="sxs-lookup"><span data-stu-id="f2d62-236">(A SAP Service Marketplace account is required for access.)</span></span>

<span data-ttu-id="f2d62-237">Для обеспечения безопасности инфраструктуры данные защищаются путем шифрования при передаче и на месте.</span><span class="sxs-lookup"><span data-stu-id="f2d62-237">For infrastructure security, data is safeguarded in transit and at rest.</span></span> <span data-ttu-id="f2d62-238">С помощью указаний в разделе "Рекомендации по безопасности" в статье [SAP NetWeaver на виртуальных машинах Windows. Руководство по планированию и внедрению][netweaver-on-azure] начните реализовать защиту сети.</span><span class="sxs-lookup"><span data-stu-id="f2d62-238">The “Security considerations” section of the [SAP NetWeaver on Azure Virtual Machines (VMs) – Planning and Implementation Guide][netweaver-on-azure] begins to address network security.</span></span> <span data-ttu-id="f2d62-239">В руководстве также указаны порты сети, которые необходимо открыть на брандмауэрах, чтобы разрешить взаимодействие с приложением.</span><span class="sxs-lookup"><span data-stu-id="f2d62-239">The guide also specifies the network ports you must open on the firewalls to allow application communication.</span></span> 

<span data-ttu-id="f2d62-240">Чтобы выполнить шифрование дисков виртуальной машины Windows и Linux IaaS, можно использовать [шифрование диска Azure][disk-encryption].</span><span class="sxs-lookup"><span data-stu-id="f2d62-240">To encrypt Windows and Linux IaaS virtual machine disks, you can use [Azure Disk Encryption][disk-encryption].</span></span> <span data-ttu-id="f2d62-241">Шифрование дисков Azure использует функции (BitLocker в Windows и DM-Crypt в Linux), которые обеспечивают шифрование томов для дисков ОС и дисков данных.</span><span class="sxs-lookup"><span data-stu-id="f2d62-241">Azure Disk Encryption uses the BitLocker feature of Windows and the DM-Crypt feature of Linux to provide volume encryption for the operating system and the data disks.</span></span> <span data-ttu-id="f2d62-242">Шифрование дисков Azure также работает в Azure Key Vault, что позволяет управлять секретами и ключами шифрования дисков в подписке Key Vault и контролировать их.</span><span class="sxs-lookup"><span data-stu-id="f2d62-242">The solution also works with Azure Key Vault to help you control and manage the disk-encryption keys and secrets in your Key Vault subscription.</span></span> <span data-ttu-id="f2d62-243">Данные на дисках виртуальной машины шифруются в хранилище Azure, когда они неактивны.</span><span class="sxs-lookup"><span data-stu-id="f2d62-243">Data on the virtual machine disks are encrypted at rest in your Azure storage.</span></span>

<span data-ttu-id="f2d62-244">Для шифрования неактивных данных SAP HANA рекомендуется использовать собственную технологию шифрования SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="f2d62-244">For SAP HANA data-at-rest encryption, we recommend using the SAP HANA native encryption technology.</span></span>

> [!NOTE]
> <span data-ttu-id="f2d62-245">Не применяйте шифрование неактивных данных HANA и шифрование диска Azure на том же сервере.</span><span class="sxs-lookup"><span data-stu-id="f2d62-245">Don't use the HANA data-at-rest encryption with Azure disk encryption on the same server.</span></span>

<span data-ttu-id="f2d62-246">Рассмотрите возможность использования [групп безопасности сети][nsg], чтобы ограничить трафик между различными подсетями в виртуальной сети.</span><span class="sxs-lookup"><span data-stu-id="f2d62-246">Consider using [network security groups][nsg] (NSGs) to restrict traffic between the various subnets in the VNet.</span></span>

## <a name="deploy-the-solution"></a><span data-ttu-id="f2d62-247">Развертывание решения</span><span class="sxs-lookup"><span data-stu-id="f2d62-247">Deploy the solution</span></span> 

<span data-ttu-id="f2d62-248">Скрипты развертывания для этой эталонной архитектуры можно найти на [GitHub][github].</span><span class="sxs-lookup"><span data-stu-id="f2d62-248">The deployment scripts for this reference architecture are available on [GitHub][github].</span></span>


### <a name="prerequisites"></a><span data-ttu-id="f2d62-249">предварительным требованиям</span><span class="sxs-lookup"><span data-stu-id="f2d62-249">Prerequisites</span></span>

- <span data-ttu-id="f2d62-250">Для завершения установки необходимо иметь доступ к центру загрузки программного обеспечения SAP.</span><span class="sxs-lookup"><span data-stu-id="f2d62-250">You must have access to the SAP Software Download Center to complete the installation.</span></span>
 
- <span data-ttu-id="f2d62-251">Установите [Azure PowerShell][azure-ps] последней версии.</span><span class="sxs-lookup"><span data-stu-id="f2d62-251">Install the latest version of [Azure PowerShell][azure-ps].</span></span> 

- <span data-ttu-id="f2d62-252">Для этого развертывания требуется 51 ядро.</span><span class="sxs-lookup"><span data-stu-id="f2d62-252">This deployment requires 51 cores.</span></span> <span data-ttu-id="f2d62-253">Перед развертыванием убедитесь, что подписка имеет достаточные квоты для ядер виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="f2d62-253">Before deploying, verify that your subscription has sufficient quota for VM cores.</span></span> <span data-ttu-id="f2d62-254">В противном случае используйте портал Azure, чтобы отправить запрос на увеличение квоты.</span><span class="sxs-lookup"><span data-stu-id="f2d62-254">If not, use the Azure portal to submit a support request for more quota.</span></span>
 
- <span data-ttu-id="f2d62-255">Это развертывание использует виртуальную машину серии GS.</span><span class="sxs-lookup"><span data-stu-id="f2d62-255">This deployment uses a GS-series VM.</span></span> <span data-ttu-id="f2d62-256">Проверьте доступность серии GS для каждого региона [здесь][region-availability].</span><span class="sxs-lookup"><span data-stu-id="f2d62-256">Check the availability of the GS series per region [here][region-availability].</span></span>

- <span data-ttu-id="f2d62-257">Для оценки стоимости развертывания перейдите к [калькулятору цен][azure-pricing].</span><span class="sxs-lookup"><span data-stu-id="f2d62-257">To estimate the cost of this deployment, see the [Azure Pricing Calculator][azure-pricing].</span></span> 
 
<span data-ttu-id="f2d62-258">Эта эталонная архитектура развертывает такие виртуальные машины:</span><span class="sxs-lookup"><span data-stu-id="f2d62-258">This reference architecture deploys the following VMs:</span></span>

| <span data-ttu-id="f2d62-259">Имя ресурса</span><span class="sxs-lookup"><span data-stu-id="f2d62-259">Resource name</span></span> | <span data-ttu-id="f2d62-260">Размер виртуальной машины</span><span class="sxs-lookup"><span data-stu-id="f2d62-260">VM Size</span></span> | <span data-ttu-id="f2d62-261">Назначение</span><span class="sxs-lookup"><span data-stu-id="f2d62-261">Purpose</span></span>  |
|---------------|---------|----------|
| <span data-ttu-id="f2d62-262">`ra-sapApps-scs-vm1` ... `ra-sapApps-scs-vmN`</span><span class="sxs-lookup"><span data-stu-id="f2d62-262">`ra-sapApps-scs-vm1` ... `ra-sapApps-scs-vmN`</span></span> | <span data-ttu-id="f2d62-263">DS11v2</span><span class="sxs-lookup"><span data-stu-id="f2d62-263">DS11v2</span></span> | <span data-ttu-id="f2d62-264">Центральные службы SAP</span><span class="sxs-lookup"><span data-stu-id="f2d62-264">SAP Central Services</span></span> |
| <span data-ttu-id="f2d62-265">`ra-sapApps-vm1` ... `ra-sapApps-vmN`</span><span class="sxs-lookup"><span data-stu-id="f2d62-265">`ra-sapApps-vm1` ... `ra-sapApps-vmN`</span></span> | <span data-ttu-id="f2d62-266">DS11v2</span><span class="sxs-lookup"><span data-stu-id="f2d62-266">DS11v2</span></span> | <span data-ttu-id="f2d62-267">Приложение SAP NetWeaver</span><span class="sxs-lookup"><span data-stu-id="f2d62-267">SAP NetWeaver application</span></span> |
| <span data-ttu-id="f2d62-268">`ra-sap-wdp-vm1` ... `ra-sap-wdp-vmN`</span><span class="sxs-lookup"><span data-stu-id="f2d62-268">`ra-sap-wdp-vm1` ... `ra-sap-wdp-vmN`</span></span> | <span data-ttu-id="f2d62-269">DS11v2</span><span class="sxs-lookup"><span data-stu-id="f2d62-269">DS11v2</span></span> | <span data-ttu-id="f2d62-270">Веб-диспетчер SAP</span><span class="sxs-lookup"><span data-stu-id="f2d62-270">SAP Web Dispatcher</span></span> |
| `ra-sap-data-vm1` | <span data-ttu-id="f2d62-271">GS5</span><span class="sxs-lookup"><span data-stu-id="f2d62-271">GS5</span></span> | <span data-ttu-id="f2d62-272">Экземпляр базы данных SAP HANA</span><span class="sxs-lookup"><span data-stu-id="f2d62-272">SAP HANA database instance</span></span> |
| `ra-sap-jumpbox-vm1` | <span data-ttu-id="f2d62-273">DS1V2</span><span class="sxs-lookup"><span data-stu-id="f2d62-273">DS1V2</span></span> | <span data-ttu-id="f2d62-274">Jumpbox</span><span class="sxs-lookup"><span data-stu-id="f2d62-274">Jumpbox</span></span> |

<span data-ttu-id="f2d62-275">Развертывается один экземпляр SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="f2d62-275">A single SAP HANA instance is deployed.</span></span> <span data-ttu-id="f2d62-276">Для виртуальных машин приложения количество развертываемых экземпляров указано в параметрах шаблона.</span><span class="sxs-lookup"><span data-stu-id="f2d62-276">For the application VMs, the number of instances to deploy is specified in the template parameters.</span></span>

### <a name="deploy-sap-infrastructure"></a><span data-ttu-id="f2d62-277">Развертывание инфраструктуры SAP</span><span class="sxs-lookup"><span data-stu-id="f2d62-277">Deploy SAP infrastructure</span></span>

<span data-ttu-id="f2d62-278">Эту архитектуру можно развертывать последовательно или всю сразу.</span><span class="sxs-lookup"><span data-stu-id="f2d62-278">You can deploy this architecture incrementally or all at once.</span></span> <span data-ttu-id="f2d62-279">Впервые мы рекомендуем выполнять пошаговое развертывание, чтобы вы могли видеть, какие действия выполняются на каждом шаге.</span><span class="sxs-lookup"><span data-stu-id="f2d62-279">The first time, we recommend an incremental deployment, so that you can see what each deployment step does.</span></span> <span data-ttu-id="f2d62-280">Выберите приращение с помощью одного из следующих параметров *режима*.</span><span class="sxs-lookup"><span data-stu-id="f2d62-280">Specify the increment using one of the following *mode* parameters</span></span>

| <span data-ttu-id="f2d62-281">Mode</span><span class="sxs-lookup"><span data-stu-id="f2d62-281">Mode</span></span>           | <span data-ttu-id="f2d62-282">Действие</span><span class="sxs-lookup"><span data-stu-id="f2d62-282">What it does</span></span>                                                                                                            |
|----------------|-----------------------------------------------------|
| <span data-ttu-id="f2d62-283">infrastructure</span><span class="sxs-lookup"><span data-stu-id="f2d62-283">infrastructure</span></span> | <span data-ttu-id="f2d62-284">Развертывание сетевой инфраструктуры в Azure.</span><span class="sxs-lookup"><span data-stu-id="f2d62-284">Deploys the network infrastructure in Azure.</span></span>        |
| <span data-ttu-id="f2d62-285">workload</span><span class="sxs-lookup"><span data-stu-id="f2d62-285">workload</span></span>       | <span data-ttu-id="f2d62-286">Развертывает серверы SAP в сеть.</span><span class="sxs-lookup"><span data-stu-id="f2d62-286">Deploys the SAP servers to the network.</span></span>             |
| <span data-ttu-id="f2d62-287">все</span><span class="sxs-lookup"><span data-stu-id="f2d62-287">all</span></span>            | <span data-ttu-id="f2d62-288">Выполняет все предыдущие развертывания.</span><span class="sxs-lookup"><span data-stu-id="f2d62-288">Deploys all the preceding deployments.</span></span>              |

<span data-ttu-id="f2d62-289">Чтобы развернуть решение, сделайте следующее:</span><span class="sxs-lookup"><span data-stu-id="f2d62-289">To deploy the solution, perform the following steps:</span></span>

1. <span data-ttu-id="f2d62-290">Скачайте или клонируйте [репозиторий GitHub][github] на локальный компьютер.</span><span class="sxs-lookup"><span data-stu-id="f2d62-290">Download or clone the [GitHub repo][github] to your local computer.</span></span>

2. <span data-ttu-id="f2d62-291">Откройте окно PowerShell и перейдите к папке `/sap/sap-hana/`.</span><span class="sxs-lookup"><span data-stu-id="f2d62-291">Open a PowerShell window and navigate to the `/sap/sap-hana/` folder.</span></span>

3. <span data-ttu-id="f2d62-292">Выполните приведенный ниже командлет PowerShell.</span><span class="sxs-lookup"><span data-stu-id="f2d62-292">Run the following PowerShell cmdlet.</span></span> <span data-ttu-id="f2d62-293">В качестве значения `<subscription id>` введите идентификатор подписки Azure.</span><span class="sxs-lookup"><span data-stu-id="f2d62-293">For `<subscription id>`, use your Azure subscription ID.</span></span> <span data-ttu-id="f2d62-294">В качестве значения `<location>` укажите регион Azure (например, `eastus` или `westus`).</span><span class="sxs-lookup"><span data-stu-id="f2d62-294">For `<location>`, specify an Azure region, such as `eastus` or `westus`.</span></span> <span data-ttu-id="f2d62-295">В качестве значения `<mode>` укажите один из перечисленных выше режимов.</span><span class="sxs-lookup"><span data-stu-id="f2d62-295">For `<mode>`, specify one of the modes listed above.</span></span>

    ```powershell
     .\Deploy-ReferenceArchitecture -SubscriptionId <subscription id> -Location <location> -ResourceGroupName <resource group> <mode>
    ```

4.  <span data-ttu-id="f2d62-296">При появлении соответствующего запроса войдите в учетную запись Azure.</span><span class="sxs-lookup"><span data-stu-id="f2d62-296">When prompted, log on to your Azure account.</span></span> 

<span data-ttu-id="f2d62-297">Выполнение сценариев развертывания может занять несколько часов в зависимости от выбранного режима.</span><span class="sxs-lookup"><span data-stu-id="f2d62-297">The deployment scripts can take up to several hours to complete, depending on the mode you selected.</span></span>

> [!WARNING]
> <span data-ttu-id="f2d62-298">Файлы параметров содержат жестко заданный пароль (`AweS0me@PW`) в различных расположениях.</span><span class="sxs-lookup"><span data-stu-id="f2d62-298">The parameter files include a hard-coded password (`AweS0me@PW`) in various places.</span></span> <span data-ttu-id="f2d62-299">Измените эти значения перед развертыванием.</span><span class="sxs-lookup"><span data-stu-id="f2d62-299">Change these values before you deploy.</span></span>
 
### <a name="configure-sap-applications-and-database"></a><span data-ttu-id="f2d62-300">Настройка приложений и базы данных SAP</span><span class="sxs-lookup"><span data-stu-id="f2d62-300">Configure SAP applications and database</span></span>

<span data-ttu-id="f2d62-301">После развертывания инфраструктуры SAP установите и настройте приложения SAP и базу данных HANA на виртуальных машинах следующим образом.</span><span class="sxs-lookup"><span data-stu-id="f2d62-301">After deploying the SAP infrastructure, install and configure your SAP applications and HANA database on the virtual machines as follows.</span></span>

> [!NOTE]
> <span data-ttu-id="f2d62-302">Вам нужны имя пользователя и пароль портала поддержки SAP для скачивания [руководств по установке SAP][sap-guide].</span><span class="sxs-lookup"><span data-stu-id="f2d62-302">For SAP installation instructions, you must have a SAP Support Portal username and password to download the [SAP installation guides][sap-guide].</span></span>

1. <span data-ttu-id="f2d62-303">Войдите в jumpbox (`ra-sap-jumpbox-vm1`).</span><span class="sxs-lookup"><span data-stu-id="f2d62-303">Log into the jumpbox (`ra-sap-jumpbox-vm1`).</span></span> <span data-ttu-id="f2d62-304">jumpbox используется для входа в другие виртуальные машины.</span><span class="sxs-lookup"><span data-stu-id="f2d62-304">You will use the jumpbox to log into the other VMs.</span></span> 

2.  <span data-ttu-id="f2d62-305">Для каждой виртуальной машины с именем `ra-sap-wdp-vm1` ... `ra-sap-wdp-vmN` войдите на ВМ и установите и настройте экземпляр веб-диспетчера SAP, выполнив действия, описанные на вики-странице по [установке веб-диспетчера][sap-dispatcher-install].</span><span class="sxs-lookup"><span data-stu-id="f2d62-305">For each VM named `ra-sap-wdp-vm1` ... `ra-sap-wdp-vmN`, log into the VM, and install and configure the SAP Web Dispatcher instance using the steps described in the [Web Dispatcher Installation][sap-dispatcher-install] wiki.</span></span>

3.  <span data-ttu-id="f2d62-306">Войдите на виртуальную машину с именем `ra-sap-data-vm1`.</span><span class="sxs-lookup"><span data-stu-id="f2d62-306">Log into the VM named `ra-sap-data-vm1`.</span></span> <span data-ttu-id="f2d62-307">Установите и настройте экземпляр базы данных SAP HANA, используя [руководство по установке и обновлению сервера SAP HANA][hana-guide].</span><span class="sxs-lookup"><span data-stu-id="f2d62-307">Install and configure the SAP Hana Database instance using the [SAP HANA Server Installation and Update Guide][hana-guide].</span></span>

4. <span data-ttu-id="f2d62-308">Для каждой виртуальной машины с именем `ra-sapApps-scs-vm1` ... `ra-sapApps-scs-vmN` войдите на ВМ, установите и настройте центральные службы SAP (SCS) с помощью [руководств по установке SAP][sap-guide].</span><span class="sxs-lookup"><span data-stu-id="f2d62-308">For each VM named `ra-sapApps-scs-vm1` ... `ra-sapApps-scs-vmN`, log into the VM, and install and configure the SAP Central Services (SCS) using the [SAP installation guides][sap-guide].</span></span>

5.  <span data-ttu-id="f2d62-309">Для каждой виртуальной машины с именем `ra-sapApps-vm1` ... `ra-sapApps-vmN` войдите на ВМ, установите и настройте приложение SAP NetWeaver с помощью [руководств по установке SAP][sap-guide].</span><span class="sxs-lookup"><span data-stu-id="f2d62-309">For each VM named `ra-sapApps-vm1` ... `ra-sapApps-vmN`, log into the VM, and install and configure the SAP NetWeaver application using the [SAP installation guides][sap-guide].</span></span>

<span data-ttu-id="f2d62-310">**_Авторы этой эталонной архитектуры_** &mdash; Рик Рейни (Rick Rainey), Росс Шпонгольц (Ross Sponholtz), Бэн Чинь (Ben Trinh).</span><span class="sxs-lookup"><span data-stu-id="f2d62-310">**_Contributors to this reference architecture_** &mdash; Rick Rainey, Ross Sponholtz, Ben Trinh</span></span>

[azure-large-instances]: /azure/virtual-machines/workloads/sap/hana-overview-architecture
[azure-lb]: /azure/load-balancer/load-balancer-overview
[azure-pricing]: https://azure.microsoft.com/pricing/calculator/
[azure-ps]: /powershell/azure/overview
[backup-faq]: /azure/backup/backup-azure-backup-faq
[clustering]: https://blogs.msdn.microsoft.com/saponsqlserver/2015/05/20/clustering-sap-ascs-instance-using-windows-server-failover-cluster-on-microsoft-azure-with-sios-datakeeper-and-azure-internal-load-balancer/
[cool-blob-storage]: /azure/storage/storage-blob-storage-tiers
[disk-encryption]: /azure/security/azure-security-disk-encryption
[github]: https://github.com/mspnp/reference-architectures/tree/master/sap/sap-hana
[hana-backup]: /azure/virtual-machines/workloads/sap/sap-hana-backup-guide
[hana-guide]: https://help.sap.com/viewer/2c1988d620e04368aa4103bf26f17727/2.0.01/en-US/7eb0167eb35e4e2885415205b8383584.html
[hybrid-networking]: ../hybrid-networking/index.md
[logon-groups]: https://wiki.scn.sap.com/wiki/display/SI/ABAP+Logon+Group+based+Load+Balancing
[managed-disks]: /azure/storage/storage-managed-disks-overview
[monitoring]: /azure/architecture/best-practices/monitoring
[multiple-vm-nics]: /azure/virtual-machines/windows/multiple-nics
[netweaver-on-azure]: /azure/virtual-machines/workloads/sap/planning-guide
[nsg]: /azure/virtual-network/virtual-networks-nsg
[region-availability]: https://azure.microsoft.com/regions/services/
[running-SAP]: https://blogs.msdn.microsoft.com/saponsqlserver/2016/06/07/sap-on-sql-general-update-for-customers-partners-june-2016/
[sap-1943937]: https://launchpad.support.sap.com/#/notes/1943937
[sap-1928533]: https://launchpad.support.sap.com/#/notes/1928533
[sap-dispatcher]: https://help.sap.com/doc/saphelp_nw73ehp1/7.31.19/en-US/48/8fe37933114e6fe10000000a421937/frameset.htm
[sap-dispatcher-ha]: https://help.sap.com/doc/saphelp_nw73ehp1/7.31.19/en-US/48/9a9a6b48c673e8e10000000a42189b/frameset.htm
[sap-dispatcher-install]: https://wiki.scn.sap.com/wiki/display/SI/Web+Dispatcher+Installation
[sap-guide]: https://service.sap.com/instguides
[sap-ha]: https://support.sap.com/content/dam/SAAP/SAP_Activate/AGS_70.pdf
[sap-hana-on-azure]: https://azure.microsoft.com/services/virtual-machines/sap-hana/
[sap-netweaver-dr]: http://download.microsoft.com/download/9/5/6/956FEDC3-702D-4EFB-A7D3-2DB7505566B6/SAP%20NetWeaver%20-%20Building%20an%20Azure%20based%20Disaster%20Recovery%20Solution%20V1_5%20.docx
[sap-security]: https://archive.sap.com/documents/docs/DOC-62943
[visio-download]: https://archcenter.blob.core.windows.net/cdn/SAP-HANA-architecture.vsdx
[vm-sizes-mem]: /azure/virtual-machines/windows/sizes-memory
[swd]: https://help.sap.com/doc/saphelp_nw70ehp2/7.02.16/en-us/48/8fe37933114e6fe10000000a421937/frameset.htm
[0]: ./images/sap-hana.png "Архитектура SAP HANA с использованием Microsoft Azure".
