---
title: "Запуск виртуальной машины Linux в Azure"
description: "Сведения о выполнении одной виртуальной машины Linux в Azure с учетом требований к масштабируемости, устойчивости, управляемости и безопасности."
author: telmosampaio
ms.date: 09/06/2017
pnp.series.title: Linux VM workloads
pnp.series.next: multi-vm
pnp.series.prev: ./index
ms.openlocfilehash: f38c53db5df1681a1abc926df9f0b7f929ceb76b
ms.sourcegitcommit: b0482d49aab0526be386837702e7724c61232c60
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/14/2017
---
# <a name="run-a-linux-vm-on-azure"></a><span data-ttu-id="be5e6-103">Запуск виртуальной машины Linux в Azure</span><span class="sxs-lookup"><span data-stu-id="be5e6-103">Run a Linux VM on Azure</span></span>

<span data-ttu-id="be5e6-104">В этой эталонной архитектуре показан набор методик по запуску виртуальных машин Linux в Azure.</span><span class="sxs-lookup"><span data-stu-id="be5e6-104">This reference architecture shows a set of proven practices for running a Linux virtual machine (VM) on Azure.</span></span> <span data-ttu-id="be5e6-105">Она содержит рекомендации для подготовки виртуальной машины, а также компоненты хранилища и сетевые компоненты.</span><span class="sxs-lookup"><span data-stu-id="be5e6-105">It includes recommendations for provisioning the VM along with networking and storage components.</span></span> <span data-ttu-id="be5e6-106">Эту архитектуру можно использовать для запуска отдельного экземпляра. Она является основой для более сложных архитектур, например, для n-уровневых приложений.</span><span class="sxs-lookup"><span data-stu-id="be5e6-106">This architecture can be used to run a single instance, and is the basis for more complex architectures such as n-tier applications.</span></span> [<span data-ttu-id="be5e6-107">**Разверните это решение**.</span><span class="sxs-lookup"><span data-stu-id="be5e6-107">**Deploy this solution**.</span></span>](#deploy-the-solution)

<span data-ttu-id="be5e6-108">![[0]][0]</span><span class="sxs-lookup"><span data-stu-id="be5e6-108">![[0]][0]</span></span>

<span data-ttu-id="be5e6-109">*Скачайте [файл Visio][visio-download] этой архитектуры.*</span><span class="sxs-lookup"><span data-stu-id="be5e6-109">*Download a [Visio file][visio-download] of this architecture.*</span></span>

## <a name="architecture"></a><span data-ttu-id="be5e6-110">Архитектура</span><span class="sxs-lookup"><span data-stu-id="be5e6-110">Architecture</span></span>

<span data-ttu-id="be5e6-111">Для подготовки виртуальной машины в Azure нужно больше подвижных частей, чем просто для ее создания.</span><span class="sxs-lookup"><span data-stu-id="be5e6-111">Provisioning a VM in Azure involves more moving parts than just the VM itself.</span></span> <span data-ttu-id="be5e6-112">К элементам, которые следует учитывать, относятся вычислительные и сетевые ресурсы, а также ресурсы хранилища.</span><span class="sxs-lookup"><span data-stu-id="be5e6-112">There are compute, networking, and storage elements that you need to consider.</span></span>

* <span data-ttu-id="be5e6-113">**Группа ресурсов.**</span><span class="sxs-lookup"><span data-stu-id="be5e6-113">**Resource group.**</span></span> <span data-ttu-id="be5e6-114">[*Группа ресурсов*][resource-manager-overview] представляет собой контейнер, содержащий связанные ресурсы.</span><span class="sxs-lookup"><span data-stu-id="be5e6-114">A [*resource group*][resource-manager-overview] is a container that holds related resources.</span></span> <span data-ttu-id="be5e6-115">Обычно вы создаете группы ресурсов, которые будут управлять ресурсами, для разных ресурсов в решении.</span><span class="sxs-lookup"><span data-stu-id="be5e6-115">You usually create resource groups for different resources in a solution based on their lifetime, and who will manage the resources.</span></span> <span data-ttu-id="be5e6-116">Для одной рабочей нагрузки виртуальной машины можно создать одну группу ресурсов для всех ресурсов.</span><span class="sxs-lookup"><span data-stu-id="be5e6-116">For a single VM workload, you may create a single resource group for all resources.</span></span>
* <span data-ttu-id="be5e6-117">**Виртуальная машина**.</span><span class="sxs-lookup"><span data-stu-id="be5e6-117">**VM**.</span></span> <span data-ttu-id="be5e6-118">Azure поддерживает ряд популярных дистрибутивов Linux, включая CentOS, Debian, Red Hat Enterprise, Ubuntu и FreeBSD.</span><span class="sxs-lookup"><span data-stu-id="be5e6-118">Azure supports running various popular Linux distributions, including CentOS, Debian, Red Hat Enterprise, Ubuntu, and FreeBSD.</span></span> <span data-ttu-id="be5e6-119">См. дополнительные сведения о [взаимодействии Azure и Linux][azure-linux].</span><span class="sxs-lookup"><span data-stu-id="be5e6-119">For more information, see [Azure and Linux][azure-linux].</span></span> <span data-ttu-id="be5e6-120">Виртуальную машину можно подготовить на основе списка опубликованных образов или файла виртуального жесткого диска (VHD), передав его в хранилище BLOB-объектов Azure.</span><span class="sxs-lookup"><span data-stu-id="be5e6-120">You can provision a VM from a list of published images or from a virtual hard disk (VHD) file that you upload to Azure Blob storage.</span></span>
* <span data-ttu-id="be5e6-121">**Диск ОС.**</span><span class="sxs-lookup"><span data-stu-id="be5e6-121">**OS disk.**</span></span> <span data-ttu-id="be5e6-122">Этот диск представляет собой VHD-файл, сохраненный в [службе хранилища Azure][azure-storage].</span><span class="sxs-lookup"><span data-stu-id="be5e6-122">The OS disk is a VHD stored in [Azure Storage][azure-storage].</span></span> <span data-ttu-id="be5e6-123">Это означает, что он сохранится, даже если хост-компьютер выйдет из строя.</span><span class="sxs-lookup"><span data-stu-id="be5e6-123">That means it persists even if the host machine goes down.</span></span> <span data-ttu-id="be5e6-124">Выберите диск операционной системы — `/dev/sda1`.</span><span class="sxs-lookup"><span data-stu-id="be5e6-124">The OS disk is `/dev/sda1`.</span></span>
* <span data-ttu-id="be5e6-125">**Временный диск.**</span><span class="sxs-lookup"><span data-stu-id="be5e6-125">**Temporary disk.**</span></span> <span data-ttu-id="be5e6-126">Виртуальная машина создается с временным диском.</span><span class="sxs-lookup"><span data-stu-id="be5e6-126">The VM is created with a temporary disk.</span></span> <span data-ttu-id="be5e6-127">Временный диск хранится на физическом диске хост-компьютера.</span><span class="sxs-lookup"><span data-stu-id="be5e6-127">This disk is stored on a physical drive on the host machine.</span></span> <span data-ttu-id="be5e6-128">Он *не* сохраняется в службе хранилища Azure и может быть удален во время перезагрузки и других событий жизненного цикла виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="be5e6-128">It is *not* saved in Azure Storage and might be deleted during reboots and other VM lifecycle events.</span></span> <span data-ttu-id="be5e6-129">Используйте этот диск только для временных данных, таких как данные страниц или файлы подкачки.</span><span class="sxs-lookup"><span data-stu-id="be5e6-129">Use this disk only for temporary data, such as page or swap files.</span></span> <span data-ttu-id="be5e6-130">Временный диск `/dev/sdb1` подключен к `/mnt/resource` или `/mnt`.</span><span class="sxs-lookup"><span data-stu-id="be5e6-130">The temporary disk is `/dev/sdb1` and is mounted at `/mnt/resource` or `/mnt`.</span></span>
* <span data-ttu-id="be5e6-131">**Диски данных.**</span><span class="sxs-lookup"><span data-stu-id="be5e6-131">**Data disks.**</span></span> <span data-ttu-id="be5e6-132">[Диск данных][data-disk] — это постоянный виртуальный жесткий диск, используемый для хранения данных приложений.</span><span class="sxs-lookup"><span data-stu-id="be5e6-132">A [data disk][data-disk] is a persistent VHD used for application data.</span></span> <span data-ttu-id="be5e6-133">Диски данных, такие как диск ОС, хранятся в службе хранилища Azure.</span><span class="sxs-lookup"><span data-stu-id="be5e6-133">Data disks are stored in Azure Storage, like the OS disk.</span></span>
* <span data-ttu-id="be5e6-134">**Виртуальная сеть и подсеть.**</span><span class="sxs-lookup"><span data-stu-id="be5e6-134">**Virtual network (VNet) and subnet.**</span></span> <span data-ttu-id="be5e6-135">Каждая виртуальная машина в Azure развертывается в виртуальной сети, а виртуальные сети разделяются на подсети.</span><span class="sxs-lookup"><span data-stu-id="be5e6-135">Every VM in Azure is deployed into a VNet that is further divided into subnets.</span></span>
* <span data-ttu-id="be5e6-136">**Общедоступный IP-адрес.**</span><span class="sxs-lookup"><span data-stu-id="be5e6-136">**Public IP address.**</span></span> <span data-ttu-id="be5e6-137">Общедоступный IP-адрес используется для обмена данных с виртуальной машиной &mdash;, например, по протоколу SSH.</span><span class="sxs-lookup"><span data-stu-id="be5e6-137">A public IP address is needed to communicate with the VM &mdash; for example, via SSH.</span></span>
* <span data-ttu-id="be5e6-138">**Сетевой интерфейс (сетевой адаптер)**.</span><span class="sxs-lookup"><span data-stu-id="be5e6-138">**Network interface (NIC)**.</span></span> <span data-ttu-id="be5e6-139">Сетевой адаптер обеспечивает взаимодействие виртуальной машины и виртуальной сети.</span><span class="sxs-lookup"><span data-stu-id="be5e6-139">The NIC enables the VM to communicate with the virtual network.</span></span>
* <span data-ttu-id="be5e6-140">**Группа безопасности сети**.</span><span class="sxs-lookup"><span data-stu-id="be5e6-140">**Network security group (NSG)**.</span></span> <span data-ttu-id="be5e6-141">[Группа безопасности сети][nsg] разрешает или запрещает прохождение сетевого трафика к подсети.</span><span class="sxs-lookup"><span data-stu-id="be5e6-141">The [NSG][nsg] is used to allow/deny network traffic to the subnet.</span></span> <span data-ttu-id="be5e6-142">Группу безопасности сети можно связать с отдельной сетевой картой или подсетью.</span><span class="sxs-lookup"><span data-stu-id="be5e6-142">You can associate an NSG with an individual NIC or with a subnet.</span></span> <span data-ttu-id="be5e6-143">Если она связывается с подсетью, то правила этой группы безопасности сети применяются ко всем виртуальным машинам в подсети.</span><span class="sxs-lookup"><span data-stu-id="be5e6-143">If you associate it with a subnet, the NSG rules apply to all VMs in that subnet.</span></span>
* <span data-ttu-id="be5e6-144">**Диагностика.**</span><span class="sxs-lookup"><span data-stu-id="be5e6-144">**Diagnostics.**</span></span> <span data-ttu-id="be5e6-145">Ведение журналов диагностики очень важно для устранения неполадок виртуальной машины и управления ею.</span><span class="sxs-lookup"><span data-stu-id="be5e6-145">Diagnostic logging is crucial for managing and troubleshooting the VM.</span></span>

## <a name="recommendations"></a><span data-ttu-id="be5e6-146">Рекомендации</span><span class="sxs-lookup"><span data-stu-id="be5e6-146">Recommendations</span></span>

<span data-ttu-id="be5e6-147">В архитектуре показаны базовые рекомендации для запуска виртуальной машины Linux в Azure.</span><span class="sxs-lookup"><span data-stu-id="be5e6-147">This architecture shows the baseline recommendations for running a Linux VM in Azure.</span></span> <span data-ttu-id="be5e6-148">Однако мы не рекомендуем использовать одну виртуальную машину для критически важных рабочих нагрузок, так как на ней создается единая точка отказа.</span><span class="sxs-lookup"><span data-stu-id="be5e6-148">However, we don't recommend using a single VM for mission critical workloads because it creates a single point of failure.</span></span> <span data-ttu-id="be5e6-149">Для повышения уровня доступности разверните несколько виртуальных машин в [группе доступности][availability-set].</span><span class="sxs-lookup"><span data-stu-id="be5e6-149">For higher availability, deploy multiple VMs in an [availability set][availability-set].</span></span> <span data-ttu-id="be5e6-150">Дополнительные сведения см. в статье [Running multiple VMs on Azure for scalability and availability][multi-vm] (Запуск нескольких виртуальных машин в Azure для обеспечения масштабируемости и доступности).</span><span class="sxs-lookup"><span data-stu-id="be5e6-150">For more information, see [Running multiple VMs on Azure][multi-vm].</span></span> 

### <a name="vm-recommendations"></a><span data-ttu-id="be5e6-151">Рекомендации по виртуальным машинам</span><span class="sxs-lookup"><span data-stu-id="be5e6-151">VM recommendations</span></span>

<span data-ttu-id="be5e6-152">Azure предлагает виртуальные машины различных размеров, но мы советуем использовать виртуальные машины серий DS и GS, так как они поддерживают [хранилище класса Premium][premium-storage].</span><span class="sxs-lookup"><span data-stu-id="be5e6-152">Azure offers many different virtual machine sizes, but we recommend the DS- and GS-series because these machine sizes support [Premium Storage][premium-storage].</span></span> <span data-ttu-id="be5e6-153">Если отсутствует специализированная рабочая нагрузка, например высокопроизводительные вычисления, выберите виртуальную машину одного из этих размеров.</span><span class="sxs-lookup"><span data-stu-id="be5e6-153">Select one of these machine sizes unless you have a specialized workload such as high-performance computing.</span></span> <span data-ttu-id="be5e6-154">Дополнительную информацию см. в статье [Размеры виртуальных машин в Azure][virtual-machine-sizes].</span><span class="sxs-lookup"><span data-stu-id="be5e6-154">For details, see [virtual machine sizes][virtual-machine-sizes].</span></span>

<span data-ttu-id="be5e6-155">При перемещении имеющейся рабочей нагрузки в Azure выберите начальный размер виртуальной машины, который точнее всего соответствует характеристикам локальных серверов.</span><span class="sxs-lookup"><span data-stu-id="be5e6-155">If you are moving an existing workload to Azure, start with the VM size that's the closest match to your on-premises servers.</span></span> <span data-ttu-id="be5e6-156">Затем измерьте производительность фактической рабочей нагрузки по таким ресурсам, как потребление ЦП, памяти и дисковых операций ввода-вывода в секунду, и при необходимости измените размер виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="be5e6-156">Then measure the performance of your actual workload with respect to CPU, memory, and disk input/output operations per second (IOPS), and adjust the size if needed.</span></span> <span data-ttu-id="be5e6-157">Если требуется несколько сетевых адаптеров для виртуальной машины, помните, что их максимально возможное количество зависит от [размера виртуальной машины][vm-size-tables].</span><span class="sxs-lookup"><span data-stu-id="be5e6-157">If you require multiple NICs for your VM, be aware that the maximum number of NICs is a function of the [VM size][vm-size-tables].</span></span>

<span data-ttu-id="be5e6-158">При подготовке виртуальной машины и других ресурсов необходимо указать регион.</span><span class="sxs-lookup"><span data-stu-id="be5e6-158">When you provision the VM and other resources, you must specify a region.</span></span> <span data-ttu-id="be5e6-159">Обычно следует выбирать ближайший регион к месту расположения внутренних пользователей или клиентов.</span><span class="sxs-lookup"><span data-stu-id="be5e6-159">Generally, choose a region closest to your internal users or customers.</span></span> <span data-ttu-id="be5e6-160">Но некоторые размеры виртуальных машин доступны не для всех регионов.</span><span class="sxs-lookup"><span data-stu-id="be5e6-160">However, not all VM sizes may be available in all region.</span></span> <span data-ttu-id="be5e6-161">Дополнительные сведения см. на странице [доступности служб по регионам][services-by-region].</span><span class="sxs-lookup"><span data-stu-id="be5e6-161">For details, see [Services by region][services-by-region].</span></span> <span data-ttu-id="be5e6-162">Чтобы получить список размеров виртуальных машин, доступных в конкретном регионе, выполните следующую команду в интерфейсе командной строки Azure (Azure CLI).</span><span class="sxs-lookup"><span data-stu-id="be5e6-162">To list the VM sizes available in a specific region, run the following Azure command-line interface (CLI) command:</span></span>

```
az vm list-sizes --location <location>
```

<span data-ttu-id="be5e6-163">Дополнительные сведения о том, как выбрать опубликованный образ виртуальной машины, см. в статье [Выбор образов виртуальных машин Linux с помощью интерфейса командной строки Azure (Azure CLI)][select-vm-image].</span><span class="sxs-lookup"><span data-stu-id="be5e6-163">For information about choosing a published VM image, see [Select Linux VM images with the Azure CLI][select-vm-image].</span></span>

<span data-ttu-id="be5e6-164">Включите мониторинг и диагностику, в том числе базовые метрики работоспособности, а также ведение журналов инфраструктуры диагностики и [диагностику загрузки][boot-diagnostics].</span><span class="sxs-lookup"><span data-stu-id="be5e6-164">Enable monitoring and diagnostics, including basic health metrics, diagnostics infrastructure logs, and [boot diagnostics][boot-diagnostics].</span></span> <span data-ttu-id="be5e6-165">Если виртуальную машину невозможно загрузить, для обнаружения неисправностей можно использовать диагностику загрузки.</span><span class="sxs-lookup"><span data-stu-id="be5e6-165">Boot diagnostics can help you diagnose boot failure if your VM gets into a non-bootable state.</span></span> <span data-ttu-id="be5e6-166">Дополнительные сведения см. в статье [Включение мониторинга и диагностики][enable-monitoring].</span><span class="sxs-lookup"><span data-stu-id="be5e6-166">For more information, see [Enable monitoring and diagnostics][enable-monitoring].</span></span>  

### <a name="disk-and-storage-recommendations"></a><span data-ttu-id="be5e6-167">Рекомендации по дискам и хранилищам</span><span class="sxs-lookup"><span data-stu-id="be5e6-167">Disk and storage recommendations</span></span>

<span data-ttu-id="be5e6-168">Чтобы обеспечить оптимальную производительность дисковых операций ввода-вывода, рекомендуем использовать [хранилище класса Premium][premium-storage], в котором данные хранятся на твердотельных накопителях (SSD).</span><span class="sxs-lookup"><span data-stu-id="be5e6-168">For best disk I/O performance, we recommend [Premium Storage][premium-storage], which stores data on solid-state drives (SSDs).</span></span> <span data-ttu-id="be5e6-169">Цена зависит от размера подготовленного диска.</span><span class="sxs-lookup"><span data-stu-id="be5e6-169">Cost is based on the size of the provisioned disk.</span></span> <span data-ttu-id="be5e6-170">Скорость выполнения операций ввода-вывода и пропускная способность (т. е. скорость передачи данных) также зависят от размера диска. Поэтому во время подготовки диска следует учитывать все эти факторы.</span><span class="sxs-lookup"><span data-stu-id="be5e6-170">IOPS and throughput (that is, data transfer rate) also depend on disk size, so when you provision a disk, consider all three factors (capacity, IOPS, and throughput).</span></span> 

<span data-ttu-id="be5e6-171">Мы также рекомендуем использовать [управляемые диски](/azure/storage/storage-managed-disks-overview).</span><span class="sxs-lookup"><span data-stu-id="be5e6-171">We also recommend the use of [managed disks](/azure/storage/storage-managed-disks-overview).</span></span> <span data-ttu-id="be5e6-172">Управляемым дискам не требуется учетная запись хранения.</span><span class="sxs-lookup"><span data-stu-id="be5e6-172">Managed disks do not require a storage account.</span></span> <span data-ttu-id="be5e6-173">Просто укажите размер и тип диска, и он будет развернут в качестве высокодоступного.</span><span class="sxs-lookup"><span data-stu-id="be5e6-173">You simply specify the size and type of disk and it is deployed in a highly available way.</span></span>

<span data-ttu-id="be5e6-174">Если вы не используете управляемые диски, создайте отдельные учетные записи хранения Azure для виртуальных жестких дисков каждой виртуальной машины, чтобы не превышать ограничения по операциям ввода-вывода для учетных записей хранения.</span><span class="sxs-lookup"><span data-stu-id="be5e6-174">If you are not using managed disks, create separate Azure storage accounts for each VM to hold the virtual hard disks (VHDs) in order to avoid hitting the IOPS limits for storage accounts.</span></span>

<span data-ttu-id="be5e6-175">Добавьте один или несколько дисков данных.</span><span class="sxs-lookup"><span data-stu-id="be5e6-175">Add one or more data disks.</span></span> <span data-ttu-id="be5e6-176">Создаваемый диск VHD не форматируется.</span><span class="sxs-lookup"><span data-stu-id="be5e6-176">When you create a VHD, it is unformatted.</span></span> <span data-ttu-id="be5e6-177">Чтобы отформатировать диск, войдите на виртуальную машину.</span><span class="sxs-lookup"><span data-stu-id="be5e6-177">Log in to the VM to format the disk.</span></span> <span data-ttu-id="be5e6-178">В оболочке Linux диски данных отображаются как `/dev/sdc`, `/dev/sdd` и т. д.</span><span class="sxs-lookup"><span data-stu-id="be5e6-178">In the Linux shell, data disks are displayed as `/dev/sdc`, `/dev/sdd`, and so on.</span></span> <span data-ttu-id="be5e6-179">Можно выполнить `lsblk` , чтобы вывести список блочных устройств, включая диски.</span><span class="sxs-lookup"><span data-stu-id="be5e6-179">You can run `lsblk` to list the block devices, including the disks.</span></span> <span data-ttu-id="be5e6-180">Чтобы использовать диск данных, создайте раздел и файловую систему, а затем подключите этот диск.</span><span class="sxs-lookup"><span data-stu-id="be5e6-180">To use a data disk, create a partition and file system, and mount the disk.</span></span> <span data-ttu-id="be5e6-181">Например:</span><span class="sxs-lookup"><span data-stu-id="be5e6-181">For example:</span></span>

```bat
# Create a partition.
sudo fdisk /dev/sdc     # Enter 'n' to partition, 'w' to write the change.

# Create a file system.
sudo mkfs -t ext3 /dev/sdc1

# Mount the drive.
sudo mkdir /data1
sudo mount /dev/sdc1 /data1
```

<span data-ttu-id="be5e6-182">Если вы не используете [управляемые диски](/azure/storage/storage-managed-disks-overview) и имеете большое количество дисков данных, учитывайте общие ограничения на количество операций ввода-вывода для учетной записи хранения.</span><span class="sxs-lookup"><span data-stu-id="be5e6-182">If you are not using [managed disks](/azure/storage/storage-managed-disks-overview) and have a large number of data disks, be aware of the total I/O limits of the storage account.</span></span> <span data-ttu-id="be5e6-183">Дополнительные сведения см. в разделе [Ограничения для дисков виртуальной машины][vm-disk-limits].</span><span class="sxs-lookup"><span data-stu-id="be5e6-183">For more information, see [virtual machine disk limits][vm-disk-limits].</span></span>

<span data-ttu-id="be5e6-184">При добавлении диска данных ему назначается логический номер устройства (LUN).</span><span class="sxs-lookup"><span data-stu-id="be5e6-184">When you add a data disk, a logical unit number (LUN) ID is assigned to the disk.</span></span> <span data-ttu-id="be5e6-185">При необходимости можно указать идентификатор LUN &mdash; например, если при замене диска нужно сохранить тот же идентификатор LUN или если у вас есть приложение, которое ищет определенный идентификатор LUN.</span><span class="sxs-lookup"><span data-stu-id="be5e6-185">Optionally, you can specify the LUN ID &mdash; for example, if you're replacing a disk and want to retain the same LUN ID, or you have an application that looks for a specific LUN ID.</span></span> <span data-ttu-id="be5e6-186">Однако следует помнить, что идентификаторы LUN для каждого диска должны быть уникальными.</span><span class="sxs-lookup"><span data-stu-id="be5e6-186">However, remember that LUN IDs must be unique for each disk.</span></span>

<span data-ttu-id="be5e6-187">Возможно, вам нужно изменить планировщик операций ввода-вывода, чтобы оптимизировать производительность твердотельных накопителей (используемых с учетными записями хранения класса Premium для виртуальных машин).</span><span class="sxs-lookup"><span data-stu-id="be5e6-187">You may want to change the I/O scheduler to optimize for performance on SSDs because the disks for VMs with premium storage accounts are SSDs.</span></span> <span data-ttu-id="be5e6-188">Обычно для SSD рекомендуется использовать планировщик NOOP, но для мониторинга производительности дискового ввода-вывода рабочей нагрузки следует использовать такой инструмент, как [iostat].</span><span class="sxs-lookup"><span data-stu-id="be5e6-188">A common recommendation is to use the NOOP scheduler for SSDs, but you should use a tool such as [iostat] to monitor disk I/O performance for your workload.</span></span>

<span data-ttu-id="be5e6-189">Для повышения производительности храните журналы диагностики в отдельной учетной записи хранения.</span><span class="sxs-lookup"><span data-stu-id="be5e6-189">For best performance, create a separate storage account to hold diagnostic logs.</span></span> <span data-ttu-id="be5e6-190">Учетной записи локально избыточного хранилища достаточно для хранения журналов диагностики.</span><span class="sxs-lookup"><span data-stu-id="be5e6-190">A standard locally redundant storage (LRS) account is sufficient for diagnostic logs.</span></span>

### <a name="network-recommendations"></a><span data-ttu-id="be5e6-191">Рекомендации по сети</span><span class="sxs-lookup"><span data-stu-id="be5e6-191">Network recommendations</span></span>

<span data-ttu-id="be5e6-192">Общедоступный IP-адрес может быть динамическим или статическим.</span><span class="sxs-lookup"><span data-stu-id="be5e6-192">The public IP address can be dynamic or static.</span></span> <span data-ttu-id="be5e6-193">По умолчанию используется динамический IP-адрес.</span><span class="sxs-lookup"><span data-stu-id="be5e6-193">The default is dynamic.</span></span>

* <span data-ttu-id="be5e6-194">Зарезервируйте [статический IP-адрес][static-ip], если вам нужен постоянный IP-адрес &mdash; например, для создания записи А в DNS или добавления IP-адреса в список надежных отправителей.</span><span class="sxs-lookup"><span data-stu-id="be5e6-194">Reserve a [static IP address][static-ip] if you need a fixed IP address that won't change &mdash; for example, if you need to create an A record in DNS, or need the IP address to be added to a safe list.</span></span>
* <span data-ttu-id="be5e6-195">Можно также создать полное доменное имя для IP-адреса.</span><span class="sxs-lookup"><span data-stu-id="be5e6-195">You can also create a fully qualified domain name (FQDN) for the IP address.</span></span> <span data-ttu-id="be5e6-196">Затем вы сможете зарегистрировать в DNS [запись CNAME][cname-record], которая указывает на полное доменное имя.</span><span class="sxs-lookup"><span data-stu-id="be5e6-196">You can then register a [CNAME record][cname-record] in DNS that points to the FQDN.</span></span> <span data-ttu-id="be5e6-197">Дополнительные сведения см. в статье [Создание полного доменного имени на портале Azure][fqdn].</span><span class="sxs-lookup"><span data-stu-id="be5e6-197">For more information, see [create a fully qualified domain name in the Azure portal][fqdn].</span></span>

<span data-ttu-id="be5e6-198">Все группы безопасности сети содержат набор [правил по умолчанию][nsg-default-rules], включая правило, которое блокирует весь входящий интернет-трафик.</span><span class="sxs-lookup"><span data-stu-id="be5e6-198">All NSGs contain a set of [default rules][nsg-default-rules], including a rule that blocks all inbound Internet traffic.</span></span> <span data-ttu-id="be5e6-199">Правила по умолчанию нельзя удалить, но их можно переопределить другими правилами.</span><span class="sxs-lookup"><span data-stu-id="be5e6-199">The default rules cannot be deleted, but other rules can override them.</span></span> <span data-ttu-id="be5e6-200">Чтобы разрешить интернет-трафик, создайте правила, разрешающие входящий трафик для определенных портов &mdash; например, это может быть порт 80 для протокола HTTP.</span><span class="sxs-lookup"><span data-stu-id="be5e6-200">To enable Internet traffic, create rules that allow inbound traffic to specific ports &mdash; for example, port 80 for HTTP.</span></span>

<span data-ttu-id="be5e6-201">Чтобы включить доступ по протоколу SSH, добавьте в группу безопасности сети правило, которое разрешает входящий трафик через TCP-порт 22.</span><span class="sxs-lookup"><span data-stu-id="be5e6-201">To enable SSH, add a rule to the NSG that allows inbound traffic to TCP port 22.</span></span>

## <a name="scalability-considerations"></a><span data-ttu-id="be5e6-202">Вопросы масштабируемости</span><span class="sxs-lookup"><span data-stu-id="be5e6-202">Scalability considerations</span></span>

<span data-ttu-id="be5e6-203">Размер виртуальной машины можно [увеличивать и уменьшать][vm-resize].</span><span class="sxs-lookup"><span data-stu-id="be5e6-203">You can scale a VM up or down by [changing the VM size][vm-resize].</span></span> <span data-ttu-id="be5e6-204">Для горизонтального развертывания разместите две или больше виртуальных машин за подсистемой балансировки нагрузки.</span><span class="sxs-lookup"><span data-stu-id="be5e6-204">To scale out horizontally, put two or more VMs behind a load balancer.</span></span> <span data-ttu-id="be5e6-205">Подробные сведения см. в статье [Running multiple VMs on Azure for scalability and availability][multi-vm] (Использование нескольких виртуальных машин в Azure для обеспечения масштабируемости и доступности).</span><span class="sxs-lookup"><span data-stu-id="be5e6-205">For details, see [Running multiple VMs on Azure for scalability and availability][multi-vm].</span></span>

## <a name="availability-considerations"></a><span data-ttu-id="be5e6-206">Вопросы доступности</span><span class="sxs-lookup"><span data-stu-id="be5e6-206">Availability considerations</span></span>

<span data-ttu-id="be5e6-207">Для повышения уровня доступности разверните несколько виртуальных машин в группе доступности.</span><span class="sxs-lookup"><span data-stu-id="be5e6-207">For higher availability, deploy multiple VMs in an availability set.</span></span> <span data-ttu-id="be5e6-208">Это также позволит использовать дополнительные услуги в рамках [соглашения об уровне обслуживания][vm-sla].</span><span class="sxs-lookup"><span data-stu-id="be5e6-208">This also provides a higher [service level agreement][vm-sla]  (SLA).</span></span>

<span data-ttu-id="be5e6-209">На виртуальную машину могут влиять процедуры [планового][planned-maintenance] и [внепланового технического обслуживания][manage-vm-availability].</span><span class="sxs-lookup"><span data-stu-id="be5e6-209">Your VM may be affected by [planned maintenance][planned-maintenance] or [unplanned maintenance][manage-vm-availability].</span></span> <span data-ttu-id="be5e6-210">Чтобы определить, вызвана ли перезагрузка плановым техническим обслуживанием, изучите [журналы перезагрузки виртуальной машины][reboot-logs].</span><span class="sxs-lookup"><span data-stu-id="be5e6-210">You can use [VM reboot logs][reboot-logs] to determine whether a VM reboot was caused by planned maintenance.</span></span>

<span data-ttu-id="be5e6-211">Виртуальные жесткие диски хранятся в [службе хранилища Azure][azure-storage], которая реплицируется для обеспечения надежности и доступности.</span><span class="sxs-lookup"><span data-stu-id="be5e6-211">VHDs are stored in [Azure storage][azure-storage], and Azure storage is replicated for durability and availability.</span></span>

<span data-ttu-id="be5e6-212">Чтобы избежать случайной потери данных во время обычной работы (например, из-за ошибки пользователя), следует реализовать создание резервных копий на определенный момент времени с помощью [моментальных снимков больших двоичных объектов][blob-snapshot] или других инструментов.</span><span class="sxs-lookup"><span data-stu-id="be5e6-212">To protect against accidental data loss during normal operations (for example, because of user error), you should also implement point-in-time backups, using [blob snapshots][blob-snapshot] or another tool.</span></span>

## <a name="manageability-considerations"></a><span data-ttu-id="be5e6-213">Вопросы управляемости</span><span class="sxs-lookup"><span data-stu-id="be5e6-213">Manageability considerations</span></span>

<span data-ttu-id="be5e6-214">**Группы ресурсов.**</span><span class="sxs-lookup"><span data-stu-id="be5e6-214">**Resource groups.**</span></span> <span data-ttu-id="be5e6-215">Поместите тесно связанные ресурсы с одинаковым жизненным циклом в одну [группу ресурсов][resource-manager-overview].</span><span class="sxs-lookup"><span data-stu-id="be5e6-215">Put tightly coupled resources that share the same life cycle into the same [resource group][resource-manager-overview].</span></span> <span data-ttu-id="be5e6-216">Группы ресурсов позволяют развертывать и отслеживать ресурсы в виде группы и получать сводные счета за затраты на группу ресурсов.</span><span class="sxs-lookup"><span data-stu-id="be5e6-216">Resource groups allow you to deploy and monitor resources as a group, and roll up billing costs by resource group.</span></span> <span data-ttu-id="be5e6-217">Можно также удалить ресурсы в виде набора, что очень удобно для тестирования развернутых служб.</span><span class="sxs-lookup"><span data-stu-id="be5e6-217">You can also delete resources as a set, which is very useful for test deployments.</span></span> <span data-ttu-id="be5e6-218">Присваивайте ресурсам информативные имена.</span><span class="sxs-lookup"><span data-stu-id="be5e6-218">Give resources meaningful names.</span></span> <span data-ttu-id="be5e6-219">Это упростит поиск определенного ресурса и понимание его роли.</span><span class="sxs-lookup"><span data-stu-id="be5e6-219">That makes it easier to locate a specific resource and understand its role.</span></span> <span data-ttu-id="be5e6-220">См. статью [Recommended naming conventions for Azure resources][naming conventions] (Рекомендуемые соглашения об именовании для ресурсов Azure).</span><span class="sxs-lookup"><span data-stu-id="be5e6-220">See [Recommended Naming Conventions for Azure Resources][naming conventions].</span></span>

<span data-ttu-id="be5e6-221">**SSH.**</span><span class="sxs-lookup"><span data-stu-id="be5e6-221">**SSH**.</span></span> <span data-ttu-id="be5e6-222">Перед созданием виртуальной машины Linux создайте парные 2048-разрядные ключи RSA (открытый и закрытый).</span><span class="sxs-lookup"><span data-stu-id="be5e6-222">Before you create a Linux VM, generate a 2048-bit RSA public-private key pair.</span></span> <span data-ttu-id="be5e6-223">При создании виртуальной машины используйте файл открытого ключа.</span><span class="sxs-lookup"><span data-stu-id="be5e6-223">Use the public key file when you create the VM.</span></span> <span data-ttu-id="be5e6-224">Дополнительные сведения см. в статье [Создание пары из открытого и закрытого ключей SSH для виртуальных машин Linux][ssh-linux].</span><span class="sxs-lookup"><span data-stu-id="be5e6-224">For more information, see [How to Use SSH with Linux and Mac on Azure][ssh-linux].</span></span>

<span data-ttu-id="be5e6-225">**Остановка виртуальной машины.**</span><span class="sxs-lookup"><span data-stu-id="be5e6-225">**Stopping a VM.**</span></span> <span data-ttu-id="be5e6-226">Azure различает состояния "Остановлена" и "Освобождена".</span><span class="sxs-lookup"><span data-stu-id="be5e6-226">Azure makes a distinction between "stopped" and "deallocated" states.</span></span> <span data-ttu-id="be5e6-227">Вы оплачиваете использование остановленных виртуальных машин, но не оплачиваете освобожденные виртуальные машины.</span><span class="sxs-lookup"><span data-stu-id="be5e6-227">You are charged when the VM status is stopped, but not when the VM is deallocated.</span></span> 

<span data-ttu-id="be5e6-228">Также это можно сделать с помощью кнопки **Прервать** на портале Azure.</span><span class="sxs-lookup"><span data-stu-id="be5e6-228">In the Azure portal, the **Stop** button deallocates the VM.</span></span> <span data-ttu-id="be5e6-229">Если вы войдете в виртуальную машину и завершите работу операционной системы, виртуальная машина будет остановлена, а *не* освобождена, поэтому с вас по-прежнему будет взиматься плата.</span><span class="sxs-lookup"><span data-stu-id="be5e6-229">If you shut down through the OS while logged in, the VM is stopped but *not* deallocated, so you will still be charged.</span></span> 

<span data-ttu-id="be5e6-230">**Удаление виртуальной машины.**</span><span class="sxs-lookup"><span data-stu-id="be5e6-230">**Deleting a VM.**</span></span> <span data-ttu-id="be5e6-231">Если вы удалите виртуальную машину, виртуальные жесткие диски останутся.</span><span class="sxs-lookup"><span data-stu-id="be5e6-231">If you delete a VM, the VHDs are not deleted.</span></span> <span data-ttu-id="be5e6-232">Это означает, что вы можете удалить виртуальную машину без потери данных.</span><span class="sxs-lookup"><span data-stu-id="be5e6-232">That means you can safely delete the VM without losing data.</span></span> <span data-ttu-id="be5e6-233">Тем не менее плата за хранение по-прежнему будет взиматься.</span><span class="sxs-lookup"><span data-stu-id="be5e6-233">However, you will still be charged for storage.</span></span> <span data-ttu-id="be5e6-234">Чтобы удалить виртуальный жесткий диск, удалите соответствующий файл из [хранилища BLOB-объектов][blob-storage].</span><span class="sxs-lookup"><span data-stu-id="be5e6-234">To delete the VHD, delete the file from [Blob storage][blob-storage].</span></span>

<span data-ttu-id="be5e6-235">Для предотвращения случайного удаления используйте [блокировку ресурсов][resource-lock], чтобы заблокировать всю группу или отдельные ресурсы (например, виртуальную машину).</span><span class="sxs-lookup"><span data-stu-id="be5e6-235">To prevent accidental deletion, use a [resource lock][resource-lock] to lock the entire resource group or lock individual resources, such as the VM.</span></span>

## <a name="security-considerations"></a><span data-ttu-id="be5e6-236">Вопросы безопасности</span><span class="sxs-lookup"><span data-stu-id="be5e6-236">Security considerations</span></span>

<span data-ttu-id="be5e6-237">Благодаря [центру безопасности Azure][security-center] можно получить полное представление о состоянии безопасности ваших ресурсов Azure.</span><span class="sxs-lookup"><span data-stu-id="be5e6-237">Use [Azure Security Center][security-center] to get a central view of the security state of your Azure resources.</span></span> <span data-ttu-id="be5e6-238">Центр безопасности отслеживает потенциальные проблемы безопасности, а также обеспечивает полное представление о состоянии системы безопасности развертывания.</span><span class="sxs-lookup"><span data-stu-id="be5e6-238">Security Center monitors potential security issues and provides a comprehensive picture of the security health of your deployment.</span></span> <span data-ttu-id="be5e6-239">Центр безопасности настраивается на уровне подписки Azure.</span><span class="sxs-lookup"><span data-stu-id="be5e6-239">Security Center is configured per Azure subscription.</span></span> <span data-ttu-id="be5e6-240">Включите сбор данных безопасности, как описано в статье [Краткое руководство по центру безопасности Azure][security-center-get-started].</span><span class="sxs-lookup"><span data-stu-id="be5e6-240">Enable security data collection as described in [Azure Security Center quick start guide][security-center-get-started].</span></span> <span data-ttu-id="be5e6-241">Когда сбор данных включен, центр безопасности автоматически проверяет все виртуальные машины, созданные для этой подписки.</span><span class="sxs-lookup"><span data-stu-id="be5e6-241">When data collection is enabled, Security Center automatically scans any VMs created under that subscription.</span></span>

<span data-ttu-id="be5e6-242">**Управление исправлениями.**</span><span class="sxs-lookup"><span data-stu-id="be5e6-242">**Patch management.**</span></span> <span data-ttu-id="be5e6-243">Если эта функция включена, то Центр безопасности проверяет, отсутствуют ли какие-либо обновления для системы безопасности и критические обновления.</span><span class="sxs-lookup"><span data-stu-id="be5e6-243">If enabled, Security Center checks whether security and critical updates are missing.</span></span> 

<span data-ttu-id="be5e6-244">**Защита от вредоносных программ.**</span><span class="sxs-lookup"><span data-stu-id="be5e6-244">**Antimalware.**</span></span> <span data-ttu-id="be5e6-245">Если эта функция включена, то Центр безопасности проверяет, установлена ли антивредоносное ПО.</span><span class="sxs-lookup"><span data-stu-id="be5e6-245">If enabled, Security Center checks whether antimalware software is installed.</span></span> <span data-ttu-id="be5e6-246">Центр безопасности позволяет также установить антивредоносное ПО с помощью портала Azure.</span><span class="sxs-lookup"><span data-stu-id="be5e6-246">You can also use Security Center to install antimalware software from inside the Azure portal.</span></span>

<span data-ttu-id="be5e6-247">**Операции.**</span><span class="sxs-lookup"><span data-stu-id="be5e6-247">**Operations.**</span></span> <span data-ttu-id="be5e6-248">Используйте [управление доступом на основе ролей][rbac] (RBAC) для управления доступом к развертываемым ресурсам Azure.</span><span class="sxs-lookup"><span data-stu-id="be5e6-248">Use [role-based access control][rbac] (RBAC) to control access to the Azure resources that you deploy.</span></span> <span data-ttu-id="be5e6-249">RBAC позволяет назначить роли авторизации участникам команды DevOps.</span><span class="sxs-lookup"><span data-stu-id="be5e6-249">RBAC lets you assign authorization roles to members of your DevOps team.</span></span> <span data-ttu-id="be5e6-250">Например, роль "Читатель" позволяет просматривать ресурсы Azure, но не позволяет создавать и удалять их или управлять ими.</span><span class="sxs-lookup"><span data-stu-id="be5e6-250">For example, the Reader role can view Azure resources but not create, manage, or delete them.</span></span> <span data-ttu-id="be5e6-251">Некоторые роли относятся к определенным типам ресурсов Azure.</span><span class="sxs-lookup"><span data-stu-id="be5e6-251">Some roles are specific to particular Azure resource types.</span></span> <span data-ttu-id="be5e6-252">Например, роль "Участник виртуальных машин" позволяет перезапустить виртуальную машину или отменить ее выделение, сбросить пароль администратора, создать новую виртуальную машину и т. д.</span><span class="sxs-lookup"><span data-stu-id="be5e6-252">For example, the Virtual Machine Contributor role can restart or deallocate a VM, reset the administrator password, create a new VM, and so forth.</span></span> <span data-ttu-id="be5e6-253">Для этой архитектуры могут оказаться полезными и другие [встроенные роли RBAC][rbac-roles], например [Пользователь DevTest Labs][rbac-devtest] и [Участник сетей][rbac-network].</span><span class="sxs-lookup"><span data-stu-id="be5e6-253">Other [built-in RBAC roles][rbac-roles] that might be useful for this architecture include [DevTest Labs User][rbac-devtest] and [Network Contributor][rbac-network].</span></span> <span data-ttu-id="be5e6-254">Пользователю можно назначить несколько ролей. Можно также создать пользовательские роли, чтобы более детально настроить разрешения.</span><span class="sxs-lookup"><span data-stu-id="be5e6-254">A user can be assigned to multiple roles, and you can create custom roles for even more fine-grained permissions.</span></span>

> [!NOTE]
> <span data-ttu-id="be5e6-255">RBAC не ограничивает действия, которые может выполнять пользователь, вошедший в виртуальную машину.</span><span class="sxs-lookup"><span data-stu-id="be5e6-255">RBAC does not limit the actions that a user logged into a VM can perform.</span></span> <span data-ttu-id="be5e6-256">Эти разрешения определяются типом учетной записи в гостевой ОС.</span><span class="sxs-lookup"><span data-stu-id="be5e6-256">Those permissions are determined by the account type on the guest OS.</span></span>   

<span data-ttu-id="be5e6-257">Просматривать действия по подготовке и другие события для виртуальной машины можно с помощью [журналов аудита][audit-logs].</span><span class="sxs-lookup"><span data-stu-id="be5e6-257">Use [audit logs][audit-logs] to see provisioning actions and other VM events.</span></span>

<span data-ttu-id="be5e6-258">**Шифрование данных.**</span><span class="sxs-lookup"><span data-stu-id="be5e6-258">**Data encryption.**</span></span> <span data-ttu-id="be5e6-259">Если нужно шифровать диски ОС и диски данных, рекомендуем применить [шифрование дисков Azure][disk-encryption].</span><span class="sxs-lookup"><span data-stu-id="be5e6-259">Consider [Azure Disk Encryption][disk-encryption] if you need to encrypt the OS and data disks.</span></span> 

## <a name="deploy-the-solution"></a><span data-ttu-id="be5e6-260">Развертывание решения</span><span class="sxs-lookup"><span data-stu-id="be5e6-260">Deploy the solution</span></span>

<span data-ttu-id="be5e6-261">Пример развертывания для этой архитектуры можно найти на портале [GitHub][github-folder].</span><span class="sxs-lookup"><span data-stu-id="be5e6-261">A deployment for this architecture is available on [GitHub][github-folder].</span></span> <span data-ttu-id="be5e6-262">Он позволяет развернуть следующее:</span><span class="sxs-lookup"><span data-stu-id="be5e6-262">It deploys the following:</span></span>

  * <span data-ttu-id="be5e6-263">Виртуальную сеть с одной подсетью, называющейся **web**, которая используется для размещения виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="be5e6-263">A virtual network with a single subnet named **web** used to host the VM.</span></span>
  * <span data-ttu-id="be5e6-264">Группу безопасности сети с двумя правилами для входящего трафика, позволяющими передавать HTTP- и SSH-трафик в виртуальную машину.</span><span class="sxs-lookup"><span data-stu-id="be5e6-264">An NSG with two incoming rules to allow SSH and HTTP traffic to the VM.</span></span>
  * <span data-ttu-id="be5e6-265">Виртуальную машину, на которой выполняется последняя версия Ubuntu 16.04.3 LTS.</span><span class="sxs-lookup"><span data-stu-id="be5e6-265">A VM running the latest version of Ubuntu 16.04.3 LTS.</span></span>
  * <span data-ttu-id="be5e6-266">Пример расширения пользовательских сценариев, которые развертывают HTTP-сервер Apache в виртуальной машине Ubuntu и форматируют два диска данных.</span><span class="sxs-lookup"><span data-stu-id="be5e6-266">A sample custom script extension that deploys Apache HTTP Server to the Ubuntu VM, and formats the two data disks.</span></span>

### <a name="prerequisites"></a><span data-ttu-id="be5e6-267">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="be5e6-267">Prerequisites</span></span>

<span data-ttu-id="be5e6-268">Перед развертыванием эталонной архитектуры в собственной подписке необходимо выполнить следующие действия.</span><span class="sxs-lookup"><span data-stu-id="be5e6-268">Before you can deploy the reference architecture to your own subscription, you must perform the following steps.</span></span>

1. <span data-ttu-id="be5e6-269">Клонируйте и скачайте ZIP-файл [с эталонными архитектурами AzureCAT][ref-arch-repo] в репозитории GitHub, а также выполните его разветвление.</span><span class="sxs-lookup"><span data-stu-id="be5e6-269">Clone, fork, or download the zip file for the [AzureCAT reference architectures][ref-arch-repo] GitHub repository.</span></span>

2. <span data-ttu-id="be5e6-270">Убедитесь, что Azure CLI 2.0 установлен на компьютере.</span><span class="sxs-lookup"><span data-stu-id="be5e6-270">Make sure you have the Azure CLI 2.0 installed on your computer.</span></span> <span data-ttu-id="be5e6-271">Чтобы установить CLI, следуйте инструкциям в статье об [установке Azure CLI 2.0][azure-cli-2].</span><span class="sxs-lookup"><span data-stu-id="be5e6-271">To install the CLI, follow the instructions in [Install Azure CLI 2.0][azure-cli-2].</span></span>

3. <span data-ttu-id="be5e6-272">Установите пакет npm [стандартных блоков Azure][azbb].</span><span class="sxs-lookup"><span data-stu-id="be5e6-272">Install the [Azure building blocks][azbb] npm package.</span></span>

4. <span data-ttu-id="be5e6-273">В командной строке, строке bash или строке PowerShell войдите в свою учетную запись Azure с помощью одной из приведенных ниже команд и следуйте инструкциям.</span><span class="sxs-lookup"><span data-stu-id="be5e6-273">From a command prompt, bash prompt, or PowerShell prompt, login to your Azure account by using one of the commands below, and follow the prompts.</span></span>

  ```bash
  az login
  ```

### <a name="deploy-the-solution-using-azbb"></a><span data-ttu-id="be5e6-274">Развертывание решения с помощью azbb</span><span class="sxs-lookup"><span data-stu-id="be5e6-274">Deploy the solution using azbb</span></span>

<span data-ttu-id="be5e6-275">Чтобы развернуть пример одной рабочей нагрузки виртуальной машины, сделайте следующее:</span><span class="sxs-lookup"><span data-stu-id="be5e6-275">To deploy the sample single VM workload, follow these steps:</span></span>

1. <span data-ttu-id="be5e6-276">Перейдите в папку `virtual-machines\single-vm\parameters\linux` репозитория, скачанного на предыдущем шаге.</span><span class="sxs-lookup"><span data-stu-id="be5e6-276">Navigate to the `virtual-machines\single-vm\parameters\linux` folder for the repository you downloaded in the pre-requisites step above.</span></span>

2. <span data-ttu-id="be5e6-277">Откройте файл `single-vm-v2.json` и введите имя пользователя и ключ SSH в кавычках, как показано ниже, а затем сохраните файл.</span><span class="sxs-lookup"><span data-stu-id="be5e6-277">Open the `single-vm-v2.json` file and enter a username and SSH key between the quotes, as shown below, then save the file.</span></span>

  ```bash
  "adminUsername": "",
  "adminsshPublicKey": "",
  ```

3. <span data-ttu-id="be5e6-278">Запустите `azbb`, чтобы развернуть пример виртуальной машины, как показано ниже.</span><span class="sxs-lookup"><span data-stu-id="be5e6-278">Run `azbb` to deploy the sample VM as shown below.</span></span>

  ```bash
  azbb -s <subscription_id> -g <resource_group_name> -l <location> -p single-vm-v2.json --deploy
  ```

<span data-ttu-id="be5e6-279">Дополнительные сведения о развертывании этого примера эталонной архитектуры см. в [нашем репозитории GitHub][git].</span><span class="sxs-lookup"><span data-stu-id="be5e6-279">For more information on deploying this sample reference architecture, visit our [GitHub repository][git].</span></span>

## <a name="next-steps"></a><span data-ttu-id="be5e6-280">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="be5e6-280">Next steps</span></span>

- <span data-ttu-id="be5e6-281">Узнайте подробнее о [стандартных блоках Azure][azbbv2].</span><span class="sxs-lookup"><span data-stu-id="be5e6-281">Learn about our [Azure building Blocks][azbbv2].</span></span>
- <span data-ttu-id="be5e6-282">Разверните [несколько виртуальных машин][multi-vm] в Azure.</span><span class="sxs-lookup"><span data-stu-id="be5e6-282">Deploy [multiple VMs][multi-vm] in Azure.</span></span>

<!-- links -->
[git]: https://github.com/mspnp/reference-architectures/tree/master/virtual-machines/single-vm
[multi-vm]: ../virtual-machines-linux/multi-vm.md
[naming conventions]: ../../best-practices/naming-conventions.md
[audit-logs]: https://azure.microsoft.com/blog/analyze-azure-audit-logs-in-powerbi-more/
[availability-set]: /azure/virtual-machines/virtual-machines-linux-manage-availability
[azbb]: https://github.com/mspnp/template-building-blocks/wiki/Install-Azure-Building-Blocks
[azbbv2]: https://github.com/mspnp/template-building-blocks
[azure-cli-2]: /cli/azure/install-azure-cli?view=azure-cli-latest
[azure-linux]: /azure/virtual-machines/virtual-machines-linux-azure-overview
[azure-storage]: /azure/storage/storage-introduction
[blob-snapshot]: /azure/storage/storage-blob-snapshots
[blob-storage]: /azure/storage/storage-introduction
[boot-diagnostics]: https://azure.microsoft.com/blog/boot-diagnostics-for-virtual-machines-v2/
[cname-record]: https://en.wikipedia.org/wiki/CNAME_record
[data-disk]: /azure/virtual-machines/virtual-machines-linux-about-disks-vhds
[disk-encryption]: /azure/security/azure-security-disk-encryption
[enable-monitoring]: /azure/monitoring-and-diagnostics/insights-how-to-use-diagnostics
[fqdn]: /azure/virtual-machines/virtual-machines-linux-portal-create-fqdn
[github-folder]: https://github.com/mspnp/reference-architectures/tree/master/virtual-machines/single-vm
[iostat]: https://en.wikipedia.org/wiki/Iostat
[manage-vm-availability]: /azure/virtual-machines/virtual-machines-linux-manage-availability
[nsg]: /azure/virtual-network/virtual-networks-nsg
[nsg-default-rules]: /azure/virtual-network/virtual-networks-nsg#default-rules
[OSPatching]: https://github.com/Azure/azure-linux-extensions/tree/master/OSPatching
[planned-maintenance]: /azure/virtual-machines/virtual-machines-linux-planned-maintenance
[premium-storage]: /azure/storage/storage-premium-storage
[rbac]: /azure/active-directory/role-based-access-control-what-is
[rbac-roles]: /azure/active-directory/role-based-access-built-in-roles
[rbac-devtest]: /azure/active-directory/role-based-access-built-in-roles#devtest-labs-user
[rbac-network]: /azure/active-directory/role-based-access-built-in-roles#network-contributor
[reboot-logs]: https://azure.microsoft.com/blog/viewing-vm-reboot-logs/
[ref-arch-repo]: https://github.com/mspnp/reference-architectures
[resource-lock]: /azure/resource-group-lock-resources
[resource-manager-overview]: /azure/azure-resource-manager/resource-group-overview
[security-center]: /azure/security-center/
[security-center-get-started]: /azure/security-center/security-center-get-started
[select-vm-image]: /azure/virtual-machines/virtual-machines-linux-cli-ps-findimage
[services-by-region]: https://azure.microsoft.com/regions/#services
[ssh-linux]: /azure/virtual-machines/virtual-machines-linux-mac-create-ssh-keys
[static-ip]: /azure/virtual-network/virtual-networks-reserved-public-ip
[virtual-machine-sizes]: /azure/virtual-machines/virtual-machines-linux-sizes
[visio-download]: https://archcenter.azureedge.net/cdn/vm-reference-architectures.vsdx
[vm-disk-limits]: /azure/azure-subscription-service-limits#virtual-machine-disk-limits
[vm-resize]: /azure/virtual-machines/virtual-machines-linux-change-vm-size
[vm-size-tables]: /azure/virtual-machines/virtual-machines-linux-sizes
[vm-sla]: https://azure.microsoft.com/support/legal/sla/virtual-machines
[readme]: https://github.com/mspnp/reference-architectures/blob/master/virtual-machines/single-vm/README.md
[0]: ./images/single-vm-diagram.png "Архитектура с одной виртуальной машиной Linux в Azure"

