---
title: "Запуск виртуальных машин Windows в n-уровневой архитектуре"
description: "Эта статья содержит способы реализации многоуровневой архитектуры в Azure и уделяет особое внимание доступности, безопасности, масштабируемости и безопасности управляемости."
author: MikeWasson
ms.date: 11/22/2016
pnp.series.title: Windows VM workloads
pnp.series.next: multi-region-application
pnp.series.prev: multi-vm
ms.openlocfilehash: 0654239a5bbd966a2aa776415b7f15ae723ffd63
ms.sourcegitcommit: c9e6d8edb069b8c513de748ce8114c879bad5f49
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2018
---
# <a name="run-windows-vms-for-an-n-tier-application"></a><span data-ttu-id="2f2e9-103">Запуск виртуальных машин Windows для n-уровневого приложения</span><span class="sxs-lookup"><span data-stu-id="2f2e9-103">Run Windows VMs for an N-tier application</span></span>

<span data-ttu-id="2f2e9-104">В этой эталонной архитектуре показан набор методик по запуску виртуальных машин Windows для n-уровневого приложения.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-104">This reference architecture shows a set of proven practices for running Windows virtual machines (VMs) for an N-tier application.</span></span> [<span data-ttu-id="2f2e9-105">**Разверните это решение**.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-105">**Deploy this solution**.</span></span>](#deploy-the-solution) 

<span data-ttu-id="2f2e9-106">![[0]][0]</span><span class="sxs-lookup"><span data-stu-id="2f2e9-106">![[0]][0]</span></span>

<span data-ttu-id="2f2e9-107">*Скачайте [файл Visio][visio-download] этой архитектуры.*</span><span class="sxs-lookup"><span data-stu-id="2f2e9-107">*Download a [Visio file][visio-download] of this architecture.*</span></span>

## <a name="architecture"></a><span data-ttu-id="2f2e9-108">Архитектура</span><span class="sxs-lookup"><span data-stu-id="2f2e9-108">Architecture</span></span> 

<span data-ttu-id="2f2e9-109">Существует много способов реализовать n-уровневую архитектуру.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-109">There are many ways to implement an N-tier architecture.</span></span> <span data-ttu-id="2f2e9-110">На диаграмме показано стандартное трехуровневое веб-приложение.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-110">The diagram shows a typical 3-tier web application.</span></span> <span data-ttu-id="2f2e9-111">Эта архитектура создана на основе архитектуры из статьи [Запуск виртуальных машин с балансировкой нагрузки для обеспечения масштабируемости и доступности][multi-vm].</span><span class="sxs-lookup"><span data-stu-id="2f2e9-111">This architecture builds on [Run load-balanced VMs for scalability and availability][multi-vm].</span></span> <span data-ttu-id="2f2e9-112">На веб- и бизнес-уровнях используются виртуальные машины с балансировкой нагрузки.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-112">The web and business tiers use load-balanced VMs.</span></span>

* <span data-ttu-id="2f2e9-113">**Группы доступности.**</span><span class="sxs-lookup"><span data-stu-id="2f2e9-113">**Availability sets.**</span></span> <span data-ttu-id="2f2e9-114">Создайте [группу доступности][azure-availability-sets] для каждого уровня и подготовьте по крайней мере две виртуальные машины для каждого уровня.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-114">Create an [availability set][azure-availability-sets] for each tier, and provision at least two VMs in each tier.</span></span> <span data-ttu-id="2f2e9-115">Таким образом виртуальные машины станут подходящими для [соглашения об уровне обслуживания (SLA)][vm-sla] более высокого уровня для виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-115">This makes the VMs eligible for a higher [service level agreement (SLA)][vm-sla] for VMs.</span></span> <span data-ttu-id="2f2e9-116">Вы можете развернуть одну виртуальную машину в группе доступности, но в таком случае вы не сможете воспользоваться преимуществами соглашения об уровне обслуживания. Это возможно, только если для всех дисков операционной системы и данных такой виртуальной машины будет использоваться хранилище Azure класса Premium.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-116">You can deploy a single VM in an availability set, but the single VM will not qualify for an SLA guarantee unless the single VM is using Azure Premium Storage for all OS and data disks.</span></span>  
* <span data-ttu-id="2f2e9-117">**Подсети.**</span><span class="sxs-lookup"><span data-stu-id="2f2e9-117">**Subnets.**</span></span> <span data-ttu-id="2f2e9-118">Создайте отдельные подсети для каждого уровня.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-118">Create a separate subnet for each tier.</span></span> <span data-ttu-id="2f2e9-119">Укажите диапазон адресов и маску подсети с помощью нотации [CIDR].</span><span class="sxs-lookup"><span data-stu-id="2f2e9-119">Specify the address range and subnet mask using [CIDR] notation.</span></span> 
* <span data-ttu-id="2f2e9-120">**Подсистемы балансировки нагрузки.**</span><span class="sxs-lookup"><span data-stu-id="2f2e9-120">**Load balancers.**</span></span> <span data-ttu-id="2f2e9-121">[Подсистема балансировки нагрузки с доступом к Интернету][load-balancer-external] передает входящий интернет-трафик на веб-уровень, а [внутренняя подсистема балансировки нагрузки][load-balancer-internal] передает сетевой трафик из веб-уровня на бизнес-уровень.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-121">Use an [Internet-facing load balancer][load-balancer-external] to distribute incoming Internet traffic to the web tier, and an [internal load balancer][load-balancer-internal] to distribute network traffic from the web tier to the business tier.</span></span>
* <span data-ttu-id="2f2e9-122">**Jumpbox.**</span><span class="sxs-lookup"><span data-stu-id="2f2e9-122">**Jumpbox.**</span></span> <span data-ttu-id="2f2e9-123">Он также называется [узлом-бастионом].</span><span class="sxs-lookup"><span data-stu-id="2f2e9-123">Also called a [bastion host].</span></span> <span data-ttu-id="2f2e9-124">Безопасная виртуальная машина в сети, которую администраторы используют для подключения к другим виртуальным машинам.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-124">A secure VM on the network that administrators use to connect to the other VMs.</span></span> <span data-ttu-id="2f2e9-125">В jumpbox есть группа безопасности сети, обеспечивающая удаленный трафик только из общедоступных IP-адресов из списка надежных отправителей.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-125">The jumpbox has an NSG that allows remote traffic only from public IP addresses on a safe list.</span></span> <span data-ttu-id="2f2e9-126">NSG должна пропускать трафик с удаленного рабочего стола (RDP).</span><span class="sxs-lookup"><span data-stu-id="2f2e9-126">The NSG should permit remote desktop (RDP) traffic.</span></span>
* <span data-ttu-id="2f2e9-127">**Мониторинг.**</span><span class="sxs-lookup"><span data-stu-id="2f2e9-127">**Monitoring.**</span></span> <span data-ttu-id="2f2e9-128">Программное обеспечение для мониторинга, например [Nagios], [Zabbix] или [Icinga], позволяет получить глубокое представление о времени отклика, времени доступности виртуальной машины и общей работоспособности вашей системы.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-128">Monitoring software such as [Nagios], [Zabbix], or [Icinga] can give you insight into response time, VM uptime, and the overall health of your system.</span></span> <span data-ttu-id="2f2e9-129">Установите программное обеспечение для мониторинга на виртуальной машине, которая размещена в отдельной подсети управления.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-129">Install the monitoring software on a VM that's placed in a separate management subnet.</span></span>
* <span data-ttu-id="2f2e9-130">**Группы безопасности сети.**</span><span class="sxs-lookup"><span data-stu-id="2f2e9-130">**NSGs.**</span></span> <span data-ttu-id="2f2e9-131">[Группы безопасности сети][nsg] (NSG) позволяют ограничить сетевой трафик в виртуальной сети.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-131">Use [network security groups][nsg] (NSGs) to restrict network traffic within the VNet.</span></span> <span data-ttu-id="2f2e9-132">Например, в приведенной здесь трехуровневой архитектуре уровень базы данных не принимает трафик из веб-интерфейса, а только с бизнес-уровня и подсети управления.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-132">For example, in the 3-tier architecture shown here, the database tier does not accept traffic from the web front end, only from the business tier and the management subnet.</span></span>
* <span data-ttu-id="2f2e9-133">**Группа доступности AlwaysOn SQL Server.**</span><span class="sxs-lookup"><span data-stu-id="2f2e9-133">**SQL Server Always On Availability Group.**</span></span> <span data-ttu-id="2f2e9-134">Обеспечивает высокий уровень доступности на уровне данных, включив репликацию и отработку отказа.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-134">Provides high availability at the data tier, by enabling replication and failover.</span></span>
* <span data-ttu-id="2f2e9-135">**Серверы доменных служб Active Directory (AD DS).**</span><span class="sxs-lookup"><span data-stu-id="2f2e9-135">**Active Directory Domain Services (AD DS) Servers**.</span></span> <span data-ttu-id="2f2e9-136">До Windows Server 2016 группы доступности Always On SQL Server требовалось присоединять к домену.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-136">Prior to Windows Server 2016, SQL Server Always On Availability Groups must be joined to a domain.</span></span> <span data-ttu-id="2f2e9-137">Это связано с тем, что группы доступности зависят от технологии отказоустойчивого кластера Windows Server.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-137">This is because Availability Groups depend on Windows Server Failover Cluster (WSFC) technology.</span></span> <span data-ttu-id="2f2e9-138">Windows Server 2016 предоставляет возможность создать отказоустойчивый кластер без Active Directory. В этом случае серверы доменных служб Active Directory не нужны для этой архитектуры.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-138">Windows Server 2016 introduces the ability to create a Failover Cluster without Active Directory, in which case the AD DS servers are not required for this architecture.</span></span> <span data-ttu-id="2f2e9-139">Дополнительные сведения см. в разделе [What's new in Failover Clustering in Windows Server 2016][wsfc-whats-new] (Новые возможности отказоустойчивой кластеризации в Windows Server 2016).</span><span class="sxs-lookup"><span data-stu-id="2f2e9-139">For more information, see [What's new in Failover Clustering in Windows Server 2016][wsfc-whats-new].</span></span>
* <span data-ttu-id="2f2e9-140">**Azure DNS**.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-140">**Azure DNS**.</span></span> <span data-ttu-id="2f2e9-141">[Azure DNS][azure-dns] — это служба размещения для доменов DNS, которая предоставляет разрешение имен с помощью инфраструктуры Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-141">[Azure DNS][azure-dns] is a hosting service for DNS domains, providing name resolution using Microsoft Azure infrastructure.</span></span> <span data-ttu-id="2f2e9-142">Размещая домены в Azure, вы можете управлять своими записями DNS с помощью тех же учетных данных, API и инструментов и оплачивать использование, как и другие службы Azure.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-142">By hosting your domains in Azure, you can manage your DNS records using the same credentials, APIs, tools, and billing as your other Azure services.</span></span>

## <a name="recommendations"></a><span data-ttu-id="2f2e9-143">Рекомендации</span><span class="sxs-lookup"><span data-stu-id="2f2e9-143">Recommendations</span></span>

<span data-ttu-id="2f2e9-144">Описанная здесь архитектура может не соответствовать вашим требованиям.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-144">Your requirements might differ from the architecture described here.</span></span> <span data-ttu-id="2f2e9-145">Воспользуйтесь этими рекомендациями в качестве отправной точки.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-145">Use these recommendations as a starting point.</span></span> 

### <a name="vnet--subnets"></a><span data-ttu-id="2f2e9-146">Виртуальная сеть и подсети</span><span class="sxs-lookup"><span data-stu-id="2f2e9-146">VNet / Subnets</span></span>

<span data-ttu-id="2f2e9-147">При создании виртуальной сети определите, сколько IP-адресов требуется для ресурсов в каждой подсети.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-147">When you create the VNet, determine how many IP addresses your resources in each subnet require.</span></span> <span data-ttu-id="2f2e9-148">Укажите маску подсети и достаточно большой диапазон адресов виртуальной сети для требуемых IP-адресов с помощью нотации [CIDR].</span><span class="sxs-lookup"><span data-stu-id="2f2e9-148">Specify a subnet mask and a VNet address range large enough for the required IP addresses, using [CIDR] notation.</span></span> <span data-ttu-id="2f2e9-149">Используйте адресное пространство, которое входит в диапазон стандартных [блоков частных IP-адресов][private-ip-space], например 10.0.0.0/8, 172.16.0.0/12 и 192.168.0.0/16.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-149">Use an address space that falls within the standard [private IP address blocks][private-ip-space], which are 10.0.0.0/8, 172.16.0.0/12, and 192.168.0.0/16.</span></span>

<span data-ttu-id="2f2e9-150">Выберите диапазон адресов, который не перекрывает локальную сеть, если вам нужно позже настроить шлюз между виртуальной сетью и локальной сетью.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-150">Choose an address range that does not overlap with your on-premises network, in case you need to set up a gateway between the VNet and your on-premise network later.</span></span> <span data-ttu-id="2f2e9-151">Создав виртуальную сеть, изменить диапазон адресов нельзя.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-151">Once you create the VNet, you can't change the address range.</span></span>

<span data-ttu-id="2f2e9-152">Проектируйте подсети с учетом требований к функциональности и безопасности.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-152">Design subnets with functionality and security requirements in mind.</span></span> <span data-ttu-id="2f2e9-153">Все виртуальные машины в пределах одного уровня или одной роли должны входить в одну и ту же подсеть, которая может быть надежным периметром безопасности.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-153">All VMs within the same tier or role should go into the same subnet, which can be a security boundary.</span></span> <span data-ttu-id="2f2e9-154">Дополнительные сведения о проектировании виртуальных сетей и подсетей см. в статье [Планирование и проектирование виртуальных сетей Azure][plan-network].</span><span class="sxs-lookup"><span data-stu-id="2f2e9-154">For more information about designing VNets and subnets, see [Plan and design Azure Virtual Networks][plan-network].</span></span>

<span data-ttu-id="2f2e9-155">Для каждой подсети укажите адресное пространство подсети в нотации CIDR.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-155">For each subnet, specify the address space for the subnet in CIDR notation.</span></span> <span data-ttu-id="2f2e9-156">Например, 10.0.0.0/24 создает диапазон из 256 IP-адресов.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-156">For example, '10.0.0.0/24' creates a range of 256 IP addresses.</span></span> <span data-ttu-id="2f2e9-157">Виртуальные машины могут использовать 251 из них (пять зарезервированы).</span><span class="sxs-lookup"><span data-stu-id="2f2e9-157">VMs can use 251 of these; five are reserved.</span></span> <span data-ttu-id="2f2e9-158">Убедитесь, что диапазоны адресов не перекрываются между подсетями.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-158">Make sure the address ranges don't overlap across subnets.</span></span> <span data-ttu-id="2f2e9-159">Ознакомьтесь со статьей [Виртуальная сеть Azure: часто задаваемые вопросы][vnet faq].</span><span class="sxs-lookup"><span data-stu-id="2f2e9-159">See the [Virtual Network FAQ][vnet faq].</span></span>

### <a name="network-security-groups"></a><span data-ttu-id="2f2e9-160">Группы безопасности сети</span><span class="sxs-lookup"><span data-stu-id="2f2e9-160">Network security groups</span></span>

<span data-ttu-id="2f2e9-161">С помощью правил NSG можно ограничить трафик между уровнями.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-161">Use NSG rules to restrict traffic between tiers.</span></span> <span data-ttu-id="2f2e9-162">Например, в показанной выше трехуровневой архитектуре веб-уровень не взаимодействует напрямую с уровнем базы данных.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-162">For example, in the 3-tier architecture shown above, the web tier does not communicate directly with the database tier.</span></span> <span data-ttu-id="2f2e9-163">Чтобы обеспечить эту возможность, уровень базы данных должен блокировать входящий трафик из подсети веб-уровня.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-163">To enforce this, the database tier should block incoming traffic from the web tier subnet.</span></span>  

1. <span data-ttu-id="2f2e9-164">Создайте NSG и свяжите ее с подсетью уровня базы данных.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-164">Create an NSG and associate it to the database tier subnet.</span></span>
2. <span data-ttu-id="2f2e9-165">Добавьте правило, которое запрещает весь входящий трафик от виртуальной сети.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-165">Add a rule that denies all inbound traffic from the VNet.</span></span> <span data-ttu-id="2f2e9-166">(В правиле используйте тег `VIRTUAL_NETWORK`.)</span><span class="sxs-lookup"><span data-stu-id="2f2e9-166">(Use the `VIRTUAL_NETWORK` tag in the rule.)</span></span> 
3. <span data-ttu-id="2f2e9-167">Добавьте правило с более высоким приоритетом, которое разрешает входящий трафик из подсети бизнес-уровня.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-167">Add a rule with a higher priority that allows inbound traffic from the business tier subnet.</span></span> <span data-ttu-id="2f2e9-168">Это правило переопределяет предыдущее и позволяет бизнес-уровню взаимодействовать с уровнем базы данных.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-168">This rule overrides the previous rule, and allows the business tier to talk to the database tier.</span></span>
4. <span data-ttu-id="2f2e9-169">Добавьте правило, которое разрешает входящий трафик из самой подсети уровня базы данных.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-169">Add a rule that allows inbound traffic from within the database tier subnet itself.</span></span> <span data-ttu-id="2f2e9-170">Это правило обеспечивает взаимодействие между виртуальными машинами на уровне базы данных, которое необходимо для репликации и отработки отказа базы данных.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-170">This rule allows communication between VMs in the database tier, which is needed for database replication and failover.</span></span>
5. <span data-ttu-id="2f2e9-171">Добавьте правило, которое разрешает трафик RDP из подсети jumpbox.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-171">Add a rule that allows RDP traffic from the jumpbox subnet.</span></span> <span data-ttu-id="2f2e9-172">Это правило позволяет администраторам подключаться к уровню базы данных из jumpbox.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-172">This rule lets administrators connect to the database tier from the jumpbox.</span></span>
   
   > [!NOTE]
   > <span data-ttu-id="2f2e9-173">NSG имеет стандартные правила, которые разрешают любой входящий трафик из виртуальной сети.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-173">An NSG has default rules that allow any inbound traffic from within the VNet.</span></span> <span data-ttu-id="2f2e9-174">Эти правила нельзя удалить, однако их можно переопределить, создав правила с более высоким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-174">These rules can't be deleted, but you can override them by creating higher priority rules.</span></span>
   > 
   > 

### <a name="load-balancers"></a><span data-ttu-id="2f2e9-175">Балансировщики нагрузки</span><span class="sxs-lookup"><span data-stu-id="2f2e9-175">Load balancers</span></span>

<span data-ttu-id="2f2e9-176">Внешняя подсистема балансировки нагрузки передает трафик Интернета на веб-уровень.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-176">The external load balancer distributes Internet traffic to the web tier.</span></span> <span data-ttu-id="2f2e9-177">Создайте общедоступный IP-адрес для этой подсистемы балансировки нагрузки.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-177">Create a public IP address for this load balancer.</span></span> <span data-ttu-id="2f2e9-178">Ознакомьтесь со статьей [Создание балансировщика нагрузки для Интернета на портале Azure][lb-external-create].</span><span class="sxs-lookup"><span data-stu-id="2f2e9-178">See [Creating an Internet-facing load balancer][lb-external-create].</span></span>

<span data-ttu-id="2f2e9-179">Внутренняя подсистема балансировки нагрузки передает сетевой трафик с веб-уровня на бизнес-уровень.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-179">The internal load balancer distributes network traffic from the web tier to the business tier.</span></span> <span data-ttu-id="2f2e9-180">Чтобы предоставить этой системе балансировки нагрузки частный IP-адрес, создайте внешнюю IP-конфигурацию и свяжите ее с подсетью для бизнес-уровня.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-180">To give this load balancer a private IP address, create a frontend IP configuration and associate it with the subnet for the business tier.</span></span> <span data-ttu-id="2f2e9-181">Ознакомьтесь со статьей [Создание подсистемы балансировки нагрузки на портале Azure][lb-internal-create].</span><span class="sxs-lookup"><span data-stu-id="2f2e9-181">See [Get started creating an Internal load balancer][lb-internal-create].</span></span>

### <a name="sql-server-always-on-availability-groups"></a><span data-ttu-id="2f2e9-182">Группы доступности AlwaysOn SQL Server</span><span class="sxs-lookup"><span data-stu-id="2f2e9-182">SQL Server Always On Availability Groups</span></span>

<span data-ttu-id="2f2e9-183">Мы рекомендуем использовать [группы доступности AlwaysOn][sql-alwayson] для обеспечения высокого уровня доступности SQL Server.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-183">We recommend [Always On Availability Groups][sql-alwayson] for SQL Server high availability.</span></span> <span data-ttu-id="2f2e9-184">До Windows Server 2016 для групп доступности Always On требовался контроллер домена, а все узлы в группе доступности должны были находиться в одном домене AD.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-184">Prior to Windows Server 2016, Always On Availability Groups require a domain controller, and all nodes in the availability group must be in the same AD domain.</span></span>

<span data-ttu-id="2f2e9-185">Другие уровни подключаются к базе данных с помощью [прослушивателя групп доступности][sql-alwayson-listeners].</span><span class="sxs-lookup"><span data-stu-id="2f2e9-185">Other tiers connect to the database through an [availability group listener][sql-alwayson-listeners].</span></span> <span data-ttu-id="2f2e9-186">Прослушиватель позволяет клиенту SQL подключаться, не зная имени физического экземпляра SQL Server.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-186">The listener enables a SQL client to connect without knowing the name of the physical instance of SQL Server.</span></span> <span data-ttu-id="2f2e9-187">Виртуальные машины, которые обращаются к базе данных, должны быть присоединены к домену.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-187">VMs that access the database must be joined to the domain.</span></span> <span data-ttu-id="2f2e9-188">Клиент (в этом случае другой уровень) использует DNS для разрешения имени виртуальной сети прослушивателя в IP-адресах.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-188">The client (in this case, another tier) uses DNS to resolve the listener's virtual network name into IP addresses.</span></span>

<span data-ttu-id="2f2e9-189">Настройте группы доступности AlwaysOn SQL Server следующим образом:</span><span class="sxs-lookup"><span data-stu-id="2f2e9-189">Configure the SQL Server Always On Availability Group as follows:</span></span>

1. <span data-ttu-id="2f2e9-190">Создайте кластер отказоустойчивой кластеризации Windows Server, группу доступности AlwaysOn SQL Server и первичную реплику.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-190">Create a Windows Server Failover Clustering (WSFC) cluster, a SQL Server Always On Availability Group, and a primary replica.</span></span> <span data-ttu-id="2f2e9-191">Дополнительные сведения см. в статье [Начало работы с группами доступности AlwaysOn (SQL Server)][sql-alwayson-getting-started].</span><span class="sxs-lookup"><span data-stu-id="2f2e9-191">For more information, see [Getting Started with Always On Availability Groups][sql-alwayson-getting-started].</span></span> 
2. <span data-ttu-id="2f2e9-192">Создайте внутреннюю подсистему балансировки нагрузки со статическим частным IP-адресом.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-192">Create an internal load balancer with a static private IP address.</span></span>
3. <span data-ttu-id="2f2e9-193">Создайте прослушиватель группы доступности и сопоставьте его DNS-имя с IP-адресом внутренней подсистемы балансировки нагрузки.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-193">Create an availability group listener, and map the listener's DNS name to the IP address of an internal load balancer.</span></span> 
4. <span data-ttu-id="2f2e9-194">Создайте правило подсистемы балансировки нагрузки для порта прослушивания SQL Server (по умолчанию используется TCP-порт 1433).</span><span class="sxs-lookup"><span data-stu-id="2f2e9-194">Create a load balancer rule for the SQL Server listening port (TCP port 1433 by default).</span></span> <span data-ttu-id="2f2e9-195">Правило подсистемы балансировки нагрузки должно включать *плавающий IP-адрес*, также называемый прямым ответом от сервера.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-195">The load balancer rule must enable *floating IP*, also called Direct Server Return.</span></span> <span data-ttu-id="2f2e9-196">В результате виртуальная машина будет отправлять ответ клиенту напрямую, что позволяет использовать прямое соединение с первичной репликой.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-196">This causes the VM to reply directly to the client, which enables a direct connection to the primary replica.</span></span>
  
  > [!NOTE]
  > <span data-ttu-id="2f2e9-197">Если плавающий IP-адрес включен, номер внешнего порта должен совпадать с номером внутреннего порта в правиле подсистемы балансировки нагрузки.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-197">When floating IP is enabled, the front-end port number must be the same as the back-end port number in the load balancer rule.</span></span>
  > 
  > 

<span data-ttu-id="2f2e9-198">Если клиент SQL пытается выполнить подключение, подсистема балансировки нагрузки направляет запрос на подключение в первичную реплику.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-198">When a SQL client tries to connect, the load balancer routes the connection request to the primary replica.</span></span> <span data-ttu-id="2f2e9-199">Если происходит отработка отказа с переходом на другую реплику, подсистема балансировки нагрузки автоматически направляет последующие запросы в новую первичную реплику.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-199">If there is a failover to another replica, the load balancer automatically routes subsequent requests to a new primary replica.</span></span> <span data-ttu-id="2f2e9-200">Дополнительные сведения см. в статье [Настройка подсистемы балансировки нагрузки для группы доступности AlwaysOn в Azure][sql-alwayson-ilb].</span><span class="sxs-lookup"><span data-stu-id="2f2e9-200">For more information, see [Configure an ILB listener for SQL Server Always On Availability Groups][sql-alwayson-ilb].</span></span>

<span data-ttu-id="2f2e9-201">Во время отработки отказа имеющиеся клиентские подключения закрыты.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-201">During a failover, existing client connections are closed.</span></span> <span data-ttu-id="2f2e9-202">После отработки отказа новые соединения направляются в новую первичную реплику.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-202">After the failover completes, new connections will be routed to the new primary replica.</span></span>

<span data-ttu-id="2f2e9-203">Если приложение выполняет значительно больше операций чтения, чем записи, вы можете разгрузить некоторые запросы только для чтения во вторичную реплику.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-203">If your application makes significantly more reads than writes, you can offload some of the read-only queries to a secondary replica.</span></span> <span data-ttu-id="2f2e9-204">Ознакомьтесь с разделом [Соединение с помощью прослушивателя со вторичной репликой только для чтения (маршрутизация только для чтения)][sql-alwayson-read-only-routing].</span><span class="sxs-lookup"><span data-stu-id="2f2e9-204">See [Using a Listener to Connect to a Read-Only Secondary Replica (Read-Only Routing)][sql-alwayson-read-only-routing].</span></span>

<span data-ttu-id="2f2e9-205">Протестируйте развертывание, [принудительно выполнив отработку отказа][sql-alwayson-force-failover] группы доступности вручную.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-205">Test your deployment by [forcing a manual failover][sql-alwayson-force-failover] of the availability group.</span></span>

### <a name="jumpbox"></a><span data-ttu-id="2f2e9-206">Jumpbox</span><span class="sxs-lookup"><span data-stu-id="2f2e9-206">Jumpbox</span></span>

<span data-ttu-id="2f2e9-207">jumpbox будет иметь минимальные требования к производительности, поэтому выберите небольшой размер виртуальной машины для jumpbox, например Standard A1.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-207">The jumpbox will have minimal performance requirements, so select a small VM size for the jumpbox such as Standard A1.</span></span> 

<span data-ttu-id="2f2e9-208">Создайте [общедоступный IP-адрес] для jumpbox.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-208">Create a [public IP address] for the jumpbox.</span></span> <span data-ttu-id="2f2e9-209">Поместите jumpbox в виртуальную сеть вместе с другими виртуальными машинами, однако в отдельную подсеть управления.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-209">Place the jumpbox in the same VNet as the other VMs, but in a separate management subnet.</span></span>

<span data-ttu-id="2f2e9-210">Запретите доступ по протоколу RDP из общедоступного Интернета к виртуальным машинам, которые выполняют рабочую нагрузку приложения.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-210">Do not allow RDP access from the public Internet to the VMs that run the application workload.</span></span> <span data-ttu-id="2f2e9-211">Вместо этого все доступы по протоколу RDP к этим виртуальным машинам должны проходить через jumpbox.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-211">Instead, all RDP access to these VMs must come through the jumpbox.</span></span> <span data-ttu-id="2f2e9-212">Администратор выполняет вход в jumpbox, а затем вход в другую виртуальную машину из jumpbox.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-212">An administrator logs into the jumpbox, and then logs into the other VM from the jumpbox.</span></span> <span data-ttu-id="2f2e9-213">jumpbox разрешает RDP трафик из Интернета, однако только из известных и безопасных IP-адресов.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-213">The jumpbox allows RDP traffic from the Internet, but only from known, safe IP addresses.</span></span>

<span data-ttu-id="2f2e9-214">Чтобы защитить jumpbox, создайте NSG и примените ее к подсети jumpbox.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-214">To secure the jumpbox, create an NSG and apply it to the jumpbox subnet.</span></span> <span data-ttu-id="2f2e9-215">Добавьте правило NSG, разрешающее подключения по протоколу RDP только из безопасного набора общедоступных IP-адресов.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-215">Add an NSG rule that allows RDP connections only from a safe set of public IP addresses.</span></span> <span data-ttu-id="2f2e9-216">NSG можно подключить к подсети или сетевому адаптеру jumpbox.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-216">The NSG can be attached either to the subnet or to the jumpbox NIC.</span></span> <span data-ttu-id="2f2e9-217">В этом случае рекомендуется подключить ее к сетевому адаптеру, чтобы трафик RDP разрешался только для jumpbox, даже если вы добавили другие виртуальные машины в ту же подсеть.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-217">In this case, we recommend attaching it to the NIC, so RDP traffic is permitted only to the jumpbox, even if you add other VMs to the same subnet.</span></span>

<span data-ttu-id="2f2e9-218">Настройте NSG для других подсетей, чтобы разрешить трафик RDP из подсети управления.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-218">Configure the NSGs for the other subnets to allow RDP traffic from the management subnet.</span></span>

## <a name="availability-considerations"></a><span data-ttu-id="2f2e9-219">Вопросы доступности</span><span class="sxs-lookup"><span data-stu-id="2f2e9-219">Availability considerations</span></span>

<span data-ttu-id="2f2e9-220">Использование нескольких виртуальных машин на уровне базы данных не приводит автоматически к высокой доступности базы данных.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-220">At the database tier, having multiple VMs does not automatically translate into a highly available database.</span></span> <span data-ttu-id="2f2e9-221">Для реляционной базы данных обычно требуется выполнить репликацию и отработку отказа, чтобы обеспечить высокий уровень доступности.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-221">For a relational database, you will typically need to use replication and failover to achieve high availability.</span></span> <span data-ttu-id="2f2e9-222">Для SQL Server мы рекомендуем использовать [группы доступности AlwaysOn][sql-alwayson].</span><span class="sxs-lookup"><span data-stu-id="2f2e9-222">For SQL Server, we recommend using [Always On Availability Groups][sql-alwayson].</span></span> 

<span data-ttu-id="2f2e9-223">Если требуется более высокий уровень доступности, чем обеспечивает [соглашение об уровне обслуживания Azure для виртуальных машин][vm-sla], реплицируйте приложение в два региона и используйте диспетчер трафика Azure для отработки отказа.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-223">If you need higher availability than the [Azure SLA for VMs][vm-sla] provides, replicate the application across two regions and use Azure Traffic Manager for failover.</span></span> <span data-ttu-id="2f2e9-224">Дополнительные сведения см. в статье [Запуск виртуальных машин Windows в нескольких регионах для обеспечения высокой доступности][multi-dc].</span><span class="sxs-lookup"><span data-stu-id="2f2e9-224">For more information, see [Run Windows VMs in multiple regions for high availability][multi-dc].</span></span>   

## <a name="security-considerations"></a><span data-ttu-id="2f2e9-225">Вопросы безопасности</span><span class="sxs-lookup"><span data-stu-id="2f2e9-225">Security considerations</span></span>

<span data-ttu-id="2f2e9-226">Выполните шифрование конфиденциальных неактивных данных и используйте [Azure Key Vault][azure-key-vault] для управления ключами шифрования базы данных.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-226">Encrypt sensitive data at rest and use [Azure Key Vault][azure-key-vault] to manage the database encryption keys.</span></span> <span data-ttu-id="2f2e9-227">Key Vault может хранить ключи шифрования в аппаратных модулях безопасности.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-227">Key Vault can store encryption keys in hardware security modules (HSMs).</span></span> <span data-ttu-id="2f2e9-228">Дополнительные сведения см. в статье [Настройка интеграции Azure Key Vault для SQL Server на виртуальных машинах Azure (Resource Manager)][sql-keyvault]. Рекомендуется также хранить секреты приложения, например строки подключения к базе данных, в Key Vault.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-228">For more information, see [Configure Azure Key Vault Integration for SQL Server on Azure VMs][sql-keyvault] It's also recommended to store application secrets, such as database connection strings, in Key Vault.</span></span>

<span data-ttu-id="2f2e9-229">Попробуйте добавить сетевой виртуальный модуль (NVA), чтобы создать сеть периметра между Интернетом и виртуальною сетью Azure.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-229">Consider adding a network virtual appliance (NVA) to create a DMZ between the Internet and the Azure virtual network.</span></span> <span data-ttu-id="2f2e9-230">Сетевой виртуальный модуль — это универсальный термин для виртуального модуля, который может выполнять сетевые задачи, например брандмауэра, проверки пакетов, аудита и пользовательской маршрутизации.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-230">NVA is a generic term for a virtual appliance that can perform network-related tasks, such as firewall, packet inspection, auditing, and custom routing.</span></span> <span data-ttu-id="2f2e9-231">Дополнительные сведения см. в статье [Сеть периметра между Azure и Интернетом][dmz].</span><span class="sxs-lookup"><span data-stu-id="2f2e9-231">For more information, see [Implementing a DMZ between Azure and the Internet][dmz].</span></span>

## <a name="scalability-considerations"></a><span data-ttu-id="2f2e9-232">Вопросы масштабируемости</span><span class="sxs-lookup"><span data-stu-id="2f2e9-232">Scalability considerations</span></span>

<span data-ttu-id="2f2e9-233">Подсистемы балансировки нагрузки передают сетевой трафик на веб- и бизнес-уровни.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-233">The load balancers distribute network traffic to the web and business tiers.</span></span> <span data-ttu-id="2f2e9-234">Выполните горизонтальное масштабирование, добавив новые экземпляры виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-234">Scale horizontally by adding new VM instances.</span></span> <span data-ttu-id="2f2e9-235">Обратите внимание, что можно масштабировать веб- и бизнес-уровни независимо друг от друга в зависимости от нагрузки.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-235">Note that you can scale the web and business tiers independently, based on load.</span></span> <span data-ttu-id="2f2e9-236">Чтобы снизить уровень усложнений, которые могут возникать из-за необходимости использовать привязку клиента, виртуальные машины на веб-уровне должны быть без отслеживания состояния.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-236">To reduce possible complications caused by the need to maintain client affinity, the VMs in the web tier should be stateless.</span></span> <span data-ttu-id="2f2e9-237">Виртуальные машины, на которых размещена бизнес-логика, также должны быть без отслеживания состояния.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-237">The VMs hosting the business logic should also be stateless.</span></span>

## <a name="manageability-considerations"></a><span data-ttu-id="2f2e9-238">Вопросы управляемости</span><span class="sxs-lookup"><span data-stu-id="2f2e9-238">Manageability considerations</span></span>

<span data-ttu-id="2f2e9-239">Упростите управление всей системой, используя централизованные инструменты администрирования, например [службу автоматизации Azure][azure-administration], [Microsoft Operations Management Suite][operations-management-suite], [Chef][chef] или [Puppet][puppet].</span><span class="sxs-lookup"><span data-stu-id="2f2e9-239">Simplify management of the entire system by using centralized administration tools such as [Azure Automation][azure-administration], [Microsoft Operations Management Suite][operations-management-suite], [Chef][chef], or [Puppet][puppet].</span></span> <span data-ttu-id="2f2e9-240">Эти инструменты могут консолидировать сведения о диагностике и работоспособности, собранные из нескольких виртуальных машин, чтобы обеспечить полное представление системы.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-240">These tools can consolidate diagnostic and health information captured from multiple VMs to provide an overall view of the system.</span></span>

## <a name="deploy-the-solution"></a><span data-ttu-id="2f2e9-241">Развертывание решения</span><span class="sxs-lookup"><span data-stu-id="2f2e9-241">Deploy the solution</span></span>

<span data-ttu-id="2f2e9-242">Пример развертывания для этой архитектуры можно найти на портале [GitHub][github-folder].</span><span class="sxs-lookup"><span data-stu-id="2f2e9-242">A deployment for this reference architecture is available on [GitHub][github-folder].</span></span> 

### <a name="prerequisites"></a><span data-ttu-id="2f2e9-243">Необходимые компоненты</span><span class="sxs-lookup"><span data-stu-id="2f2e9-243">Prerequisites</span></span>

<span data-ttu-id="2f2e9-244">Перед развертыванием эталонной архитектуры в собственной подписке необходимо выполнить следующие действия.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-244">Before you can deploy the reference architecture to your own subscription, you must perform the following steps.</span></span>

1. <span data-ttu-id="2f2e9-245">Клонируйте и скачайте ZIP-файл [с эталонными архитектурами AzureCAT][ref-arch-repo] в репозитории GitHub, а также выполните его разветвление.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-245">Clone, fork, or download the zip file for the [AzureCAT reference architectures][ref-arch-repo] GitHub repository.</span></span>

2. <span data-ttu-id="2f2e9-246">Убедитесь, что Azure CLI 2.0 установлен на компьютере.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-246">Make sure you have the Azure CLI 2.0 installed on your computer.</span></span> <span data-ttu-id="2f2e9-247">Чтобы установить CLI, следуйте инструкциям в статье об [установке Azure CLI 2.0][azure-cli-2].</span><span class="sxs-lookup"><span data-stu-id="2f2e9-247">To install the CLI, follow the instructions in [Install Azure CLI 2.0][azure-cli-2].</span></span>

3. <span data-ttu-id="2f2e9-248">Установите пакет npm [стандартных блоков Azure][azbb].</span><span class="sxs-lookup"><span data-stu-id="2f2e9-248">Install the [Azure building blocks][azbb] npm package.</span></span>

  ```bash
  npm install -g @mspnp/azure-building-blocks
  ```

4. <span data-ttu-id="2f2e9-249">В командной строке, строке bash или строке PowerShell войдите в свою учетную запись Azure с помощью одной из приведенных ниже команд и следуйте инструкциям.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-249">From a command prompt, bash prompt, or PowerShell prompt, login to your Azure account by using one of the commands below, and follow the prompts.</span></span>

  ```bash
  az login
  ```

### <a name="deploy-the-solution-using-azbb"></a><span data-ttu-id="2f2e9-250">Развертывание решения с помощью azbb</span><span class="sxs-lookup"><span data-stu-id="2f2e9-250">Deploy the solution using azbb</span></span>

<span data-ttu-id="2f2e9-251">Чтобы развернуть виртуальные машины Windows для эталонной архитектуры n-уровневого приложения, сделайте следующее:</span><span class="sxs-lookup"><span data-stu-id="2f2e9-251">To deploy the Windows VMs for an N-tier application reference architecture, follow these steps:</span></span>

1. <span data-ttu-id="2f2e9-252">Перейдите в папку `virtual-machines\n-tier-windows` репозитория, клонированного на шаге 1 (см. список необходимых компонентов).</span><span class="sxs-lookup"><span data-stu-id="2f2e9-252">Navigate to the `virtual-machines\n-tier-windows` folder for the repository you cloned in step 1 of the pre-requisites above.</span></span>

2. <span data-ttu-id="2f2e9-253">Файл параметров присваивает стандартные имя пользователя и пароль для администратора каждой виртуальной машине в развертывании.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-253">The parameter file specifies a default adminstrator user name and password for each VM in the deployment.</span></span> <span data-ttu-id="2f2e9-254">Перед развертыванием эталонной архитектуры эти значения нужно изменить.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-254">You must change these before you deploy the reference architecture.</span></span> <span data-ttu-id="2f2e9-255">Откройте файл `n-tier-windows.json` и замените все поля **adminUsername** и **adminPassword** новыми значениями.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-255">Open the `n-tier-windows.json` file and replace each **adminUsername** and **adminPassword** field with your new settings.</span></span>
  
  > [!NOTE]
  > <span data-ttu-id="2f2e9-256">Есть несколько сценариев, которые выполняются в ходе развертывания в объектах **VirtualMachineExtension** и параметрах **extension** для некоторых объектов **VirtualMachine**.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-256">There are multiple scripts that run during this deployment both in the  **VirtualMachineExtension** objects and in the **extensions** settings for some of the **VirtualMachine** objects.</span></span> <span data-ttu-id="2f2e9-257">Для работы некоторых из этих скриптов требуются учетные данные администратора, которые вы только что изменили.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-257">Some of these scripts require the administrator user name and password that you have just changed.</span></span> <span data-ttu-id="2f2e9-258">Рекомендуется просмотреть скрипты, чтобы проверить, указаны ли там правильные учетные данные.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-258">It's recommended that you review these scripts to ensure that you specified the correct credentials.</span></span> <span data-ttu-id="2f2e9-259">Развертывание может завершиться ошибкой, если будут указаны неправильные учетные данные.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-259">The deployment may fail if you have not specified the correct credentials.</span></span>
  > 
  > 

<span data-ttu-id="2f2e9-260">Сохраните файл.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-260">Save the file.</span></span>

3. <span data-ttu-id="2f2e9-261">Разверните эталонную архитектуру, используя средство командной строки **azbb**, как показано ниже.</span><span class="sxs-lookup"><span data-stu-id="2f2e9-261">Deploy the reference architecture using the **azbb** command line tool as shown below.</span></span>

  ```bash
  azbb -s <your subscription_id> -g <your resource_group_name> -l <azure region> -p n-tier-windows.json --deploy
  ```

<span data-ttu-id="2f2e9-262">Дополнительные сведения о развертывании этого примера эталонной архитектуры с использованием стандартных блоков Azure см. в [нашем репозитории GitHub][git].</span><span class="sxs-lookup"><span data-stu-id="2f2e9-262">For more information on deploying this sample reference architecture using Azure Building Blocks, visit the [GitHub repository][git].</span></span>


<!-- links -->
[dmz]: ../dmz/secure-vnet-dmz.md
[multi-dc]: multi-region-application.md
[multi-vm]: multi-vm.md
[n-tier]: n-tier.md
[azbb]: https://github.com/mspnp/template-building-blocks/wiki/Install-Azure-Building-Blocks
[azure-administration]: /azure/automation/automation-intro
[azure-availability-sets]: /azure/virtual-machines/virtual-machines-windows-manage-availability#configure-each-application-tier-into-separate-availability-sets
[azure-cli]: /azure/virtual-machines-command-line-tools
[azure-cli-2]: https://docs.microsoft.com/cli/azure/install-azure-cli?view=azure-cli-latest
[azure-dns]: /azure/dns/dns-overview
[azure-key-vault]: https://azure.microsoft.com/services/key-vault
[узлом-бастионом]: https://en.wikipedia.org/wiki/Bastion_host
[CIDR]: https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing
[chef]: https://www.chef.io/solutions/azure/
[git]: https://github.com/mspnp/template-building-blocks
[github-folder]: https://github.com/mspnp/reference-architectures/tree/master/virtual-machines/n-tier-windows
[lb-external-create]: /azure/load-balancer/load-balancer-get-started-internet-portal
[lb-internal-create]: /azure/load-balancer/load-balancer-get-started-ilb-arm-portal
[load-balancer-external]: /azure/load-balancer/load-balancer-internet-overview
[load-balancer-internal]: /azure/load-balancer/load-balancer-internal-overview
[nsg]: /azure/virtual-network/virtual-networks-nsg
[operations-management-suite]: https://www.microsoft.com/server-cloud/operations-management-suite/overview.aspx
[plan-network]: /azure/virtual-network/virtual-network-vnet-plan-design-arm
[private-ip-space]: https://en.wikipedia.org/wiki/Private_network#Private_IPv4_address_spaces
[общедоступный IP-адрес]: /azure/virtual-network/virtual-network-ip-addresses-overview-arm
[puppet]: https://puppetlabs.com/blog/managing-azure-virtual-machines-puppet
[ref-arch-repo]: https://github.com/mspnp/reference-architectures
[sql-alwayson]: https://msdn.microsoft.com/library/hh510230.aspx
[sql-alwayson-force-failover]: https://msdn.microsoft.com/library/ff877957.aspx
[sql-alwayson-getting-started]: https://msdn.microsoft.com/library/gg509118.aspx
[sql-alwayson-ilb]: /azure/virtual-machines/windows/sql/virtual-machines-windows-portal-sql-alwayson-int-listener
[sql-alwayson-listeners]: https://msdn.microsoft.com/library/hh213417.aspx
[sql-alwayson-read-only-routing]: https://technet.microsoft.com/library/hh213417.aspx#ConnectToSecondary
[sql-keyvault]: /azure/virtual-machines/virtual-machines-windows-ps-sql-keyvault
[vm-sla]: https://azure.microsoft.com/support/legal/sla/virtual-machines
[vnet faq]: /azure/virtual-network/virtual-networks-faq
[wsfc-whats-new]: https://technet.microsoft.com/windows-server-docs/failover-clustering/whats-new-in-failover-clustering
[Nagios]: https://www.nagios.org/
[Zabbix]: http://www.zabbix.com/
[Icinga]: http://www.icinga.org/
[visio-download]: https://archcenter.azureedge.net/cdn/vm-reference-architectures.vsdx
[0]: ./images/n-tier-diagram.png "N-уровневая архитектура с использованием Microsoft Azure"