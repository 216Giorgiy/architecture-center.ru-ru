---
title: Базовое веб-приложение
description: Рекомендуемые архитектуры для базовых веб-приложений, работающих в Microsoft Azure.
author: MikeWasson
ms.date: 12/12/2017
cardTitle: Basic web application
ms.openlocfilehash: efd831b1f54fa0662bdfa9874318e7b314172215
ms.sourcegitcommit: e67b751f230792bba917754d67789a20810dc76b
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2018
ms.locfileid: "30846409"
---
# <a name="basic-web-application"></a><span data-ttu-id="824b6-103">Базовое веб-приложение</span><span class="sxs-lookup"><span data-stu-id="824b6-103">Basic web application</span></span>
[!INCLUDE [header](../../_includes/header.md)]

<span data-ttu-id="824b6-104">Эталонная архитектура демонстрирует набор проверенных методов для создания веб-приложения, в котором используются [служба приложений Azure][app-service] и служба [База данных SQL Azure][sql-db].</span><span class="sxs-lookup"><span data-stu-id="824b6-104">This reference architecture shows a set of proven practices for a web application that uses [Azure App Service][app-service] and [Azure SQL Database][sql-db].</span></span> [<span data-ttu-id="824b6-105">**Разверните это решение**.</span><span class="sxs-lookup"><span data-stu-id="824b6-105">**Deploy this solution.**</span></span>](#deploy-the-solution)

<span data-ttu-id="824b6-106">![[0]][0]</span><span class="sxs-lookup"><span data-stu-id="824b6-106">![[0]][0]</span></span>

<span data-ttu-id="824b6-107">*Скачайте [файл Visio][visio-download] этой архитектуры.*</span><span class="sxs-lookup"><span data-stu-id="824b6-107">*Download a [Visio file][visio-download] of this architecture.*</span></span>

## <a name="architecture"></a><span data-ttu-id="824b6-108">Архитектура</span><span class="sxs-lookup"><span data-stu-id="824b6-108">Architecture</span></span> 

> [!NOTE]
> <span data-ttu-id="824b6-109">Эта архитектура не предназначена для разработки приложений и не требует использования какой-либо конкретной исполняющей среды.</span><span class="sxs-lookup"><span data-stu-id="824b6-109">This architecture does not focus on application development, and does not assume any particular application framework.</span></span> <span data-ttu-id="824b6-110">Она просто помогает разобраться в том, как разные службы Azure работают вместе.</span><span class="sxs-lookup"><span data-stu-id="824b6-110">The goal is to understand how various Azure services fit together.</span></span>
>
>

<span data-ttu-id="824b6-111">Архитектура состоит из следующих компонентов.</span><span class="sxs-lookup"><span data-stu-id="824b6-111">The architecture has the following components:</span></span>

* <span data-ttu-id="824b6-112">**Группа ресурсов**.</span><span class="sxs-lookup"><span data-stu-id="824b6-112">**Resource group**.</span></span> <span data-ttu-id="824b6-113">[Группа ресурсов](/azure/azure-resource-manager/resource-group-overview) — это логический контейнер для ресурсов Azure.</span><span class="sxs-lookup"><span data-stu-id="824b6-113">A [resource group](/azure/azure-resource-manager/resource-group-overview) is a logical container for Azure resources.</span></span>

* <span data-ttu-id="824b6-114">**Приложение службы приложений.**</span><span class="sxs-lookup"><span data-stu-id="824b6-114">**App Service app**.</span></span> <span data-ttu-id="824b6-115">[Служба приложений Azure][app-service] — это полностью управляемая платформа для создания и развертывания облачных приложений.</span><span class="sxs-lookup"><span data-stu-id="824b6-115">[Azure App Service][app-service] is a fully managed platform for creating and deploying cloud applications.</span></span>     

* <span data-ttu-id="824b6-116">**План службы приложений.**</span><span class="sxs-lookup"><span data-stu-id="824b6-116">**App Service plan**.</span></span> <span data-ttu-id="824b6-117">[План служб приложений][app-service-plans] предоставляет управляемые виртуальные машины для размещения приложения.</span><span class="sxs-lookup"><span data-stu-id="824b6-117">An [App Service plan][app-service-plans] provides the managed virtual machines (VMs) that host your app.</span></span> <span data-ttu-id="824b6-118">Все приложения, связанные с одним планом, выполняются на одних тех же экземплярах виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="824b6-118">All apps associated with a plan run on the same VM instances.</span></span>

* <span data-ttu-id="824b6-119">**Слоты развертывания.**</span><span class="sxs-lookup"><span data-stu-id="824b6-119">**Deployment slots**.</span></span>  <span data-ttu-id="824b6-120">[Слот развертывания][deployment-slots] позволяет заранее подготовить развертывание, а затем переключить его на рабочую среду.</span><span class="sxs-lookup"><span data-stu-id="824b6-120">A [deployment slot][deployment-slots] lets you stage a deployment and then swap it with the production deployment.</span></span> <span data-ttu-id="824b6-121">Это дает возможность избежать развертываний непосредственно в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="824b6-121">That way, you avoid deploying directly into production.</span></span> <span data-ttu-id="824b6-122">В разделе об [управляемости](#manageability-considerations) приводится несколько конкретных рекомендаций.</span><span class="sxs-lookup"><span data-stu-id="824b6-122">See the [Manageability](#manageability-considerations) section for specific recommendations.</span></span>

* <span data-ttu-id="824b6-123">**IP-адрес.**</span><span class="sxs-lookup"><span data-stu-id="824b6-123">**IP address**.</span></span> <span data-ttu-id="824b6-124">Для приложения службы приложений используется общедоступный IP-адрес и доменное имя.</span><span class="sxs-lookup"><span data-stu-id="824b6-124">The App Service app has a public IP address and a domain name.</span></span> <span data-ttu-id="824b6-125">К доменному имени добавляется имя поддомена `azurewebsites.net`, например: `contoso.azurewebsites.net`.</span><span class="sxs-lookup"><span data-stu-id="824b6-125">The domain name is a subdomain of `azurewebsites.net`, such as `contoso.azurewebsites.net`.</span></span>  

* <span data-ttu-id="824b6-126">**Azure DNS**.</span><span class="sxs-lookup"><span data-stu-id="824b6-126">**Azure DNS**.</span></span> <span data-ttu-id="824b6-127">[Azure DNS][azure-dns] — это служба размещения для доменов DNS, которая предоставляет разрешение имен с помощью инфраструктуры Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="824b6-127">[Azure DNS][azure-dns] is a hosting service for DNS domains, providing name resolution using Microsoft Azure infrastructure.</span></span> <span data-ttu-id="824b6-128">Размещая домены в Azure, вы можете управлять своими записями DNS с помощью тех же учетных данных, API и инструментов и оплачивать использование, как и другие службы Azure.</span><span class="sxs-lookup"><span data-stu-id="824b6-128">By hosting your domains in Azure, you can manage your DNS records using the same credentials, APIs, tools, and billing as your other Azure services.</span></span> <span data-ttu-id="824b6-129">Чтобы использовать пользовательское доменное имя, например `contoso.com`, создайте записи DNS, которые позволяют сопоставить это доменное имя с IP-адресом.</span><span class="sxs-lookup"><span data-stu-id="824b6-129">To use a custom domain name (such as `contoso.com`) create DNS records that map the custom domain name to the IP address.</span></span> <span data-ttu-id="824b6-130">Дополнительные сведения см. в статье [Сопоставление существующего настраиваемого DNS-имени с веб-приложениями Azure][custom-domain-name].</span><span class="sxs-lookup"><span data-stu-id="824b6-130">For more information, see [Configure a custom domain name in Azure App Service][custom-domain-name].</span></span>  

* <span data-ttu-id="824b6-131">**База данных SQL Azure**.</span><span class="sxs-lookup"><span data-stu-id="824b6-131">**Azure SQL Database**.</span></span> <span data-ttu-id="824b6-132">Служба [База данных SQL Azure][sql-db] — это реляционная база данных, которая предоставляется как облачная служба.</span><span class="sxs-lookup"><span data-stu-id="824b6-132">[SQL Database][sql-db] is a relational database-as-a-service in the cloud.</span></span> <span data-ttu-id="824b6-133">База данных SQL использует свою базу кода совместно с ядром СУБД Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="824b6-133">SQL Database shares its code base with the Microsoft SQL Server database engine.</span></span> <span data-ttu-id="824b6-134">В зависимости от требований приложения можно также использовать службу [База данных Azure для MySQL](/azure/mysql) или [База данных Azure для PostgreSQL](/azure/postgresql).</span><span class="sxs-lookup"><span data-stu-id="824b6-134">Depending on your application requirements, you can also use [Azure Database for MySQL](/azure/mysql) or [Azure Database for PostgreSQL](/azure/postgresql).</span></span> <span data-ttu-id="824b6-135">Это полностью управляемые службы баз данных, основанные на ядрах СУБД с открытым исходным кодом MySQL и Postgres соответственно.</span><span class="sxs-lookup"><span data-stu-id="824b6-135">These are fully managed database services, based on the open source MySQL Server and Postgres database engines, respectively.</span></span>

* <span data-ttu-id="824b6-136">**Логический сервер.**</span><span class="sxs-lookup"><span data-stu-id="824b6-136">**Logical server**.</span></span> <span data-ttu-id="824b6-137">На логическом сервере в службе "База данных SQL Azure" размещаются базы данных.</span><span class="sxs-lookup"><span data-stu-id="824b6-137">In Azure SQL Database, a logical server hosts your databases.</span></span> <span data-ttu-id="824b6-138">Вы можете создать несколько баз данных на одном логическом сервере.</span><span class="sxs-lookup"><span data-stu-id="824b6-138">You can create multiple databases per logical server.</span></span>

* <span data-ttu-id="824b6-139">**Хранилище Azure.**</span><span class="sxs-lookup"><span data-stu-id="824b6-139">**Azure Storage**.</span></span> <span data-ttu-id="824b6-140">Создайте учетную запись хранения Azure и в ней — контейнер больших двоичных объектов для хранения журналов диагностики.</span><span class="sxs-lookup"><span data-stu-id="824b6-140">Create an Azure storage account with a blob container to store diagnostic logs.</span></span>

* <span data-ttu-id="824b6-141">**Azure Active Directory** (Azure AD).</span><span class="sxs-lookup"><span data-stu-id="824b6-141">**Azure Active Directory** (Azure AD).</span></span> <span data-ttu-id="824b6-142">Выполняйте аутентификацию при помощи Azure AD или другого поставщика удостоверений.</span><span class="sxs-lookup"><span data-stu-id="824b6-142">Use Azure AD or another identity provider for authentication.</span></span>

## <a name="recommendations"></a><span data-ttu-id="824b6-143">Рекомендации</span><span class="sxs-lookup"><span data-stu-id="824b6-143">Recommendations</span></span>

<span data-ttu-id="824b6-144">Описанная здесь архитектура может не соответствовать вашим требованиям.</span><span class="sxs-lookup"><span data-stu-id="824b6-144">Your requirements might differ from the architecture described here.</span></span> <span data-ttu-id="824b6-145">Используйте рекомендации из этого раздела в качестве отправной точки.</span><span class="sxs-lookup"><span data-stu-id="824b6-145">Use the recommendations in this section as a starting point.</span></span>

### <a name="app-service-plan"></a><span data-ttu-id="824b6-146">План службы приложений</span><span class="sxs-lookup"><span data-stu-id="824b6-146">App Service plan</span></span>
<span data-ttu-id="824b6-147">Используйте уровни "Стандартный" или "Премиум", которые поддерживают масштабирование, автомасштабирование и протокол SSL.</span><span class="sxs-lookup"><span data-stu-id="824b6-147">Use the Standard or Premium tiers, because they support scale out, autoscale, and secure sockets layer (SSL).</span></span> <span data-ttu-id="824b6-148">Каждый уровень поддерживает несколько *размеров экземпляров*, которые отличаются количеством ядер и объемом памяти.</span><span class="sxs-lookup"><span data-stu-id="824b6-148">Each tier supports several *instance sizes* that differ by number of cores and memory.</span></span> <span data-ttu-id="824b6-149">После создания плана можно изменить его уровень или размер экземпляров.</span><span class="sxs-lookup"><span data-stu-id="824b6-149">You can change the tier or instance size after you create a plan.</span></span> <span data-ttu-id="824b6-150">Дополнительные сведения см. на странице с [ценами на службу приложений][app-service-plans-tiers].</span><span class="sxs-lookup"><span data-stu-id="824b6-150">For more information about App Service plans, see [App Service Pricing][app-service-plans-tiers].</span></span>

<span data-ttu-id="824b6-151">Плата взимается за все экземпляры в плане службы приложений, даже если приложение остановлено.</span><span class="sxs-lookup"><span data-stu-id="824b6-151">You are charged for the instances in the App Service plan, even if the app is stopped.</span></span> <span data-ttu-id="824b6-152">Обязательно удаляйте планы, которые более не используются (например, тестовые развертывания).</span><span class="sxs-lookup"><span data-stu-id="824b6-152">Make sure to delete plans that you aren't using (for example, test deployments).</span></span>

### <a name="sql-database"></a><span data-ttu-id="824b6-153">База данных SQL</span><span class="sxs-lookup"><span data-stu-id="824b6-153">SQL Database</span></span>
<span data-ttu-id="824b6-154">Используйте службу "База данных SQL" [версии 12][sql-db-v12].</span><span class="sxs-lookup"><span data-stu-id="824b6-154">Use the [V12 version][sql-db-v12] of SQL Database.</span></span> <span data-ttu-id="824b6-155">Служба "База данных SQL" поддерживает [уровни службы][sql-db-service-tiers] "Базовый", "Стандартный" или "Премиум", а также несколько уровней производительности для каждого из них, которые измеряются в [единицах передачи данных (DTU)][sql-dtu].</span><span class="sxs-lookup"><span data-stu-id="824b6-155">SQL Database supports Basic, Standard, and Premium [service tiers][sql-db-service-tiers], with multiple performance levels within each tier measured in [Database Transaction Units (DTUs)][sql-dtu].</span></span> <span data-ttu-id="824b6-156">Оцените потребности в производительности и выберите подходящие уровни базы данных и производительности.</span><span class="sxs-lookup"><span data-stu-id="824b6-156">Perform capacity planning and choose a tier and performance level that meets your requirements.</span></span>

### <a name="region"></a><span data-ttu-id="824b6-157">Регион</span><span class="sxs-lookup"><span data-stu-id="824b6-157">Region</span></span>
<span data-ttu-id="824b6-158">Создайте план службы приложений и базу данных SQL в одном регионе, чтобы минимизировать задержки в сети.</span><span class="sxs-lookup"><span data-stu-id="824b6-158">Provision the App Service plan and the SQL Database in the same region to minimize network latency.</span></span> <span data-ttu-id="824b6-159">Обычно лучше выбирать регион, ближайший к пользователям приложения.</span><span class="sxs-lookup"><span data-stu-id="824b6-159">Generally, choose the region closest to your users.</span></span>

<span data-ttu-id="824b6-160">Группа ресурсов также привязана к региону, в котором хранятся метаданные развертывания.</span><span class="sxs-lookup"><span data-stu-id="824b6-160">The resource group also has a region, which specifies where deployment metadata is stored.</span></span> <span data-ttu-id="824b6-161">Поместите группу ресурсов и все ее ресурсы в один регион.</span><span class="sxs-lookup"><span data-stu-id="824b6-161">Put the resource group and its resources in the same region.</span></span> <span data-ttu-id="824b6-162">Это повысит доступность во время развертывания.</span><span class="sxs-lookup"><span data-stu-id="824b6-162">This can improve availability during deployment.</span></span> 

## <a name="scalability-considerations"></a><span data-ttu-id="824b6-163">Вопросы масштабируемости</span><span class="sxs-lookup"><span data-stu-id="824b6-163">Scalability considerations</span></span>

<span data-ttu-id="824b6-164">Главным преимуществом службы приложений Azure является возможность масштабировать приложение с учетом нагрузки.</span><span class="sxs-lookup"><span data-stu-id="824b6-164">A major benefit of Azure App Service is the ability to scale your application based on load.</span></span> <span data-ttu-id="824b6-165">Ниже приведены некоторые рекомендации, которые следует учитывать, если вы планируете масштабировать приложение.</span><span class="sxs-lookup"><span data-stu-id="824b6-165">Here are some considerations to keep in mind when planning to scale your application.</span></span>

### <a name="scaling-the-app-service-app"></a><span data-ttu-id="824b6-166">Масштабирование приложения в службе приложений</span><span class="sxs-lookup"><span data-stu-id="824b6-166">Scaling the App Service app</span></span>

<span data-ttu-id="824b6-167">Есть два способа масштабировать приложение службы приложений:</span><span class="sxs-lookup"><span data-stu-id="824b6-167">There are two ways to scale an App Service app:</span></span>

* <span data-ttu-id="824b6-168">*Вертикальное масштабирование*, что означает изменение размера экземпляра.</span><span class="sxs-lookup"><span data-stu-id="824b6-168">*Scale up*, which means changing the instance size.</span></span> <span data-ttu-id="824b6-169">Размер определяет доступный объем памяти, хранилища и количество ядер для каждого экземпляра виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="824b6-169">The instance size determines the memory, number of cores, and storage on each VM instance.</span></span> <span data-ttu-id="824b6-170">Вертикальное масштабирование выполняется вручную путем изменения размера экземпляров или уровня плана.</span><span class="sxs-lookup"><span data-stu-id="824b6-170">You can scale up manually by changing the instance size or the plan tier.</span></span>  

* <span data-ttu-id="824b6-171">*Горизонтальное масштабирование*, что означает добавление экземпляров при повышении нагрузки.</span><span class="sxs-lookup"><span data-stu-id="824b6-171">*Scale out*, which means adding instances to handle increased load.</span></span> <span data-ttu-id="824b6-172">В каждой ценовой категории есть ограничение на число экземпляров.</span><span class="sxs-lookup"><span data-stu-id="824b6-172">Each pricing tier has a maximum number of instances.</span></span> 

  <span data-ttu-id="824b6-173">Горизонтальное масштабирование можно выполнять вручную, изменяя число экземпляров, или с помощью функции [автомасштабирования][web-app-autoscale]. Эта функция позволяет автоматически добавлять или удалять экземпляры в Azure по заданному расписанию и (или) метрикам производительности.</span><span class="sxs-lookup"><span data-stu-id="824b6-173">You can scale out manually by changing the instance count, or use [autoscaling][web-app-autoscale] to have Azure automatically add or remove instances based on a schedule and/or performance metrics.</span></span> <span data-ttu-id="824b6-174">Операции масштабирования выполняются достаточно быстро, обычно за несколько секунд.</span><span class="sxs-lookup"><span data-stu-id="824b6-174">Each scale operation happens quickly&mdash;typically within seconds.</span></span> 

  <span data-ttu-id="824b6-175">Чтобы включить функцию автомасштабирования, создайте *профиль* автомасштабирования, в котором указано минимальное и максимальное число экземпляров.</span><span class="sxs-lookup"><span data-stu-id="824b6-175">To enable autoscaling, create an autoscale *profile* that defines the minimum and maximum number of instances.</span></span> <span data-ttu-id="824b6-176">Для профилей можно применить расписания.</span><span class="sxs-lookup"><span data-stu-id="824b6-176">Profiles can be scheduled.</span></span> <span data-ttu-id="824b6-177">Например, вы можете создать отдельные профили для будних и выходных дней.</span><span class="sxs-lookup"><span data-stu-id="824b6-177">For example, you might create separate profiles for weekdays and weekends.</span></span> <span data-ttu-id="824b6-178">Также профиль может содержать правила добавления или удаления экземпляров.</span><span class="sxs-lookup"><span data-stu-id="824b6-178">Optionally, a profile contains rules for when to add or remove instances.</span></span> <span data-ttu-id="824b6-179">(Например: добавлять два экземпляра, если в течение 5 минут загрузка ЦП превышает 70 %.)</span><span class="sxs-lookup"><span data-stu-id="824b6-179">(Example: Add two instances if CPU usage is above 70% for 5 minutes.)</span></span>
  
<span data-ttu-id="824b6-180">Рекомендации по масштабированию веб-приложения:</span><span class="sxs-lookup"><span data-stu-id="824b6-180">Recommendations for scaling a web app:</span></span>

* <span data-ttu-id="824b6-181">По возможности избегайте вертикального масштабирования, при котором часто происходит перезапуск приложения.</span><span class="sxs-lookup"><span data-stu-id="824b6-181">As much as possible, avoid scaling up and down, because it may trigger an application restart.</span></span> <span data-ttu-id="824b6-182">Вместо этого выберите уровень и размер экземпляров, которые соответствуют требованиям к производительности при типичной нагрузке, а затем используйте горизонтальное масштабирование, чтобы изменить число экземпляров в соответствии с объемом трафика.</span><span class="sxs-lookup"><span data-stu-id="824b6-182">Instead, select a tier and size that meet your performance requirements under typical load and then scale out the instances to handle changes in traffic volume.</span></span>    
* <span data-ttu-id="824b6-183">Примените функцию автомасштабирования.</span><span class="sxs-lookup"><span data-stu-id="824b6-183">Enable autoscaling.</span></span> <span data-ttu-id="824b6-184">Если объем рабочей нагрузки для вашего приложения стабилен и прогнозируем, создайте профили и расписание для своевременного добавления экземпляров.</span><span class="sxs-lookup"><span data-stu-id="824b6-184">If your application has a predictable, regular workload, create profiles to schedule the instance counts ahead of time.</span></span> <span data-ttu-id="824b6-185">Если рабочая нагрузка плохо прогнозируется, используйте автомасштабирование на основе правил, чтобы оперативно реагировать на изменения нагрузки.</span><span class="sxs-lookup"><span data-stu-id="824b6-185">If the workload is not predictable, use rule-based autoscaling to react to changes in load as they occur.</span></span> <span data-ttu-id="824b6-186">Можно использовать оба подхода одновременно.</span><span class="sxs-lookup"><span data-stu-id="824b6-186">You can combine both approaches.</span></span>
* <span data-ttu-id="824b6-187">Обычно в качестве метрики для правил автомасштабирования хорошо подходит загрузка ЦП.</span><span class="sxs-lookup"><span data-stu-id="824b6-187">CPU usage is generally a good metric for autoscale rules.</span></span> <span data-ttu-id="824b6-188">Но мы рекомендуем провести нагрузочный тест для приложения, определить потенциальные узкие места и в соответствии с ними создать правила автомасштабирования.</span><span class="sxs-lookup"><span data-stu-id="824b6-188">However, you should load test your application, identify potential bottlenecks, and base your autoscale rules on that data.</span></span>  
* <span data-ttu-id="824b6-189">Правила автомасштабирования охватывают *период ожидания* после очередного действия, в течение которого новые действия масштабирования не выполняются.</span><span class="sxs-lookup"><span data-stu-id="824b6-189">Autoscale rules include a *cool-down* period, which is the interval to wait after a scale action has completed before starting a new scale action.</span></span> <span data-ttu-id="824b6-190">Период ожидания позволяет стабилизировать систему перед новым масштабированием.</span><span class="sxs-lookup"><span data-stu-id="824b6-190">The cool-down period lets the system stabilize before scaling again.</span></span> <span data-ttu-id="824b6-191">Применяйте более короткий период ожидания для добавления экземпляров и более длительный — для их удаления.</span><span class="sxs-lookup"><span data-stu-id="824b6-191">Set a shorter cool-down period for adding instances, and a longer cool-down period for removing instances.</span></span> <span data-ttu-id="824b6-192">Например, 5 минут при добавлении экземпляра и 60 минут при его удалении.</span><span class="sxs-lookup"><span data-stu-id="824b6-192">For example, set 5 minutes to add an instance, but 60 minutes to remove an instance.</span></span> <span data-ttu-id="824b6-193">При значительной нагрузке можно быстро добавить сразу несколько экземпляров для ускоренной обработки трафика, а затем постепенно уменьшать их количество.</span><span class="sxs-lookup"><span data-stu-id="824b6-193">It's better to add new instances quickly under heavy load to handle the additional traffic, and then gradually scale back.</span></span>

### <a name="scaling-sql-database"></a><span data-ttu-id="824b6-194">База данных SQL Azure</span><span class="sxs-lookup"><span data-stu-id="824b6-194">Scaling SQL Database</span></span>
<span data-ttu-id="824b6-195">Если вам нужен более высокий уровень службы или производительности для базы данных SQL, вы можете масштабировать отдельные базы данных без простоя приложения.</span><span class="sxs-lookup"><span data-stu-id="824b6-195">If you need a higher service tier or performance level for SQL Database, you can scale up individual databases with no application downtime.</span></span> <span data-ttu-id="824b6-196">Дополнительные сведения см. в статье о [возможностях, производительности и особенностях уровней службы "База данных SQL"][sql-db-scale].</span><span class="sxs-lookup"><span data-stu-id="824b6-196">For more information, see [SQL Database options and performance: Understand what's available in each service tier][sql-db-scale].</span></span>

## <a name="availability-considerations"></a><span data-ttu-id="824b6-197">Вопросы доступности</span><span class="sxs-lookup"><span data-stu-id="824b6-197">Availability considerations</span></span>
<span data-ttu-id="824b6-198">На момент написания статьи для службы приложений действует соглашение об уровне обслуживания с доступностью 99,95 %, а для службы "База данных SQL" — с доступностью 99,99 % для уровней "Базовый", "Стандартный" и "Премиум".</span><span class="sxs-lookup"><span data-stu-id="824b6-198">At the time of writing, the service level agreement (SLA) for App Service is 99.95% and the SLA for SQL Database is 99.99% for Basic, Standard, and Premium tiers.</span></span> 

> [!NOTE]
> <span data-ttu-id="824b6-199">Соглашения об уровне обслуживания в службе приложений действуют как для одного, так и для нескольких экземпляров.</span><span class="sxs-lookup"><span data-stu-id="824b6-199">The App Service SLA applies to both single and multiple instances.</span></span>  
>
>

### <a name="backups"></a><span data-ttu-id="824b6-200">Резервные копии</span><span class="sxs-lookup"><span data-stu-id="824b6-200">Backups</span></span>
<span data-ttu-id="824b6-201">В случае потери данных служба "База данных SQL" обеспечивает восстановление до точки во времени и геовосстановление.</span><span class="sxs-lookup"><span data-stu-id="824b6-201">In the event of data loss, SQL Database provides point-in-time restore and geo-restore.</span></span> <span data-ttu-id="824b6-202">Эти функции доступны на всех уровнях и включаются автоматически.</span><span class="sxs-lookup"><span data-stu-id="824b6-202">These features are available in all tiers and are automatically enabled.</span></span> <span data-ttu-id="824b6-203">Нет необходимости настраивать расписание или параметры резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="824b6-203">You don't need to schedule or manage the backups.</span></span> 

- <span data-ttu-id="824b6-204">Используйте восстановление до точки во времени, чтобы [исправить ошибку оператора][sql-human-error]. При этом база данных возвращается к состоянию, в котором она находилась в определенный момент в прошлом.</span><span class="sxs-lookup"><span data-stu-id="824b6-204">Use point-in-time restore to [recover from human error][sql-human-error] by returning the database to an earlier point in time.</span></span> 
- <span data-ttu-id="824b6-205">Геовосстановление позволяет [восстановить данные после отключения служб][sql-outage-recovery], развертывая базу данных из геоизбыточной резервной копии.</span><span class="sxs-lookup"><span data-stu-id="824b6-205">Use geo-restore to [recover from a service outage][sql-outage-recovery] by restoring a database from a geo-redundant backup.</span></span> 

<span data-ttu-id="824b6-206">Дополнительные сведения см. в статье [Обзор обеспечения непрерывности бизнес-процессов с помощью базы данных SQL Azure][sql-backup].</span><span class="sxs-lookup"><span data-stu-id="824b6-206">For more information, see [Cloud business continuity and database disaster recovery with SQL Database][sql-backup].</span></span>

<span data-ttu-id="824b6-207">Служба приложений предоставляет возможность [резервного копирования и восстановления][web-app-backup] файлов приложения.</span><span class="sxs-lookup"><span data-stu-id="824b6-207">App Service provides a [backup and restore][web-app-backup] feature for your application files.</span></span> <span data-ttu-id="824b6-208">Однако учтите, что резервные копии создаются в том числе для файлов с параметрами в виде простого текста, где могут содержаться секретные данные, например строки соединения.</span><span class="sxs-lookup"><span data-stu-id="824b6-208">However, be aware that the backed-up files include app settings in plain text and these may include secrets, such as connection strings.</span></span> <span data-ttu-id="824b6-209">Старайтесь не использовать функцию резервного копирования службы приложений для баз данных SQL, так как при этом база данных SQL экспортируется в BACPAC-файл и на это расходуются единицы [DTU][sql-dtu].</span><span class="sxs-lookup"><span data-stu-id="824b6-209">Avoid using the App Service backup feature to back up your SQL databases because it exports the database to a SQL .bacpac file, consuming [DTUs][sql-dtu].</span></span> <span data-ttu-id="824b6-210">Вместо этого применяйте описанную выше функцию для восстановления базы данных SQL до точки во времени.</span><span class="sxs-lookup"><span data-stu-id="824b6-210">Instead, use SQL Database point-in-time restore described above.</span></span>

## <a name="manageability-considerations"></a><span data-ttu-id="824b6-211">Вопросы управляемости</span><span class="sxs-lookup"><span data-stu-id="824b6-211">Manageability considerations</span></span>
<span data-ttu-id="824b6-212">Создайте отдельные группы ресурсов для рабочей среды, сред разработки и тестирования.</span><span class="sxs-lookup"><span data-stu-id="824b6-212">Create separate resource groups for production, development, and test environments.</span></span> <span data-ttu-id="824b6-213">Так будет проще управлять развертыванием, удалять тестовые развертывания и назначать права доступа.</span><span class="sxs-lookup"><span data-stu-id="824b6-213">This makes it easier to manage deployments, delete test deployments, and assign access rights.</span></span>

<span data-ttu-id="824b6-214">При назначении ресурсов в группы ресурсов учитывайте следующие факторы:</span><span class="sxs-lookup"><span data-stu-id="824b6-214">When assigning resources to resource groups, consider the following:</span></span>

* <span data-ttu-id="824b6-215">Жизненный цикл.</span><span class="sxs-lookup"><span data-stu-id="824b6-215">Lifecycle.</span></span> <span data-ttu-id="824b6-216">Обычно в группу ресурсов лучше объединять ресурсы с одинаковым жизненным циклом.</span><span class="sxs-lookup"><span data-stu-id="824b6-216">In general, put resources with the same lifecycle into the same resource group.</span></span>
* <span data-ttu-id="824b6-217">Доступ.</span><span class="sxs-lookup"><span data-stu-id="824b6-217">Access.</span></span> <span data-ttu-id="824b6-218">С помощью [управления доступом на основе ролей][rbac] (RBAC) вы можете применить политики доступа к ресурсам в группе.</span><span class="sxs-lookup"><span data-stu-id="824b6-218">You can use [role-based access control][rbac] (RBAC) to apply access policies to the resources in a group.</span></span>
* <span data-ttu-id="824b6-219">Выставление счетов.</span><span class="sxs-lookup"><span data-stu-id="824b6-219">Billing.</span></span> <span data-ttu-id="824b6-220">Вы сможете просматривать сведенные затраты для группы ресурсов.</span><span class="sxs-lookup"><span data-stu-id="824b6-220">You can view the rolled-up costs for the resource group.</span></span>  

<span data-ttu-id="824b6-221">Дополнительные сведения см. в [обзоре Azure Resource Manager](/azure/azure-resource-manager/resource-group-overview).</span><span class="sxs-lookup"><span data-stu-id="824b6-221">For more information, see [Azure Resource Manager overview](/azure/azure-resource-manager/resource-group-overview).</span></span>

### <a name="deployment"></a><span data-ttu-id="824b6-222">Развертывание</span><span class="sxs-lookup"><span data-stu-id="824b6-222">Deployment</span></span>
<span data-ttu-id="824b6-223">Развертывание состоит из двух этапов.</span><span class="sxs-lookup"><span data-stu-id="824b6-223">Deployment involves two steps:</span></span>

1. <span data-ttu-id="824b6-224">Подготовка ресурсов Azure.</span><span class="sxs-lookup"><span data-stu-id="824b6-224">Provisioning the Azure resources.</span></span> <span data-ttu-id="824b6-225">Для выполнения этого шага мы рекомендуем использовать [шаблоны Azure Resoure Manager][arm-template].</span><span class="sxs-lookup"><span data-stu-id="824b6-225">We recommend that you use [Azure Resoure Manager templates][arm-template] for this step.</span></span> <span data-ttu-id="824b6-226">Шаблоны облегчают автоматическое развертывание с помощью PowerShell или интерфейса командной строки Azure.</span><span class="sxs-lookup"><span data-stu-id="824b6-226">Templates make it easier to automate deployments via PowerShell or the Azure command line interface (CLI).</span></span>
2. <span data-ttu-id="824b6-227">Развертывание приложения (код, двоичные файлы и файлы содержимого).</span><span class="sxs-lookup"><span data-stu-id="824b6-227">Deploying the application (code, binaries, and content files).</span></span> <span data-ttu-id="824b6-228">Здесь у вас есть несколько вариантов, в том числе: развертывание из локального репозитория Git, с помощью Visual Studio или непрерывное развертывание из системы управления версиями в облаке.</span><span class="sxs-lookup"><span data-stu-id="824b6-228">You have several options, including deploying from a local Git repository, using Visual Studio, or continuous deployment from cloud-based source control.</span></span> <span data-ttu-id="824b6-229">Дополнительные сведения см. в статье о [развертывании приложения в службе приложений Azure][deploy].</span><span class="sxs-lookup"><span data-stu-id="824b6-229">See [Deploy your app to Azure App Service][deploy].</span></span>  

<span data-ttu-id="824b6-230">В приложении службы приложений всегда есть один слот развертывания с именем `production`, который представляет действующий сайт в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="824b6-230">An App Service app always has one deployment slot named `production`, which represents the live production site.</span></span> <span data-ttu-id="824b6-231">Мы рекомендуем создать еще и промежуточный слот для развертывания обновлений.</span><span class="sxs-lookup"><span data-stu-id="824b6-231">We recommend creating a staging slot for deploying updates.</span></span> <span data-ttu-id="824b6-232">Промежуточный слот предоставит следующие преимущества:</span><span class="sxs-lookup"><span data-stu-id="824b6-232">The benefits of using a staging slot include:</span></span>

* <span data-ttu-id="824b6-233">Вы можете проверить успешность развертывания, прежде чем перемещать его в рабочую среду.</span><span class="sxs-lookup"><span data-stu-id="824b6-233">You can verify the deployment succeeded, before swapping it into production.</span></span>
* <span data-ttu-id="824b6-234">Развертывание в промежуточный слот гарантирует, что все экземпляры будут подготовлены перед перемещением в рабочую среду.</span><span class="sxs-lookup"><span data-stu-id="824b6-234">Deploying to a staging slot ensures that all instances are warmed up before being swapped into production.</span></span> <span data-ttu-id="824b6-235">Для многих приложений довольно долго выполняются начальная загрузка и "холодный" запуск.</span><span class="sxs-lookup"><span data-stu-id="824b6-235">Many applications have a significant warmup and cold-start time.</span></span>

<span data-ttu-id="824b6-236">Рекомендуем создать третий слот, в котором будет развернута последняя удачная версия приложения.</span><span class="sxs-lookup"><span data-stu-id="824b6-236">We also recommend creating a third slot to hold the last-known-good deployment.</span></span> <span data-ttu-id="824b6-237">После переключения с промежуточного слота на рабочий переместите в слот последней удачной версии предыдущее рабочее развертывание (которое теперь стало промежуточным).</span><span class="sxs-lookup"><span data-stu-id="824b6-237">After you swap staging and production, move the previous production deployment (which is now in staging) into the last-known-good slot.</span></span> <span data-ttu-id="824b6-238">Теперь, если позже обнаружится проблема, вы сможете быстро вернуться к последней удачной версии.</span><span class="sxs-lookup"><span data-stu-id="824b6-238">That way, if you discover a problem later, you can quickly revert to the last-known-good version.</span></span>

<span data-ttu-id="824b6-239">![[1]][1]</span><span class="sxs-lookup"><span data-stu-id="824b6-239">![[1]][1]</span></span>

<span data-ttu-id="824b6-240">Если потребуется вернуться к предыдущей версии, убедитесь, что все изменения схемы базы данных имеют обратную совместимость.</span><span class="sxs-lookup"><span data-stu-id="824b6-240">If you revert to a previous version, make sure any database schema changes are backward compatible.</span></span>

<span data-ttu-id="824b6-241">Не используйте слоты рабочего развертывания для тестирования, так как для всех приложений в одном плане службы приложений используются одни и те же экземпляры виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="824b6-241">Don't use slots on your production deployment for testing because all apps within the same App Service plan share the same VM instances.</span></span> <span data-ttu-id="824b6-242">Например, нагрузочные тесты могут привести к ухудшению производительности активного рабочего сайта.</span><span class="sxs-lookup"><span data-stu-id="824b6-242">For example, load tests might degrade the live production site.</span></span> <span data-ttu-id="824b6-243">Вместо этого создайте дополнительные планы службы приложений для рабочей и тестовой сред.</span><span class="sxs-lookup"><span data-stu-id="824b6-243">Instead, create separate App Service plans for production and test.</span></span> <span data-ttu-id="824b6-244">Поместив тестовые развертывания в отдельный план, можно изолировать их от рабочей версии.</span><span class="sxs-lookup"><span data-stu-id="824b6-244">By putting test deployments into a separate plan, you isolate them from the production version.</span></span>

### <a name="configuration"></a><span data-ttu-id="824b6-245">Параметр Configuration</span><span class="sxs-lookup"><span data-stu-id="824b6-245">Configuration</span></span>
<span data-ttu-id="824b6-246">Сохраняйте конфигурацию в виде [настроек приложений][app-settings].</span><span class="sxs-lookup"><span data-stu-id="824b6-246">Store configuration settings as [app settings][app-settings].</span></span> <span data-ttu-id="824b6-247">Определите параметры приложения в шаблонах Resource Manager или с помощью PowerShell.</span><span class="sxs-lookup"><span data-stu-id="824b6-247">Define the app settings in your Resource Manager templates, or using PowerShell.</span></span> <span data-ttu-id="824b6-248">В среде выполнения параметры приложений доступны из приложения как переменные среды.</span><span class="sxs-lookup"><span data-stu-id="824b6-248">At runtime, app settings are available to the application as environment variables.</span></span>

<span data-ttu-id="824b6-249">Ни в коем случае не помещайте пароли, ключи доступа или строки подключения в систему управления версиями.</span><span class="sxs-lookup"><span data-stu-id="824b6-249">Never check passwords, access keys, or connection strings into source control.</span></span> <span data-ttu-id="824b6-250">Вместо этого передавайте их в качестве параметров в скрипт развертывания, где эти значения сохранятся как параметры приложения.</span><span class="sxs-lookup"><span data-stu-id="824b6-250">Instead, pass these as parameters to a deployment script that stores these values as app settings.</span></span>

<span data-ttu-id="824b6-251">При переключении слотов развертывания по умолчанию заменяются и параметры приложения.</span><span class="sxs-lookup"><span data-stu-id="824b6-251">When you swap a deployment slot, the app settings are swapped by default.</span></span> <span data-ttu-id="824b6-252">Если вам нужно использовать для рабочего и промежуточного слотов разные параметры, создайте набор параметров и прикрепите его к слоту, чтобы они не изменялись при переключении слотов.</span><span class="sxs-lookup"><span data-stu-id="824b6-252">If you need different settings for production and staging, you can create app settings that stick to a slot and don't get swapped.</span></span>

### <a name="diagnostics-and-monitoring"></a><span data-ttu-id="824b6-253">Диагностика и мониторинг</span><span class="sxs-lookup"><span data-stu-id="824b6-253">Diagnostics and monitoring</span></span>
<span data-ttu-id="824b6-254">Включите [ведение журнала диагностики][diagnostic-logs], в частности для приложения и веб-сервера.</span><span class="sxs-lookup"><span data-stu-id="824b6-254">Enable [diagnostics logging][diagnostic-logs], including application logging and web server logging.</span></span> <span data-ttu-id="824b6-255">Настройте ведение журнала таким образом, чтобы он сохранялся в хранилище BLOB-объектов.</span><span class="sxs-lookup"><span data-stu-id="824b6-255">Configure logging to use Blob storage.</span></span> <span data-ttu-id="824b6-256">Для повышения производительности создайте отдельную учетную запись хранения для журналов диагностики.</span><span class="sxs-lookup"><span data-stu-id="824b6-256">For performance reasons, create a separate storage account for diagnostic logs.</span></span> <span data-ttu-id="824b6-257">Не используйте одну учетную запись хранения для журналов и данных приложения.</span><span class="sxs-lookup"><span data-stu-id="824b6-257">Don't use the same storage account for logs and application data.</span></span> <span data-ttu-id="824b6-258">Более подробные инструкции по ведению журналов см. в [руководстве по мониторингу и диагностике][monitoring-guidance].</span><span class="sxs-lookup"><span data-stu-id="824b6-258">For more detailed guidance on logging, see [Monitoring and diagnostics guidance][monitoring-guidance].</span></span>

<span data-ttu-id="824b6-259">Используйте службу [New Relic][new-relic] или [Application Insights][app-insights], чтобы контролировать производительность и поведение загруженных приложений.</span><span class="sxs-lookup"><span data-stu-id="824b6-259">Use a service such as [New Relic][new-relic] or [Application Insights][app-insights] to monitor application performance and behavior under load.</span></span> <span data-ttu-id="824b6-260">Не забывайте об [ограничениях на скорость передачи данных][app-insights-data-rate] в Application Insights.</span><span class="sxs-lookup"><span data-stu-id="824b6-260">Be aware of the [data rate limits][app-insights-data-rate] for Application Insights.</span></span>

<span data-ttu-id="824b6-261">Выполните нагрузочное тестирование с использованием специального средства, например [Visual Studio Team Services][vsts].</span><span class="sxs-lookup"><span data-stu-id="824b6-261">Perform load testing, using a tool such as [Visual Studio Team Services][vsts].</span></span> <span data-ttu-id="824b6-262">Общее описание анализа производительности в облачных приложениях вы найдете в [руководстве по анализу производительности для начинающих][perf-analysis].</span><span class="sxs-lookup"><span data-stu-id="824b6-262">For a general overview of performance analysis in cloud applications, see [Performance Analysis Primer][perf-analysis].</span></span>

<span data-ttu-id="824b6-263">Советы по устранению неполадок в приложениях.</span><span class="sxs-lookup"><span data-stu-id="824b6-263">Tips for troubleshooting your application:</span></span>

* <span data-ttu-id="824b6-264">Используйте [колонку устранения неполадок][troubleshoot-blade] на портале Azure, чтобы найти решения для распространенных проблем.</span><span class="sxs-lookup"><span data-stu-id="824b6-264">Use the [troubleshoot blade][troubleshoot-blade] in the Azure portal to find solutions to common problems.</span></span>
* <span data-ttu-id="824b6-265">Включите [потоковую передачу журналов][web-app-log-stream], чтобы получать данные из журналов практически в режиме реального времени.</span><span class="sxs-lookup"><span data-stu-id="824b6-265">Enable [log streaming][web-app-log-stream] to see logging information in near-real time.</span></span>
* <span data-ttu-id="824b6-266">[Панель мониторинга Kudu][kudu] предоставляет несколько средств для мониторинга и отладки приложения.</span><span class="sxs-lookup"><span data-stu-id="824b6-266">The [Kudu dashboard][kudu] has several tools for monitoring and debugging your application.</span></span> <span data-ttu-id="824b6-267">Дополнительные сведения см. в статье [Azure Websites online tools you should know about][kudu] (Интерактивные инструменты веб-сайтов Azure, о которых вам нужно знать).</span><span class="sxs-lookup"><span data-stu-id="824b6-267">For more information, see [Azure Websites online tools you should know about][kudu] (blog post).</span></span> <span data-ttu-id="824b6-268">Панель мониторинга Kudu можно открыть на портале Azure.</span><span class="sxs-lookup"><span data-stu-id="824b6-268">You can reach the Kudu dashboard from the Azure portal.</span></span> <span data-ttu-id="824b6-269">Для этого откройте колонку приложения и щелкните <strong>Средства</strong>, затем выберите <strong>Kudu</strong>.</span><span class="sxs-lookup"><span data-stu-id="824b6-269">Open the blade for your app and click <strong>Tools</strong>, then click <strong>Kudu</strong>.</span></span>
* <span data-ttu-id="824b6-270">Если вы используете Visual Studio, изучите статью [Устранение неполадок веб-приложения в службе приложений Azure с помощью Visual Studio][troubleshoot-web-app], в которой предлагаются советы по отладке и устранению неполадок.</span><span class="sxs-lookup"><span data-stu-id="824b6-270">If you use Visual Studio, see the article [Troubleshoot a web app in Azure App Service using Visual Studio][troubleshoot-web-app] for debugging and troubleshooting tips.</span></span>

## <a name="security-considerations"></a><span data-ttu-id="824b6-271">Вопросы безопасности</span><span class="sxs-lookup"><span data-stu-id="824b6-271">Security considerations</span></span>
<span data-ttu-id="824b6-272">В этом разделе перечислены рекомендации по безопасности, относящиеся к службам Azure, описанным в этой статье.</span><span class="sxs-lookup"><span data-stu-id="824b6-272">This section lists security considerations that are specific to the Azure services described in this article.</span></span> <span data-ttu-id="824b6-273">Это не полный список рекомендаций по обеспечению безопасности.</span><span class="sxs-lookup"><span data-stu-id="824b6-273">It's not a complete list of security best practices.</span></span> <span data-ttu-id="824b6-274">Дополнительные рекомендации см. в статье [Проверка подлинности и авторизация в службе приложений Azure][app-service-security].</span><span class="sxs-lookup"><span data-stu-id="824b6-274">For some additional security considerations, see [Secure an app in Azure App Service][app-service-security].</span></span>

### <a name="sql-database-auditing"></a><span data-ttu-id="824b6-275">аудит баз данных SQL;</span><span class="sxs-lookup"><span data-stu-id="824b6-275">SQL Database auditing</span></span>
<span data-ttu-id="824b6-276">Аудит поможет вам обеспечить соответствие нормативным требованиям и получать важные сведения об отклонениях и аномалиях, которые могут указывать на бизнес-проблемы или потенциальные нарушения безопасности.</span><span class="sxs-lookup"><span data-stu-id="824b6-276">Auditing can help you maintain regulatory compliance and get insight into discrepancies and irregularities that could indicate business concerns or suspected security violations.</span></span> <span data-ttu-id="824b6-277">См. статью [Приступая к работе с аудитом базы данных SQL][sql-audit].</span><span class="sxs-lookup"><span data-stu-id="824b6-277">See [Get started with SQL database auditing][sql-audit].</span></span>

### <a name="deployment-slots"></a><span data-ttu-id="824b6-278">Слоты развертывания</span><span class="sxs-lookup"><span data-stu-id="824b6-278">Deployment slots</span></span>
<span data-ttu-id="824b6-279">Каждый слот развертывания имеет общедоступный IP-адрес.</span><span class="sxs-lookup"><span data-stu-id="824b6-279">Each deployment slot has a public IP address.</span></span> <span data-ttu-id="824b6-280">Слоты, не используемые в рабочей среде, следует защитить с помощью [входа в Azure Active Directory][aad-auth], чтобы доступ к этим конечным точкам могли получить только члены команд разработки и DevOps.</span><span class="sxs-lookup"><span data-stu-id="824b6-280">Secure the nonproduction slots using [Azure Active Directory login][aad-auth] so that only members of your development and DevOps teams can reach those endpoints.</span></span>

### <a name="logging"></a><span data-ttu-id="824b6-281">Ведение журналов</span><span class="sxs-lookup"><span data-stu-id="824b6-281">Logging</span></span>
<span data-ttu-id="824b6-282">Ни в коем случае не сохраняйте в журналы такую информацию, как пароли пользователей или другие сведения, которые могут использовать мошенники.</span><span class="sxs-lookup"><span data-stu-id="824b6-282">Logs should never record users' passwords or other information that might be used to commit identity fraud.</span></span> <span data-ttu-id="824b6-283">Перед сохранением данных удалите такие сведения.</span><span class="sxs-lookup"><span data-stu-id="824b6-283">Scrub those details from the data before storing it.</span></span>   

### <a name="ssl"></a><span data-ttu-id="824b6-284">SSL</span><span class="sxs-lookup"><span data-stu-id="824b6-284">SSL</span></span>
<span data-ttu-id="824b6-285">Приложение службы приложений бесплатно получает одну конечную точку SSL в поддомене `azurewebsites.net`.</span><span class="sxs-lookup"><span data-stu-id="824b6-285">An App Service app includes an SSL endpoint on a subdomain of `azurewebsites.net` at no additional cost.</span></span> <span data-ttu-id="824b6-286">Конечная точка SSL содержит групповой сертификат для доменного имени `*.azurewebsites.net`.</span><span class="sxs-lookup"><span data-stu-id="824b6-286">The SSL endpoint includes a wildcard certificate for the `*.azurewebsites.net` domain.</span></span> <span data-ttu-id="824b6-287">Чтобы применить пользовательское доменное имя, самостоятельно предоставьте для него сертификат.</span><span class="sxs-lookup"><span data-stu-id="824b6-287">If you use a custom domain name, you must provide a certificate that matches the custom domain.</span></span> <span data-ttu-id="824b6-288">Для этого проще всего приобрести сертификат непосредственно на портале Azure.</span><span class="sxs-lookup"><span data-stu-id="824b6-288">The simplest approach is to buy a certificate directly through the Azure portal.</span></span> <span data-ttu-id="824b6-289">Также вы можете импортировать сертификаты других центров сертификации.</span><span class="sxs-lookup"><span data-stu-id="824b6-289">You can also import certificates from other certificate authorities.</span></span> <span data-ttu-id="824b6-290">Дополнительные сведения см. в статье [Приобретение и настройка сертификата SSL для службы приложений Azure][ssl-cert].</span><span class="sxs-lookup"><span data-stu-id="824b6-290">For more information, see [Buy and Configure an SSL Certificate for your Azure App Service][ssl-cert].</span></span>

<span data-ttu-id="824b6-291">Из соображений безопасности следует принудительно применять в приложении протокол HTTPS, перенаправляя все HTTP-запросы.</span><span class="sxs-lookup"><span data-stu-id="824b6-291">As a security best practice, your app should enforce HTTPS by redirecting HTTP requests.</span></span> <span data-ttu-id="824b6-292">Такое перенаправление можно реализовать в самом приложении или с помощью правила подстановки URL-адресов, как описано в разделе [Принудительное использование HTTPS][ssl-redirect].</span><span class="sxs-lookup"><span data-stu-id="824b6-292">You can implement this inside your application or use a URL rewrite rule as described in [Enable HTTPS for an app in Azure App Service][ssl-redirect].</span></span>

### <a name="authentication"></a><span data-ttu-id="824b6-293">Authentication</span><span class="sxs-lookup"><span data-stu-id="824b6-293">Authentication</span></span>
<span data-ttu-id="824b6-294">Мы рекомендуем выполнять аутентификацию при помощи поставщика удостоверений, например Azure AD, Facebook, Google или Twitter.</span><span class="sxs-lookup"><span data-stu-id="824b6-294">We recommend authenticating through an identity provider (IDP), such as Azure AD, Facebook, Google, or Twitter.</span></span> <span data-ttu-id="824b6-295">Используйте в потоке аутентификации маркеры OAuth 2 или OpenID Connect (OIDC).</span><span class="sxs-lookup"><span data-stu-id="824b6-295">Use OAuth 2 or OpenID Connect (OIDC) for the authentication flow.</span></span> <span data-ttu-id="824b6-296">Azure AD предоставляет функциональные возможности для управления пользователями и группами, создания ролей приложений, интеграции локальных служб идентификации и подключения серверных служб, например Office 365 и Skype для бизнеса.</span><span class="sxs-lookup"><span data-stu-id="824b6-296">Azure AD provides functionality to manage users and groups, create application roles, integrate your on-premises identities, and consume backend services such as Office 365 and Skype for Business.</span></span>

<span data-ttu-id="824b6-297">Избегайте прямого управления учетными данными в приложении, так как это может повысить уязвимость.</span><span class="sxs-lookup"><span data-stu-id="824b6-297">Avoid having the application manage user logins and credentials directly, as it creates a potential attack surface.</span></span>  <span data-ttu-id="824b6-298">Если вам необходим такой подход, реализуйте по меньшей мере подтверждение по электронной почте, восстановление паролей и многофакторную проверку подлинности, а также проверяйте надежность паролей и храните только их хэши.</span><span class="sxs-lookup"><span data-stu-id="824b6-298">At a minimum, you would need to have email confirmation, password recovery, and multi-factor authentication; validate password strength; and store password hashes securely.</span></span> <span data-ttu-id="824b6-299">Крупные поставщики удостоверений берут на себя заботу обо всех этих компонентах, постоянно контролируют и улучшают все меры по обеспечению безопасности.</span><span class="sxs-lookup"><span data-stu-id="824b6-299">The large identity providers handle all of those things for you, and are constantly monitoring and improving their security practices.</span></span>

<span data-ttu-id="824b6-300">Чтобы реализовать поток аутентификации с использованием OAuth или OIDC, рекомендуем применить [аутентификацию службы приложений][app-service-auth].</span><span class="sxs-lookup"><span data-stu-id="824b6-300">Consider using [App Service authentication][app-service-auth] to implement the OAuth/OIDC authentication flow.</span></span> <span data-ttu-id="824b6-301">Аутентификация службы приложений дает следующие преимущества:</span><span class="sxs-lookup"><span data-stu-id="824b6-301">The benefits of App Service authentication include:</span></span>

* <span data-ttu-id="824b6-302">Простота настройки.</span><span class="sxs-lookup"><span data-stu-id="824b6-302">Easy to configure.</span></span>
* <span data-ttu-id="824b6-303">Вам не нужно писать код для сценариев аутентификации.</span><span class="sxs-lookup"><span data-stu-id="824b6-303">No code is required for simple authentication scenarios.</span></span>
* <span data-ttu-id="824b6-304">Поддержка делегированной авторизации с помощью маркеров доступа OAuth для использования ресурсов от имени пользователя.</span><span class="sxs-lookup"><span data-stu-id="824b6-304">Supports delegated authorization using OAuth access tokens to consume resources on behalf of the user.</span></span>
* <span data-ttu-id="824b6-305">Встроенные кэши маркеров.</span><span class="sxs-lookup"><span data-stu-id="824b6-305">Provides a built-in token cache.</span></span>

<span data-ttu-id="824b6-306">Аутентификация службы приложений имеет и ряд ограничений:</span><span class="sxs-lookup"><span data-stu-id="824b6-306">Some limitations of App Service authentication:</span></span>  

* <span data-ttu-id="824b6-307">Ограниченные возможности настройки.</span><span class="sxs-lookup"><span data-stu-id="824b6-307">Limited customization options.</span></span>
* <span data-ttu-id="824b6-308">Делегированная авторизация поддерживается только для одного внутреннего ресурса в каждом сеансе входа.</span><span class="sxs-lookup"><span data-stu-id="824b6-308">Delegated authorization is restricted to one backend resource per login session.</span></span>
* <span data-ttu-id="824b6-309">Для сценария с несколькими поставщиками удостоверений нет встроенных механизмов обнаружения домашней области.</span><span class="sxs-lookup"><span data-stu-id="824b6-309">If you use more than one IDP, there is no built-in mechanism for home realm discovery.</span></span>
* <span data-ttu-id="824b6-310">При работе с несколькими клиентами логику для проверки издателя маркера нужно реализовать в приложении.</span><span class="sxs-lookup"><span data-stu-id="824b6-310">For multi-tenant scenarios, the application must implement the logic to validate the token issuer.</span></span>

## <a name="deploy-the-solution"></a><span data-ttu-id="824b6-311">Развертывание решения</span><span class="sxs-lookup"><span data-stu-id="824b6-311">Deploy the solution</span></span>
<span data-ttu-id="824b6-312">Пример шаблона Resource Manager для этой архитектуры вы найдете [на сайте GitHub][paas-basic-arm-template].</span><span class="sxs-lookup"><span data-stu-id="824b6-312">An example Resoure Manager template for this architecture is [available on GitHub][paas-basic-arm-template].</span></span>

<span data-ttu-id="824b6-313">Чтобы развернуть этот шаблон с помощью PowerShell, выполните следующие команды.</span><span class="sxs-lookup"><span data-stu-id="824b6-313">To deploy the template using PowerShell, run the following commands:</span></span>

```
New-AzureRmResourceGroup -Name <resource-group-name> -Location "West US"

$parameters = @{"appName"="<app-name>";"environment"="dev";"locationShort"="uw";"databaseName"="app-db";"administratorLogin"="<admin>";"administratorLoginPassword"="<password>"}

New-AzureRmResourceGroupDeployment -Name <deployment-name> -ResourceGroupName <resource-group-name> -TemplateFile .\PaaS-Basic.json -TemplateParameterObject  $parameters
```

<span data-ttu-id="824b6-314">Дополнительные сведения см. в статье [Развертывание ресурсов с использованием шаблонов Resource Manager и Azure PowerShell][deploy-arm-template].</span><span class="sxs-lookup"><span data-stu-id="824b6-314">For more information, see [Deploy resources with Azure Resource Manager templates][deploy-arm-template].</span></span>

<!-- links -->

[aad-auth]: /azure/app-service-mobile/app-service-mobile-how-to-configure-active-directory-authentication
[app-insights]: /azure/application-insights/app-insights-overview
[app-insights-data-rate]: /azure/application-insights/app-insights-pricing
[app-service]: https://azure.microsoft.com/documentation/services/app-service/
[app-service-auth]: /azure/app-service-api/app-service-api-authentication
[app-service-plans]: /azure/app-service/azure-web-sites-web-hosting-plans-in-depth-overview
[app-service-plans-tiers]: https://azure.microsoft.com/pricing/details/app-service/
[app-service-security]: /azure/app-service-web/web-sites-security
[app-settings]: /azure/app-service-web/web-sites-configure
[arm-template]: /azure/azure-resource-manager/resource-group-overview#resource-groups
[azure-dns]: /azure/dns/dns-overview
[custom-domain-name]: /azure/app-service-web/web-sites-custom-domain-name
[deploy]: /azure/app-service-web/web-sites-deploy
[deploy-arm-template]: /azure/resource-group-template-deploy
[deployment-slots]: /azure/app-service-web/web-sites-staged-publishing
[diagnostic-logs]: /azure/app-service-web/web-sites-enable-diagnostic-log
[kudu]: https://azure.microsoft.com/blog/windows-azure-websites-online-tools-you-should-know-about/
[monitoring-guidance]: ../../best-practices/monitoring.md
[new-relic]: http://newrelic.com/
[paas-basic-arm-template]: https://github.com/mspnp/reference-architectures/tree/master/managed-web-app/basic-web-app/Paas-Basic/Templates
[perf-analysis]: https://github.com/mspnp/performance-optimization/blob/master/Performance-Analysis-Primer.md
[rbac]: /azure/active-directory/role-based-access-control-what-is
[resource-group]: /azure/azure-resource-manager/resource-group-overview
[sla]: https://azure.microsoft.com/support/legal/sla/
[sql-audit]: /azure/sql-database/sql-database-auditing-get-started
[sql-backup]: /azure/sql-database/sql-database-business-continuity
[sql-db]: https://azure.microsoft.com/documentation/services/sql-database/
[sql-db-overview]: /azure/sql-database/sql-database-technical-overview
[sql-db-scale]: /azure/sql-database/sql-database-service-tiers#scaling-up-or-scaling-down-a-single-database
[sql-db-service-tiers]: /azure/sql-database/sql-database-service-tiers
[sql-db-v12]: /azure/sql-database/sql-database-features
[sql-dtu]: /azure/sql-database/sql-database-service-tiers
[sql-human-error]: /azure/sql-database/sql-database-business-continuity#recover-a-database-after-a-user-or-application-error
[sql-outage-recovery]: /azure/sql-database/sql-database-business-continuity#recover-a-database-to-another-region-from-an-azure-regional-data-center-outage
[ssl-redirect]: /azure/app-service-web/web-sites-configure-ssl-certificate#bkmk_enforce
[sql-resource-limits]: /azure/sql-database/sql-database-resource-limits
[ssl-cert]: /azure/app-service-web/web-sites-purchase-ssl-web-site
[troubleshoot-blade]: https://azure.microsoft.com/updates/self-service-troubleshooting-for-app-service-web-apps-customers/
[troubleshoot-web-app]: /azure/app-service-web/web-sites-dotnet-troubleshoot-visual-studio
[visio-download]: https://archcenter.blob.core.windows.net/cdn/app-service-reference-architectures.vsdx
[vsts]: https://www.visualstudio.com/features/vso-cloud-load-testing-vs.aspx
[web-app-autoscale]: /azure/app-service-web/web-sites-scale
[web-app-backup]: /azure/app-service-web/web-sites-backup
[web-app-log-stream]: /azure/app-service-web/web-sites-enable-diagnostic-log#streamlogs
[0]: ./images/basic-web-app.png "Архитектура базового веб-приложения Azure"
[1]: ./images/paas-basic-web-app-staging-slots.png "Переключение слотов рабочей среды и промежуточного развертывания"
