---
title: Мониторинг веб-приложений в Azure
description: Мониторинг веб-приложения, размещенного в Службе приложений Azure.
author: adamboeglin
ms.date: 12/12/2018
ms.topic: reference-architecture
ms.service: architecture-center
ms.subservice: reference-architecture
ms.custom: azcat
ms.openlocfilehash: 5219d08fce5cf09b075b6d7adfb73970e007ded4
ms.sourcegitcommit: 1b50810208354577b00e89e5c031b774b02736e2
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/23/2019
ms.locfileid: "54487939"
---
# <a name="web-application-monitoring-on-azure"></a><span data-ttu-id="0e8e7-103">Мониторинг веб-приложений в Azure</span><span class="sxs-lookup"><span data-stu-id="0e8e7-103">Web application monitoring on Azure</span></span>

<span data-ttu-id="0e8e7-104">Платформа как услуга (PaaS) в Azure используется для управления вычислительными ресурсами. От нее зависят способы мониторинга развертываний.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-104">Azure platform as a service (PaaS) offerings manage compute resources for you and affect how you monitor deployments.</span></span> <span data-ttu-id="0e8e7-105">Azure включает в себя несколько служб мониторинга, каждая из которых выполняет определенную роль.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-105">Azure includes multiple monitoring services, each of which performs a specific role.</span></span> <span data-ttu-id="0e8e7-106">Вместе эти службы предоставляют комплексное решение для сбора, анализа и использования телеметрии из соответствующих приложений и ресурсов Azure.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-106">Together, these services deliver a comprehensive solution for collecting, analyzing, and acting on telemetry from your applications and the Azure resources they consume.</span></span>

<span data-ttu-id="0e8e7-107">В этом сценарии рассматриваются службы мониторинга, которые можно использовать, и описывается модель потока данных, используемая с несколькими источниками данных.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-107">This scenario addresses the monitoring services you can use and describes a dataflow model for use with multiple data sources.</span></span> <span data-ttu-id="0e8e7-108">Что касается мониторинга, то с развертыванием Azure могут работать многие средства и службы.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-108">When it comes to monitoring, many tools and services work with Azure deployments.</span></span> <span data-ttu-id="0e8e7-109">В этом сценарии выбираются готовые службы, так как их легко использовать.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-109">In this scenario, we choose readily available services precisely because they are easy to consume.</span></span> <span data-ttu-id="0e8e7-110">Остальные параметры мониторинга рассматриваются далее.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-110">Other monitoring options are discussed later in this article.</span></span>

## <a name="relevant-use-cases"></a><span data-ttu-id="0e8e7-111">Варианты соответствующего использования</span><span class="sxs-lookup"><span data-stu-id="0e8e7-111">Relevant use cases</span></span>

<span data-ttu-id="0e8e7-112">Другие варианты использования:</span><span class="sxs-lookup"><span data-stu-id="0e8e7-112">Other relevant use cases include:</span></span>

- <span data-ttu-id="0e8e7-113">инструментирование веб-приложения для мониторинга телеметрии;</span><span class="sxs-lookup"><span data-stu-id="0e8e7-113">Instrumenting a web application for monitoring telemetry.</span></span>
- <span data-ttu-id="0e8e7-114">сбор телеметрии интерфейса и сервера для приложения, развернутого в Azure;</span><span class="sxs-lookup"><span data-stu-id="0e8e7-114">Collecting front-end and back-end telemetry for an application deployed on Azure.</span></span>
- <span data-ttu-id="0e8e7-115">мониторинг метрик и квот, связанных со службами в Azure.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-115">Monitoring metrics and quotas associated with services on Azure.</span></span>

## <a name="architecture"></a><span data-ttu-id="0e8e7-116">Архитектура</span><span class="sxs-lookup"><span data-stu-id="0e8e7-116">Architecture</span></span>

![Схема архитектуры](./images/architecture-diagram-app-monitoring.svg)

<span data-ttu-id="0e8e7-118">В этом сценарии для размещения приложения и уровня данных используется управляемая среда Azure.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-118">This scenario uses a managed Azure environment to host an application and data tier.</span></span> <span data-ttu-id="0e8e7-119">Данные передаются в сценарии следующим образом:</span><span class="sxs-lookup"><span data-stu-id="0e8e7-119">The data flows through the scenario as follows:</span></span>

1. <span data-ttu-id="0e8e7-120">пользователь взаимодействует с приложением;</span><span class="sxs-lookup"><span data-stu-id="0e8e7-120">A user interacts with the application.</span></span>
2. <span data-ttu-id="0e8e7-121">с помощью браузера и службы приложений выполняется отправка телеметрии;</span><span class="sxs-lookup"><span data-stu-id="0e8e7-121">The browser and app service emit telemetry.</span></span>
3. <span data-ttu-id="0e8e7-122">служба Application Insights собирает и анализирует данные о работоспособности приложения, его производительности и использовании;</span><span class="sxs-lookup"><span data-stu-id="0e8e7-122">Application Insights collects and analyzes application health, performance, and usage data.</span></span>
4. <span data-ttu-id="0e8e7-123">разработчики и администраторы могут просматривать данные о работоспособности, производительности и использовании;</span><span class="sxs-lookup"><span data-stu-id="0e8e7-123">Developers and administrators can review health, performance, and usage information.</span></span>
5. <span data-ttu-id="0e8e7-124">при помощи базы данных SQL Azure выполняется отправка телеметрии;</span><span class="sxs-lookup"><span data-stu-id="0e8e7-124">Azure SQL Database emits telemetry.</span></span>
6. <span data-ttu-id="0e8e7-125">Azure Monitor собирает и анализирует метрики инфраструктуры и квоты;</span><span class="sxs-lookup"><span data-stu-id="0e8e7-125">Azure Monitor collects and analyzes infrastructure metrics and quotas.</span></span>
7. <span data-ttu-id="0e8e7-126">служба Log Analytics собирает и анализирует журналы и метрики;</span><span class="sxs-lookup"><span data-stu-id="0e8e7-126">Log Analytics collects and analyzes logs and metrics.</span></span>
8. <span data-ttu-id="0e8e7-127">разработчики и администраторы могут просматривать данные о работоспособности, производительности и использовании.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-127">Developers and administrators can review health, performance, and usage information.</span></span>

### <a name="components"></a><span data-ttu-id="0e8e7-128">Компоненты</span><span class="sxs-lookup"><span data-stu-id="0e8e7-128">Components</span></span>

- <span data-ttu-id="0e8e7-129">[Служба приложений Azure](/azure/app-service/) — это служба PaaS (платформа как услуга), используемая для создания и размещения приложений в управляемых виртуальных машинах.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-129">[Azure App Service](/azure/app-service/) is a PaaS service for building and hosting apps in managed virtual machines.</span></span> <span data-ttu-id="0e8e7-130">Вы сами управляете базовой вычислительной инфраструктурой, в которой работают приложения.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-130">The underlying compute infrastructures on which your apps run is managed for you.</span></span> <span data-ttu-id="0e8e7-131">Служба приложений выполняет мониторинг квот по использованию ресурсов и приложений метрики, журналов сведений о диагностике и оповещений, основанных на метриках.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-131">App Service provides monitoring of resource usage quotas and app metrics, logging of diagnostic information, and alerts based on metrics.</span></span> <span data-ttu-id="0e8e7-132">Более того, Application Insights можно использовать для создания [тестов доступности][availability-tests], с помощью которых можно проверять приложения из разных регионов.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-132">Even better, you can use Application Insights to create [availability tests][availability-tests] for testing your application from different regions.</span></span>
- <span data-ttu-id="0e8e7-133">[Application Insights][application-insights] — это расширяемая служба управления производительностью приложений (APM) для разработчиков, поддерживаемая на нескольких платформах.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-133">[Application Insights][application-insights] is an extensible Application Performance Management (APM) service for developers and supports multiple platforms.</span></span> <span data-ttu-id="0e8e7-134">Она используется для отслеживания приложений, обнаружения таких отклонений в работе приложений, как низкая производительность и ошибки, а также для отправки телеметрии на портал Azure.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-134">It monitors the application, detects application anomalies such as poor performance and failures, and sends telemetry to the Azure portal.</span></span> <span data-ttu-id="0e8e7-135">Также Application Insights можно использовать для ведения журнала, распределенной трассировки и метрик пользовательского приложения.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-135">Application Insights can also be used for logging, distributed tracing, and custom application metrics.</span></span>
- <span data-ttu-id="0e8e7-136">[Azure Monitor][azure-monitor] предоставляет [метрики и журналы][metrics] инфраструктуры базового уровня для большинства служб в Azure.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-136">[Azure Monitor][azure-monitor] provides base-level infrastructure [metrics and logs][metrics] for most services in Azure.</span></span> <span data-ttu-id="0e8e7-137">Пользователь может взаимодействовать с метриками несколькими способами, включая создание диаграмм метрик на портале Azure, доступ к метрикам через REST API или запрос метрик с помощью PowerShell или интерфейса командной строки.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-137">You can interact with the metrics in several ways, including charting them in Azure portal, accessing them through the REST API, or querying them using PowerShell or CLI.</span></span> <span data-ttu-id="0e8e7-138">Также Azure Monitor предлагает использовать данные непосредственно в [Log Analytics и других службах], в которых пользователь может запрашивать и комбинировать их с данными из других источников локально или в облаке.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-138">Azure Monitor also offers its data directly into [Log Analytics and other services], where you can query and combine it with data from other sources on premises or in the cloud.</span></span>
- <span data-ttu-id="0e8e7-139">[Log Analytics][log-analytics] используется для сопоставления данных об использовании и производительности, собранных Application Insights, с данными о конфигурации и производительности ресурсов Azure, которые поддерживают работу приложения.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-139">[Log Analytics][log-analytics] helps correlate the usage and performance data collected by Application Insights with configuration and performance data across the Azure resources that support the app.</span></span> <span data-ttu-id="0e8e7-140">Чтобы передать журналы аудита SQL Server в Log Analytics в этом сценарии используется [агент Azure Log Analytics][Azure Log Analytics agent].</span><span class="sxs-lookup"><span data-stu-id="0e8e7-140">This scenario uses the [Azure Log Analytics agent][Azure Log Analytics agent] to push SQL Server audit logs into Log Analytics.</span></span> <span data-ttu-id="0e8e7-141">В колонке Log Analytics на портале Azure можно записывать запросы и просматривать данные.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-141">You can write queries and view data in the Log Analytics blade of the Azure portal.</span></span>

## <a name="considerations"></a><span data-ttu-id="0e8e7-142">Рекомендации</span><span class="sxs-lookup"><span data-stu-id="0e8e7-142">Considerations</span></span>

<span data-ttu-id="0e8e7-143">Application Insights рекомендуется добавить в код при разработке с помощью [пакетов SDK для Application Insights][Application Insights SDKs] с последующей настройкой для каждого приложения.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-143">A recommended practice is adding Application Insights to your code during development using the [Application Insights SDKs][Application Insights SDKs], and customizing per application.</span></span> <span data-ttu-id="0e8e7-144">Пакеты SDK с открытым исходным кодом доступны для большинства исполняющих сред.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-144">These open-source SDKs are available for most application frameworks.</span></span> <span data-ttu-id="0e8e7-145">Чтобы расширить и контролировать собранные данные, включите пакеты SDK для тестирования и рабочего развертывания в процесс разработки.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-145">To enrich and control the data you collect, incorporate the use of the SDKs both for testing and production deployments into your development process.</span></span> <span data-ttu-id="0e8e7-146">Основное требование для приложений — наличие прямой или непрямой связи с конечной точкой приема Applications Insights, размещенной с помощью адреса, ориентированного на Интернет.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-146">The main requirement is for the app to have a direct or indirect line of sight to the Applications Insights ingestion endpoint hosted with an Internet-facing address.</span></span> <span data-ttu-id="0e8e7-147">После этого можно добавить телеметрию или обогатить существующую коллекцию телеметрии.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-147">You can then add telemetry or enrich an existing telemetry collection.</span></span>

<span data-ttu-id="0e8e7-148">Еще один быстрый способ приступить к работе — мониторинг сред выполнения.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-148">Runtime monitoring is another easy way to get started.</span></span> <span data-ttu-id="0e8e7-149">Управление собранными данными телеметрии должно выполнятся с помощью файлов конфигурации.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-149">The telemetry that is collected must be controlled through configuration files.</span></span> <span data-ttu-id="0e8e7-150">Например, можно включить методы среды выполнения, в которые включены такие инструменты как [монитор состояний Application Insights][Application Insights Status Monitor], предназначенный для развертывания пакетов SDK в нужную папку, и добавить нужные конфигурации для начала мониторинга.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-150">For example, you can include runtime methods that enable tools such as [Application Insights Status Monitor][Application Insights Status Monitor] to deploy the SDKs into the correct folder and add the right configurations to begin monitoring.</span></span>

<span data-ttu-id="0e8e7-151">Как и Application Insights, Log Analytics предоставляет средства для [анализа данных из разных источников][analyzing data across sources], создания сложных запросов и [отправки упреждающих оповещений][sending proactive alerts] на основе указанных условий.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-151">Like Application Insights, Log Analytics provides tools for [analyzing data across sources][analyzing data across sources], creating complex queries, and [sending proactive alerts][sending proactive alerts] on specified conditions.</span></span> <span data-ttu-id="0e8e7-152">Просматривать телеметрию можно также на [портале Azure][the Azure portal].</span><span class="sxs-lookup"><span data-stu-id="0e8e7-152">You can also view telemetry in [the Azure portal][the Azure portal].</span></span> <span data-ttu-id="0e8e7-153">Log Analytics используется для повышения эффективности таких существующих служб мониторинга, как [Azure Monitor][azure-monitor], а также для мониторинга локальных сред.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-153">Log Analytics adds value to existing monitoring services such as [Azure Monitor][azure-monitor] and can also monitor on-premises environments.</span></span>

<span data-ttu-id="0e8e7-154">В Application Insights и Log Analytics используется [язык запросов Azure Log Analytics][Azure Log Analytics Query Language].</span><span class="sxs-lookup"><span data-stu-id="0e8e7-154">Both Application Insights and Log Analytics use [Azure Log Analytics Query Language][Azure Log Analytics Query Language].</span></span> <span data-ttu-id="0e8e7-155">Также для анализа телеметрии, собранной Application Insights и Log Analytics, с помощью единого запроса можно использовать [запросы между ресурсами](https://azure.microsoft.com/blog/query-across-resources).</span><span class="sxs-lookup"><span data-stu-id="0e8e7-155">You can also use [cross-resource queries](https://azure.microsoft.com/blog/query-across-resources) to analyze the telemetry gathered by Application Insights and Log Analytics in a single query.</span></span>

<span data-ttu-id="0e8e7-156">Azure Monitor, Application Insights и Log Analytics используются для отправки [оповещений](/azure/monitoring-and-diagnostics/monitoring-overview-alerts).</span><span class="sxs-lookup"><span data-stu-id="0e8e7-156">Azure Monitor, Application Insights, and Log Analytics all send [alerts](/azure/monitoring-and-diagnostics/monitoring-overview-alerts).</span></span> <span data-ttu-id="0e8e7-157">Например, к оповещениям метрики Azure Monitor уровня платформы можно отнести загрузку ЦП, а к оповещениям метрик Application Insights уровня приложения — время отклика сервера.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-157">For example, Azure Monitor alerts on platform-level metrics such as CPU utilization, while Application Insights alerts on application-level metrics such as server response time.</span></span> <span data-ttu-id="0e8e7-158">Azure Monitor уведомляет о новых событиях в журнале действий Azure, в то время как служба Log Analytics может уведомлять о метриках или данных о событиях для служб, настроенных для ее использования.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-158">Azure Monitor alerts on new events in the Azure Activity Log, while Log Analytics can issue alerts about metrics or event data for the services configured to use it.</span></span> <span data-ttu-id="0e8e7-159">[Функция "Унифицированные оповещения" в Azure Monitor](/azure/monitoring-and-diagnostics/monitoring-overview-unified-alerts) представляет собой новый, единый интерфейс оповещений в Azure, для которого используется разная классификация.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-159">[Unified alerts in Azure Monitor](/azure/monitoring-and-diagnostics/monitoring-overview-unified-alerts) is a new, unified alerting experience in Azure that uses a different taxonomy.</span></span>

### <a name="alternatives"></a><span data-ttu-id="0e8e7-160">Альтернативные варианты</span><span class="sxs-lookup"><span data-stu-id="0e8e7-160">Alternatives</span></span>

<span data-ttu-id="0e8e7-161">С помощью популярных функций в этой статье описываются доступные параметры мониторинга. При этом у пользователя остается богатый выбор, включая возможность создания собственных механизмов ведения журнала.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-161">This article describes conveniently available monitoring options with popular features, but you have many choices, including the option to create your own logging mechanisms.</span></span> <span data-ttu-id="0e8e7-162">Добавлять службы мониторинга рекомендуется при создании уровней в решении.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-162">A recommended practice is to add monitoring services as you build out tiers in a solution.</span></span> <span data-ttu-id="0e8e7-163">Ниже приведены некоторые расширения и альтернативные варианты.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-163">Here are some possible extensions and alternatives:</span></span>

- <span data-ttu-id="0e8e7-164">Объединение метрик Azure Monitor и Application Insights в Grafana с помощью [источника данных Azure Monitor для Grafana][Azure Monitor Data Source For Grafana].</span><span class="sxs-lookup"><span data-stu-id="0e8e7-164">Consolidate Azure Monitor and Application Insights metrics in Grafana using the [Azure Monitor Data Source For Grafana][Azure Monitor Data Source For Grafana].</span></span>
- <span data-ttu-id="0e8e7-165">Служба [Data Dog][data-dog] включает в себя соединитель для Azure Monitor.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-165">[Data Dog][data-dog] features a connector for Azure Monitor</span></span>
- <span data-ttu-id="0e8e7-166">Использование [службы автоматизации Azure][Azure Automation] для автоматизации функций мониторинга.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-166">Automate monitoring functions using [Azure Automation][Azure Automation].</span></span>
- <span data-ttu-id="0e8e7-167">Добавление обмена данными с помощью [решений ITSM][ITSM solutions].</span><span class="sxs-lookup"><span data-stu-id="0e8e7-167">Add communication with [ITSM solutions][ITSM solutions].</span></span>
- <span data-ttu-id="0e8e7-168">Расширение Log Analytics с помощью [решения по управлению][management solution].</span><span class="sxs-lookup"><span data-stu-id="0e8e7-168">Extend Log Analytics with a [management solution][management solution].</span></span>

### <a name="scalability-and-availability"></a><span data-ttu-id="0e8e7-169">Доступность и масштабируемость</span><span class="sxs-lookup"><span data-stu-id="0e8e7-169">Scalability and availability</span></span>

<span data-ttu-id="0e8e7-170">По большей части в данном сценарии основное внимание уделяется решениям PaaS для мониторинга, так как их удобно использовать для обеспечения доступности и масштабируемости, а также они поддерживаются соглашениями об уровне обслуживания (SLA).</span><span class="sxs-lookup"><span data-stu-id="0e8e7-170">This scenario focuses on PaaS solutions for monitoring in large part because they conveniently handle availability and scalability for you and are backed by service-level agreements (SLAs).</span></span> <span data-ttu-id="0e8e7-171">Например, использование служб приложений предусматривает [SLA][SLA] для гарантированной доступности.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-171">For example, App Services provides a guaranteed [SLA][SLA] for its availability.</span></span>

<span data-ttu-id="0e8e7-172">У Application Insights есть [ограничения][app-insights-limits] на количество обрабатываемых запросов в секунду.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-172">Application Insights has [limits][app-insights-limits] on how many requests can be processed per second.</span></span> <span data-ttu-id="0e8e7-173">Если превысить лимит, то возникнет регулирование количества запросов сообщений.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-173">If you exceed the request limit, you may experience message throttling.</span></span> <span data-ttu-id="0e8e7-174">Чтобы этого избежать, необходимо выполнить [фильтрацию][message-filtering] или [выборку][message-sampling], что позволит уменьшить интенсивность передачи данных.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-174">To prevent throttling, implement [filtering][message-filtering] or [sampling][message-sampling] to reduce the data rate</span></span>

<span data-ttu-id="0e8e7-175">Тем не менее, за рекомендации по высокой доступности, предназначенные для запущенного приложения, ответственность несет разработчик.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-175">High availability considerations for the app you run, however, are the developer's responsibility.</span></span> <span data-ttu-id="0e8e7-176">Например, дополнительные сведения о масштабе см. в разделе [Вопросы масштабируемости](#scalability-considerations) в эталонной архитектуре базового веб-приложения.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-176">For information about scale, for example, see the [Scalability considerations](#scalability-considerations) section in the basic web application reference architecture.</span></span> <span data-ttu-id="0e8e7-177">После развертывания приложения можно использовать Application Insights и настроить тесты для [мониторинга доступности][monitor its availability].</span><span class="sxs-lookup"><span data-stu-id="0e8e7-177">After an app is deployed, you can set up tests to [monitor its availability][monitor its availability] using Application Insights.</span></span>

### <a name="security"></a><span data-ttu-id="0e8e7-178">Безопасность</span><span class="sxs-lookup"><span data-stu-id="0e8e7-178">Security</span></span>

<span data-ttu-id="0e8e7-179">Информация с ограниченным доступом и требования соответствия влияют на сбор, сохранение и хранение данных.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-179">Sensitive information and compliance requirements affect data collection, retention, and storage.</span></span> <span data-ttu-id="0e8e7-180">Узнайте больше об обработке телеметрии в [Application Insights][application-insights] и [Log Analytics][log-analytics].</span><span class="sxs-lookup"><span data-stu-id="0e8e7-180">Learn more about how [Application Insights][application-insights] and [Log Analytics][log-analytics] handle telemetry.</span></span>

<span data-ttu-id="0e8e7-181">Следующие вопросы безопасности также могут быть применены.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-181">The following security considerations may also apply:</span></span>

- <span data-ttu-id="0e8e7-182">Разработка плана обработки личной информации в случае, когда разработчикам можно собирать собственные данные или обогащать существующую телеметрию.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-182">Develop a plan to handle personal information if developers are allowed to collect their own data or enrich existing telemetry.</span></span>
- <span data-ttu-id="0e8e7-183">Рассмотрение сохранения данных.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-183">Consider data retention.</span></span> <span data-ttu-id="0e8e7-184">Например, Application Insights хранит данные телеметрии на протяжении 90 дней.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-184">For example, Application Insights retains telemetry data for 90 days.</span></span> <span data-ttu-id="0e8e7-185">Для доступа к архивным данным, которые хранятся в течение длительного времени, используется Microsoft Power BI, непрерывный экспорт или REST API.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-185">Archive data you want access to for longer periods using Microsoft Power BI, Continuous Export, or the REST API.</span></span> <span data-ttu-id="0e8e7-186">Применимы ставки за использование хранилища.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-186">Storage rates apply.</span></span>
- <span data-ttu-id="0e8e7-187">Ограничение доступа к ресурсам Azure. Это позволит управлять доступом к данным и тем, кто может просматривать телеметрию из определенного приложения.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-187">Limit access to Azure resources to control access to data and who can view telemetry from a specific application.</span></span> <span data-ttu-id="0e8e7-188">Чтобы получить дополнительные сведения о блокировке доступа к мониторингу телеметрии, см. статью [Ресурсы, роли и контроль доступа в Application Insights][Resources, roles, and access control in Application Insights].</span><span class="sxs-lookup"><span data-stu-id="0e8e7-188">To help lock down access to monitoring telemetry, see [Resources, roles, and access control in Application Insights][Resources, roles, and access control in Application Insights].</span></span>
- <span data-ttu-id="0e8e7-189">Рассмотрение необходимости управлять доступом на чтение или запись в коде приложения, чтобы избежать добавления пользователями маркеров версий или тегов, которые ограничивают прием данных из приложения.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-189">Consider whether to control read/write access in application code to prevent users from adding version or tag markers that limit data ingestion from the application.</span></span> <span data-ttu-id="0e8e7-190">При использовании Application Insights контроль над отдельными элементами данных после их отправки на ресурс отсутствует, поэтому если у пользователя есть доступ к каким-либо данным, он получает доступ ко всем данным отдельного ресурса.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-190">With Application Insights, there is no control over individual data items once they are sent to a resource, so if a user has access to any data, they have access to all data in an individual resource.</span></span>
- <span data-ttu-id="0e8e7-191">Добавление механизма [системы управления](/azure/security/governance-in-azure) для применения управления политикой или затратами в ресурсах Azure (при необходимости).</span><span class="sxs-lookup"><span data-stu-id="0e8e7-191">Add [governance](/azure/security/governance-in-azure) mechanisms to enforce policy or cost controls over Azure resources if needed.</span></span> <span data-ttu-id="0e8e7-192">В качестве примера можно использовать Log Analytics для связанного с безопасностью мониторинга, например, политики и управления доступом на основе ролей. Также можно использовать [политику Azure](/azure/azure-policy/azure-policy-introduction) для создания, назначения и администрирования определений политики.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-192">For example, use Log Analytics for security-related monitoring such as policies and role-based access control, or use [Azure Policy](/azure/azure-policy/azure-policy-introduction) to create, assign and, manage policy definitions.</span></span>
- <span data-ttu-id="0e8e7-193">Для отслеживания потенциальных проблем с безопасностью и получения полного представления о состоянии безопасности ресурсов Azure используйте [Центр безопасности Azure](/azure/security-center/security-center-intro).</span><span class="sxs-lookup"><span data-stu-id="0e8e7-193">To monitor potential security issues and get a central view of the security state of your Azure resources, consider using [Azure Security Center](/azure/security-center/security-center-intro).</span></span>

## <a name="pricing"></a><span data-ttu-id="0e8e7-194">Цены</span><span class="sxs-lookup"><span data-stu-id="0e8e7-194">Pricing</span></span>

<span data-ttu-id="0e8e7-195">Плата за мониторинг может быстро расти, поэтому рекомендуется рассмотреть ценообразование, получить общие сведения о контролируемых ресурсах и проверить соответствующую комиссию за каждую услугу.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-195">Monitoring charges can add up quickly, so consider pricing up front, understand what you are monitoring, and check the associated fees for each service.</span></span> <span data-ttu-id="0e8e7-196">Azure Monitor бесплатно предоставляет [базовые метрики][basic metrics], в то время как стоимость мониторинга для [Application Insights][application-insights-pricing] и [Log Analytics][log-analytics] основывается на количестве принятых данных и числе выполненных тестов.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-196">Azure Monitor provides [basic metrics][basic metrics] at no cost, while monitoring costs for [Application Insights][application-insights-pricing] and [Log Analytics][log-analytics] are based on the amount of data ingested and the number of tests you run.</span></span>

<span data-ttu-id="0e8e7-197">Для начала рекомендуется оценить затраты с помощью [калькулятора цен][pricing].</span><span class="sxs-lookup"><span data-stu-id="0e8e7-197">To help you get started, use the [pricing calculator][pricing] to estimate costs.</span></span> <span data-ttu-id="0e8e7-198">Чтобы узнать, как изменится цена для конкретного варианта использования, измените различные параметры в соответствии с ожидаемым развертыванием.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-198">To see how the pricing would change for your particular use case, change the various options to match your expected deployment.</span></span>

<span data-ttu-id="0e8e7-199">Данные телеметрии из Application Insights оправляются на портал Azure как во время отладки, так и после публикации приложения.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-199">Telemetry from Application Insights is sent to the Azure portal during debugging and after you have published your app.</span></span> <span data-ttu-id="0e8e7-200">В целях проверки и предотвращения расходов инструментируется ограниченный объем данных телеметрии.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-200">For testing purposes and to avoid charges, a limited volume of telemetry is instrumented.</span></span> <span data-ttu-id="0e8e7-201">Чтобы добавить индикаторы, можно расширить ограничения телеметрии.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-201">To add more indicators, you can raise the telemetry limit.</span></span> <span data-ttu-id="0e8e7-202">Дополнительные сведения см. в статье [Выборка в Application Insights][Sampling in Application Insights].</span><span class="sxs-lookup"><span data-stu-id="0e8e7-202">For more granular control, see [Sampling in Application Insights][Sampling in Application Insights].</span></span>

<span data-ttu-id="0e8e7-203">После развертывания можно просмотреть показатели эффективности [Live Metrics Stream][Live Metrics Stream].</span><span class="sxs-lookup"><span data-stu-id="0e8e7-203">After deployment, you can watch a [Live Metrics Stream][Live Metrics Stream] of performance indicators.</span></span> <span data-ttu-id="0e8e7-204">Эти данные не сохраняются. Пользователь просматривает метрики в реальном времени. Но телеметрию можно сохранить для последующего анализа.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-204">This data is not stored &mdash; you are viewing real-time metrics &mdash; but the telemetry can be collected and analyzed later.</span></span> <span data-ttu-id="0e8e7-205">Плата за данные Live Stream не взимается.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-205">There is no charge for Live Stream data.</span></span>

<span data-ttu-id="0e8e7-206">Плата за использование Log Analytics начисляется за каждый гигабайт данных, полученных службой.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-206">Log Analytics is billed per gigabyte (GB) of data ingested into the service.</span></span> <span data-ttu-id="0e8e7-207">Каждый месяц первые 5 ГБ данных, получаемых службой Azure Log Analytics, предоставляются бесплатно. Также эти данные бесплатно сохраняются в течение первых 31 дней в рабочем пространстве Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-207">The first 5 GB of data ingested to the Azure Log Analytics service every month is offered free, and the data is retained at no charge for first 31 days in your Log Analytics workspace.</span></span>

## <a name="next-steps"></a><span data-ttu-id="0e8e7-208">Дополнительная информация</span><span class="sxs-lookup"><span data-stu-id="0e8e7-208">Next steps</span></span>

<span data-ttu-id="0e8e7-209">Ознакомьтесь с материалами, которые помогут приступить к работе с помощью собственного решения для мониторинга.</span><span class="sxs-lookup"><span data-stu-id="0e8e7-209">Check out these resources designed to help you get started with your own monitoring solution:</span></span>

<span data-ttu-id="0e8e7-210">[Базовое веб-приложение][Basic web application reference architecture]</span><span class="sxs-lookup"><span data-stu-id="0e8e7-210">[Basic web application reference architecture][Basic web application reference architecture]</span></span>

<span data-ttu-id="0e8e7-211">[Запуск мониторинга веб-приложения ASP.NET][Start monitoring your ASP.NET Web Application]</span><span class="sxs-lookup"><span data-stu-id="0e8e7-211">[Start monitoring your ASP.NET Web Application][Start monitoring your ASP.NET Web Application]</span></span>

<span data-ttu-id="0e8e7-212">[Сбор данных о виртуальных машинах Azure][Collect data about Azure Virtual Machines]</span><span class="sxs-lookup"><span data-stu-id="0e8e7-212">[Collect data about Azure Virtual Machines][Collect data about Azure Virtual Machines]</span></span>

## <a name="related-resources"></a><span data-ttu-id="0e8e7-213">Связанные ресурсы</span><span class="sxs-lookup"><span data-stu-id="0e8e7-213">Related resources</span></span>

<span data-ttu-id="0e8e7-214">[Общие сведения о службе Azure Monitor][Monitoring Azure applications and resources]</span><span class="sxs-lookup"><span data-stu-id="0e8e7-214">[Monitoring Azure applications and resources][Monitoring Azure applications and resources]</span></span>

<span data-ttu-id="0e8e7-215">[Поиск и диагностика исключений во время выполнения с помощью Azure Application Insights][Find and diagnose run-time exceptions with Azure Application Insights]</span><span class="sxs-lookup"><span data-stu-id="0e8e7-215">[Find and diagnose run-time exceptions with Azure Application Insights][Find and diagnose run-time exceptions with Azure Application Insights]</span></span>

<!-- links -->
[architecture]: ./images/architecture-diagram-app-monitoring.svg
[availability-tests]: /azure/application-insights/app-insights-monitor-web-app-availability
[application-insights]: /azure/application-insights/app-insights-overview
[azure-monitor]: /azure/monitoring-and-diagnostics/monitoring-overview-azure-monitor
[metrics]: /azure/monitoring-and-diagnostics/monitoring-supported-metrics
[Log Analytics и других службах]: /azure/log-analytics/log-analytics-azure-storage
[Log Analytics and other services]: /azure/log-analytics/log-analytics-azure-storage
[log-analytics]: /azure/log-analytics/log-analytics-overview
[Azure Log Analytics agent]: https://blogs.msdn.microsoft.com/sqlsecurity/2017/12/28/azure-log-analytics-oms-agent-now-collects-sql-server-audit-logs/
[application-insights-pricing]: https://azure.microsoft.com/pricing/details/application-insights/
[Application Insights SDKs]: /azure/application-insights/app-insights-asp-net
[Application Insights Status Monitor]: https://azure.microsoft.com/updates/application-insights-status-monitor-and-sdk-updated/
[analyzing data across sources]: /azure/log-analytics/log-analytics-dashboards
[sending proactive alerts]: /azure/log-analytics/log-analytics-alerts
[the Azure portal]: /azure/log-analytics/log-analytics-tutorial-dashboards
[Azure Log Analytics Query Language]: https://docs.loganalytics.io/docs/Learn
[cross-resource queries]: https://azure.microsoft.com/blog/query-across-resources/
[alerts]: /azure/monitoring-and-diagnostics/monitoring-overview-alerts
[Alerts (Preview)]: /azure/monitoring-and-diagnostics/monitoring-overview-unified-alerts
[Azure Monitor Data Source For Grafana]: https://grafana.com/plugins/grafana-azure-monitor-datasource
[Azure Automation]: /azure/automation/automation-intro
[ITSM solutions]: https://azure.microsoft.com/blog/itsm-connector-for-azure-is-now-generally-available/
[management solution]: /azure/monitoring/monitoring-solutions
[SLA]: https://azure.microsoft.com/support/legal/sla/app-service/v1_4/
[monitor its availability]: /azure/application-insights/app-insights-monitor-web-app-availability
[Resources, roles, and access control in Application Insights]: /azure/application-insights/app-insights-resources-roles-access-control
[basic metrics]: /azure/monitoring-and-diagnostics/monitoring-supported-metrics
[pricing]: https://azure.microsoft.com/pricing/calculator/#log-analyticsc126d8c1-ec9c-4e5b-9b51-4db95d06a9b1
[Sampling in Application Insights]: /azure/application-insights/app-insights-sampling
[Live Metrics Stream]: /azure/application-insights/app-insights-live-stream
[Basic web application reference architecture]: /azure/architecture/reference-architectures/app-service-web-app/basic-web-app#scalability-considerations
[Start monitoring your ASP.NET Web Application]: /azure/application-insights/quick-monitor-portal
[Collect data about Azure Virtual Machines]: /azure/log-analytics/log-analytics-quick-collect-azurevm
[Monitoring Azure applications and resources]: /azure/monitoring-and-diagnostics/monitoring-overview
[Find and diagnose run-time exceptions with Azure Application Insights]: /azure/application-insights/app-insights-tutorial-runtime-exceptions
[data-dog]: https://www.datadoghq.com/blog/azure-monitoring-enhancements/
[app-insights-limits]: /azure/azure-subscription-service-limits#application-insights-limits
[message-filtering]: /azure/application-insights/app-insights-api-filtering-sampling
[message-sampling]: /azure/application-insights/app-insights-sampling
