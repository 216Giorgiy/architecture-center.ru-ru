---
title: Внедрение облачных решений в организации. Разработка системы управления в Azure для нескольких команд
description: Руководство по настройке элементов управления Azure для нескольких команд, нескольких рабочих нагрузок и нескольких сред
author: petertaylor9999
ms.date: 09/10/2018
ms.topic: guide
ms.service: architecture-center
ms.subservice: enterprise-cloud-adoption
ms.openlocfilehash: de2bfeee7d098984a35f56f9e794e6a37933a3bd
ms.sourcegitcommit: 1b50810208354577b00e89e5c031b774b02736e2
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/23/2019
ms.locfileid: "54488432"
---
# <a name="enterprise-cloud-adoption-governance-design-for-multiple-teams"></a><span data-ttu-id="ac279-103">Внедрение облачных решений в организации. Разработка системы управления для нескольких команд</span><span class="sxs-lookup"><span data-stu-id="ac279-103">Enterprise Cloud Adoption: Governance design for multiple teams</span></span>

<span data-ttu-id="ac279-104">Цель этого руководства — помочь вам ознакомиться с разработкой модели системы управления ресурсами в Azure с поддержкой нескольких команд, рабочих нагрузок и сред.</span><span class="sxs-lookup"><span data-stu-id="ac279-104">The goal of this guidance is to help you learn the process for designing a resource governance model in Azure to support multiple teams, multiple workloads, and multiple environments.</span></span>  <span data-ttu-id="ac279-105">Мы рассмотрим набор гипотетических требований к управлению, а затем рассмотрим несколько примеров реализации, которые отвечают этим требованиям.</span><span class="sxs-lookup"><span data-stu-id="ac279-105">We'll look at a set of hypothetical governance requirements, then go through several example implementations that satisfy those requirements.</span></span>

<span data-ttu-id="ac279-106">Для этого необходимы следующие компоненты:</span><span class="sxs-lookup"><span data-stu-id="ac279-106">The requirements are:</span></span>
* <span data-ttu-id="ac279-107">Организация планирует назначить новые роли и обязанности по работе с облаком ряду пользователей, поэтому ей требуется возможность управлять удостоверениями нескольких команд с различными потребностями в доступе к ресурсам в Azure.</span><span class="sxs-lookup"><span data-stu-id="ac279-107">The enterprise plans to transition new cloud roles and responsibilities to a set of users and therefore requires identity management for multiple teams with different resource access needs in Azure.</span></span> <span data-ttu-id="ac279-108">В этой системе управления удостоверениями должны храниться удостоверения следующих пользователей:</span><span class="sxs-lookup"><span data-stu-id="ac279-108">This identity management system is required to store the identity of the following users:</span></span>
  1. <span data-ttu-id="ac279-109">Сотрудник организации, являющийся владельцем **подписок**.</span><span class="sxs-lookup"><span data-stu-id="ac279-109">The individual in your organization responsible for ownership of **subscriptions**.</span></span>
  2. <span data-ttu-id="ac279-110">Сотрудник организации, отвечающий за **ресурсы общей инфраструктуры**, которые используются для подключения локальной сети организации к виртуальной сети Azure.</span><span class="sxs-lookup"><span data-stu-id="ac279-110">The individual in your organization responsible for the **shared infrastructure resources** used to connect your on-premises network to an Azure virtual network.</span></span> 
  3. <span data-ttu-id="ac279-111">Два сотрудника организации, отвечающих за управление **рабочей нагрузкой**.</span><span class="sxs-lookup"><span data-stu-id="ac279-111">Two individuals in your organization responsible for managing a **workload**.</span></span> 
* <span data-ttu-id="ac279-112">Поддержка нескольких **сред**.</span><span class="sxs-lookup"><span data-stu-id="ac279-112">Support for multiple **environments**.</span></span> <span data-ttu-id="ac279-113">Среда — это логическое объединение ресурсов, например виртуальных машин, виртуальных сетей и служб маршрутизации сетевого трафика.</span><span class="sxs-lookup"><span data-stu-id="ac279-113">An environment is a logical grouping of resources, such as virtual machines, virtual networking, and network traffic routing services.</span></span> <span data-ttu-id="ac279-114">К этим группам ресурсов предъявляются схожие требования к управлению и безопасности, а сами они обычно используются для определенных задач в тестовых или рабочих средах.</span><span class="sxs-lookup"><span data-stu-id="ac279-114">These groups of resources have similar management and security requirements and are typically used for a specific purpose such as testing or production.</span></span> <span data-ttu-id="ac279-115">В этом примере требование предусматривает наличие трех сред:</span><span class="sxs-lookup"><span data-stu-id="ac279-115">In this example, the  requirement is for three environments:</span></span>
  1. <span data-ttu-id="ac279-116">**Среда общей инфраструктуры**, которая включает общие ресурсы, разделяемые рабочими нагрузками в других средах.</span><span class="sxs-lookup"><span data-stu-id="ac279-116">A **shared infrastructure environment** that includes resources shared by workloads in other environments.</span></span> <span data-ttu-id="ac279-117">Например, виртуальная сеть с подсетью шлюза, обеспечивающая подключение к локальной сети.</span><span class="sxs-lookup"><span data-stu-id="ac279-117">For example, a virtual network with a gateway subnet that provides connectivity to on-premises.</span></span>
  2. <span data-ttu-id="ac279-118">**Рабочая среда** с наиболее строгими политиками безопасности.</span><span class="sxs-lookup"><span data-stu-id="ac279-118">A **production environment** with the most restrictive security policies.</span></span> <span data-ttu-id="ac279-119">Может включать внутренние или внешние рабочие нагрузки.</span><span class="sxs-lookup"><span data-stu-id="ac279-119">May include internal or external facing workloads.</span></span>
  3. <span data-ttu-id="ac279-120">**Среда разработки** для подтверждения концепции и тестирования.</span><span class="sxs-lookup"><span data-stu-id="ac279-120">A **development environment** for proof-of-concept and testing work.</span></span> <span data-ttu-id="ac279-121">Эта среда имеет политики безопасности, соответствий и затрат, которые отличаются от политик производственной среды.</span><span class="sxs-lookup"><span data-stu-id="ac279-121">This environment has security, compliance, and cost policies that differ from those in the production environment.</span></span>
* <span data-ttu-id="ac279-122">**Модель разрешений с наименьшими привилегиями**, при которой пользователи не имеют разрешений по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="ac279-122">A **permissions model of least privilege** in which users have no permissions by default.</span></span> <span data-ttu-id="ac279-123">Модель должна поддерживать следующее.</span><span class="sxs-lookup"><span data-stu-id="ac279-123">The model must support the following:</span></span>
  * <span data-ttu-id="ac279-124">Единственный доверенный пользователь в области подписки с разрешением назначать права доступа к ресурсам.</span><span class="sxs-lookup"><span data-stu-id="ac279-124">A single trusted user at the subscription scope with permission to assign resource access rights.</span></span>
  * <span data-ttu-id="ac279-125">Каждому владельцу рабочей нагрузки по умолчанию запрещен доступ к ресурсам.</span><span class="sxs-lookup"><span data-stu-id="ac279-125">Each workload owner is denied access to resources by default.</span></span> <span data-ttu-id="ac279-126">Единственный доверенный пользователь в области подписки предоставляет права доступа к ресурсам явным образом.</span><span class="sxs-lookup"><span data-stu-id="ac279-126">Resource access rights are granted explicitly by the single trusted user at the subscription scope.</span></span>
  * <span data-ttu-id="ac279-127">Доступ к управлению для ресурсов общей инфраструктуры ограничен владельцем общей инфраструктуры.</span><span class="sxs-lookup"><span data-stu-id="ac279-127">Management access for the shared infrastructure resources limited to the shared infrastructure owner.</span></span>  
  * <span data-ttu-id="ac279-128">Доступ к управлению для каждой рабочей нагрузки ограничен владельцем рабочей нагрузки.</span><span class="sxs-lookup"><span data-stu-id="ac279-128">Management access for each workload restricted to the workload owner.</span></span>
  * <span data-ttu-id="ac279-129">Организации не нужно независимо управлять ролями в каждой из трех сред, поэтому ей требуются только [встроенные роли RBAC][rbac-built-in-roles].</span><span class="sxs-lookup"><span data-stu-id="ac279-129">The enterprise does not want to have to manage roles independently in each of the three environments, therefore requires the use of [built-in RBAC roles][rbac-built-in-roles] only.</span></span> <span data-ttu-id="ac279-130">Если бы в организации использовались пользовательские роли RBAC, потребовался бы дополнительный процесс синхронизации пользовательских ролей во всех трех средах.</span><span class="sxs-lookup"><span data-stu-id="ac279-130">If the enterprise were to use custom RBAC roles, an additional process is required to synchronize custom roles across the three environments.</span></span> 
* <span data-ttu-id="ac279-131">Отслеживание затрат по имени владельца рабочей среды, по среде или по обоим.</span><span class="sxs-lookup"><span data-stu-id="ac279-131">Cost tracking by workload owner name, environment, or both.</span></span> 

## <a name="identity-management"></a><span data-ttu-id="ac279-132">Управление удостоверениями</span><span class="sxs-lookup"><span data-stu-id="ac279-132">Identity management</span></span>

<span data-ttu-id="ac279-133">Прежде чем разрабатывать систему управления удостоверениями для модели управления ресурсами, необходимо ознакомиться с четырьмя основными областями, которые она охватывает:</span><span class="sxs-lookup"><span data-stu-id="ac279-133">Before we can design identity management for your governance model, it's important to understand the four major areas it encompasses:</span></span>

* <span data-ttu-id="ac279-134">Администрирование: процессы и средства для создания, редактирования и удаления идентификатора пользователя.</span><span class="sxs-lookup"><span data-stu-id="ac279-134">Administration: the processes and tools for creating, editing, and deleting user identity.</span></span>
* <span data-ttu-id="ac279-135">Аутентификация: проверка подлинности пользователя путем проверки учетных данных, таких как имя пользователя и пароль.</span><span class="sxs-lookup"><span data-stu-id="ac279-135">Authentication: verifying user identity by validating credentials, such as a user name and password.</span></span>
* <span data-ttu-id="ac279-136">Авторизация: определение того, к каким ресурсам разрешен доступ аутентифицированному пользователю или на выполнение каких операций у него есть разрешение.</span><span class="sxs-lookup"><span data-stu-id="ac279-136">Authorization: determining which resources an authenticated user is allowed to access or what operations they have permission to perform.</span></span>
* <span data-ttu-id="ac279-137">Аудит: периодический просмотр журналов и другой информации для обнаружения проблем безопасности, связанных с идентификацией пользователя.</span><span class="sxs-lookup"><span data-stu-id="ac279-137">Auditing: periodically reviewing logs and other information to discover security issues related to user identity.</span></span> <span data-ttu-id="ac279-138">Он включает проверку подозрительных шаблонов использования, периодический просмотр разрешений пользователей для проверки их точности и другие функции.</span><span class="sxs-lookup"><span data-stu-id="ac279-138">This includes reviewing suspicious usage patterns, periodically reviewing user permissions to verify they are accurate, and other functions.</span></span>

<span data-ttu-id="ac279-139">Существует только одна служба управления удостоверениями, являющаяся доверенной в Azure, — Azure Active Directory (Azure AD).</span><span class="sxs-lookup"><span data-stu-id="ac279-139">There is only one service trusted by Azure for identity, and that is Azure Active Directory (Azure AD).</span></span> <span data-ttu-id="ac279-140">Мы будем добавлять пользователей в Microsoft Azure Active Directory и использовать их для всех перечисленных выше функций.</span><span class="sxs-lookup"><span data-stu-id="ac279-140">We'll be adding users to Azure AD and using it for all of the functions listed above.</span></span> <span data-ttu-id="ac279-141">Но прежде чем посмотреть на настройку Microsoft Azure Active Directory, важно понять суть привилегированных учетных записей, которые используются для управления доступом к этим службам.</span><span class="sxs-lookup"><span data-stu-id="ac279-141">But before we look at how we'll configure Azure AD, it's important to understand the privileged accounts that are used to manage access to these services.</span></span>

<span data-ttu-id="ac279-142">При регистрации учетной записи организации в Azure назначается по крайней мере один **владелец учетной записи** Azure.</span><span class="sxs-lookup"><span data-stu-id="ac279-142">When your organization signed up for an Azure account, at least one Azure **account owner** was assigned.</span></span> <span data-ttu-id="ac279-143">При этом также создается **клиент** Azure AD. Исключением является ситуация, когда уже существует клиент, с помощью которого организация использует другие службы Майкрософт, например Office 365.</span><span class="sxs-lookup"><span data-stu-id="ac279-143">Also, an Azure AD **tenant** was created, unless an existing tenant was already associated with your organization's use of other Microsoft services such as Office 365.</span></span> <span data-ttu-id="ac279-144">Microsoft Azure Active Directory**Глобальный администратор** с полными правами при создании был связан с клиентом Microsoft Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="ac279-144">A **global administrator** with full permissions on the Azure AD tenant was associated when it was created.</span></span> 

<span data-ttu-id="ac279-145">Удостоверения пользователей — как владельца учетной записи Azure, так и глобального администратора Azure AD, — хранятся в надежной системе идентификации, управляемой корпорацией Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="ac279-145">The user identities for both the Azure Account Owner and the Azure AD global administrator are stored in a highly secure identity system that is managed by Microsoft.</span></span> <span data-ttu-id="ac279-146">Владелец учетной записи Azure имеет право создавать, обновлять и удалять подписки.</span><span class="sxs-lookup"><span data-stu-id="ac279-146">The Azure Account Owner is authorized to create, update, and delete subscriptions.</span></span> <span data-ttu-id="ac279-147">Глобальный администратор Microsoft Azure Active Directory уполномочен выполнять множество действий в Microsoft Azure Active Directory, но в этом руководстве по проектированию рассматривается только создание и удаление идентификатора пользователя.</span><span class="sxs-lookup"><span data-stu-id="ac279-147">The Azure AD global administrator is authorized to perform many actions in Azure AD, but for this design guide we'll focus on the creation and deletion of user identity.</span></span> 

> [!NOTE]
> <span data-ttu-id="ac279-148">Если имеется существующая лицензия Office 365 или Intune, связанная с учетной записью организации, то возможно уже есть существующий клиент Microsoft Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="ac279-148">Your organization may already have an existing Azure AD tenant if there's an existing Office 365 or Intune license associated with your account.</span></span>

<span data-ttu-id="ac279-149">У владельца учетной записи Azure есть разрешение на создание, обновление и удаление подписок.</span><span class="sxs-lookup"><span data-stu-id="ac279-149">The Azure Account Owner has permission to create, update, and delete subscriptions:</span></span> 

<span data-ttu-id="ac279-150">![Учетная запись Azure с менеджером учетной записи и глобальным администратором Microsoft Azure Active Directory](../_images/governance-3-0.png)
*Рис. 1. Учетная запись Azure с менеджером учетной записи и глобальным администратором Microsoft Azure Active Directory.*</span><span class="sxs-lookup"><span data-stu-id="ac279-150">![Azure account with Azure Account Manager and Azure AD global admin](../_images/governance-3-0.png)
*Figure 1. An Azure account with an Account Manager and Azure AD Global Administrator.*</span></span>

<span data-ttu-id="ac279-151">**Глобальный администратор** Microsoft Azure Active Directory имеет разрешение на создание учетных записей пользователей.</span><span class="sxs-lookup"><span data-stu-id="ac279-151">The Azure AD **global administrator** has permission to create user accounts:</span></span>  

<span data-ttu-id="ac279-152">![Учетная запись Azure с менеджером учетной записи и глобальным администратором Microsoft Azure Active Directory](../_images/governance-3-0a.png)
*Рис. 2. Глобальный администратор Microsoft Azure Active Directory создает необходимые учетные записи в клиенте.*</span><span class="sxs-lookup"><span data-stu-id="ac279-152">![Azure account with Azure Account Manager and Azure AD global admin](../_images/governance-3-0a.png)
*Figure 2. The Azure AD Global Administrator creates the required user accounts in the tenant.*</span></span>

<span data-ttu-id="ac279-153">Первые две учетные записи — **App1 Workload Owner** и **App2 Workload Owner** — связаны с сотрудником организации, отвечающим за управление рабочей нагрузкой.</span><span class="sxs-lookup"><span data-stu-id="ac279-153">The first two accounts, **App1 Workload Owner** and **App2 Workload Owner** are each associated with an individual in your organization responsible for managing a workload.</span></span> <span data-ttu-id="ac279-154">Учетная запись **пользователя сетевых операций** принадлежит лицу, ответственному за ресурсы общей инфраструктуры.</span><span class="sxs-lookup"><span data-stu-id="ac279-154">The **network operations** account is owned by the individual that is responsible for the shared infrastructure resources.</span></span> <span data-ttu-id="ac279-155">Наконец, учетная запись **владельца подписок** связана с лицом, ответственным за право собственности на подписки.</span><span class="sxs-lookup"><span data-stu-id="ac279-155">Finally, the **subscription owner** account is associated with the individual responsible for ownership of subscriptions.</span></span>

## <a name="resource-access-permissions-model-of-least-privilege"></a><span data-ttu-id="ac279-156">Модель разрешений доступа с наименьшими привилегиями</span><span class="sxs-lookup"><span data-stu-id="ac279-156">Resource access permissions model of least privilege</span></span>

<span data-ttu-id="ac279-157">Теперь, когда создана система управления удостоверениями и учетные записи пользователей, необходимо решить, как применять управление доступом на основе ролей (RBAC) к каждой учетной записи для реализации модели разрешений с наименьшими привилегиями.</span><span class="sxs-lookup"><span data-stu-id="ac279-157">Now that your identity management system and user accounts have been created, we have to decide how we'll apply role-based access control (RBAC) roles to each account to support a permissions model of least privilege.</span></span>

<span data-ttu-id="ac279-158">Другое требование состоит в том, чтобы ресурсы, связанные с каждой рабочей нагрузкой, были изолированы друг от друга, так чтобы ни один владелец рабочей нагрузки не мог управлять доступом к любой другой рабочей нагрузке, которой он не владеет.</span><span class="sxs-lookup"><span data-stu-id="ac279-158">There's another requirement stating the resources associated with each workload be isolated from one another such that no one workload owner has management access to any other workload they do not own.</span></span> <span data-ttu-id="ac279-159">Также существует требование реализовать эту модель, используя только [встроенные роли Azure RBAC][rbac-built-in-roles].</span><span class="sxs-lookup"><span data-stu-id="ac279-159">There's also a requirement to implement this model using only [built-in roles for Azure RBAC][rbac-built-in-roles].</span></span>

<span data-ttu-id="ac279-160">Каждая роль RBAC применяется в одной из трех областей в Azure: **подписка**, **группа ресурсов** и отдельный **ресурс**.</span><span class="sxs-lookup"><span data-stu-id="ac279-160">Each RBAC role is applied at one of three scopes in Azure: **subscription**, **resource group**, then an individual **resource**.</span></span> <span data-ttu-id="ac279-161">Роли наследуются в более низких областях.</span><span class="sxs-lookup"><span data-stu-id="ac279-161">Roles are inherited at lower scopes.</span></span> <span data-ttu-id="ac279-162">Например, если пользователю назначена [встроенная роль владельца][rbac-built-in-owner] на уровне подписки, то эта роль, если только она не переопределена, также назначается этому пользователю в группе ресурсов и на уровне отдельного ресурса.</span><span class="sxs-lookup"><span data-stu-id="ac279-162">For example, if a user is assigned the [built-in owner role][rbac-built-in-owner] at the subscription level, that role is also assigned to that user at the resource group and individual resource level unless it's overridden.</span></span>

<span data-ttu-id="ac279-163">Поэтому, чтобы создать модель доступа с наименьшими привилегиями, необходимо разрешить действия, которые может предпринимать конкретный тип пользователя в каждой из этих трех областей.</span><span class="sxs-lookup"><span data-stu-id="ac279-163">Therefore, to create a model of least privilege access we have to decide the actions a particular type of user is allowed to take at each of these three scopes.</span></span> <span data-ttu-id="ac279-164">Например, существует требование, чтобы владелец рабочей нагрузки имел разрешение управлять доступом только к ресурсам, связанным с его рабочей нагрузкой, и никаким другим.</span><span class="sxs-lookup"><span data-stu-id="ac279-164">For example, the requirement is for a workload owner to have permission to manage access to only the resources associated with their workload and no others.</span></span> <span data-ttu-id="ac279-165">Если назначить [встроенную роль владельца][rbac-built-in-owner] в области подписки, то каждый владелец рабочей нагрузки будет иметь доступ к управлению всеми рабочими нагрузками.</span><span class="sxs-lookup"><span data-stu-id="ac279-165">If we were to assign the [built-in owner role][rbac-built-in-owner] at the subscription scope, each workload owner would have management access to all workloads.</span></span>

<span data-ttu-id="ac279-166">Давайте рассмотрим два примера моделей разрешений, чтобы лучше понять эту концепцию.</span><span class="sxs-lookup"><span data-stu-id="ac279-166">Let's take a look at two example permission models to understand this concept a little better.</span></span> <span data-ttu-id="ac279-167">В первом примере модель позволяет создавать группы ресурсов только администратору служб.</span><span class="sxs-lookup"><span data-stu-id="ac279-167">In the first example, the model trusts only the service administrator to create resource groups.</span></span> <span data-ttu-id="ac279-168">Во втором примере модель назначает встроенную роль владельца каждому владельцу рабочей нагрузки в области подписки.</span><span class="sxs-lookup"><span data-stu-id="ac279-168">In the second example, the model assigns the built-in owner role to each workload owner at the subscription scope.</span></span> 

<span data-ttu-id="ac279-169">В обоих примерах у нас есть администратор служб подписки, которому назначена [встроенная роль владельца][rbac-built-in-owner] в области подписки.</span><span class="sxs-lookup"><span data-stu-id="ac279-169">In both examples, we have a subscription service administrator that is assigned the [built-in owner role][rbac-built-in-owner] at the subscription scope.</span></span> <span data-ttu-id="ac279-170">Напомним, что [встроенная роль владельца][rbac-built-in-owner] предоставляет все разрешения, включая управление доступом к ресурсам.</span><span class="sxs-lookup"><span data-stu-id="ac279-170">Recall that the [built-in owner role][rbac-built-in-owner] grants all permissions including the management of access to resources.</span></span>
<span data-ttu-id="ac279-171">![администратор служб подписки с ролью владельца](../_images/governance-2-1.png)
*Рис. 3. Подписка с администратором служб назначила встроенную роль владельца.*</span><span class="sxs-lookup"><span data-stu-id="ac279-171">![subscription service administrator with owner role](../_images/governance-2-1.png)
*Figure 3. A subscription with a service administrator assigned the built-in owner role.*</span></span> 

1. <span data-ttu-id="ac279-172">В первом примере у нас есть **владелец рабочей нагрузки A** без разрешений в области подписки. По умолчанию он не имеет прав управления доступом к ресурсам.</span><span class="sxs-lookup"><span data-stu-id="ac279-172">In the first example, we have **workload owner A** with no permissions at the subscription scope - they have no resource access management rights by default.</span></span> <span data-ttu-id="ac279-173">Этот пользователь хочет развернуть ресурсы для своей рабочей нагрузки и управлять ими.</span><span class="sxs-lookup"><span data-stu-id="ac279-173">This user wants to deploy and manage the resources for their workload.</span></span> <span data-ttu-id="ac279-174">Ему необходимо обратиться к **администратору служб** с запросом о создании группы ресурсов.</span><span class="sxs-lookup"><span data-stu-id="ac279-174">They must contact the **service administrator** to request creation of a resource group.</span></span>
<span data-ttu-id="ac279-175">![запрос владельца рабочей нагрузки о создании группы ресурсов A](../_images/governance-2-2.png)</span><span class="sxs-lookup"><span data-stu-id="ac279-175">![workload owner requests creation of resource group A](../_images/governance-2-2.png)</span></span>  

2. <span data-ttu-id="ac279-176">**Администратор служб** рассматривает его запрос и создает **группу ресурсов A**. На этом этапе **владелец рабочей нагрузки A** по-прежнему не имеет никаких разрешений.</span><span class="sxs-lookup"><span data-stu-id="ac279-176">The **service administrator** reviews their request and creates **resource group A**. At this point, **workload owner A** still doesn't have permission to do anything.</span></span>
<span data-ttu-id="ac279-177">![администратор служб создает группу ресурсов А](../_images/governance-2-3.png)</span><span class="sxs-lookup"><span data-stu-id="ac279-177">![service administrator creates resource group A](../_images/governance-2-3.png)</span></span>

3. <span data-ttu-id="ac279-178">**Администратор служб** добавляет **владельца рабочей нагрузки A** к **группе ресурсов A** и назначает [встроенную роль участника](/azure/role-based-access-control/built-in-roles#contributor).</span><span class="sxs-lookup"><span data-stu-id="ac279-178">The **service administrator** adds **workload owner A** to **resource group A** and assigns the [built-in contributor role](/azure/role-based-access-control/built-in-roles#contributor).</span></span> <span data-ttu-id="ac279-179">Роль участника предоставляет все разрешения в **группе ресурсов A**, за исключением разрешения на доступ к управлению.</span><span class="sxs-lookup"><span data-stu-id="ac279-179">The contributor role grants all permissions on **resource group A** except managing access permission.</span></span>
<span data-ttu-id="ac279-180">![администратор служб добавляет владельца рабочей нагрузки к группе ресурсов А](../_images/governance-2-4.png)</span><span class="sxs-lookup"><span data-stu-id="ac279-180">![service administrator adds workload owner a to resource group a](../_images/governance-2-4.png)</span></span>

4. <span data-ttu-id="ac279-181">Предположим, что **владельцу рабочей нагрузки A** необходимо добавить в группу двух членов команды для просмотра данных мониторинга ЦП и сетевого трафика в рамках планирования мощности для рабочей нагрузки.</span><span class="sxs-lookup"><span data-stu-id="ac279-181">Let's assume that **workload owner A** has a requirement for a pair of team members to view the CPU and network traffic monitoring data as part of capacity planning for the workload.</span></span> <span data-ttu-id="ac279-182">Поскольку **владельцу рабочей нагрузки A** назначена роль участника, у него нет разрешения на добавление пользователей к **группе ресурсов A**. Необходимо отправить этот запрос **администратору служб**.</span><span class="sxs-lookup"><span data-stu-id="ac279-182">Because **workload owner A** is assigned the contributor role, they do not have permission to add a user to **resource group A**. They must send this request to the **service administrator**.</span></span>
<span data-ttu-id="ac279-183">![владелец рабочей нагрузки запрашивает добавление участников рабочей нагрузки к группе ресурсов](../_images/governance-2-5.png)</span><span class="sxs-lookup"><span data-stu-id="ac279-183">![workload owner requests workload contributors be added to resource group](../_images/governance-2-5.png)</span></span>

5. <span data-ttu-id="ac279-184">**Администратор служб** рассматривает запрос и добавляет двух пользователей, **участников рабочей нагрузки**, к **группе ресурсов А**. Ни одному из этих двух пользователей не требуется разрешение для управления ресурсами, поэтому им назначаются [встроенные роли читателей](/azure/role-based-access-control/built-in-roles#contributor).</span><span class="sxs-lookup"><span data-stu-id="ac279-184">The **service administrator** reviews the request, and adds the two **workload contributor** users to **resource group A**. Neither of these two users require permission to manage resources, so they are assigned the [built-in reader role](/azure/role-based-access-control/built-in-roles#contributor).</span></span> 
<span data-ttu-id="ac279-185">![администратор служб добавляет участников рабочей нагрузки к группе ресурсов А](../_images/governance-2-6.png)</span><span class="sxs-lookup"><span data-stu-id="ac279-185">![service administrator adds workload contributors to resource group A](../_images/governance-2-6.png)</span></span>

6. <span data-ttu-id="ac279-186">Далее, **владелец рабочей нагрузки Б** также требует группу ресурсов для ресурсов своей рабочей нагрузки.</span><span class="sxs-lookup"><span data-stu-id="ac279-186">Next, **workload owner B** also requires a resource group to contain the resources for their workload.</span></span> <span data-ttu-id="ac279-187">Как и в случае с **владельцем рабочей нагрузки A**, **владелец рабочей нагрузки Б** изначально не имеет разрешения принимать какие-либо действия в области подписки, поэтому ему необходимо отправить запрос **администратору служб**</span><span class="sxs-lookup"><span data-stu-id="ac279-187">As with **workload owner A**, **workload owner B** initially does not have permission to take any action at the subscription scope so they must send a request to the **service administrator**.</span></span> 
<span data-ttu-id="ac279-188">![владелец рабочей нагрузки Б запрашивает создание группы ресурсов Б](../_images/governance-2-7.png)</span><span class="sxs-lookup"><span data-stu-id="ac279-188">![workload owner B requests creation of resource group B](../_images/governance-2-7.png)</span></span>

7. <span data-ttu-id="ac279-189">**Администратор служб** рассматривает его запрос и создает **группу ресурсов Б**. ![администратор служб создает группу ресурсов Б](../_images/governance-2-8.png)</span><span class="sxs-lookup"><span data-stu-id="ac279-189">The **service administrator** reviews the request and creates **resource group B**. ![Service Administrator creates resource group B](../_images/governance-2-8.png)</span></span>

8. <span data-ttu-id="ac279-190">**Администратор служб** добавляет **владельца рабочей нагрузки Б** к **группе ресурсов Б** и назначает [встроенную роль участника](https://docs.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#contributor).</span><span class="sxs-lookup"><span data-stu-id="ac279-190">The **service administrator** then adds **workload owner B** to **resource group B** and assigns the [built-in contributor role](https://docs.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#contributor).</span></span> 
<span data-ttu-id="ac279-191">![Администратор служб добавляет владельца рабочей нагрузки Б к группе ресурсов Б](../_images/governance-2-9.png)</span><span class="sxs-lookup"><span data-stu-id="ac279-191">![Service Administrator adds Workload Owner B to resource group B](../_images/governance-2-9.png)</span></span>

<span data-ttu-id="ac279-192">На этом этапе каждый владелец рабочей нагрузки изолирован в своей собственной группе ресурсов.</span><span class="sxs-lookup"><span data-stu-id="ac279-192">At this point, each of the workload owners is isolated in their own resource group.</span></span> <span data-ttu-id="ac279-193">Ни один из владельцев рабочей нагрузки или члены их команд не имеют доступа к управлению ресурсами в любой другой группе ресурсов.</span><span class="sxs-lookup"><span data-stu-id="ac279-193">None of the workload owners or their team members have management access to the resources in any other resource group.</span></span> 

<span data-ttu-id="ac279-194">![подписка с группами ресурсов A и Б](../_images/governance-2-10.png)
*Рис. 4. Подписка с двумя владельцами рабочей нагрузки, изолированными в собственных группах ресурсов.*</span><span class="sxs-lookup"><span data-stu-id="ac279-194">![subscription with resource groups A and B](../_images/governance-2-10.png)
*Figure 4. A subscription with two workload owners isolated with their own resource group.*</span></span>

<span data-ttu-id="ac279-195">Эта модель является моделью с наименьшими привилегиями — каждому пользователю назначается соответствующее разрешение в соответствующей области управления ресурсами.</span><span class="sxs-lookup"><span data-stu-id="ac279-195">This model is a least privilege model - each user is assigned the correct permission at the correct resource management scope.</span></span>

<span data-ttu-id="ac279-196">Однако учтите, что каждая задача в этом примере выполнялась **администратором служб**.</span><span class="sxs-lookup"><span data-stu-id="ac279-196">However, consider that every task in this example was performed by the **service administrator**.</span></span> <span data-ttu-id="ac279-197">Это простой пример, и здесь не возникают проблемы, возможно потому, что есть только два владельца рабочей нагрузки. Но легко представить себе типы проблем, которые могут возникнуть в большой организации.</span><span class="sxs-lookup"><span data-stu-id="ac279-197">While this is a simple example and may not appear to be an issue because there were only two workload owners, it's easy to imagine the types of issues that would result for a large organization.</span></span> <span data-ttu-id="ac279-198">Например, **администратор служб** может стать узким местом с большим количеством невыполненных запросов, которые приводят к задержкам.</span><span class="sxs-lookup"><span data-stu-id="ac279-198">For example, the **service administrator** can become a bottleneck with a large backlog of requests that result in delays.</span></span>  

<span data-ttu-id="ac279-199">Давайте рассмотрим второй пример, который уменьшает количество задач, выполняемых **администратором служб**.</span><span class="sxs-lookup"><span data-stu-id="ac279-199">Let's take a look at second example that reduces the number of tasks performed by the **service administrator**.</span></span> 

1. <span data-ttu-id="ac279-200">В этой модели **владельцу рабочей нагрузки A** присваивается [встроенная роль владельца][rbac-built-in-owner] в области подписки, что позволяет ему создавать свою собственную группу ресурсов: **группа ресурсов A**. ![Администратор служб добавляет владельца рабочей нагрузки А к подписке](../_images/governance-2-11.png)</span><span class="sxs-lookup"><span data-stu-id="ac279-200">In this model, **workload owner A** is assigned the [built-in owner role][rbac-built-in-owner] at the subscription scope, enabling them to create their own resource group: **resource group A**. ![Service Administrator adds Workload Owner A to subscription](../_images/governance-2-11.png)</span></span>

2. <span data-ttu-id="ac279-201">Когда создается **группа ресурсов A**, по умолчанию добавляется **владелец рабочей нагрузки A** и наследует [встроенную роль владельца][rbac-built-in-owner] из области подписки.</span><span class="sxs-lookup"><span data-stu-id="ac279-201">When **resource group A** is created, **workload owner A** is added by default and inherits the [built-in owner][rbac-built-in-owner] role from the subscription scope.</span></span>
<span data-ttu-id="ac279-202">![Владелец рабочей нагрузки А создает группу ресурсов А](../_images/governance-2-12.png)</span><span class="sxs-lookup"><span data-stu-id="ac279-202">![Workload Owner A creates resource group A](../_images/governance-2-12.png)</span></span>

3. <span data-ttu-id="ac279-203">[Роль встроенного владельца][rbac-built-in-owner] предоставляет **владельцу рабочей нагрузки A** разрешение на управление доступом к группе ресурсов.</span><span class="sxs-lookup"><span data-stu-id="ac279-203">The [built-in owner role][rbac-built-in-owner] grants **workload owner A** permission to manage access to the resource group.</span></span> <span data-ttu-id="ac279-204">**Владелец рабочей нагрузки A** добавляет двух **участников рабочей нагрузки** и назначает каждому из них [встроенную роль читателя][rbac-built-in-owner].</span><span class="sxs-lookup"><span data-stu-id="ac279-204">**Workload owner A** adds two **workload contributors** and assigns the [built-in reader role][rbac-built-in-owner] to each of them.</span></span> 
<span data-ttu-id="ac279-205">![Владелец рабочей нагрузки A добавляет участников рабочей нагрузки](../_images/governance-2-13.png)</span><span class="sxs-lookup"><span data-stu-id="ac279-205">![Workload Owner A adds Workload Contributors](../_images/governance-2-13.png)</span></span>

4. <span data-ttu-id="ac279-206">**Администратор служб** теперь добавляет **владельца рабочей нагрузки Б** к подписке с встроенной ролью владельца.</span><span class="sxs-lookup"><span data-stu-id="ac279-206">**Service administrator** now adds **workload owner B** to the subscription with the built-in owner role.</span></span> 
<span data-ttu-id="ac279-207">![Администратор служб добавляет владельца рабочей нагрузки Б к подписке](../_images/governance-2-14.png)</span><span class="sxs-lookup"><span data-stu-id="ac279-207">![Service Administrator adds Workload Owners B to subscription](../_images/governance-2-14.png)</span></span>

5. <span data-ttu-id="ac279-208">**Владелец рабочей нагрузки Б** создает **группы ресурсов Б** и добавляется по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="ac279-208">**Workload owner B** creates **resource group B** and is added by default.</span></span> <span data-ttu-id="ac279-209">Опять же, **владелец рабочей нагрузки Б** наследует встроенную роль владельца из области подписки.</span><span class="sxs-lookup"><span data-stu-id="ac279-209">Again, **workload owner B** inherits the built-in owner role from the subscription scope.</span></span>
<span data-ttu-id="ac279-210">![Владелец рабочей нагрузки Б создает группу ресурсов Б](../_images/governance-2-15.png)</span><span class="sxs-lookup"><span data-stu-id="ac279-210">![Workload Owner B creates resource group B](../_images/governance-2-15.png)</span></span>

<span data-ttu-id="ac279-211">Обратите внимание, что в этой модели **администратор служб** выполнял меньше действий, чем в первом примере, путем делегирования управления доступом каждому из отдельных владельцев рабочей нагрузки.</span><span class="sxs-lookup"><span data-stu-id="ac279-211">Note that in this model, the **service administrator** performed fewer actions than they did in the first example due to the delegation of management access to each of the individual workload owners.</span></span>

<span data-ttu-id="ac279-212">![подписка с группами ресурсов A и Б](../_images/governance-2-16.png)
*Рис. 5. Подписка с администратором службы и двумя владельцами рабочей нагрузки, всем назначены встроенные роли владельца.*</span><span class="sxs-lookup"><span data-stu-id="ac279-212">![subscription with resource groups A and B](../_images/governance-2-16.png)
*Figure 5. A subscription with a service administrator and two workload owners, all assigned the built-in owner role.*</span></span>

<span data-ttu-id="ac279-213">Тем не менее, поскольку **владельцу рабочей нагрузки A** и **владельцу рабочей нагрузки Б** присваивается встроенная роль владельца в области подписки, каждая из них унаследовала роль встроенного владельца групп ресурсов друг друга.</span><span class="sxs-lookup"><span data-stu-id="ac279-213">However, because both **workload owner A** and **workload owner B** are assigned the built-in owner role at the subscription scope, they have each inherited the built-in owner role for each other's resource group.</span></span> <span data-ttu-id="ac279-214">Это означает, что они не только имеют полный доступ к ресурсам друг друга, но также могут делегировать доступ управления к группам ресурсов друг друга.</span><span class="sxs-lookup"><span data-stu-id="ac279-214">This means that not only do they have full access to one another's resources, they are also able to delegate management access to each other's resource groups.</span></span> <span data-ttu-id="ac279-215">Например, владелец **рабочей нагрузки Б** имеет разрешение добавлять любого другого пользователя в **группу ресурсов A** и может назначать ему какую-либо роль, включая встроенную роль владельца.</span><span class="sxs-lookup"><span data-stu-id="ac279-215">For example, **workload owner B** has rights to add any other user to **resource group A** and can assign any role to them, including the built-in owner role.</span></span>

<span data-ttu-id="ac279-216">Если сравнивать примеры с требованиями, видно, что в обоих примерах фигурирует один доверенный пользователь в области подписки с разрешением на предоставление прав доступа к ресурсам двум владельцам рабочей нагрузки.</span><span class="sxs-lookup"><span data-stu-id="ac279-216">If we compare each example to the requirements, we see that both examples support a single trusted user at the subscription scope with permission to grant resource access rights to the two workload owners.</span></span> <span data-ttu-id="ac279-217">Каждый из двух владельцев рабочей нагрузки не имел доступа к управлению ресурсами по умолчанию и требовал, чтобы **администратор служб** явно назначил ему права.</span><span class="sxs-lookup"><span data-stu-id="ac279-217">Each of the two workload owners did not have access to resource management by default and required the **service administrator** to explicitly assign permissions to them.</span></span> <span data-ttu-id="ac279-218">Однако только первый пример поддерживает требование, чтобы ресурсы, связанные с отдельной рабочей нагрузкой, были изолированы друг от друга таким образом, что владелец рабочей нагрузки не имеет доступа к ресурсам любой другой рабочей нагрузки.</span><span class="sxs-lookup"><span data-stu-id="ac279-218">However, only the first example supports the requirement that the resources associated with each workload are isolated from one another such that no workload owner has access to the resources of any other workload.</span></span>

## <a name="resource-management-model"></a><span data-ttu-id="ac279-219">Модель управления ресурсами</span><span class="sxs-lookup"><span data-stu-id="ac279-219">Resource management model</span></span>

<span data-ttu-id="ac279-220">Теперь, когда модель разрешений с наименьшими привилегиями разработана, давайте перейдем к рассмотрению некоторых практических приложений для этих моделей системы управления.</span><span class="sxs-lookup"><span data-stu-id="ac279-220">Now that we've designed a permissions model of least privilege, let's move on to take a look at some practical applications of these governance models.</span></span> <span data-ttu-id="ac279-221">Напомним, что требования предусматривают поддержку трех сред:</span><span class="sxs-lookup"><span data-stu-id="ac279-221">Recall from the requirements that we must support the following three environments:</span></span>
1. <span data-ttu-id="ac279-222">**Общая инфраструктура:** единая группа ресурсов, общая для всех рабочих нагрузок.</span><span class="sxs-lookup"><span data-stu-id="ac279-222">**Shared infrastructure:** a single group of resources shared by all workloads.</span></span> <span data-ttu-id="ac279-223">Это такие ресурсы, как сетевые шлюзы, брандмауэры и службы безопасности.</span><span class="sxs-lookup"><span data-stu-id="ac279-223">These are resources such as network gateways, firewalls, and security services.</span></span>  
2. <span data-ttu-id="ac279-224">**Разработка:** несколько групп ресурсов, представляющих несколько нерабочих готовых рабочих нагрузок.</span><span class="sxs-lookup"><span data-stu-id="ac279-224">**Development:** multiple groups of resources representing multiple non-production ready workloads.</span></span> <span data-ttu-id="ac279-225">Эти ресурсы используются для подтверждения концепции, тестирования и других действий разработчиков.</span><span class="sxs-lookup"><span data-stu-id="ac279-225">These resources are used for proof-of-concept, testing, and other developer activities.</span></span> <span data-ttu-id="ac279-226">Эти ресурсы могут иметь менее жесткую модель системы управления, позволяющую увеличить маневренность разработчика.</span><span class="sxs-lookup"><span data-stu-id="ac279-226">These resources may have a more relaxed governance model to enable increased developer agility.</span></span>
3. <span data-ttu-id="ac279-227">**Рабочая среда:** несколько групп ресурсов, представляющих несколько рабочих нагрузок.</span><span class="sxs-lookup"><span data-stu-id="ac279-227">**Production:** multiple groups of resources representing multiple production workloads.</span></span> <span data-ttu-id="ac279-228">Эти ресурсы используются для размещения частных и публичных артефактов приложений.</span><span class="sxs-lookup"><span data-stu-id="ac279-228">These resources are used to host the private and public facing application artifacts.</span></span> <span data-ttu-id="ac279-229">Эти ресурсы обычно имеют самые жесткие модели системы управления и безопасности для защиты ресурсов, кода приложений и данных от несанкционированного доступа.</span><span class="sxs-lookup"><span data-stu-id="ac279-229">These resources typically have the tightest governance and security models to protect the resources, application code, and data from unauthorized access.</span></span>

<span data-ttu-id="ac279-230">Для каждой из этих трех сред есть требования по отслеживанию данных о расходах **владельца рабочей нагрузки**, **среды** или обоих.</span><span class="sxs-lookup"><span data-stu-id="ac279-230">For each of these three environments, we have a requirement to track cost data by **workload owner**, **environment**, or both.</span></span> <span data-ttu-id="ac279-231">То есть необходимо знать текущие затраты **общей инфраструктуры**, затраты, произведенные отдельными лицами в среде **разработки** и **рабочей** среде, и, наконец, общую стоимость **разработки** и **работы**.</span><span class="sxs-lookup"><span data-stu-id="ac279-231">That is, we want to know the ongoing cost of the **shared infrastructure**, the costs incurred by individuals in both the **development** and **production** environments, and finally the overall cost of **development** and **production**.</span></span> 

<span data-ttu-id="ac279-232">Вы уже знаете, что ресурсы ограничиваются только двумя уровнями: **подпиской** и **группой ресурсов**.</span><span class="sxs-lookup"><span data-stu-id="ac279-232">You have already learned that resources are scoped to two levels: **subscription** and **resource group**.</span></span> <span data-ttu-id="ac279-233">Поэтому первое решение — организовать среду с использованием **подписки**.</span><span class="sxs-lookup"><span data-stu-id="ac279-233">Therefore, the first decision is how to organize environments by **subscription**.</span></span> <span data-ttu-id="ac279-234">Есть только две возможности: единая подписка или несколько подписок.</span><span class="sxs-lookup"><span data-stu-id="ac279-234">There are only two possibilities: a single subscription, or, multiple subscriptions.</span></span> 

<span data-ttu-id="ac279-235">Прежде чем перейти к примерам каждой из этих моделей, давайте рассмотрим структуру управления подписками в Azure.</span><span class="sxs-lookup"><span data-stu-id="ac279-235">Before we look at examples of each of these models, let's review the management structure for subscriptions in Azure.</span></span> 

<span data-ttu-id="ac279-236">Следует напомнить, что в организации есть сотрудник, отвечающий за подписки, и он распоряжается учетной записью **владельца подписок** в клиенте Azure AD.</span><span class="sxs-lookup"><span data-stu-id="ac279-236">Recall from the requirements that we have an individual in the organization who is responsible for subscriptions, and this user owns the **subscription owner** account in the Azure AD tenant.</span></span> <span data-ttu-id="ac279-237">Однако эта учетная запись не имеет разрешения на создание подписок.</span><span class="sxs-lookup"><span data-stu-id="ac279-237">However, this account does not have permission to create subscriptions.</span></span> <span data-ttu-id="ac279-238">Только **владелец учетной записи Azure** имеет на это право: ![](../_images/governance-3-0b.png)
*Рис. 6. Владелец учетной записи Azure создает подписку.*</span><span class="sxs-lookup"><span data-stu-id="ac279-238">Only the **Azure Account Owner** has permission to do this: ![](../_images/governance-3-0b.png)
*Figure 6. An Azure Account Owner creates a subscription.*</span></span>

<span data-ttu-id="ac279-239">После создания подписки **владелец учетной записи Azure** может добавить учетную запись **владельца подписки** к подписке с ролью **владельца**.</span><span class="sxs-lookup"><span data-stu-id="ac279-239">Once the subscription has been created, the **Azure Account Owner** can add the **subscription owner** account to the subscription with the **owner** role:</span></span>

<span data-ttu-id="ac279-240">![](../_images/governance-3-0c.png)
*Рис. 7. Владелец учетной записи Azure добавляет учетную запись пользователя **владельца подписки** к подписке с ролью **владельца**.*</span><span class="sxs-lookup"><span data-stu-id="ac279-240">![](../_images/governance-3-0c.png)
*Figure 7. The Azure Account Owner adds the **subscription owner** user account to the subscription with the **owner** role.*</span></span>

<span data-ttu-id="ac279-241">**Владелец подписки** теперь может создать **группу ресурсов** и делегировать управление доступом к ресурсам.</span><span class="sxs-lookup"><span data-stu-id="ac279-241">The **subscription owner** can now create **resource groups** and delegate resource access management.</span></span>

<span data-ttu-id="ac279-242">Сначала давайте рассмотрим пример модели управления ресурсами, используя единую подписку.</span><span class="sxs-lookup"><span data-stu-id="ac279-242">First let's look at an example resource management model using a single subscription.</span></span> <span data-ttu-id="ac279-243">Первое решение касается выравнивания групп ресурсов в трех средах.</span><span class="sxs-lookup"><span data-stu-id="ac279-243">The first decision is how to align resource groups to the three environments.</span></span> <span data-ttu-id="ac279-244">Это можно сделать двумя способами.</span><span class="sxs-lookup"><span data-stu-id="ac279-244">We have two options:</span></span>
1. <span data-ttu-id="ac279-245">Совместите каждую среду с одной группой ресурсов.</span><span class="sxs-lookup"><span data-stu-id="ac279-245">Align each environment to a single resource group.</span></span> <span data-ttu-id="ac279-246">Все ресурсы общей инфраструктуры развертываются в единую группу ресурсов **общей инфраструктуры**.</span><span class="sxs-lookup"><span data-stu-id="ac279-246">All shared infrastructure resources are deployed to a single **shared infrastructure** resource group.</span></span> <span data-ttu-id="ac279-247">Все ресурсы, связанные с рабочими нагрузками разработки, развертываются в единую группу ресурсов **разработки**.</span><span class="sxs-lookup"><span data-stu-id="ac279-247">All resources associated with development workloads are deployed to a single **development** resource group.</span></span> <span data-ttu-id="ac279-248">Все ресурсы, связанные с производственными рабочими нагрузками, развертываются в единую **производственную** группу ресурсов для **рабочей** среды.</span><span class="sxs-lookup"><span data-stu-id="ac279-248">All resources associated with production workloads are deployed into a single **production** resource group for the **production** environment.</span></span> 
2. <span data-ttu-id="ac279-249">Создайте отдельные группы ресурсов для каждой рабочей нагрузки, используя соглашение об именовании и теги для выравнивания групп ресурсов в каждой из трех сред.</span><span class="sxs-lookup"><span data-stu-id="ac279-249">Create separate resource groups for each workload, using a naming convention and tags to align resource groups with each of the three environments.</span></span>  

<span data-ttu-id="ac279-250">Начнем с оценки первого способа.</span><span class="sxs-lookup"><span data-stu-id="ac279-250">Let's begin by evaluating the first option.</span></span> <span data-ttu-id="ac279-251">Воспользуемся моделью разрешений, о которой шла речь в предыдущем разделе, когда администратор служб единой подписки создает группы ресурсов и добавляет к ним пользователей со встроенной ролью **участника** или **читателя**.</span><span class="sxs-lookup"><span data-stu-id="ac279-251">We'll be using the permissions model that we discussed in the previous section, with a single subscription service administrator who creates resource groups and adds users to them with either the built-in **contributor** or **reader** role.</span></span> 

1. <span data-ttu-id="ac279-252">Первая развернутая группа ресурсов представляет собой среду **общей инфраструктуры**.</span><span class="sxs-lookup"><span data-stu-id="ac279-252">The first resource group deployed represents the **shared infrastructure** environment.</span></span> <span data-ttu-id="ac279-253">**Владелец подписки** создает группу ресурсов для ресурсов общей инфраструктуры с именем **netops-shared-rg**.</span><span class="sxs-lookup"><span data-stu-id="ac279-253">The **subscription owner** creates a resource group for the shared infrastructure resources named **netops-shared-rg**.</span></span> 
![](../_images/governance-3-0d.png)
2. <span data-ttu-id="ac279-254">**Владелец подписки** добавляет учетную запись **пользователя сетевых операций** для группы ресурсов и назначает роль **участника**.</span><span class="sxs-lookup"><span data-stu-id="ac279-254">The **subscription owner** adds the **network operations user** account to the resource group and assigns the **contributor** role.</span></span> 
![](../_images/governance-3-0e.png)
3. <span data-ttu-id="ac279-255">**Пользователь сетевых операций** создает [VPN-шлюз](/azure/vpn-gateway/vpn-gateway-about-vpngateways) и настраивает его для подключения к VPN-устройству в локальной среде.</span><span class="sxs-lookup"><span data-stu-id="ac279-255">The **network operations user** creates a [VPN gateway](/azure/vpn-gateway/vpn-gateway-about-vpngateways) and configures it to connect to the on-premises VPN appliance.</span></span> <span data-ttu-id="ac279-256">Пользователь **сетевых операций** также применяет пару [тегов](/azure/azure-resource-manager/resource-group-using-tags) для каждого из ресурсов: *environment:shared* и *managedBy:netOps*.</span><span class="sxs-lookup"><span data-stu-id="ac279-256">The **network operations** user also applies a pair of [tags](/azure/azure-resource-manager/resource-group-using-tags) to each of the resources: *environment:shared* and *managedBy:netOps*.</span></span> <span data-ttu-id="ac279-257">Когда **администратор служб подписки** экспортирует отчет о затратах, затраты будут выровнены по каждому из этих тегов.</span><span class="sxs-lookup"><span data-stu-id="ac279-257">When the **subscription service administrator** exports a cost report, costs will be aligned with each of these tags.</span></span> <span data-ttu-id="ac279-258">Это позволяет **администратору служб подписки** сводить затраты с помощью тега *environment* и тега *managedBy*.</span><span class="sxs-lookup"><span data-stu-id="ac279-258">This allows the **subscription service administrator** to pivot costs using the *environment* tag and the *managedBy* tag.</span></span> <span data-ttu-id="ac279-259">Обратите внимание на счетчик **границ ресурсов** в верхней правой части рисунка.</span><span class="sxs-lookup"><span data-stu-id="ac279-259">Notice the **resource limits** counter at the top right-hand side of the figure.</span></span> <span data-ttu-id="ac279-260">Каждая подписка Azure имеет [границы обслуживания](/azure/azure-subscription-service-limits), и чтобы понять эффект этих ограничений, будем придерживаться границ виртуальной сети для каждой подписки.</span><span class="sxs-lookup"><span data-stu-id="ac279-260">Each Azure subscription has [service limits](/azure/azure-subscription-service-limits), and to help you understand the effect of these limits we'll follow the virtual network limit for each subscription.</span></span> <span data-ttu-id="ac279-261">По умолчанию ограничение составляет 50 виртуальных сетей на подписку, а после развертывания первой виртуальной сети остаются доступными 49 виртуальных сетей.</span><span class="sxs-lookup"><span data-stu-id="ac279-261">There is a default limit of 50 virtual networks per subscription, and after the first virtual network is deployed there are now 49 available.</span></span>
![](../_images/governance-3-1.png)
4. <span data-ttu-id="ac279-262">Были развернуты еще две группы ресурсов, первая называется *prod-rg*.</span><span class="sxs-lookup"><span data-stu-id="ac279-262">Two more resource groups are deployed, the first is named *prod-rg*.</span></span> <span data-ttu-id="ac279-263">Эта группа ресурсов выровнена с **рабочей** средой.</span><span class="sxs-lookup"><span data-stu-id="ac279-263">This resource group is aligned with the **production** environment.</span></span> <span data-ttu-id="ac279-264">Вторая называется *dev-rg* и выровнена со средой **разработки**.</span><span class="sxs-lookup"><span data-stu-id="ac279-264">The second is named *dev-rg* and is aligned with the **development** environment.</span></span> <span data-ttu-id="ac279-265">Все ресурсы, связанные с производственными рабочими нагрузками, развертываются в **рабочей** среде, а все ресурсы, связанные с рабочими нагрузками разработки, развертываются в среде **разработки**.</span><span class="sxs-lookup"><span data-stu-id="ac279-265">All resources associated with production workloads are deployed to the **production** environment and all resources associated with development workloads are deployed to the **development** environment.</span></span> <span data-ttu-id="ac279-266">В этом примере показано, как развернуть только две рабочие нагрузки для каждой из этих двух сред, чтобы не превысить пределы абонентской подписки Azure.</span><span class="sxs-lookup"><span data-stu-id="ac279-266">In this example we'll only deploy two workloads to each of these two environments so we won't encounter any Azure subscription service limits.</span></span> <span data-ttu-id="ac279-267">Однако важно учитывать, что каждая группа ресурсов имеет ограничение в 800 ресурсов.</span><span class="sxs-lookup"><span data-stu-id="ac279-267">However, it's important to consider that each resource group has a limit of 800 resources per resource group.</span></span> <span data-ttu-id="ac279-268">Поэтому, если добавлять рабочие нагрузки для каждой группы ресурсов, возможно, что этот предел будет достигнут.</span><span class="sxs-lookup"><span data-stu-id="ac279-268">Therefore, if we keep adding workloads to each resource group it is possible that this limit will be reached.</span></span> 
![](../_images/governance-3-2.png)
5. <span data-ttu-id="ac279-269">Первый **владелец рабочей нагрузки** отправляет запрос **администратору служб подписки** и добавляется к каждой из сред групп ресурсов (к среде **разработки** и к **рабочей** среде) с ролью **участника**.</span><span class="sxs-lookup"><span data-stu-id="ac279-269">The first **workload owner** sends a request to the **subscription service administrator** and is added to each of the **development** and **production** environment resource groups with the **contributor** role.</span></span> <span data-ttu-id="ac279-270">Как упоминалось ранее, роль **участника** позволяет пользователю выполнять любую операцию, отличную от назначения роли другому пользователю.</span><span class="sxs-lookup"><span data-stu-id="ac279-270">As you learned earlier, the **contributor** role allows the user to perform any operation other than assigning a role to another user.</span></span> <span data-ttu-id="ac279-271">Первый **владелец рабочей нагрузки** теперь может создавать ресурсы, связанные со своей рабочей нагрузкой.</span><span class="sxs-lookup"><span data-stu-id="ac279-271">The first **workload owner** can now create the resources associated with their workload.</span></span>
![](../_images/governance-3-3.png)
6. <span data-ttu-id="ac279-272">Первый **владелец рабочей нагрузки** создает виртуальную сеть в каждой из двух групп ресурсов с парой виртуальных машин в каждой.</span><span class="sxs-lookup"><span data-stu-id="ac279-272">The first **workload owner** creates a virtual network in each of the two resource groups with a pair of virtual machines in each.</span></span> <span data-ttu-id="ac279-273">Первый **владелец рабочей нагрузки** применяет теги *environment* и *managedBy* ко всем ресурсам.</span><span class="sxs-lookup"><span data-stu-id="ac279-273">The first **workload owner** applies the *environment* and *managedBy* tags to all resources.</span></span> <span data-ttu-id="ac279-274">Обратите внимание, что счетчик границ обслуживания Azure теперь показывает оставшиеся 47 виртуальных сетей.</span><span class="sxs-lookup"><span data-stu-id="ac279-274">Note that the Azure service limit counter is now at 47 virtual networks remaining.</span></span>
![](../_images/governance-3-4.png)
7. <span data-ttu-id="ac279-275">При создании каждой виртуальной сети нет возможности подключения к локальным сетям.</span><span class="sxs-lookup"><span data-stu-id="ac279-275">Each of the virtual networks does not have connectivity to on-premises when they are created.</span></span> <span data-ttu-id="ac279-276">В этом типе архитектуры каждая виртуальная сеть должна быть привязана к *hub-vnet* в среде **общей инфраструктуры**.</span><span class="sxs-lookup"><span data-stu-id="ac279-276">In this type of architecture, each virtual network must be peered to the *hub-vnet* in the **shared infrastructure** environment.</span></span> <span data-ttu-id="ac279-277">Пиринг виртуальной сети создает соединение между двумя отдельными виртуальными сетями и позволяет сетевому трафику перемещаться между ними.</span><span class="sxs-lookup"><span data-stu-id="ac279-277">Virtual network peering creates a connection between two separate virtual networks and allows network traffic to travel between them.</span></span> <span data-ttu-id="ac279-278">Обратите внимание, что пиринг виртуальной сети не является по своей сути транзитивным.</span><span class="sxs-lookup"><span data-stu-id="ac279-278">Note that virtual network peering is not inherently transitive.</span></span> <span data-ttu-id="ac279-279">В каждой из двух подключенных виртуальных сетей должен быть указан пиринг, и если только в одной из виртуальных сетей указан пиринг, соединение является неполным.</span><span class="sxs-lookup"><span data-stu-id="ac279-279">A peering must be specified in each of the two virtual networks that are connected, and if only one of the virtual networks specifies a peering the connection is incomplete.</span></span> <span data-ttu-id="ac279-280">Чтобы проиллюстрировать этот эффект, пусть первый **владелец рабочей нагрузки** укажет пиринг между **prod-vnet** и **hub-vnet**.</span><span class="sxs-lookup"><span data-stu-id="ac279-280">To illustrate the effect of this, the first **workload owner** specifies a peering between **prod-vnet** and **hub-vnet**.</span></span> <span data-ttu-id="ac279-281">Создается первый пиринг, но нет потоков трафика, потому что еще не был указан взаимодополняющий пиринг из **hub-vnet** к **prod-vnet**.</span><span class="sxs-lookup"><span data-stu-id="ac279-281">The first peering is created, but no traffic flows because the complementary peering from **hub-vnet** to **prod-vnet** has not yet been specified.</span></span> <span data-ttu-id="ac279-282">Первый **владелец рабочей нагрузки** связывается с пользователем **сетевых операций** и запрашивает это взаимодополняющее пиринговое подключение.</span><span class="sxs-lookup"><span data-stu-id="ac279-282">The first **workload owner** contacts the **network operations** user and requests this complementary peering connection.</span></span>
![](../_images/governance-3-5.png)
8. <span data-ttu-id="ac279-283">Пользователь **сетевых операций** просматривает запрос, утверждает его, а затем указывает пиринг в параметрах **hub-vnet**.</span><span class="sxs-lookup"><span data-stu-id="ac279-283">The **network operations** user reviews the request, approves it, then specifies the peering in the settings for the **hub-vnet**.</span></span> <span data-ttu-id="ac279-284">Теперь пиринговое соединение полное и сетевой трафик проходит между двумя виртуальными сетями.</span><span class="sxs-lookup"><span data-stu-id="ac279-284">The peering connection is now complete and network traffic flows between the two virtual networks.</span></span>
![](../_images/governance-3-6.png)
9. <span data-ttu-id="ac279-285">Теперь второй **владелец рабочей нагрузки** отправляет запрос **администратору служб подписки** и добавляется к каждой из существующих сред групп ресурсов (к среде **разработки** и к **рабочей** среде) с ролью **участника**.</span><span class="sxs-lookup"><span data-stu-id="ac279-285">Now, a second **workload owner** sends a request to the **subscription service administrator** and is added to the existing **production** and **development** environment resource groups with the **contributor** role.</span></span> <span data-ttu-id="ac279-286">Второй **владелец рабочей нагрузки** имеет те же разрешения, что и первый **владелец рабочей нагрузки**, для всех ресурсов в каждой группе ресурсов.</span><span class="sxs-lookup"><span data-stu-id="ac279-286">The second **workload owner** has the same permissions on all resources as the first **workload owner** in each resource group.</span></span> 
![](../_images/governance-3-7.png)
10. <span data-ttu-id="ac279-287">Второй **владелец рабочей нагрузки** создает подсеть в виртуальной сети **prod-vnet**, а затем добавляет две виртуальные машины.</span><span class="sxs-lookup"><span data-stu-id="ac279-287">The second **workload owner** creates a subnet in the **prod-vnet** virtual network, then adds two virtual machines.</span></span> <span data-ttu-id="ac279-288">Второй **владелец рабочей нагрузки** применяет теги *environment* и *managedBy* для каждого ресурса.</span><span class="sxs-lookup"><span data-stu-id="ac279-288">The second **workload owner** applies the *environment* and *managedBy* tags to each resource.</span></span>
![](../_images/governance-3-8.png) 

<span data-ttu-id="ac279-289">Этот пример модели управления ресурсами позволяет управлять ресурсами в трех требуемых средах.</span><span class="sxs-lookup"><span data-stu-id="ac279-289">This example resource management model enables us to manage resources in the three required environments.</span></span> <span data-ttu-id="ac279-290">Ресурсы общей инфраструктуры защищены, так как в подписке есть только один пользователь с правом доступа к этим ресурсам.</span><span class="sxs-lookup"><span data-stu-id="ac279-290">The shared infrastructure resources are protected because there's only a single user in the subscription with permission to access those resources.</span></span> <span data-ttu-id="ac279-291">Каждый из владельцев рабочей нагрузки может использовать ресурсы общей инфраструктуры, не имея каких-либо разрешений на эти общие ресурсы.</span><span class="sxs-lookup"><span data-stu-id="ac279-291">Each of the workload owners is able to utilize the share infrastructure resources without having any permissions on the actual shared resources themselves.</span></span> <span data-ttu-id="ac279-292">Но эта модель управления не отвечает требованию к изоляции рабочей нагрузки, так как оба **владельца рабочей нагрузки** имеют доступ к ресурсам друг друга.</span><span class="sxs-lookup"><span data-stu-id="ac279-292">However, This management model fails the requirement for workload isolation - each of the two **workload owners** are able to access the resources of the other's workload.</span></span> 

<span data-ttu-id="ac279-293">Есть еще одно важное замечание к этой модели, которое может быть не сразу очевидно.</span><span class="sxs-lookup"><span data-stu-id="ac279-293">There's another important consideration with this model that may not be immediately obvious.</span></span> <span data-ttu-id="ac279-294">В примере **владелец рабочей нагрузки аpp1** запросил сетевое пиринговое соединение с **hub-vnet**, чтобы обеспечить возможность подключения к локальной сети.</span><span class="sxs-lookup"><span data-stu-id="ac279-294">In the example, it was **app1 workload owner** that requested the network peering connection with the **hub-vnet** to provide connectivity to on-premises.</span></span> <span data-ttu-id="ac279-295">Пользователь **сетевых операций** оценил этот запрос на основании ресурсов, развертываемых с этой рабочей нагрузкой.</span><span class="sxs-lookup"><span data-stu-id="ac279-295">The **network operations** user evaluated that request based on the resources deployed with that workload.</span></span> <span data-ttu-id="ac279-296">Когда **владелец подписки** добавил **владельца рабочей нагрузки app2** с ролью **участника**, у этого пользователя были права доступа к управлению всеми ресурсами в группе ресурсов **prod-rg**.</span><span class="sxs-lookup"><span data-stu-id="ac279-296">When the **subscription owner** added **app2 workload owner** with the **contributor** role, that user had management access rights to all resources in the **prod-rg** resource group.</span></span> 

![](../_images/governance-3-10.png)

<span data-ttu-id="ac279-297">Это значит, что **владелец рабочей нагрузки app2** имел разрешение на развертывание своей собственной подсети с виртуальными машинами в виртуальной сети **prod-vnet**.</span><span class="sxs-lookup"><span data-stu-id="ac279-297">This means **app2 workload owner** had permission to deploy their own subnet with virtual machines in the **prod-vnet** virtual network.</span></span> <span data-ttu-id="ac279-298">По умолчанию эти виртуальные машины теперь имеют доступ к локальной сети.</span><span class="sxs-lookup"><span data-stu-id="ac279-298">By default, those virtual machines now have access to the on-premises network.</span></span> <span data-ttu-id="ac279-299">Пользователь **сетевых операций** не имеет сведений о компьютерах и не утвердил их подключение к локальной сети.</span><span class="sxs-lookup"><span data-stu-id="ac279-299">The **network operations** user is not aware of those machines and did not approve their connectivity to on-premises.</span></span>

<span data-ttu-id="ac279-300">Затем давайте рассмотрим единую подписку с несколькими группами ресурсов для разных сред и рабочих нагрузок.</span><span class="sxs-lookup"><span data-stu-id="ac279-300">Next, let's look at a single subscription with multiple resources groups for different environments and workloads.</span></span> <span data-ttu-id="ac279-301">Обратите внимание, что в предыдущем примере ресурсы для каждой среды были легко идентифицируемы, поскольку они находились в одной группе ресурсов.</span><span class="sxs-lookup"><span data-stu-id="ac279-301">Note that in the previous example, the resources for each environment were easily identifiable because they were in the same resource group.</span></span> <span data-ttu-id="ac279-302">Теперь, когда больше нет этой группировки, для обеспечения этой функциональности придется полагаться на соглашение об именовании групп ресурсов.</span><span class="sxs-lookup"><span data-stu-id="ac279-302">Now that we no longer have that grouping, we will have to rely on a resource group naming convention to provide that functionality.</span></span> 

1. <span data-ttu-id="ac279-303">Ресурсы **общей инфраструктуры** в этой модели все еще имеют отдельную группу ресурсов, поэтому она останется прежней.</span><span class="sxs-lookup"><span data-stu-id="ac279-303">The **shared infrastructure** resources will still have a separate resource group in this model, so that remains the same.</span></span> <span data-ttu-id="ac279-304">Для каждой рабочей нагрузки требуются две группы ресурсов — по одной для среды **разработки** и для **рабочей** среды.</span><span class="sxs-lookup"><span data-stu-id="ac279-304">Each workload requires two resource groups - one for each of the **development** and **production** environments.</span></span> <span data-ttu-id="ac279-305">Для первой рабочей нагрузки **владелец подписки** создает две группы ресурсов.</span><span class="sxs-lookup"><span data-stu-id="ac279-305">For the first workload, the **subscription owner** creates two resource groups.</span></span> <span data-ttu-id="ac279-306">Первая называется **app1-prod-rg**, а вторая — **app1-dev-rg**.</span><span class="sxs-lookup"><span data-stu-id="ac279-306">The first is named **app1-prod-rg** and the second one is named **app1-dev-rg**.</span></span> <span data-ttu-id="ac279-307">Как обсуждалось ранее, это соглашение об именовании идентифицирует ресурсы как связанные с первой рабочей нагрузкой **app1** и либо со средой **dev**, либо со средой **prod**.</span><span class="sxs-lookup"><span data-stu-id="ac279-307">As discussed earlier, this naming convention identifies the resources as being associated with the first workload, **app1**, and either the **dev** or **prod** environment.</span></span> <span data-ttu-id="ac279-308">Опять же, владелец *подписки* добавляет **владельца рабочей нагрузки аpp1** в группу ресурсов с ролью **участника**.</span><span class="sxs-lookup"><span data-stu-id="ac279-308">Again, the *subscription* owner adds **app1 workload owner** to the resource group with the **contributor** role.</span></span>
![](../_images/governance-3-12.png)
2. <span data-ttu-id="ac279-309">Как и в первом примере **владелец рабочей нагрузки аpp1** развертывает виртуальную сеть с именем **app1-prod-vnet** в **рабочей** среде, а другой — виртуальную сеть **app1- dev-vnet** в среде **разработки**.</span><span class="sxs-lookup"><span data-stu-id="ac279-309">Similar to the first example, **app1 workload owner** deploys a virtual network named **app1-prod-vnet** to the **production** environment, and another named **app1-dev-vnet** to the **development** environment.</span></span> <span data-ttu-id="ac279-310">Опять же, **владелец рабочей нагрузки аpp1** отправляет запрос пользователю **сетевых операций** для создания пирингового соединения.</span><span class="sxs-lookup"><span data-stu-id="ac279-310">Again, **app1 workload owner** sends a request to the **network operations** user to create a peering connection.</span></span> <span data-ttu-id="ac279-311">Обратите внимание, что **владелец рабочей нагрузки аpp1** добавляет те же теги, что и в первом примере, а счетчик границ был уменьшен до 47 виртуальных сетей, оставшихся в подписке.</span><span class="sxs-lookup"><span data-stu-id="ac279-311">Note that **app1 workload owner** adds the same tags as in the first example, and the limit counter has been decremented to 47 virtual networks remaining in the subscription.</span></span>
![](../_images/governance-3-13.png)
3. <span data-ttu-id="ac279-312">**Владелец подписки** теперь создает две группы ресурсов для **владельца рабочей нагрузки app2**.</span><span class="sxs-lookup"><span data-stu-id="ac279-312">The **subscription owner** now creates two resource groups for **app2 workload owner**.</span></span> <span data-ttu-id="ac279-313">Следуя тем же соглашениям, что и для **владельца рабочей нагрузки app1**, группы ресурсов называются **app2-prod-rg** и **app2-dev-rg**.</span><span class="sxs-lookup"><span data-stu-id="ac279-313">Following the same conventions as for **app1 workload owner**, the resource groups are named **app2-prod-rg** and **app2-dev-rg**.</span></span> <span data-ttu-id="ac279-314">**Владелец подписки** добавляет **владельца рабочей нагрузки app2** к каждой из групп ресурсов с ролью **участника**.</span><span class="sxs-lookup"><span data-stu-id="ac279-314">The **subscription owner** adds **app2 workload owner** to each of the resource groups with the **contributor** role.</span></span>
![](../_images/governance-3-14.png)
4. <span data-ttu-id="ac279-315">*Владелец рабочей нагрузки App2* развертывает виртуальные сети и виртуальные машины в группе ресурсов с теми же соглашениями об именовании.</span><span class="sxs-lookup"><span data-stu-id="ac279-315">*App2 workload owner* deploys virtual networks and virtual machines to the resource groups with the same naming conventions.</span></span> <span data-ttu-id="ac279-316">Добавляются теги, а счетчик границ уменьшается до 45 виртуальных сетей, остающихся в *подписке*.</span><span class="sxs-lookup"><span data-stu-id="ac279-316">Tags are added and the limit counter has been decremented to 45 virtual networks remaining in the *subscription*.</span></span>
![](../_images/governance-3-15.png)
5. <span data-ttu-id="ac279-317">*Владелец рабочей нагрузки App2* отправляет запрос пользователю *сетевых операций* для установки кэширующего узла *app2-prod-vnet* с *hub-vnet*.</span><span class="sxs-lookup"><span data-stu-id="ac279-317">*App2 workload owner* sends a request to the *network operations* user to peer the *app2-prod-vnet* with the *hub-vnet*.</span></span> <span data-ttu-id="ac279-318">Пользователь *сетевых операций* создает пиринговое соединение.</span><span class="sxs-lookup"><span data-stu-id="ac279-318">The *network operations* user creates the peering connection.</span></span>
![](../_images/governance-3-16.png)

<span data-ttu-id="ac279-319">Полученная модель управления похожа на первый пример с несколькими ключевыми отличиями.</span><span class="sxs-lookup"><span data-stu-id="ac279-319">The resulting management model is similar to the first example, with several key differences:</span></span>
* <span data-ttu-id="ac279-320">Каждая из двух рабочих нагрузок является изолированной рабочей нагрузкой и средой.</span><span class="sxs-lookup"><span data-stu-id="ac279-320">Each of the two workloads is isolated by workload and by environment.</span></span>
* <span data-ttu-id="ac279-321">Этой модели требуются две дополнительные виртуальные сети, по сравнению с первым примером модели.</span><span class="sxs-lookup"><span data-stu-id="ac279-321">This model required two more virtual networks than the first example model.</span></span> <span data-ttu-id="ac279-322">Теоретический предел числа рабочих нагрузок для этой модели равен 24, хотя это не является важным отличием для модели только с двумя рабочими нагрузками.</span><span class="sxs-lookup"><span data-stu-id="ac279-322">While this is not an important distinction with only two workloads, the theoretical limit on the number of workloads for this model is 24.</span></span> 
* <span data-ttu-id="ac279-323">Ресурсы больше не группируются в одну группу ресурсов для каждой среды.</span><span class="sxs-lookup"><span data-stu-id="ac279-323">Resources are no longer grouped in a single resource group for each environment.</span></span> <span data-ttu-id="ac279-324">Для группирования ресурсов требуется понимание соглашений об именовании, используемых для каждой среды.</span><span class="sxs-lookup"><span data-stu-id="ac279-324">Grouping resources requires an understanding of the naming conventions used for each environment.</span></span> 
* <span data-ttu-id="ac279-325">Каждое из подключенных виртуальных сетевых соединений было рассмотрено и одобрено пользователем *сетевых операций*.</span><span class="sxs-lookup"><span data-stu-id="ac279-325">Each of the peered virtual network connections was reviewed and approved by the *network operations* user.</span></span>

<span data-ttu-id="ac279-326">Теперь давайте рассмотрим модель управления ресурсами, использующую несколько подписок.</span><span class="sxs-lookup"><span data-stu-id="ac279-326">Now let's look at a resource management model using multiple subscriptions.</span></span> <span data-ttu-id="ac279-327">В этой модели мы выровняем каждую из трех сред с отдельной подпиской: подписка **общих служб**, **рабочая** подписка и, наконец, подписка **разработки**.</span><span class="sxs-lookup"><span data-stu-id="ac279-327">In this model, we'll align each of the three environments to a separate subscription: a **shared services** subscription, **production** subscription, and finally a **development** subscription.</span></span> <span data-ttu-id="ac279-328">Соображения для этой модели аналогичны модели, использующей единую подписку, в которой необходимо решить, как уровнять группы ресурсов с рабочими нагрузками.</span><span class="sxs-lookup"><span data-stu-id="ac279-328">The considerations for this model are similar to a model using a single subscription in that we have to decide how to align resource groups to workloads.</span></span> <span data-ttu-id="ac279-329">Как выяснилось, создание группы ресурсов для каждой рабочей нагрузки удовлетворяет требованию к изоляции рабочей нагрузки, поэтому в примере будем придерживаться этой модели.</span><span class="sxs-lookup"><span data-stu-id="ac279-329">We've already determined that creating a resource group for each workload satisfies the workload isolation requirement, so we'll stick with that model in this example.</span></span>

1. <span data-ttu-id="ac279-330">В этой модели существуют три *подписки*: *общая инфраструктура*, *рабочая* и *разработка*.</span><span class="sxs-lookup"><span data-stu-id="ac279-330">In this model, there are three *subscriptions*: *shared infrastructure*, *production*, and *development*.</span></span> <span data-ttu-id="ac279-331">Для каждой из этих трех подписок требуется *владелец подписки*. В простейшем случае будем использовать одну учетную запись для всех трех подписок.</span><span class="sxs-lookup"><span data-stu-id="ac279-331">Each of these three subscriptions requires a *subscription owner*, and in the simple example we'll use the same user account for all three.</span></span> <span data-ttu-id="ac279-332">Ресурсы *общей инфраструктуры* управляются аналогично первым двум приведенным выше примерам, а первая рабочая нагрузка связана с *app1-rg* в *рабочей* среде и с так же называемой группой ресурсов в среде *разработки*.</span><span class="sxs-lookup"><span data-stu-id="ac279-332">The *shared infrastructure* resources are managed similarly to the first two examples above, and the first workload is associated with the *app1-rg* in the *production* environment and the same-named resource group in the *development* environment.</span></span> <span data-ttu-id="ac279-333">*Владелец рабочей нагрузки аpp1* добавляется в каждую группу ресурсов с ролью *участника*.</span><span class="sxs-lookup"><span data-stu-id="ac279-333">The *app1 workload owner* is added to each of the resource group with the *contributor* role.</span></span> 
![](../_images/governance-3-17.png)
2. <span data-ttu-id="ac279-334">Как и в предыдущих примерах, *владелец рабочей нагрузки аpp1* создает ресурсы и запрашивает пиринговое подключение с виртуальной сетью *общей инфраструктуры*.</span><span class="sxs-lookup"><span data-stu-id="ac279-334">As with the earlier examples, *app1 workload owner* creates the resources and requests the peering connection with the *shared infrastructure* virtual network.</span></span> <span data-ttu-id="ac279-335">*Владелец рабочей нагрузки App1* добавляет только тег *managedBy*, так как тег *environment* больше не требуется.</span><span class="sxs-lookup"><span data-stu-id="ac279-335">*App1 workload owner* adds only the *managedBy* tag because there is no longer a need for the *environment* tag.</span></span> <span data-ttu-id="ac279-336">То есть, ресурсы для каждой среды теперь сгруппированы в одну и ту же *подписку*, а тэг *environment* является избыточным.</span><span class="sxs-lookup"><span data-stu-id="ac279-336">That is, resources are for each environment are now grouped in the same *subscription* and the *environment* tag is redundant.</span></span> <span data-ttu-id="ac279-337">Счетчик ограничений уменьшается до 49 виртуальных сетей.</span><span class="sxs-lookup"><span data-stu-id="ac279-337">The limit counter is decremented to 49 virtual networks remaining.</span></span>
![](../_images/governance-3-18.png)
3. <span data-ttu-id="ac279-338">Наконец *владелец подписки* повторяет процесс для второй рабочей нагрузки, добавляя группы ресурсов *владельцу рабочей нагрузки аpp2* в \*роли участника.</span><span class="sxs-lookup"><span data-stu-id="ac279-338">Finally, the *subscription owner* repeats the process for the second workload, adding the resource groups with the *app2 workload owner* in the \*contributor role.</span></span> <span data-ttu-id="ac279-339">Счетчик ограничений для каждой подписки на среду уменьшается до 48 виртуальных сетей.</span><span class="sxs-lookup"><span data-stu-id="ac279-339">The limit counter for each of the environment subscriptions is decremented to 48 virtual networks remaining.</span></span> 

<span data-ttu-id="ac279-340">Эта модель управления имеет преимущества по сравнению со вторым примером.</span><span class="sxs-lookup"><span data-stu-id="ac279-340">This management model has the benefits of the second example above.</span></span> <span data-ttu-id="ac279-341">Однако ключевое различие заключается в том, что границы являются менее значимыми так как они распределены по двум *подпискам*.</span><span class="sxs-lookup"><span data-stu-id="ac279-341">However, the key difference is that limits are less of an issue due to the fact that they are spread over two *subscriptions*.</span></span> <span data-ttu-id="ac279-342">Недостатком является то, что данные по затратам, отслеживаемые с помощью тегов, должны быть агрегированы по всем трем *подпискам*.</span><span class="sxs-lookup"><span data-stu-id="ac279-342">The drawback is that the cost data tracked by tags must be aggregated across all three *subscriptions*.</span></span> 

<span data-ttu-id="ac279-343">Таким образом можно выбрать любой из этих двух примеров моделей управления ресурсами в зависимости от приоритета требований.</span><span class="sxs-lookup"><span data-stu-id="ac279-343">Therefore, you can select any of these two examples resource management models depending on the priority of your requirements.</span></span> <span data-ttu-id="ac279-344">Если предполагается, что ваша организация не достигнет ограничения для служб для одной подписки, можно использовать одну подписку с несколькими группами ресурсов.</span><span class="sxs-lookup"><span data-stu-id="ac279-344">If you anticipate that your organization will not reach the service limits for a single subscription, you can use a single subscription with multiple resource groups.</span></span> <span data-ttu-id="ac279-345">И наоборот — если ваша организация планирует использовать много рабочих нагрузок, несколько подписок для каждой среды будет лучшим решением.</span><span class="sxs-lookup"><span data-stu-id="ac279-345">Conversely, if your organization anticipates many workloads, multiple subscriptions for each environment may be better.</span></span>

## <a name="implementing-the-resource-management-model"></a><span data-ttu-id="ac279-346">Реализация модели управления ресурсами</span><span class="sxs-lookup"><span data-stu-id="ac279-346">Implementing the resource management model</span></span>

<span data-ttu-id="ac279-347">Вы изучили несколько моделей управления доступом к ресурсам Azure.</span><span class="sxs-lookup"><span data-stu-id="ac279-347">You've learned about several different models for governing access to Azure resources.</span></span> <span data-ttu-id="ac279-348">Давайте рассмотрим шаги, необходимые для реализации модели управления ресурсами с одной подпиской для каждой **общей инфраструктуры**, **рабочей среды** и среды **разработки**, описанные в руководстве по проектированию.</span><span class="sxs-lookup"><span data-stu-id="ac279-348">Now we'll walk through the steps necessary to implement the resource management model with one subscription for each of the **shared infrastructure**, **production**, and **development** environments from the design guide.</span></span> <span data-ttu-id="ac279-349">**Владельцем подписки** для всех трех сред будет один человек.</span><span class="sxs-lookup"><span data-stu-id="ac279-349">We'll have one **subscription owner** for all three environments.</span></span> <span data-ttu-id="ac279-350">Каждая рабочая нагрузка будет изолирована в **группе ресурсов** с помощью **владельца рабочей нагрузки**, которому при добавлении назначается роль **участника**.</span><span class="sxs-lookup"><span data-stu-id="ac279-350">Each workload will be isolated in a **resource group** with a **workload owner** added with the **contributor** role.</span></span>

> [!NOTE]
> <span data-ttu-id="ac279-351">Дополнительную информацию о связи между учетными записями Azure и подписками можно узнать из статьи [Основные сведения о доступе к ресурсам в Azure][understand-resource-access-in-azure].</span><span class="sxs-lookup"><span data-stu-id="ac279-351">Read [understanding resource access in Azure][understand-resource-access-in-azure] to learn more about the relationship between Azure Accounts and subscriptions.</span></span> 

<span data-ttu-id="ac279-352">Выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="ac279-352">Follow these steps:</span></span>

1. <span data-ttu-id="ac279-353">Если у вашей организации нет учетной записи Azure, создайте [ее](/azure/active-directory/sign-up-organization).</span><span class="sxs-lookup"><span data-stu-id="ac279-353">Create an [Azure account](/azure/active-directory/sign-up-organization) if your organization doesn't already have one.</span></span> <span data-ttu-id="ac279-354">Пользователь, зарегистрировавший учетную запись Azure, становится ее администратором, поэтому руководство организации должно выбрать человека, который возьмет на себя эту роль.</span><span class="sxs-lookup"><span data-stu-id="ac279-354">The person who signs up for the Azure account becomes the Azure account administrator, and your organization's leadership must select an individual to assume this role.</span></span> <span data-ttu-id="ac279-355">Он будет отвечать за:</span><span class="sxs-lookup"><span data-stu-id="ac279-355">This individual will be responsible for:</span></span>
    * <span data-ttu-id="ac279-356">создание подписок;</span><span class="sxs-lookup"><span data-stu-id="ac279-356">Creating subscriptions, and</span></span>
    * <span data-ttu-id="ac279-357">создание и администрирование клиентов [Azure Active Directory (AD)](/azure/active-directory/active-directory-whatis), в которых хранится удостоверение пользователя для этих подписок.</span><span class="sxs-lookup"><span data-stu-id="ac279-357">Creating and administering [Azure Active Directory (AD)](/azure/active-directory/active-directory-whatis) tenants that store user identity for those subscriptions.</span></span>    
2. <span data-ttu-id="ac279-358">Руководство организации определяет, кто из сотрудников несет ответственность за следующие аспекты:</span><span class="sxs-lookup"><span data-stu-id="ac279-358">Your organization's leadership team decides which people are responsible for:</span></span>
    * <span data-ttu-id="ac279-359">Управление удостоверением пользователя. [Клиент Microsoft Azure Active Directory](/azure/active-directory/develop/active-directory-howto-tenant) создается по умолчанию при создании учетной записи Azure для организации, а администратор учетной записи по умолчанию добавляется в качестве [глобального администратора Microsoft Azure Active Directory](/azure/active-directory/active-directory-assign-admin-roles-azure-portal#details-about-the-global-administrator-role).</span><span class="sxs-lookup"><span data-stu-id="ac279-359">Management of user identity; an [Azure AD tenant](/azure/active-directory/develop/active-directory-howto-tenant) is created by default when your organization's Azure Account is created, and the account administrator is added as the [Azure AD global administrator](/azure/active-directory/active-directory-assign-admin-roles-azure-portal#details-about-the-global-administrator-role) by default.</span></span> <span data-ttu-id="ac279-360">Ваша организация может выбрать другого пользователя для управления удостоверением пользователя, [назначив ему роль глобального администратора Microsoft Azure Active Directory](/azure/active-directory/active-directory-users-assign-role-azure-portal).</span><span class="sxs-lookup"><span data-stu-id="ac279-360">Your organization can choose another user to manage user identity by [assigning the Azure AD global administrator role to that user](/azure/active-directory/active-directory-users-assign-role-azure-portal).</span></span> 
    * <span data-ttu-id="ac279-361">Подписки. Благодаря этому такие пользователи могут:</span><span class="sxs-lookup"><span data-stu-id="ac279-361">Subscriptions, which means these users:</span></span>
        * <span data-ttu-id="ac279-362">управлять расходами, связанными с использованием ресурсов в этой подписке;</span><span class="sxs-lookup"><span data-stu-id="ac279-362">Manage costs associated with resource usage in that subscription,</span></span>
        * <span data-ttu-id="ac279-363">реализовывать и поддерживать модель минимального разрешения для доступа к ресурсам;</span><span class="sxs-lookup"><span data-stu-id="ac279-363">Implement and maintain least permission model for resource access, and</span></span>
        * <span data-ttu-id="ac279-364">отслеживать ограничения служб.</span><span class="sxs-lookup"><span data-stu-id="ac279-364">Keep track of service limits.</span></span>
    * <span data-ttu-id="ac279-365">Общие службы инфраструктуры (при использовании вашей организацией этой модели). Вследствие этого такие пользователи несут ответственность за:</span><span class="sxs-lookup"><span data-stu-id="ac279-365">Shared infrastructure services (if your organization decides to use this model), which means this user is responsible for:</span></span>
        * <span data-ttu-id="ac279-366">подключение к локальной сети Azure;</span><span class="sxs-lookup"><span data-stu-id="ac279-366">On-premises to Azure network connectivity, and</span></span> 
        * <span data-ttu-id="ac279-367">владение сетевым подключением в Azure через пиринг виртуальной сети.</span><span class="sxs-lookup"><span data-stu-id="ac279-367">Ownership of network connectivity within Azure through virtual network peering.</span></span>
    * <span data-ttu-id="ac279-368">Владельцы рабочих нагрузок.</span><span class="sxs-lookup"><span data-stu-id="ac279-368">Workload owners.</span></span> 
3. <span data-ttu-id="ac279-369">Глобальный администратор Microsoft Azure Active Directory [создает учетные записи пользователей](/azure/active-directory/add-users-azure-active-directory) для:</span><span class="sxs-lookup"><span data-stu-id="ac279-369">The Azure AD global administrator [creates the new user accounts](/azure/active-directory/add-users-azure-active-directory) for:</span></span>
    * <span data-ttu-id="ac279-370">сотрудников, которые будут выступать в роли **владельцев подписки** для каждой подписки, связанной со средой</span><span class="sxs-lookup"><span data-stu-id="ac279-370">The person who will be the **subscription owner** for each subscription associated with each environment.</span></span> <span data-ttu-id="ac279-371">(обратите внимание, что это необходимо, только если на **администратора служб** подписки не будут возложены функции по управлению доступом к ресурсам для каждой подписки или среды);</span><span class="sxs-lookup"><span data-stu-id="ac279-371">Note that this is necessary only if the subscription **service administrator** will not be tasked with managing resource access for each subscription/environment.</span></span>
    * <span data-ttu-id="ac279-372">сотрудников, которые будут **пользователями сетевых операций**;</span><span class="sxs-lookup"><span data-stu-id="ac279-372">The person who will be the **network operations user**, and</span></span>
    * <span data-ttu-id="ac279-373">сотрудников, которые будут **владельцами рабочих нагрузок**.</span><span class="sxs-lookup"><span data-stu-id="ac279-373">The people who are **workload owner(s)**.</span></span>
4. <span data-ttu-id="ac279-374">Администратор учетной записи Azure с помощью [портала управления учетными записями Azure](https://account.azure.com) создает следующие три подписки:</span><span class="sxs-lookup"><span data-stu-id="ac279-374">The Azure account administrator creates the following three subscriptions using the [Azure account portal](https://account.azure.com):</span></span>
    * <span data-ttu-id="ac279-375">подписку для среды **общей инфраструктуры**;</span><span class="sxs-lookup"><span data-stu-id="ac279-375">A subscription for the **shared infrastructure** environment,</span></span>
    * <span data-ttu-id="ac279-376">подписку для **рабочей** среды;</span><span class="sxs-lookup"><span data-stu-id="ac279-376">A subscription for the **production** environment, and</span></span> 
    * <span data-ttu-id="ac279-377">подписку для среды **разработки**.</span><span class="sxs-lookup"><span data-stu-id="ac279-377">A subscription for the **development** environment.</span></span> 
5. <span data-ttu-id="ac279-378">Администратор учетных записей Azure [добавляет к каждой подписке ее владельца](/azure/billing/billing-add-change-azure-subscription-administrator#add-an-rbac-owner-admin-for-a-subscription-in-azure-portal).</span><span class="sxs-lookup"><span data-stu-id="ac279-378">The Azure account administrator [adds the subscription service owner to each subscription](/azure/billing/billing-add-change-azure-subscription-administrator#add-an-rbac-owner-admin-for-a-subscription-in-azure-portal).</span></span>
6. <span data-ttu-id="ac279-379">Чтобы запросить создание групп ресурсов, создайте процесс утверждения для **владельцев рабочей нагрузки**.</span><span class="sxs-lookup"><span data-stu-id="ac279-379">Create an approval process for **workload owners** to request the creation of resource groups.</span></span> <span data-ttu-id="ac279-380">Процесс утверждения может быть реализован по-разному, например по электронной почте или с помощью инструмента управления рабочими процессами, такими как [рабочие процессы SharePoint](https://support.office.com/article/introduction-to-sharepoint-workflow-07982276-54e8-4e17-8699-5056eff4d9e3).</span><span class="sxs-lookup"><span data-stu-id="ac279-380">The approval process can be implemented in many ways, such as over email, or you can using a process management tool such as [Sharepoint workflows](https://support.office.com/article/introduction-to-sharepoint-workflow-07982276-54e8-4e17-8699-5056eff4d9e3).</span></span> <span data-ttu-id="ac279-381">Процесс утверждения может состоять из следующих шагов:</span><span class="sxs-lookup"><span data-stu-id="ac279-381">The approval process can follow these steps:</span></span>  
    * <span data-ttu-id="ac279-382">**Владелец рабочей нагрузки** готовит спецификацию необходимых ресурсов Azure для среды **разработки** или **рабочей** среды (или из обеих) и отправляет ее **владельцу подписки**.</span><span class="sxs-lookup"><span data-stu-id="ac279-382">The **workload owner** prepares a bill of materials for required Azure resources in either the **development** environment, **production** environment, or both, and submits it to the **subscription owner**.</span></span>
    * <span data-ttu-id="ac279-383">**Владелец подписки** проверяет спецификацию и запрашиваемые ресурсы, чтобы убедиться в их применимости для запланированного использования. Например, он проверяет, верны ли запрошенные [размеры виртуальных машин](/azure/virtual-machines/windows/sizes).</span><span class="sxs-lookup"><span data-stu-id="ac279-383">The **subscription owner** reviews the bill of materials and validates the requested resources to ensure that the requested resources are appropriate for their planned use - for example, checking that the requested [virtual machine sizes](/azure/virtual-machines/windows/sizes) are correct.</span></span>
    * <span data-ttu-id="ac279-384">Если запрос не будет подтвержден, **владелец рабочей нагрузки** получит уведомление.</span><span class="sxs-lookup"><span data-stu-id="ac279-384">If the request is not approved, the **workload owner** is notified.</span></span> <span data-ttu-id="ac279-385">Если запрос подтвержден, **владелец подписки** [создает запрашиваемую группу ресурсов](/azure/azure-resource-manager/resource-group-portal#manage-resource-groups), следуя [соглашению об именовании](/azure/architecture/best-practices/naming-conventions) в организации, [добавляет **владельца рабочей нагрузки**](/azure/role-based-access-control/role-assignments-portal#add-access) с [ролью **участник**](/azure/role-based-access-control/built-in-roles#contributor) и отправляет уведомление **владельцу рабочей нагрузки** о том, что группа ресурсов создана.</span><span class="sxs-lookup"><span data-stu-id="ac279-385">If the request is approved, the **subscription owner** [creates the requested resource group](/azure/azure-resource-manager/resource-group-portal#manage-resource-groups) following your organization's [naming conventions](/azure/architecture/best-practices/naming-conventions), [adds the **workload owner**](/azure/role-based-access-control/role-assignments-portal#add-access) with the [**contributor** role](/azure/role-based-access-control/built-in-roles#contributor) and sends notification to the **workload owner** that the resource group has been created.</span></span>
7. <span data-ttu-id="ac279-386">Чтобы запросить пиринговое соединение с виртуальной сетью у владельца общей инфраструктуры, для владельцев рабочей нагрузки создается процесс утверждения.</span><span class="sxs-lookup"><span data-stu-id="ac279-386">Create an approval process for workload owners to request a virtual network peering connection from the shared infrastructure owner.</span></span> <span data-ttu-id="ac279-387">Как и на предыдущем этапе, этот процесс утверждения может быть реализован с использованием электронной почты или инструмента управления процессами.</span><span class="sxs-lookup"><span data-stu-id="ac279-387">As with the previous step, this approval process can be implemented using email or a process management tool.</span></span>

<span data-ttu-id="ac279-388">После внедрения своей модели управления можно развернуть службы общей инфраструктуры.</span><span class="sxs-lookup"><span data-stu-id="ac279-388">Now that you've implemented your governance model, you can deploy your shared infrastructure services.</span></span>

## <a name="next-steps"></a><span data-ttu-id="ac279-389">Дополнительная информация</span><span class="sxs-lookup"><span data-stu-id="ac279-389">Next steps</span></span>
> [!div class="nextstepaction"]
> [<span data-ttu-id="ac279-390">Сведения о развертывании базовой инфраструктуры</span><span class="sxs-lookup"><span data-stu-id="ac279-390">Learn about deploying a basic infrastructure</span></span>](../infrastructure/basic-workload.md)

<!-- links -->
[understand-resource-access-in-azure]: /azure/role-based-access-control/rbac-and-directory-admin-roles

<!-- links -->

[rbac-built-in-owner]: /azure/role-based-access-control/built-in-roles#owner
[rbac-built-in-roles]: /azure/role-based-access-control/built-in-roles
